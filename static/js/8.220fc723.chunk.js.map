{"version":3,"sources":["dice/environment.dds","hooks/usePreventTouch.ts","components/dice/DiceInteraction.tsx","dice/shared/d4.glb","dice/shared/d6.glb","dice/shared/d8.glb","dice/shared/d10.glb","dice/shared/d12.glb","dice/shared/d20.glb","dice/shared/d100.glb","helpers/babylon.ts","types/Dice.ts","dice/Dice.ts","icons/ExpandMoreDiceTrayIcon.tsx","icons/ShareDiceOnIcon.tsx","icons/ShareDiceOffIcon.tsx","components/dice/DiceButtonCount.tsx","components/dice/DiceButton.tsx","icons/SelectDiceIcon.tsx","components/dice/DiceTile.tsx","components/dice/DiceTiles.tsx","dice/galaxy/albedo.jpg","dice/galaxy/metalRoughness.jpg","dice/galaxy/normal.jpg","dice/galaxy/GalaxyDice.ts","dice/iron/albedo.jpg","dice/iron/metalRoughness.jpg","dice/iron/normal.jpg","dice/iron/IronDice.ts","dice/nebula/albedo.jpg","dice/nebula/metalRoughness.jpg","dice/nebula/normal.jpg","dice/nebula/NebulaDice.ts","dice/sunrise/albedo.jpg","dice/sunrise/metalRoughness.jpg","dice/sunrise/normal.jpg","dice/sunrise/SunriseDice.ts","dice/sunset/albedo.jpg","dice/sunset/metalRoughness.jpg","dice/sunset/normal.jpg","dice/sunset/SunsetDice.ts","dice/walnut/albedo.jpg","dice/walnut/metalRoughness.jpg","dice/walnut/normal.jpg","dice/walnut/WalnutDice.ts","dice/walnut/d4.glb","dice/walnut/d6.glb","dice/walnut/d8.glb","dice/walnut/d10.glb","dice/walnut/d12.glb","dice/walnut/d20.glb","dice/walnut/d100.glb","dice/glass/albedo.jpg","dice/glass/mask.png","dice/glass/normal.jpg","dice/glass/GlassDice.ts","dice/gemstone/albedo.jpg","dice/gemstone/metalRoughness.jpg","dice/gemstone/normal.jpg","dice/gemstone/GemstoneDice.ts","dice/galaxy/preview.png","dice/iron/preview.png","dice/nebula/preview.png","dice/sunrise/preview.png","dice/sunset/preview.png","dice/walnut/preview.png","dice/glass/preview.png","dice/gemstone/preview.png","dice/index.ts","modals/SelectDiceModal.tsx","components/dice/SelectDiceButton.tsx","components/dice/DiceButtons.tsx","icons/ClearDiceIcon.tsx","icons/RerollDiceIcon.tsx","components/dice/DiceResults.tsx","dice/diceTray/single.glb","dice/diceTray/double.glb","dice/diceTray/singleAlbedo.jpg","dice/diceTray/singleMetalRoughness.jpg","dice/diceTray/singleNormal.jpg","dice/diceTray/doubleAlbedo.jpg","dice/diceTray/doubleMetalRoughness.jpg","dice/diceTray/doubleNormal.jpg","dice/diceTray/DiceTray.ts","components/dice/DiceTrayOverlay.tsx"],"names":["usePreventTouch","elementRef","useEffect","prevent3DTouch","event","preventDefault","element","current","addEventListener","removeEventListener","DiceInteraction","onSceneMount","onPointerDown","onPointerUp","useState","error","setError","sceneRef","useRef","engineRef","canvasRef","containerRef","canvas","engine","Engine","isSafari","preserveDrawingBuffer","stencil","xrCompatible","scene","Scene","clearColor","Color4","Ammo","then","enablePhysics","Vector3","AmmoJSPlugin","camera","TargetCamera","fov","setTarget","Zero","runRenderLoop","selectedMesh","selectedMeshRef","ray","createPickingRay","pointerX","pointerY","Matrix","Identity","currentPosition","getAbsolutePosition","newPosition","origin","scale","globalPosition","y","delta","subtract","setAbsolutePosition","velocity","deltaTime","selectedMeshVelocityWindowRef","slice","Math","max","length","selectedMeshVelocityWindowSize","push","Error","selectedMeshMassRef","handlePointerUp","velocityWindow","v","addInPlace","scaleInPlace","physicsImpostor","setMass","forceUpdate","applyImpulse","mass","getObjectCenter","style","width","height","position","overflow","ref","handleWidth","handleHeight","onResize","resize","targetRef","pickInfo","pick","hit","pickedMesh","name","setLinearVelocity","setAngularVelocity","onPointerCancel","onPointerLeave","outline","ErrorBanner","onRequestClose","undefined","defaultProps","importTextureAsync","url","a","Promise","resolve","reject","texture","Texture","isDiceMeshes","meshes","d4","d6","d8","d10","d12","d20","d100","Dice","material","sourceOverrides","addToMeshes","type","defaultSource","source","loadMesh","mesh","all","d4Source","d6Source","d8Source","d10Source","d12Source","d20Source","d100Source","SceneLoader","ImportMeshAsync","setParent","receiveShadows","isVisible","materialName","textures","pbr","PBRMaterial","albedo","normal","metalRoughness","albedoTexture","bumpTexture","metallicTexture","useRoughnessFromMetallicTextureAlpha","useRoughnessFromMetallicTextureGreen","useMetallnessFromMetallicTextureBlue","physicalProperties","instance","createInstance","getChildTransformNodes","child","locator","clone","addChild","PhysicsImpostor","ConvexHullImpostor","diceType","friction","getScene","diceTraySingle","getMeshByID","diceTrayDouble","visibleDiceTray","trayBounds","getBoundingInfo","boundingBox","center","x","random","z","addRotation","PI","throwTarget","lerp","minimumWorld","maximumWorld","impulse","normalizeToNew","this","instanceCount","createInstanceFromMesh","ExpandMoreDotIcon","xmlns","viewBox","fill","d","ShareDiceOnIcon","ShareDiceOffIcon","DiceButtonCount","children","sx","top","right","transform","display","alignItems","variant","as","color","fontSize","fontWeight","DiceButton","title","count","onClick","disabled","SelectDiceIcon","DiceTile","dice","isSelected","onDiceSelect","onDone","cursor","Tile","onSelect","onDoubleClick","src","preview","DiceTiles","selectedDice","layout","useResponsiveLayout","tileContainerHeight","p","pb","bg","borderRadius","minHeight","screenSize","gap","columns","tileGridColumns","map","key","GalaxyDice","loadMaterial","loadMeshes","getDicePhysicalProperties","IronDice","properties","createInstanceMesh","NebulaDice","SunriseDice","SunsetDice","WalnutDice","GlassDice","mask","roughness","metallic","subSurface","isRefractionEnabled","indexOfRefraction","refractionIntensity","isTranslucencyEnabled","translucencyIntensity","minimumThickness","maximumThickness","tintColor","Color3","thicknessTexture","useMaskFromThicknessTexture","loadGlassMaterial","GemstoneDice","diceClasses","galaxy","nebula","sunrise","sunset","iron","walnut","glass","gemstone","dicePreviews","GalaxyPreview","NebulaPreview","SunrisePreview","SunsetPreview","IronPreview","WalnutPreview","GlassPreview","GemstonePreview","Object","keys","Case","capital","class","SelectDiceModal","isOpen","defaultDice","setSelectedDice","Modal","content","maxWidth","modalSize","flexDirection","pt","my","SelectDiceButton","onDiceChange","currentDice","isModalOpen","setIsModalOpen","closeModal","DiceButtons","diceRolls","onDiceAdd","onDiceLoad","diceTraySize","onDiceTraySizeChange","shareDice","onShareDiceChange","loading","useSetting","currentDiceStyle","setCurrentDiceStyle","find","setCurrentDice","initialDice","diceCounts","buttons","D20Icon","D12Icon","D10Icon","D8Icon","D6Icon","D4Icon","D100Icon","left","maxHeight","pointerEvents","justifyContent","Divider","button","ExpandMoreDiceTrayIcon","ClearDiceIcon","RerollDiceIcon","DiceResults","onDiceClear","onDiceReroll","isExpanded","setIsExpanded","rolls","filter","roll","index","Fragment","bottom","ml","userSelect","getDiceRollTotal","mr","DiceTray","initialSize","shadowGenerator","_size","collisionSize","wallTop","wallRight","wallBottom","wallLeft","singleMesh","doubleMesh","newSize","wallOffsetWidth","wallOffsetHeight","size","loadWalls","collision","Mesh","CreateBox","DOUBLESIDE","BoxImpostor","createCollision","singleMeshSource","doubleMeshSource","singleAlbedo","singleNormal","singleMetalRoughness","doubleAlbedo","doubleNormal","doubleMetalRoughness","singleMeshes","doubleMeshes","singleAlbedoTexture","singleNormalTexture","singleMetalRoughnessTexture","doubleAlbedoTexture","doubleNormalTexture","doubleMetalRoughnessTexture","id","singleMaterial","addShadowCaster","doubleMaterial","DiceTrayOverlay","onDiceRollsChange","shadowGeneratorRef","diceRefs","sceneVisibleRef","sceneInteractionRef","sceneKeepAwakeRef","diceTrayRef","setDiceTraySize","useDiceLoading","assetLoadStart","assetLoadFinish","isLoading","fullScreen","handleAssetLoadStart","handleAssetLoadFinish","forceRender","triggered","timeout","setTimeout","clearTimeout","cleanup","diceTray","handleSceneMount","useCallback","initializeScene","update","light","DirectionalLight","shadowMinZ","shadowMaxZ","ShadowGenerator","useCloseExponentialShadowMap","darkness","environmentTexture","CubeTexture","CreateFromPrefilteredData","environment","environmentIntensity","load","die","forceSceneRender","sceneInteraction","diceAwake","asleep","includes","i","speed","diceSpeed","getLinearVelocity","d10Instance","d10Speed","getDiceSpeed","sleepTimeout","render","traySize","setTraySize","renderTimeout","renderCleanup","handleResize","document","querySelector","mapRect","getBoundingClientRect","availableWidth","availableHeight","min","window","updateInterval","setInterval","newRolls","getDiceRoll","clearInterval","dispose","handleDiceClear","handleDiceAdd","LoadingOverlay"],"mappings":"mPAAe,MAA0B,wC,0HCqB1BA,MAnBf,SAAyBC,GACvBC,oBAAU,WAER,SAASC,EAAeC,GACtBA,EAAMC,gBACP,CACD,IAAMC,EAAUL,EAAWM,QAK3B,OAJID,GACFA,EAAQE,iBAAiB,aAAcL,GAAgB,GAGlD,WACDG,GACFA,EAAQG,oBAAoB,aAAcN,EAE7C,CACF,EAAE,CAACF,GACL,E,iBCqBD,SAASS,EAAT,GAI0B,IAHxBC,EAGuB,EAHvBA,aACAC,EAEuB,EAFvBA,cACAC,EACuB,EADvBA,YACuB,EACGC,qBADH,mBAChBC,EADgB,KACTC,EADS,KAGjBC,EAAWC,mBACXC,EAAYD,mBACZE,EAAYF,iBAA0B,MACtCG,EAAeH,iBAAuB,MAE5ChB,oBAAU,WACR,IAAMoB,EAASF,EAAUb,QAEzB,GAAKe,EAIL,IAGE,IAAMC,EAAS,IAAIC,IAAOF,GAASG,IAAU,CAC3CC,uBAAuB,EACvBC,SAAS,EAGTC,cAAc,IAEVC,EAAQ,IAAIC,IAAMP,GACxBM,EAAME,WAAa,IAAIC,IAAO,EAAG,EAAG,EAAG,GAEvCC,MAAOC,KAAK,WACVL,EAAMM,cAAc,IAAIC,IAAQ,GAAI,GAAI,GAAI,IAAIC,KAAa,GAC9D,GAED,IAAIC,EAAS,IAAIC,IAAa,SAAU,IAAIH,IAAQ,EAAG,KAAM,GAAIP,GACjES,EAAOE,IAAM,IACbF,EAAOG,UAAUL,IAAQM,QAEzB/B,GAAgBA,EAAa,CAAEkB,QAAON,SAAQD,WAE9CH,EAAUZ,QAAUgB,EACpBN,EAASV,QAAUsB,EAEnBN,EAAOoB,cAAc,WACnB,IAAMd,EAAQZ,EAASV,QACjBqC,EAAeC,EAAgBtC,QACrC,GAAIqC,GAAgBf,EAAO,CACzB,IAAMiB,EAAMjB,EAAMkB,iBAChBlB,EAAMmB,SACNnB,EAAMoB,SACNC,IAAOC,WACPb,GAEIc,EAAkBR,EAAaS,sBACjCC,EAAcR,EAAIS,OAAOC,MAAMlB,EAAOmB,eAAeC,GACzDJ,EAAYI,EAAIN,EAAgBM,EAChC,IAAMC,EAAQL,EAAYM,SAASR,GACnCR,EAAaiB,oBAAoBP,GACjC,IAAMQ,EAAWH,EAAMH,MAAM,IAAO3B,EAAMkC,WAC1CC,EAA8BzD,QAC5ByD,EAA8BzD,QAAQ0D,MACpCC,KAAKC,IACHH,EAA8BzD,QAAQ6D,OACpCC,EACF,IAGNL,EAA8BzD,QAAQ+D,KAAKR,EAC5C,CACF,EACF,CAAC,MAAO/C,GACHA,aAAiBwD,OACnBvD,EAASD,EAEZ,CACF,EAAE,CAACJ,IAEJ,IAAMkC,EAAkB3B,iBAA4B,MAC9C8C,EAAgC9C,iBAAkB,IAClDmD,EAAiC,EACjCG,EAAsBtD,iBAAe,GAyB3C,SAASuD,IACP,IAAM7B,EAAeC,EAAgBtC,QAC/BmE,EAAiBV,EAA8BzD,QAC/CsB,EAAQZ,EAASV,QACvB,GAAIqC,GAAgBf,EAAO,CAAC,IAAD,QAErBiC,EAAW1B,IAAQM,OAFE,cAGXgC,GAHW,IAGzB,2BAA8B,CAAC,IAAtBC,EAAqB,QAC5Bb,EAASc,WAAWD,EACrB,CALwB,+BAMrBD,EAAeN,OAAS,GAC1BN,EAASe,aAAa,EAAIH,EAAeN,QAI3C,UAAAxB,EAAakC,uBAAb,SAA8BC,QAAQP,EAAoBjE,SAC1D,UAAAqC,EAAakC,uBAAb,SAA8BE,cAE9B,UAAApC,EAAakC,uBAAb,SAA8BG,aAC5BnB,EAASN,MA9IM,EA8IiBZ,EAAakC,gBAAgBI,MAC7DtC,EAAakC,gBAAgBK,kBAEhC,CACDtC,EAAgBtC,QAAU,KAC1ByD,EAA8BzD,QAAU,GACxCiE,EAAoBjE,QAAU,EAE9BM,GACD,CAeD,OAFAb,EAAgBqB,GAGd,sBACE+D,MAAO,CACLC,MAAO,OACPC,OAAQ,OACRC,SAAU,WACVC,SAAU,UAEZC,IAAKpE,EAPP,UASE,cAAC,IAAD,CACEqE,aAAW,EACXC,cAAY,EACZC,SA1BN,SAAsBP,EAAgBC,GACpC,GAAID,GAASC,EAAQ,CACnB,IAAM/D,EAASJ,EAAUZ,QACrBgB,GAAUH,EAAUb,UACtBgB,EAAOsE,SACPzE,EAAUb,QAAQ8E,MAAQA,EAC1BjE,EAAUb,QAAQ+E,OAASA,EAE9B,CACF,EAkBKQ,UAAWzE,EAJb,SAME,wBACET,cApFR,WACE,IAAMiB,EAAQZ,EAASV,QACvB,GAAIsB,EAAO,CACT,IAME,QANIkE,EAAWlE,EAAMmE,KAAKnE,EAAMmB,SAAUnB,EAAMoB,UAClD,GACE8C,GACAA,EAASE,KACTF,EAASG,YACoB,cAA7BH,EAASG,WAAWC,KAEpB,UAAAJ,EAASG,WAAWpB,uBAApB,SAAqCsB,kBAAkBhE,IAAQM,QAC/D,UAAAqD,EAASG,WAAWpB,uBAApB,SAAqCuB,mBAAmBjE,IAAQM,QAGhE8B,EAAoBjE,SAClB,UAAAwF,EAASG,WAAWpB,uBAApB,eAAqCI,OAAQ,EAC/C,UAAAa,EAASG,WAAWpB,uBAApB,SAAqCC,QAAQ,GAE7ClC,EAAgBtC,QAAUwF,EAASG,UAEtC,CACDtF,GACD,EA+DOC,YAAa4D,EACb6B,gBAAiB7B,EACjB8B,eAAgB9B,EAChBgB,IAAKrE,EACLgE,MAAO,CAAEoB,QAAS,YAGtB,cAACC,EAAA,EAAD,CAAa1F,MAAOA,EAAO2F,eAAgB,kBAAM1F,OAAS2F,EAAf,MAGhD,CAEDjG,EAAgBkG,aAAe,CAC7BhG,cAD6B,WACX,EAClBC,YAF6B,WAEb,GAGHH,Q,yCCjOA,MAA0B,+BCA1B,MAA0B,+BCA1B,MAA0B,+BCA1B,MAA0B,gCCA1B,MAA0B,gCCA1B,MAA0B,gCCA1B,MAA0B,iC,SCGlC,SAAemG,EAAtB,kC,2CAAO,WAAkCC,GAAlC,SAAAC,EAAA,8EACE,IAAIC,QAAQ,SAACC,EAASC,GAC3B,IAAIC,EAAU,IAAIC,IAChBN,EACA,UACAH,GACA,OACAA,EACA,WACEM,EAAQE,EACT,EACD,WACED,EAAO,yBACR,EAEJ,IAfI,0C,sBCmCA,SAASG,EACdC,GAEA,QACIA,EAAOC,MACPD,EAAOE,MACPF,EAAOG,MACPH,EAAOI,OACPJ,EAAOK,OACPL,EAAOM,OACPN,EAAOO,IAEZ,CClBD,IAGMC,E,gJAIFC,EACAlG,EACAmG,G,sFAEIV,EAA8B,CAAC,EAC7BW,E,sCAAc,WAAOC,EAAgBC,GAAvB,iBAAApB,EAAA,4DACdqB,EAASJ,EAAkBA,EAAgBE,GAAQC,EADrC,SAEC,EAAKE,SAASD,EAAQL,EAAUlG,GAFjC,OAEZyG,EAFY,OAGlBhB,EAAOY,GAAQI,EAHG,yC,iEAKdtB,QAAQuB,IAAI,CAChBN,EAAY,KAAMO,GAClBP,EAAY,KAAMQ,GAClBR,EAAY,KAAMS,GAClBT,EAAY,MAAOU,GACnBV,EAAY,MAAOW,GACnBX,EAAY,MAAOY,GACnBZ,EAAY,OAAQa,K,WAElBzB,EAAaC,G,yCACRA,G,aAED,IAAI/C,MAAM,mD,2KAIE6D,EAAgBL,EAAoBlG,G,sFACtCkH,IAAYC,gBAAgB,GAAIZ,EAAQ,GAAIvG,G,cAA1DyG,E,OACDhB,OAAO,IACL2B,UAAU,MAEfX,EAAKP,SAAWA,EAEhBO,EAAKY,gBAAiB,EACtBZ,EAAKa,WAAY,E,kBACVb,G,+KAIPc,EACAC,EACAxH,G,uFAEIyH,EAAM,IAAIC,IAAYH,EAAcvH,G,SACKmF,QAAQuB,IAAI,CACvD1B,EAAmBwC,EAASG,QAC5B3C,EAAmBwC,EAASI,QAC5B5C,EAAmBwC,EAASK,kB,0CAHzBF,E,KAAQC,E,KAAQC,E,KAKrBJ,EAAIK,cAAgBH,EACpBF,EAAIM,YAAcH,EAClBH,EAAIO,gBAAkBH,EACtBJ,EAAIQ,sCAAuC,EAC3CR,EAAIS,sCAAuC,EAC3CT,EAAIU,sCAAuC,E,kBACpCV,G,kJAIPhB,EACAnC,EACA8D,EACApI,GAEA,IAAIqI,EAAW5B,EAAK6B,eAAehE,GACnC+D,EAAS3E,SAAW+C,EAAK/C,SAFzB,oBAGkB+C,EAAK8B,0BAHvB,IAGA,2BAAiD,CAAC,IAAzCC,EAAwC,QACzCC,EAAUD,EAAME,MAAMF,EAAMlE,KAAM+D,GACxC,IAAKI,EACH,MAAM,IAAI/F,MAAM,gCAElB+F,EAAQzG,oBAAoBwG,EAAMhH,uBAClCiH,EAAQnE,KAAOkE,EAAMlE,KACrB+D,EAASM,SAASF,EACnB,CAXD,+BAoBA,OAPAJ,EAASpF,gBAAkB,IAAI2F,IAC7BP,EACAO,IAAgBC,mBAChBT,EACApI,GAGKqI,CACR,G,gDAEgCS,GAC/B,OAAQA,GACN,IAAK,KACH,MAAO,CAAEzF,KAAM,EAAG0F,SAAU,GAC9B,IAAK,KACH,MAAO,CAAE1F,KAAM,EAAG0F,SAAU,GAC9B,IAAK,KACH,MAAO,CAAE1F,KAAM,IAAK0F,SAAU,GAChC,IAAK,MACL,IAAK,OACH,MAAO,CAAE1F,KAAM,EAAG0F,SAAU,GAC9B,IAAK,MACH,MAAO,CAAE1F,KAAM,EAAG0F,SAAU,GAG9B,QACE,MAAO,CAAE1F,KAAM,GAAI0F,SAAU,GAElC,G,2BAEWV,GAA0B,IAAD,MACnC,UAAAA,EAASpF,uBAAT,SAA0BsB,kBAAkBhE,IAAQM,QACpD,UAAAwH,EAASpF,uBAAT,SAA0BuB,mBAAmBjE,IAAQM,QAErD,IAAMb,EAAQqI,EAASW,WACjBC,EAAiBjJ,EAAMkJ,YAAY,oBACnCC,EAAiBnJ,EAAMkJ,YAAY,oBACnCE,GAAgC,OAAdH,QAAc,IAAdA,OAAA,EAAAA,EAAgB3B,WACpC2B,EACAE,EACJ,IAAKC,EACH,MAAM,IAAI1G,MAAM,2BAElB,IAAM2G,EAAU,OAAGD,QAAH,IAAGA,OAAH,EAAGA,EAAiBE,kBAAkBC,YAEhD7F,EAAW,IAAInD,IACnB8I,EAAWG,OAAOC,GAAqB,EAAhBpH,KAAKqH,SAAe,GAC3C,EACAL,EAAWG,OAAOG,GAAqB,EAAhBtH,KAAKqH,SAAe,IAE7CrB,EAAS3E,SAAWA,EACpB2E,EAASuB,YACPvH,KAAKqH,SAAWrH,KAAKwH,GAAK,EAC1BxH,KAAKqH,SAAWrH,KAAKwH,GAAK,EAC1BxH,KAAKqH,SAAWrH,KAAKwH,GAAK,GAG5B,IAAMC,EAAc,IAAIvJ,IACtBwJ,YAAKV,EAAWW,aAAaP,EAAGJ,EAAWY,aAAaR,EAAGpH,KAAKqH,UAChE,EACAK,YAAKV,EAAWW,aAAaL,EAAGN,EAAWY,aAAaN,EAAGtH,KAAKqH,WAG5DQ,EAAU,IAAI3J,IAAQ,EAAG,EAAG,GAC/BwB,SAAS+H,GACTK,iBACAxI,MAAMoI,YArJY,IACA,IAoJ6B1H,KAAKqH,WAEvD,UAAArB,EAASpF,uBAAT,SAA0BG,aACxB8G,EACA7B,EAASpF,gBAAgBK,kBAE5B,G,yCAGCmD,EACA2B,EACApI,GAIA,OAFAoK,KAAKC,gBAEED,KAAKE,uBACV7D,EADK,wBAEY2D,KAAKC,eACtBjC,EACApI,EAEH,G,mEAEiBA,G,sEACV,IAAI0C,MAAJ,yBAA4B1C,I,qIAGd8I,EAAoB9I,GACxC,MAAM,IAAI0C,MAAJ,oCAAuCoG,EAAvC,eAAsD9I,GAC7D,K,KA/KGiG,EACGoE,cAAgB,EAiLVpE,Q,0FCrMAsE,OAhBf,WACE,OACE,sBACEC,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,kBAAkBD,KAAK,SAC/B,sBAAMC,EAAE,8MACR,sBAAMA,EAAE,uMAGb,ECCcC,OAff,WACE,OACE,sBACEJ,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,iBAAiBD,KAAK,SAC9B,sBAAMC,EAAE,mTAGb,ECEcE,OAff,WACE,OACE,sBACEL,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,iBAAiBD,KAAK,SAC9B,sBAAMC,EAAE,iiBAGb,ECecG,OAzBf,YAAuE,IAA5CC,EAA2C,EAA3CA,SACzB,OACE,cAAC,IAAD,CACEC,GAAI,CACFtH,SAAU,WACVuH,IAAK,MACLC,MAAO,MACPC,UAAW,mBACX1H,OAAQ,OACR2H,QAAS,OACTC,WAAY,UARhB,SAWE,cAAC,IAAD,CACEC,QAAQ,UACRC,GAAG,IACHC,MAAM,OACNR,GAAI,CAAES,SAAU,OAAQC,WAAY,QAJtC,SAMGX,KAIR,ECQcY,OArBf,YAMqB,IALnBC,EAKkB,EALlBA,MACAb,EAIkB,EAJlBA,SACAc,EAGkB,EAHlBA,MACAC,EAEkB,EAFlBA,QACAC,EACkB,EADlBA,SAEA,OACE,eAAC,IAAD,CACEH,MAAOA,EACP,aAAYA,EACZE,QAASA,EACTd,GAAI,CAAEtH,SAAU,YAChBqI,SAAUA,EALZ,UAOGhB,EACAc,GAAS,cAAC,GAAD,UAAQA,MAGvB,ECjBcG,OAff,WACE,OACE,sBACExB,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,gBAAgBD,KAAK,SAC7B,sBAAMC,EAAE,2cAGb,E,mBCecsB,OAff,YAA8E,IAA1DC,EAAyD,EAAzDA,KAAMC,EAAmD,EAAnDA,WAAYC,EAAuC,EAAvCA,aAAcC,EAAyB,EAAzBA,OAClD,OACE,qBAAK9I,MAAO,CAAE+I,OAAQ,WAAtB,SACE,cAACC,GAAA,EAAD,CACEX,MAAOM,EAAK5H,KACZ6H,WAAYA,EACZK,SAAU,kBAAMJ,EAAaF,EAAnB,EACVO,cAAe,kBAAMJ,EAAOH,EAAb,EAJjB,SAME,cAAC,IAAD,CAAOQ,IAAKR,EAAKS,aAIxB,E,SCyBcC,OAnCf,YAKmB,IAJjBV,EAIgB,EAJhBA,KACAE,EAGgB,EAHhBA,aACAS,EAEgB,EAFhBA,aACAR,EACgB,EADhBA,OAEMS,EAASC,eAEf,OACE,cAAC,IAAD,CAAWxJ,MAAO,CAAEE,OAAQqJ,EAAOE,qBAAnC,SACE,cAAC,IAAD,CACEC,EAAG,EACHC,GAAI,EACJC,GAAG,QACHnC,GAAI,CACFoC,aAAc,MACdC,UAAiC,UAAtBP,EAAOQ,WAAyB,QAAU,SAEvDC,IAAK,EACLC,QAAO,iBAAYV,EAAOW,gBAAnB,UATT,SAWGvB,EAAKwB,IAAI,SAACxB,GAAD,OACR,cAAC,GAAD,CAEEA,KAAMA,EACNC,WAAYU,GAAgBX,EAAKyB,MAAQd,EAAac,IACtDvB,aAAcA,EACdC,OAAQA,GAJHH,EAAKyB,IAFJ,MAYjB,E,wDCjDc,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCSnCC,G,kNAIc5N,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,aACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAO,kEACL0H,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA3BsBiG,GAAnB2H,GACGnI,Y,EADHmI,GAEG1H,c,EA4BM0H,UCvCA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCSnCI,G,+LAI6BlF,GAC/B,IAAImF,EAAU,yEAAmCnF,GACjD,MAAO,CAAEzF,KAAwB,EAAlB4K,EAAW5K,KAAU0F,SAAUkF,EAAWlF,SAC1D,G,mEAEiB/I,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,WACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAOuD,EAAKiI,mBACV9D,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GAhCoBiG,GAAjB+H,GACGvI,Y,EADHuI,GAEG9H,c,EAiCM8H,UC5CA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCSnCG,G,kNAIcnO,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,cACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAOuD,EAAKiI,mBACV9D,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA3BsBiG,GAAnBkI,GACG1I,Y,EADH0I,GAEGjI,c,EA4BMiI,UCvCA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCSnCC,G,kNAIcpO,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,cACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAO,kEACL0H,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA3BuBiG,GAApBmI,GACG3I,Y,EADH2I,GAEGlI,c,EA4BMkI,UCvCA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCSnCC,G,kNAIcrO,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,aACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAO,kEACL0H,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA3BsBiG,GAAnBoI,GACG5I,Y,EADH4I,GAEGnI,c,EA4BMmI,UCvCA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCgBnClI,GAAkB,CACtBT,GCjBa,IAA0B,+BDkBvCC,GElBa,IAA0B,+BFmBvCC,GGnBa,IAA0B,+BHoBvCC,IIpBa,IAA0B,gCJqBvCC,IKrBa,IAA0B,gCLsBvCC,IMtBa,IAA0B,gCNuBvCC,KOvBa,IAA0B,kCP0BnCsI,G,+LAI6BxF,GAC/B,IAAImF,EAAU,yEAAmCnF,GACjD,MAAO,CAAEzF,KAAwB,IAAlB4K,EAAW5K,KAAY0F,SAAUkF,EAAWlF,SAC5D,G,mEAEiB/I,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,aACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WACvB1D,KAAKlE,SACLlG,EACAmG,I,OAHFiE,KAAK3E,O,iJAQaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAO,kEACL0H,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GApCsBiG,GAAnBqI,GACG7I,Y,EADH6I,GAEGpI,c,EAqCMoI,UQjEA,OAA0B,mCCA1B,OAA0B,iCCA1B,OAA0B,mCCmBnCC,G,+LAI6BzF,GAC/B,IAAImF,EAAU,yEAAmCnF,GACjD,MAAO,CAAEzF,KAAwB,IAAlB4K,EAAW5K,KAAY0F,SAAUkF,EAAWlF,SAC5D,G,gFAGCxB,EACAC,EACAxH,G,uFAEIyH,EAAM,IAAIC,IAAYH,EAAcvH,G,SACLmF,QAAQuB,IAAI,CAC7C1B,EAAmBwC,EAASG,QAC5B3C,EAAmBwC,EAASI,QAC5B5C,EAAmBwC,EAASgH,Q,0CAHzB7G,E,KAAQC,E,KAAQ4G,E,KAKrB/G,EAAIK,cAAgBH,EACpBF,EAAIM,YAAcH,EAClBH,EAAIgH,UAAY,IAChBhH,EAAIiH,SAAW,EACfjH,EAAIkH,WAAWC,qBAAsB,EACrCnH,EAAIkH,WAAWE,kBAAoB,EACnCpH,EAAIkH,WAAWG,oBAAsB,EACrCrH,EAAIkH,WAAWI,uBAAwB,EACvCtH,EAAIkH,WAAWK,sBAAwB,GACvCvH,EAAIkH,WAAWM,iBAAmB,GAClCxH,EAAIkH,WAAWO,iBAAmB,GAClCzH,EAAIkH,WAAWQ,UAAY,IAAIC,IAAO,GAAK,IAAK,EAAG,IAAM,KACzD3H,EAAIkH,WAAWU,iBAAmBb,EAClC/G,EAAIkH,WAAWW,6BAA8B,E,kBAEtC7H,G,wKAGSzH,G,mEACXoK,KAAKlE,S,gCACckE,KAAKmF,kBACzB,YACA,CAAE5H,UAAQ6G,QAAM5G,WAChB5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAOuD,EAAKiI,mBACV9D,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA7DqBiG,GAAlBsI,GACG9I,Y,EADH8I,GAEGrI,c,EA8DMqI,UCnFA,OAA0B,mCCA1B,OAA0B,2CCA1B,OAA0B,mCCanCiB,G,+LAI6B1G,GAC/B,IAAImF,EAAU,yEAAmCnF,GACjD,MAAO,CAAEzF,KAAwB,IAAlB4K,EAAW5K,KAAY0F,SAAUkF,EAAWlF,SAC5D,G,2EAGCxB,EACAC,EACAxH,G,uFAEIyH,EAAM,IAAIC,IAAYH,EAAcvH,G,SACKmF,QAAQuB,IAAI,CACvD1B,EAAmBwC,EAASG,QAC5B3C,EAAmBwC,EAASI,QAC5B5C,EAAmBwC,EAASK,kB,0CAHzBF,E,KAAQC,E,KAAQC,E,KAKrBJ,EAAIK,cAAgBH,EACpBF,EAAIM,YAAcH,EAClBH,EAAIO,gBAAkBH,EACtBJ,EAAIQ,sCAAuC,EAC3CR,EAAIS,sCAAuC,EAC3CT,EAAIU,sCAAuC,EAE3CV,EAAIkH,WAAWI,uBAAwB,EACvCtH,EAAIkH,WAAWK,sBAAwB,GACvCvH,EAAIkH,WAAWM,iBAAmB,EAClCxH,EAAIkH,WAAWO,iBAAmB,GAClCzH,EAAIkH,WAAWQ,UAAY,IAAIC,IAAO,IAAM,IAAK,EAAG,IAAM,K,kBAEnD3H,G,wKAGSzH,G,mEACXoK,KAAKlE,S,gCACckE,KAAKyD,aACzB,eACA,CAAElG,UAAQE,kBAAgBD,WAC1B5H,G,OAHFoK,KAAKlE,S,iBAMFkE,KAAK3E,O,gCACY2E,KAAK0D,WAAW1D,KAAKlE,SAAUlG,G,OAAnDoK,KAAK3E,O,iJAIaqD,EAAoB9I,GACxC,IAAKoK,KAAKlE,WAAakE,KAAK3E,OAC1B,MAAM/C,MAAM,0DAGd,OAAOuD,EAAKiI,mBACV9D,KAAK3E,OAAOqD,GACZsB,KAAK2D,0BAA0BjF,GAC/B9I,EAEH,K,GA3DwBiG,GAArBuJ,GACG/J,Y,EADH+J,GAEGtJ,c,EA4DMsJ,UC3EA,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCA1B,OAA0B,oCCyB5BC,GAA2B,CACtCC,OAAQ9B,GACR+B,OAAQxB,GACRyB,QAASxB,GACTyB,OAAQxB,GACRyB,KAAM9B,GACN+B,OAAQzB,GACR0B,MAAOzB,GACP0B,SAAUT,IAKCU,GAA4B,CACvCR,OAAQS,GACRR,OAAQS,GACRR,QAASS,GACTR,OAAQS,GACRR,KAAMS,GACNR,OAAQS,GACRR,MAAOS,GACPR,SAAUS,IAGCxE,GAAsByE,OAAOC,KAAKnB,IAAa/B,IAAI,SAACC,GAAD,MAAU,CACxEA,MACArJ,KAAMuM,KAAKC,QAAQnD,GACnBoD,MAAOtB,GAAY9B,GACnBhB,QAASuD,GAAavC,GAJwC,GCajDqD,OAvCf,YAKqB,IAJnBC,EAIkB,EAJlBA,OACApM,EAGkB,EAHlBA,eACAwH,EAEkB,EAFlBA,OACA6E,EACkB,EADlBA,YACkB,EACsBjS,mBAASiS,GAD/B,mBACXrE,EADW,KACGsE,EADH,KAEZrE,EAASC,eAEf,OACE,cAACqE,GAAA,EAAD,CACEH,OAAQA,EACRpM,eAAgBA,EAChBtB,MAAO,CACL8N,QAAS,CAAEC,SAAUxE,EAAOyE,UAAW/N,MAAO,sBAJlD,SAOE,eAAC,IAAD,CACEwH,GAAI,CACFwG,cAAe,UAFnB,UAKE,cAAC,IAAD,CAAOC,GAAI,EAAGvE,GAAI,EAAlB,iCAGA,cAAC,GAAD,CACEhB,KAAMA,GACNE,aAAc+E,EACdtE,aAAcA,EACdR,OAAQA,IAEV,cAAC,IAAD,CAAQqF,GAAI,EAAGpG,QAAQ,UAAUQ,QAAS,kBAAMO,EAAOQ,EAAb,EAA1C,wBAMP,EC9CD,SAAS8E,GAAT,GAI2B,IAHzBC,EAGwB,EAHxBA,aACAC,EAEwB,EAFxBA,YACA9F,EACwB,EADxBA,SACwB,EACc9M,oBAAS,GADvB,mBACjB6S,EADiB,KACJC,EADI,KAMxB,SAASC,IACPD,GAAe,EAChB,CAOD,OACE,qCACE,cAAC,IAAD,CACE,aAAW,oBACXnG,MAAM,oBACNE,QAjBN,WACEiG,GAAe,EAChB,EAgBKhG,SAAUA,EAJZ,SAME,cAAC,GAAD,MAEF,cAAC,GAAD,CACEkF,OAAQa,EACRjN,eAAgBmN,EAChBd,YAAaW,EACbxF,OAnBN,SAAoBH,GAClB0F,EAAa1F,GACb8F,GACD,MAoBF,CAEDL,GAAiB5M,aAAe,CAC9BgH,UAAU,GAGG4F,U,kBCiJAM,OAnKf,YASsB,IARpBC,EAQmB,EARnBA,UACAC,EAOmB,EAPnBA,UACAC,EAMmB,EANnBA,WACAC,EAKmB,EALnBA,aACAC,EAImB,EAJnBA,qBACAC,EAGmB,EAHnBA,UACAC,EAEmB,EAFnBA,kBACAC,EACmB,EADnBA,QACmB,EAC6BC,aAAW,cADxC,mBACZC,EADY,KACMC,EADN,OAEmB3T,mBACpCiN,GAAK2G,KAAK,SAAClI,GAAD,OAAOA,EAAEgD,MAAQgF,CAAjB,IAAsCzG,GAAK,IAHpC,mBAEZ2F,EAFY,KAECiB,EAFD,KAMnBzU,oBAAU,WACR,IAAM0U,EAAc7G,GAAK2G,KAAK,SAAClI,GAAD,OAAOA,EAAEgD,MAAQgF,CAAjB,GAC1BI,IACFX,EAAWW,GACXD,EAAeC,GAGlB,EAAE,IAEH,IAfmB,EAebC,EAAgD,CAAC,EAfpC,cAgBFd,GAhBE,IAgBnB,2BAA4B,CAAC,IAApBhG,EAAmB,QACtBA,EAAK7F,QAAQ2M,EAEfA,EAAW9G,EAAK7F,OAAU,EAE1B2M,EAAW9G,EAAK7F,MAAQ,CAE3B,CAvBkB,0EAyBnB,WAAgC6F,GAAhC,SAAAhH,EAAA,qEACQkN,EAAWlG,GADnB,OAEE4G,EAAe5G,GACf0G,EAAoB1G,EAAKyB,KAH3B,0CAzBmB,sBA+BnB,IAAIsF,EAAU,CACZ,CACEtF,IAAK,MACL/B,MAAO,UACPC,MAAOmH,EAAWjN,IAClB+F,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,MAAnC,EACThG,SAAU,cAACmI,EAAA,EAAD,KAEZ,CACEvF,IAAK,MACL/B,MAAO,UACPC,MAAOmH,EAAWlN,IAClBgG,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,MAAnC,EACThG,SAAU,cAACoI,EAAA,EAAD,KAEZ,CACExF,IAAK,MACL/B,MAAO,UACPC,MAAOmH,EAAWnN,IAClBiG,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,MAAnC,EACThG,SAAU,cAACqI,EAAA,EAAD,KAEZ,CACEzF,IAAK,KACL/B,MAAO,SACPC,MAAOmH,EAAWpN,GAClBkG,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,KAAnC,EACThG,SAAU,cAACsI,GAAA,EAAD,KAEZ,CACE1F,IAAK,KACL/B,MAAO,SACPC,MAAOmH,EAAWrN,GAClBmG,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,KAAnC,EACThG,SAAU,cAACuI,GAAA,EAAD,KAEZ,CACE3F,IAAK,KACL/B,MAAO,SACPC,MAAOmH,EAAWtN,GAClBoG,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,KAAnC,EACThG,SAAU,cAACwI,GAAA,EAAD,KAEZ,CACE5F,IAAK,OACL/B,MAAO,WACPC,MAAOmH,EAAWhN,KAClB8F,QAAS,kBAAMqG,EAAUN,EAAYd,MAAO,OAAnC,EACThG,SAAU,cAACyI,GAAA,EAAD,MAId,OACE,cAAC,IAAD,CACExI,GAAI,CACFoC,aAAc,MACd1J,SAAU,WACVuH,IAAK,IACLwI,KAAM,IACNhQ,OAAQ,OACRiQ,UAAW,QACXC,cAAe,OAEjBxG,GAAG,UAVL,SAYE,cAAC,IAAD,CAAW5J,MAAO,CAAEC,MAAO,OAAQC,OAAQ,QAA3C,SACE,eAAC,IAAD,CACEuH,GAAI,CACF4I,eAAgB,SAChBvI,WAAY,SACZmG,cAAe,UAEjBvE,EAAG,EANL,UAQE,cAAC,GAAD,CACE2E,aA1GS,4CA2GTC,YAAaA,EACb9F,SAAU0G,IAEZ,cAACoB,GAAA,EAAD,IACCZ,EAAQvF,IAAI,SAACoG,GAAD,OACX,cAAC,GAAD,aAAY/H,SAAU0G,GAAaqB,GADxB,GAGb,cAACD,GAAA,EAAD,IACA,cAAC,IAAD,CACE,aACmB,WAAjBxB,EACI,mBACA,mBAENzG,MACmB,WAAjByG,EACI,mBACA,mBAENrH,GAAI,CACFG,UACmB,WAAjBkH,EAA4B,YAAc,kBAE9CvG,QAAS,kBACPwG,EACmB,WAAjBD,EAA4B,SAAW,SAFlC,EAKTtG,SAAU0G,EApBZ,SAsBE,cAACsB,GAAD,MAEF,cAACF,GAAA,EAAD,IACA,cAAC,IAAD,CACE,aAAYtB,EAAY,kBAAoB,mBAC5C3G,MAAO2G,EAAY,kBAAoB,mBACvCzG,QAAS,kBAAM0G,GAAmBD,EAAzB,EACTxG,SAAU0G,EAJZ,SAMGF,EAAY,cAAC,GAAD,IAAsB,cAAC,GAAD,YAM9C,ECzLcyB,OAff,WACE,OACE,sBACExJ,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,kBAAkBD,KAAK,SAC/B,sBAAMC,EAAE,sRAGb,ECEcsJ,OAff,WACE,OACE,sBACEzJ,MAAM,6BACN/G,OAAO,KACPgH,QAAQ,YACRjH,MAAM,KACNkH,KAAK,eALP,UAOE,sBAAMC,EAAE,gBAAgBD,KAAK,SAC7B,sBAAMC,EAAE,osBAGb,E,UCoGcuJ,OAhGf,YAIsB,IAHpBhC,EAGmB,EAHnBA,UACAiC,EAEmB,EAFnBA,YACAC,EACmB,EADnBA,aACmB,EACiBnV,oBAAS,GAD1B,mBACZoV,EADY,KACAC,EADA,KAGnB,GAAyB,IAArBpC,EAAU3P,OACZ,OAAO,KAGT,IAAIgS,EAA4B,GAgBhC,OAfIrC,EAAU3P,OAAS,IACrBgS,EAAQrC,EACLsC,OAAO,SAACtI,GAAD,MAAwB,YAAdA,EAAKuI,IAAf,GACP/G,IAAI,SAACxB,EAAMwI,GAAP,OACH,eAAC,IAAMC,SAAP,WACE,cAAC,IAAD,CAAMrJ,QAAQ,QAAQC,GAAG,IAAIC,MAAM,qBAAnC,SACGU,EAAKuI,OAER,cAAC,IAAD,CAAMnJ,QAAQ,QAAQC,GAAG,IAAIC,MAAM,OAAnC,SACGkJ,IAAUxC,EAAU3P,OAAS,EAAI,GAAK,QALtBmS,EADlB,IAaP,eAAC,IAAD,CACE1J,GAAI,CACF4I,eAAgB,gBAChBvI,WAAY,SACZ3H,SAAU,WACVkR,OAAQ,KACRnB,KAAM,EACNvI,MAAO,EACPE,QAAS,OACTI,MAAO,QACPmI,cAAe,QAVnB,UAaE,cAAC,IAAD,CACEkB,GAAG,KACHjJ,MAAM,aACN,aAAW,aACXE,QAASqI,EACTnJ,GAAI,CAAE2I,cAAe,OALvB,SAOE,cAAC,GAAD,MAEF,eAAC,IAAD,CACE3I,GAAI,CACFwG,cAAe,SACfoC,eAAgB,SAChBvI,WAAY,UAJhB,UAOE,cAAC,IAAD,CACEC,QAAQ,UACRC,GAAG,KACHP,GAAI,CAAES,SAAU,EAAGqJ,WAAY,QAHjC,SAKGC,aAAiB7C,KAEnBqC,EAAMhS,OAxEW,EAyEhB,eAAC,IAAD,CACE,aAAY,oBACZqJ,MAAO,oBACPE,QAAS,kBAAMwI,GAAeD,EAArB,EACT/I,QAAQ,YACRN,GAAI,CAAEI,QAAS,OAAQ3H,OAAQ,OAAQkQ,cAAe,OALxD,UAOGU,EAAaE,EAAQA,EAAMnS,MAAM,EAhFpB,IAiFZiS,GACA,cAAC,IAAD,CAAM/I,QAAQ,QAAQC,GAAG,IAAIC,MAAM,qBAAnC,oBAMJ,cAAC,IAAD,CAAMR,GAAI,CAAEvH,OAAQ,QAApB,SAA+B8Q,OAGnC,cAAC,IAAD,CACES,GAAG,KACHpJ,MAAM,cACN,aAAW,cACXE,QAASsI,EACTpJ,GAAI,CAAE2I,cAAe,OALvB,SAOE,cAAC,GAAD,QAIP,E,UC/Gc,OAA0B,mCCA1B,OAA0B,mCCA1B,OAA0B,yCCA1B,OAA0B,iDCA1B,OAA0B,yCCA1B,OAA0B,yCCA1B,OAA0B,iDCA1B,OAA0B,yCCmBnCsB,G,WAmCJ,WACEC,EACAlV,EACAmV,GACC,yBAtCHC,WAsCE,OApBFpV,WAoBE,OAnBFmV,qBAmBE,OAbF1R,OAAS,GAaP,KAZF4R,cAAgB,GAYd,KAXFC,aAWE,OAVFC,eAUE,OATFC,gBASE,OARFC,cAQE,OAPFC,gBAOE,OANFC,gBAME,EACAvL,KAAKgL,MAAQF,EACb9K,KAAKpK,MAAQA,EACboK,KAAK+K,gBAAkBA,CACxB,C,iDAvCC,OAAO/K,KAAKgL,KACb,E,aAEQQ,GACPxL,KAAKgL,MAAQQ,EACb,IAAMC,EAAkBzL,KAAKiL,cAAgB,EAAIjL,KAAK5G,MAAQ,EAAI,GAC5DsS,EAAmB1L,KAAKiL,cAAgB,EAAIjL,KAAK3G,OAAS,EAAI,GAChE2G,KAAKkL,UAASlL,KAAKkL,QAAQ5R,SAASiG,GAAKmM,GACzC1L,KAAKmL,YAAWnL,KAAKmL,UAAU7R,SAAS+F,GAAKoM,GAC7CzL,KAAKoL,aAAYpL,KAAKoL,WAAW9R,SAASiG,EAAImM,GAC9C1L,KAAKqL,WAAUrL,KAAKqL,SAAS/R,SAAS+F,EAAIoM,GAC1CzL,KAAKsL,aAAYtL,KAAKsL,WAAWpO,UAAwB,WAAZsO,GAC7CxL,KAAKuL,aAAYvL,KAAKuL,WAAWrO,UAAwB,WAAZsO,EAClD,G,4BAMC,MAAqB,WAAdxL,KAAK2L,KAAoB,GAAK,EACtC,K,2JAsBC3L,KAAK4L,Y,SACC5L,KAAK0D,a,0IAIXxJ,EACAmF,EACA5H,EACA8H,EACAZ,GAEA,IAAIkN,EAAYC,KAAKC,UACnB7R,EACA8F,KAAKiL,cACLjL,KAAKpK,OACL,EACAkW,KAAKE,YAaP,OAXAH,EAAUvS,SAAS+F,EAAIA,EACvBwM,EAAUvS,SAAS7B,EAAIA,EACvBoU,EAAUvS,SAASiG,EAAIA,EACvBsM,EAAUhT,gBAAkB,IAAI2F,IAC9BqN,EACArN,IAAgByN,YAChB,CAAEhT,KAAM,EAAG0F,SAAUA,GACrBqB,KAAKpK,OAEPiW,EAAU3O,WAAY,EAEf2O,CACR,G,kCAGC,IAAMJ,EAAkBzL,KAAKiL,cAAgB,EAAIjL,KAAK5G,MAAQ,EAAI,GAC5DsS,EAAmB1L,KAAKiL,cAAgB,EAAIjL,KAAK3G,OAAS,EAAI,GACpE2G,KAAKkL,QAAUlL,KAAKkM,gBAAgB,UAAW,EAAG,GAAIR,EAAkB,IACxE1L,KAAKmL,UAAYnL,KAAKkM,gBACpB,aACCT,EACD,EACA,EACA,IAEFzL,KAAKoL,WAAapL,KAAKkM,gBACrB,aACA,EACA,EACAR,EACA,IAEF1L,KAAKqL,SAAWrL,KAAKkM,gBAAgB,WAAYT,EAAiB,EAAG,EAAG,IAExEzL,KAAKkM,gBACH,SACA,GACClM,KAAKiL,cAAgB,EAJK,IAK3B,EACA,IAGFjL,KAAKkM,gBACH,OACA,EACAlM,KAAKiL,cAAgB,EAJI,GAKzB,EACA,IAEH,G,uLAYWlQ,QAAQuB,IAAI,CACpBQ,IAAYC,gBAAgB,GAAIoP,GAAkB,GAAInM,KAAKpK,OAC3DkH,IAAYC,gBAAgB,GAAIqP,GAAkB,GAAIpM,KAAKpK,OAC3DgF,EAAmByR,IACnBzR,EAAmB0R,IACnB1R,EAAmB2R,IACnB3R,EAAmB4R,IACnB5R,EAAmB6R,IACnB7R,EAAmB8R,M,mCAhBnBC,E,KACAC,E,KACAC,E,KACAC,E,KACAC,E,KACAC,E,KACAC,E,KACAC,E,KAYFlN,KAAKsL,WAAaqB,EAAatR,OAAO,GACtC2E,KAAKsL,WAAW6B,GAAK,mBACrBnN,KAAKsL,WAAWpR,KAAO,aACnBkT,EAAiB,IAAI9P,IAAY,uBAAwB0C,KAAKpK,QACnD8H,cAAgBmP,EAC/BO,EAAezP,YAAcmP,EAC7BM,EAAexP,gBAAkBmP,EACjCK,EAAevP,sCAAuC,EACtDuP,EAAetP,sCAAuC,EACtDsP,EAAerP,sCAAuC,EACtDiC,KAAKsL,WAAWxP,SAAWsR,EAE3BpN,KAAKsL,WAAWrO,gBAAiB,EACjC+C,KAAK+K,gBAAgBsC,gBAAgBrN,KAAKsL,YAC1CtL,KAAKsL,WAAWpO,UAA0B,WAAd8C,KAAK2L,KAEjC3L,KAAKuL,WAAaqB,EAAavR,OAAO,GACtC2E,KAAKuL,WAAW4B,GAAK,mBACrBnN,KAAKuL,WAAWrR,KAAO,aACnBoT,EAAiB,IAAIhQ,IAAY,uBAAwB0C,KAAKpK,QACnD8H,cAAgBsP,EAC/BM,EAAe3P,YAAcsP,EAC7BK,EAAe1P,gBAAkBsP,EACjCI,EAAezP,sCAAuC,EACtDyP,EAAexP,sCAAuC,EACtDwP,EAAevP,sCAAuC,EACtDiC,KAAKuL,WAAWzP,SAAWwR,EAE3BtN,KAAKuL,WAAWtO,gBAAiB,EACjC+C,KAAK+K,gBAAgBsC,gBAAgBrN,KAAKuL,YAC1CvL,KAAKuL,WAAWrO,UAA0B,WAAd8C,KAAK2L,K,4GAItBd,M,UCqMA0C,UA3Vf,YAM0B,IALxB1G,EAKuB,EALvBA,OACAsB,EAIuB,EAJvBA,UACAC,EAGuB,EAHvBA,kBACAN,EAEuB,EAFvBA,UACA0F,EACuB,EADvBA,kBAEMxY,EAAWC,mBACXwY,EAAqBxY,mBACrByY,EAAWzY,iBAAmB,IAC9B0Y,EAAkB1Y,kBAAO,GACzB2Y,EAAsB3Y,kBAAO,GAE7B4Y,EAAoB5Y,iBAAO,GAC3B6Y,EAAc7Y,mBARG,EAWrBJ,mBAA8B,UAXT,mBAUhBoT,EAVgB,KAUF8F,EAVE,OAYgCC,eAA/CC,EAZe,EAYfA,eAAgBC,EAZD,EAYCA,gBAAiBC,EAZlB,EAYkBA,UAZlB,EAaF7F,aAAW,kBAAzB8F,EAbgB,oBAevB,SAASC,IACPJ,GACD,CAED,SAASK,IACPJ,IACAK,GACD,CAGD,SAASA,IAEPV,EAAkBvZ,UAClB,IAAIka,GAAY,EACZC,EAAUC,WAAW,WACvBb,EAAkBvZ,UAClBka,GAAY,CACb,EAAE,KAEH,OAAO,WACLG,aAAaF,GACRD,GACHX,EAAkBvZ,SAErB,CACF,CAGDL,oBAAU,WACR,IACI2a,EADEC,EAAWf,EAAYxZ,QAM7B,OAJIua,IACFA,EAASlD,KAAO1D,EAChB2G,EAAUL,KAELK,CACR,EAAE,CAAC3G,IAEJhU,oBAAU,WACR,IAAI2a,EAQJ,OAPI/H,GACF8G,EAAgBrZ,SAAU,EAC1Bsa,EAAUL,KAEVZ,EAAgBrZ,SAAU,EAGrBsa,CACR,EAAE,CAAC/H,IAEJ,IAAMiI,EAAmBC,sBAAW,sCAAC,+BAAAjU,EAAA,4DAASlF,EAAT,EAASA,MAAON,EAAhB,EAAgBA,OACnDN,EAASV,QAAUsB,EADgB,SAE7BoZ,EAAgBpZ,GAFa,OAGnCN,EAAOoB,cAAc,kBAAMuY,EAAOrZ,EAAb,GAHc,yCAAD,sDAKjC,IAtEoB,SAwERoZ,EAxEQ,6EAwEvB,WAA+BpZ,GAA/B,mBAAAkF,EAAA,4DACEuT,KACIa,EAAQ,IAAIC,IACd,mBACA,IAAIhZ,KAAS,IAAM,GAAI,IACvBP,IAEI0D,SAAW,IAAInD,IAAQ,EAAG,GAAI,GACpC+Y,EAAME,WAAa,EACnBF,EAAMG,WAAa,IACftE,EAAkB,IAAIuE,IAAgB,KAAMJ,IAChCK,8BAA+B,EAC/CxE,EAAgByE,SAAW,GAC3B/B,EAAmBnZ,QAAUyW,EAE7BnV,EAAM6Z,mBAAqBC,IAAYC,0BACrCC,EACAha,GAEFA,EAAMia,qBAAuB,EAEzBhB,EAAW,IAAIhE,GAAS,SAAUjV,EAAOmV,GArB/C,UAsBQ8D,EAASiB,OAtBjB,QAuBEhC,EAAYxZ,QAAUua,EACtBP,IAxBF,2CAxEuB,sBAmGvB,SAASW,EAAOrZ,GAcd,IAAMma,EAAMrC,EAASpZ,QAErB,GADqBqZ,EAAgBrZ,QACrC,CAGA,IAAM0b,EAAmBnC,EAAkBvZ,QAAU,EAC/C2b,EAAmBrC,EAAoBtZ,QACvC4b,EAAYH,EAAIzM,IAAI,SAACxB,GAAD,OAAUA,EAAKqO,MAAf,GAAuBC,UAAS,GAE1D,GAAKJ,GAAqBC,GAAqBC,EAA/C,CAIA,IA3B4B,eA2BnBG,GACP,IAAMvO,EAAOiO,EAAIM,GACXC,EA5BR,SAAsBxO,GAAiB,IAAD,IAC9ByO,GACJ,UAAAzO,EAAK7D,SAASpF,uBAAd,mBAA+B2X,2BAA/B,eAAoDrY,WAAY,EAElE,GAAI2J,EAAK2O,YAAa,CAAC,IAAD,IACdC,GACJ,UAAA5O,EAAK2O,YAAY5X,uBAAjB,mBAAkC2X,2BAAlC,eAAuDrY,WAAY,EACrE,OAAOF,KAAKC,IAAIqY,EAAWG,EAC5B,CACC,OAAOH,CAEV,CAiBeI,CAAa7O,GAEvBwO,EAAQ,MAASxO,EAAK8O,aACxB9O,EAAK8O,aAAelC,WAAW,WAC7B5M,EAAKqO,QAAS,CACf,EAAE,KACMG,EAAQ,KAAQxO,EAAKqO,QAAUrO,EAAK8O,gBAC7C9O,EAAKqO,QAAS,EACdrO,EAAK8O,cAAgBjC,aAAa7M,EAAK8O,cACvC9O,EAAK8O,kBAAelW,EAtCI,EA2BnB2V,EAAI,EAAGA,EAAIN,EAAI5X,OAAQkY,IAAM,EAA7BA,GAeLza,GACFA,EAAMib,QAlBP,CAPA,CA2BF,CAhJsB,2CA4LvB,WAA8B/O,GAA9B,eAAAhH,EAAA,wDACEuT,MACMzY,EAAQZ,EAASV,SAFzB,gCAIUwN,EAAK6E,MAAMmJ,KAAKla,GAJ1B,OAME0Y,IANF,0CA5LuB,4BAqMSzZ,mBAAS,CACvCuE,MAAO,EACPC,OAAQ,IAvMa,mBAqMhByX,EArMgB,KAqMNC,EArMM,KAkRvB,OAxEA9c,oBAAU,WACR,IAAI+c,EACAC,EACJ,SAASC,IACP,IAAM5N,EAAM6N,SAASC,cAAc,QACnC,GAAK9N,EAAL,CAGA,IAAM+N,EAAU/N,EAAIgO,wBAEdC,EAAiBF,EAAQjY,MAAQ,IACjCoY,EAAkBH,EAAQhY,OAAS,GAErCA,EAASpB,KAAKwZ,IAAID,EAAiB,KACnCpY,EAAyB,WAAjB6O,EAA4B5O,EAAS,EAAIA,EAEjDD,EAAQmY,IACVnY,EAAQmY,EACRlY,EAA0B,WAAjB4O,EAAoC,EAAR7O,EAAYA,GAInD4X,EAAgBtC,WAAW,WACzBuC,EAAgB1C,GACjB,EAAE,KAEHwC,EAAY,CAAE3X,QAAOC,UAnBpB,CAoBF,CAMD,OAJAqY,OAAOnd,iBAAiB,SAAU2c,GAElCA,IAEO,WACLQ,OAAOld,oBAAoB,SAAU0c,GACjCF,GACFrC,aAAaqC,GAEXC,GACFA,GAEH,CACF,EAAE,CAAChJ,EAAcmG,EAAYvH,IAG9B5S,oBAAU,WAqBR,IAAM0d,EAAiBC,YApBvB,WACE,IAAM7B,EAAMrC,EAASpZ,QAErB,GADqBqZ,EAAgBrZ,QACrC,CAGA,IAAM4b,EAAYH,EAAIzM,IAAI,SAACxB,GAAD,OAAUA,EAAKqO,MAAf,GAAuBC,UAAS,GAC1D,GAAKF,EAAL,CAKA,IADA,IAAI2B,EAAuB,GAClBxB,EAAI,EAAGA,EAAIN,EAAI5X,OAAQkY,IAAK,CACnC,IAAMvO,EAAOiO,EAAIM,GACbhG,EAAOyH,aAAYhQ,GACvB+P,EAASxB,GAAKhG,CACf,CACDmD,EAAkBqE,EARjB,CAJA,CAaF,EAEmD,KACpD,OAAO,WACLE,cAAcJ,EACf,CACF,EAAE,CAACjE,EAAUC,EAAiBH,IAG7B,eAAC,IAAD,CACE5M,GAAI,CACFxH,MAAM,GAAD,OAAK0X,EAAS1X,MAAd,MACLC,OAAO,GAAD,OAAKyX,EAASzX,OAAd,MACN2J,aAAc,MACdhC,QAAS6F,EAAS,QAAU,OAC5BvN,SAAU,WACVC,SAAU,WAPd,UAUE,eAAC,IAAD,CACEqH,GAAI,CACFG,UAAW,mBACX3H,MAAO,OACPC,OAAQ,OACRkQ,cAAe,OALnB,UAQE,cAAC,EAAD,CACE7U,aAAcoa,EACdna,cAAe,WACbiZ,EAAoBtZ,SAAU,CAC/B,EACDM,YAAa,WACXgZ,EAAoBtZ,SAAU,CAC/B,IAEH,cAAC,GAAD,CACEwT,UAAWA,EACXiC,YAAa,YA3IrB,WACE,IADyB,EACnBgG,EAAMrC,EAASpZ,QADI,cAERyb,GAFQ,IAEzB,2BAAsB,CAAC,IAAdjO,EAAa,QACpBA,EAAK7D,SAAS+T,UACVlQ,EAAK2O,aACP3O,EAAK2O,YAAYuB,SAEpB,CAPwB,+BAQzBtE,EAASpZ,QAAU,GACnBia,GACD,CAkIS0D,GACAzE,EAAkB,GACnB,EACDxD,aAnIR,WACE,IAD0B,EACpB+F,EAAMrC,EAASpZ,QADK,cAETyb,GAFS,IAE1B,2BAAsB,CAAC,IAAdjO,EAAa,QACpBjG,EAAKwO,KAAKvI,EAAK7D,UACX6D,EAAK2O,aACP5U,EAAKwO,KAAKvI,EAAK2O,aAEjB3O,EAAKqO,QAAS,CACf,CARyB,+BAS3B,OA6HG,cAAC,GAAD,CACErI,UAAWA,EACXC,UAAW,SAAC5O,EAAO8C,IAvKzB,SAAuB9C,EAAoB8C,GACzC,IAAMrG,EAAQZ,EAASV,QACjByW,EAAkB0C,EAAmBnZ,QAC3C,GAAIsB,GAASmV,EAAiB,CAC5B,IAAM9M,EAAW9E,EAAM+E,eAAejC,EAAMrG,GAC5CmV,EAAgBsC,gBAAgBpP,GAChC9E,EAAMkR,KAAKpM,GACX,IAAI6D,EAAiB,CAAE7F,OAAMgC,WAAUkS,QAAQ,GAE/C,GAAa,SAATlU,EAAiB,CACnB,IAAMwU,EAActX,EAAM+E,eAAe,MAAOtI,GAChDmV,EAAgBsC,gBAAgBoD,GAChC5U,EAAKwO,KAAKoG,GACV3O,EAAK2O,YAAcA,CACpB,CACD/C,EAASpZ,QAAQ+D,KAAKyJ,EACvB,CACF,CAuJOoQ,CAAc/Y,EAAO8C,GACrBuR,EAAkB,GAAD,mBAAK1F,GAAL,CAAgB,CAAE7L,OAAMoO,KAAM,aAChD,EACDrC,WA7TiB,4CA8TjBE,qBAAsB6F,EACtB9F,aAAcA,EACdE,UAAWA,EACXC,kBAAmBA,EACnBC,QAAS8F,IAEVA,GACC,cAAC,IAAD,CACEvN,GAAI,CACFxH,MAAO,OACPC,OAAQ,OACRC,SAAU,WACVuH,IAAK,EACLwI,KAAM,QANV,SASE,cAAC8I,EAAA,EAAD,QAKT,C","file":"static/js/8.220fc723.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/environment.6140ab69.dds\";","import { useEffect } from \"react\";\n\nfunction usePreventTouch(elementRef: React.RefObject<HTMLElement>) {\n  useEffect(() => {\n    // Stop 3d touch\n    function prevent3DTouch(event: TouchEvent) {\n      event.preventDefault();\n    }\n    const element = elementRef.current;\n    if (element) {\n      element.addEventListener(\"touchstart\", prevent3DTouch, false);\n    }\n\n    return () => {\n      if (element) {\n        element.removeEventListener(\"touchstart\", prevent3DTouch);\n      }\n    };\n  }, [elementRef]);\n}\n\nexport default usePreventTouch;\n","import { useRef, useEffect, useState } from \"react\";\nimport { Engine } from \"@babylonjs/core/Engines/engine\";\nimport { Scene } from \"@babylonjs/core/scene\";\nimport { Vector3, Color4, Matrix } from \"@babylonjs/core/Maths/math\";\nimport { AmmoJSPlugin } from \"@babylonjs/core/Physics/Plugins/ammoJSPlugin\";\nimport { TargetCamera } from \"@babylonjs/core/Cameras/targetCamera\";\nimport Ammo from \"ammo.js\";\n\nimport \"@babylonjs/core/Physics/physicsEngineComponent\";\nimport \"@babylonjs/core/Lights/Shadows/shadowGeneratorSceneComponent\";\nimport \"@babylonjs/core/Materials/Textures/Loaders/ddsTextureLoader\";\nimport \"@babylonjs/core/Meshes/Builders/boxBuilder\";\nimport \"@babylonjs/core/Actions/actionManager\";\nimport \"@babylonjs/core/Culling/ray\";\nimport \"@babylonjs/loaders/glTF\";\n\nimport ReactResizeDetector from \"react-resize-detector\";\n\nimport usePreventTouch from \"../../hooks/usePreventTouch\";\n\nimport ErrorBanner from \"../banner/ErrorBanner\";\nimport { AbstractMesh } from \"@babylonjs/core/Meshes/abstractMesh\";\nimport { isSafari } from \"../../helpers/shared\";\n\nconst diceThrowSpeed = 2;\n\ntype SceneMountEvent = {\n  scene: Scene;\n  engine: Engine;\n  canvas: HTMLCanvasElement;\n};\n\ntype SceneMountEventHandler = (event: SceneMountEvent) => void;\n\ntype DiceInteractionProps = {\n  onSceneMount?: SceneMountEventHandler;\n  onPointerDown: () => void;\n  onPointerUp: () => void;\n};\n\nfunction DiceInteraction({\n  onSceneMount,\n  onPointerDown,\n  onPointerUp,\n}: DiceInteractionProps) {\n  const [error, setError] = useState<Error | undefined>();\n\n  const sceneRef = useRef<Scene>();\n  const engineRef = useRef<Engine>();\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n\n    if (!canvas) {\n      return;\n    }\n\n    try {\n      // iOS 15.4 introduced a bug - animation trails ar visible on dice in Safari. Have to disable antialiasing on Safari\n      // https://forum.babylonjs.com/t/render-loop-issue-on-iphone-11-unwanted-animation-trails/29742\n      const engine = new Engine(canvas, !isSafari, {\n        preserveDrawingBuffer: true,\n        stencil: true,\n        // Prevent XR from loading as Safari 15 crashes with this enabled\n        // TODO: Remove when https://github.com/BabylonJS/Babylon.js/pull/11121/files released\n        xrCompatible: false\n      });\n      const scene = new Scene(engine);\n      scene.clearColor = new Color4(0, 0, 0, 0);\n      // Enable physics\n      Ammo().then(() => {\n        scene.enablePhysics(new Vector3(0, -98, 0), new AmmoJSPlugin(false));\n      });\n\n      let camera = new TargetCamera(\"camera\", new Vector3(0, 33.5, 0), scene);\n      camera.fov = 0.65;\n      camera.setTarget(Vector3.Zero());\n\n      onSceneMount && onSceneMount({ scene, engine, canvas });\n\n      engineRef.current = engine;\n      sceneRef.current = scene;\n\n      engine.runRenderLoop(() => {\n        const scene = sceneRef.current;\n        const selectedMesh = selectedMeshRef.current;\n        if (selectedMesh && scene) {\n          const ray = scene.createPickingRay(\n            scene.pointerX,\n            scene.pointerY,\n            Matrix.Identity(),\n            camera\n          );\n          const currentPosition = selectedMesh.getAbsolutePosition();\n          let newPosition = ray.origin.scale(camera.globalPosition.y);\n          newPosition.y = currentPosition.y;\n          const delta = newPosition.subtract(currentPosition);\n          selectedMesh.setAbsolutePosition(newPosition);\n          const velocity = delta.scale(1000 / scene.deltaTime);\n          selectedMeshVelocityWindowRef.current =\n            selectedMeshVelocityWindowRef.current.slice(\n              Math.max(\n                selectedMeshVelocityWindowRef.current.length -\n                  selectedMeshVelocityWindowSize,\n                0\n              )\n            );\n          selectedMeshVelocityWindowRef.current.push(velocity);\n        }\n      });\n    } catch (error) {\n      if (error instanceof Error) {\n        setError(error);\n      }\n    }\n  }, [onSceneMount]);\n\n  const selectedMeshRef = useRef<AbstractMesh | null>(null);\n  const selectedMeshVelocityWindowRef = useRef<Vector3[]>([]);\n  const selectedMeshVelocityWindowSize = 4;\n  const selectedMeshMassRef = useRef<number>(0);\n  function handlePointerDown() {\n    const scene = sceneRef.current;\n    if (scene) {\n      const pickInfo = scene.pick(scene.pointerX, scene.pointerY);\n      if (\n        pickInfo &&\n        pickInfo.hit &&\n        pickInfo.pickedMesh &&\n        pickInfo.pickedMesh.name !== \"dice_tray\"\n      ) {\n        pickInfo.pickedMesh.physicsImpostor?.setLinearVelocity(Vector3.Zero());\n        pickInfo.pickedMesh.physicsImpostor?.setAngularVelocity(Vector3.Zero());\n\n        // Save the meshes mass and set it to 0 so we can pick it up\n        selectedMeshMassRef.current =\n          pickInfo.pickedMesh.physicsImpostor?.mass || 0;\n        pickInfo.pickedMesh.physicsImpostor?.setMass(0);\n\n        selectedMeshRef.current = pickInfo.pickedMesh;\n      }\n    }\n    onPointerDown();\n  }\n\n  function handlePointerUp() {\n    const selectedMesh = selectedMeshRef.current;\n    const velocityWindow = selectedMeshVelocityWindowRef.current;\n    const scene = sceneRef.current;\n    if (selectedMesh && scene) {\n      // Average velocity window\n      let velocity = Vector3.Zero();\n      for (let v of velocityWindow) {\n        velocity.addInPlace(v);\n      }\n      if (velocityWindow.length > 0) {\n        velocity.scaleInPlace(1 / velocityWindow.length);\n      }\n\n      // Re-apply the meshes mass\n      selectedMesh.physicsImpostor?.setMass(selectedMeshMassRef.current);\n      selectedMesh.physicsImpostor?.forceUpdate();\n\n      selectedMesh.physicsImpostor?.applyImpulse(\n        velocity.scale(diceThrowSpeed * selectedMesh.physicsImpostor.mass),\n        selectedMesh.physicsImpostor.getObjectCenter()\n      );\n    }\n    selectedMeshRef.current = null;\n    selectedMeshVelocityWindowRef.current = [];\n    selectedMeshMassRef.current = 0;\n\n    onPointerUp();\n  }\n\n  function handleResize(width?: number, height?: number) {\n    if (width && height) {\n      const engine = engineRef.current;\n      if (engine && canvasRef.current) {\n        engine.resize();\n        canvasRef.current.width = width;\n        canvasRef.current.height = height;\n      }\n    }\n  }\n\n  usePreventTouch(containerRef);\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        position: \"absolute\",\n        overflow: \"hidden\",\n      }}\n      ref={containerRef}\n    >\n      <ReactResizeDetector\n        handleWidth\n        handleHeight\n        onResize={handleResize}\n        targetRef={containerRef}\n      >\n        <canvas\n          onPointerDown={handlePointerDown}\n          onPointerUp={handlePointerUp}\n          onPointerCancel={handlePointerUp}\n          onPointerLeave={handlePointerUp}\n          ref={canvasRef}\n          style={{ outline: \"none\" }}\n        />\n      </ReactResizeDetector>\n      <ErrorBanner error={error} onRequestClose={() => setError(undefined)} />\n    </div>\n  );\n}\n\nDiceInteraction.defaultProps = {\n  onPointerDown() {},\n  onPointerUp() {},\n};\n\nexport default DiceInteraction;\n","export default __webpack_public_path__ + \"static/media/d4.5f4a6b12.glb\";","export default __webpack_public_path__ + \"static/media/d6.01277ab0.glb\";","export default __webpack_public_path__ + \"static/media/d8.aef4e07e.glb\";","export default __webpack_public_path__ + \"static/media/d10.75162417.glb\";","export default __webpack_public_path__ + \"static/media/d12.0acb683a.glb\";","export default __webpack_public_path__ + \"static/media/d20.8be40bdc.glb\";","export default __webpack_public_path__ + \"static/media/d100.f247533e.glb\";","import { Texture } from \"@babylonjs/core/Materials/Textures/texture\";\n\n// Turn texture load into an async function so it can be awaited\nexport async function importTextureAsync(url: string): Promise<Texture> {\n  return new Promise((resolve, reject) => {\n    let texture = new Texture(\n      url,\n      null,\n      undefined,\n      false,\n      undefined,\n      () => {\n        resolve(texture);\n      },\n      () => {\n        reject(\"Unable to load texture\");\n      }\n    );\n  });\n}\n","import { InstancedMesh, Mesh } from \"@babylonjs/core\";\nimport Dice from \"../dice/Dice\";\n\nexport type DiceType = \"d4\" | \"d6\" | \"d8\" | \"d10\" | \"d12\" | \"d20\" | \"d100\";\n\nexport type DiceRoll = {\n  type: DiceType;\n  roll: number | \"unknown\";\n};\n\nexport type DiceMesh = {\n  type: DiceType;\n  instance: InstancedMesh;\n  asleep: boolean;\n  sleepTimeout?: NodeJS.Timeout;\n  d10Instance?: InstancedMesh;\n};\n\nexport type DiceState = {\n  share: boolean;\n  rolls: DiceRoll[];\n};\n\nexport type DefaultDice = {\n  key: string;\n  name: string;\n  class: typeof Dice;\n  preview: string;\n};\n\nexport type BaseDiceTextureSources = {\n  albedo: string;\n  normal: string;\n  metalRoughness: string;\n};\n\nexport type DiceMeshes = Record<DiceType, Mesh>;\n\nexport function isDiceMeshes(\n  meshes: Partial<DiceMeshes>\n): meshes is DiceMeshes {\n  return (\n    !!meshes.d4 &&\n    !!meshes.d6 &&\n    !!meshes.d8 &&\n    !!meshes.d10 &&\n    !!meshes.d12 &&\n    !!meshes.d20 &&\n    !!meshes.d100\n  );\n}\n","import { Vector3 } from \"@babylonjs/core/Maths/math\";\nimport { SceneLoader } from \"@babylonjs/core/Loading/sceneLoader\";\nimport { PBRMaterial } from \"@babylonjs/core/Materials/PBR/pbrMaterial\";\nimport {\n  PhysicsImpostor,\n  PhysicsImpostorParameters,\n} from \"@babylonjs/core/Physics/physicsImpostor\";\n\nimport d4Source from \"./shared/d4.glb\";\nimport d6Source from \"./shared/d6.glb\";\nimport d8Source from \"./shared/d8.glb\";\nimport d10Source from \"./shared/d10.glb\";\nimport d12Source from \"./shared/d12.glb\";\nimport d20Source from \"./shared/d20.glb\";\nimport d100Source from \"./shared/d100.glb\";\n\nimport { lerp } from \"../helpers/shared\";\nimport { importTextureAsync } from \"../helpers/babylon\";\nimport {\n  AbstractMesh,\n  InstancedMesh,\n  Material,\n  Mesh,\n  Scene,\n} from \"@babylonjs/core\";\nimport {\n  DiceType,\n  BaseDiceTextureSources,\n  isDiceMeshes,\n  DiceMeshes,\n} from \"../types/Dice\";\n\nconst minDiceRollSpeed = 600;\nconst maxDiceRollSpeed = 800;\n\nclass Dice {\n  static instanceCount = 0;\n\n  static async loadMeshes(\n    material: Material,\n    scene: Scene,\n    sourceOverrides?: Record<DiceType, string>\n  ): Promise<DiceMeshes> {\n    let meshes: Partial<DiceMeshes> = {};\n    const addToMeshes = async (type: DiceType, defaultSource: string) => {\n      let source = sourceOverrides ? sourceOverrides[type] : defaultSource;\n      const mesh = await this.loadMesh(source, material, scene);\n      meshes[type] = mesh;\n    };\n    await Promise.all([\n      addToMeshes(\"d4\", d4Source),\n      addToMeshes(\"d6\", d6Source),\n      addToMeshes(\"d8\", d8Source),\n      addToMeshes(\"d10\", d10Source),\n      addToMeshes(\"d12\", d12Source),\n      addToMeshes(\"d20\", d20Source),\n      addToMeshes(\"d100\", d100Source),\n    ]);\n    if (isDiceMeshes(meshes)) {\n      return meshes;\n    } else {\n      throw new Error(\"Dice meshes failed to load, missing mesh source\");\n    }\n  }\n\n  static async loadMesh(source: string, material: Material, scene: Scene) {\n    let mesh = (await SceneLoader.ImportMeshAsync(\"\", source, \"\", scene))\n      .meshes[1] as Mesh;\n    mesh.setParent(null);\n\n    mesh.material = material;\n\n    mesh.receiveShadows = true;\n    mesh.isVisible = false;\n    return mesh;\n  }\n\n  static async loadMaterial(\n    materialName: string,\n    textures: BaseDiceTextureSources,\n    scene: Scene\n  ) {\n    let pbr = new PBRMaterial(materialName, scene);\n    let [albedo, normal, metalRoughness] = await Promise.all([\n      importTextureAsync(textures.albedo),\n      importTextureAsync(textures.normal),\n      importTextureAsync(textures.metalRoughness),\n    ]);\n    pbr.albedoTexture = albedo;\n    pbr.bumpTexture = normal;\n    pbr.metallicTexture = metalRoughness;\n    pbr.useRoughnessFromMetallicTextureAlpha = false;\n    pbr.useRoughnessFromMetallicTextureGreen = true;\n    pbr.useMetallnessFromMetallicTextureBlue = true;\n    return pbr;\n  }\n\n  static createInstanceFromMesh(\n    mesh: Mesh,\n    name: string,\n    physicalProperties: PhysicsImpostorParameters,\n    scene: Scene\n  ) {\n    let instance = mesh.createInstance(name);\n    instance.position = mesh.position;\n    for (let child of mesh.getChildTransformNodes()) {\n      const locator = child.clone(child.name, instance);\n      if (!locator) {\n        throw new Error(\"Unable to clone dice locator\");\n      }\n      locator.setAbsolutePosition(child.getAbsolutePosition());\n      locator.name = child.name;\n      instance.addChild(locator as AbstractMesh);\n    }\n\n    instance.physicsImpostor = new PhysicsImpostor(\n      instance,\n      PhysicsImpostor.ConvexHullImpostor,\n      physicalProperties,\n      scene\n    );\n\n    return instance;\n  }\n\n  static getDicePhysicalProperties(diceType: DiceType) {\n    switch (diceType) {\n      case \"d4\":\n        return { mass: 4, friction: 4 };\n      case \"d6\":\n        return { mass: 6, friction: 4 };\n      case \"d8\":\n        return { mass: 6.2, friction: 4 };\n      case \"d10\":\n      case \"d100\":\n        return { mass: 7, friction: 4 };\n      case \"d12\":\n        return { mass: 8, friction: 4 };\n      case \"d20\":\n        return { mass: 10, friction: 4 };\n      default:\n        return { mass: 10, friction: 4 };\n    }\n  }\n\n  static roll(instance: InstancedMesh) {\n    instance.physicsImpostor?.setLinearVelocity(Vector3.Zero());\n    instance.physicsImpostor?.setAngularVelocity(Vector3.Zero());\n\n    const scene = instance.getScene();\n    const diceTraySingle = scene.getMeshByID(\"dice_tray_single\");\n    const diceTrayDouble = scene.getMeshByID(\"dice_tray_double\");\n    const visibleDiceTray = diceTraySingle?.isVisible\n      ? diceTraySingle\n      : diceTrayDouble;\n    if (!visibleDiceTray) {\n      throw new Error(\"No dice tray to roll in\");\n    }\n    const trayBounds = visibleDiceTray?.getBoundingInfo().boundingBox;\n\n    const position = new Vector3(\n      trayBounds.center.x + (Math.random() * 2 - 1),\n      8,\n      trayBounds.center.z + (Math.random() * 2 - 1)\n    );\n    instance.position = position;\n    instance.addRotation(\n      Math.random() * Math.PI * 2,\n      Math.random() * Math.PI * 2,\n      Math.random() * Math.PI * 2\n    );\n\n    const throwTarget = new Vector3(\n      lerp(trayBounds.minimumWorld.x, trayBounds.maximumWorld.x, Math.random()),\n      5,\n      lerp(trayBounds.minimumWorld.z, trayBounds.maximumWorld.z, Math.random())\n    );\n\n    const impulse = new Vector3(0, 0, 0)\n      .subtract(throwTarget)\n      .normalizeToNew()\n      .scale(lerp(minDiceRollSpeed, maxDiceRollSpeed, Math.random()));\n\n    instance.physicsImpostor?.applyImpulse(\n      impulse,\n      instance.physicsImpostor.getObjectCenter()\n    );\n  }\n\n  static createInstanceMesh(\n    mesh: Mesh,\n    physicalProperties: PhysicsImpostorParameters,\n    scene: Scene\n  ): InstancedMesh {\n    this.instanceCount++;\n\n    return this.createInstanceFromMesh(\n      mesh,\n      `dice_instance_${this.instanceCount}`,\n      physicalProperties,\n      scene\n    );\n  }\n\n  static async load(scene: Scene) {\n    throw new Error(`Unable to load ${scene}`);\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene): InstancedMesh {\n    throw new Error(`No instance available for ${diceType} in ${scene}`);\n  }\n}\n\nexport default Dice;\n","function ExpandMoreDotIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M20.08,11.42l-4.04-5.65C15.7,5.29,15.15,5,14.56,5h0c-1.49,0-2.35,1.68-1.49,2.89L16,12l-2.93,4.11 c-0.87,1.21,0,2.89,1.49,2.89h0c0.59,0,1.15-0.29,1.49-0.77l4.04-5.65C20.33,12.23,20.33,11.77,20.08,11.42z\" />\n      <path d=\"M13.08,11.42L9.05,5.77C8.7,5.29,8.15,5,7.56,5h0C6.07,5,5.2,6.68,6.07,7.89L9,12l-2.93,4.11C5.2,17.32,6.07,19,7.56,19h0 c0.59,0,1.15-0.29,1.49-0.77l4.04-5.65C13.33,12.23,13.33,11.77,13.08,11.42z\" />\n    </svg>\n  );\n}\n\nexport default ExpandMoreDotIcon;\n","function ShareDiceOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 24H0V0h24z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z\" />\n    </svg>\n  );\n}\n\nexport default ShareDiceOnIcon;\n","function ShareDiceOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 24H0V0h24z\" fill=\"none\" />\n      <path d=\"M11,8.17L6.49,3.66C8.07,2.61,9.96,2,12,2c5.52,0,10,4.48,10,10c0,2.04-0.61,3.93-1.66,5.51l-1.46-1.46 C19.59,14.87,20,13.48,20,12c0-3.35-2.07-6.22-5-7.41V5c0,1.1-0.9,2-2,2h-2V8.17z M20.49,21.9L20.49,21.9 c-0.39,0.39-1.02,0.39-1.41,0l-1.56-1.56c-2.07,1.37-4.68,2-7.45,1.48c-3.95-0.75-7.13-3.92-7.88-7.88 c-0.52-2.77,0.1-5.38,1.48-7.45L2.1,4.93c-0.39-0.39-0.39-1.02,0-1.41l0,0c0.39-0.39,1.02-0.39,1.41,0l16.97,16.97 C20.88,20.88,20.88,21.51,20.49,21.9z M11,18c-1.1,0-2-0.9-2-2v-1l-4.79-4.79C4.08,10.79,4,11.38,4,12c0,4.08,3.05,7.44,7,7.93V18z\" />\n    </svg>\n  );\n}\n\nexport default ShareDiceOffIcon;\n","import React from \"react\";\nimport { Box, Text } from \"theme-ui\";\n\nfunction DiceButtonCount({ children }: { children: React.ReactNode }) {\n  return (\n    <Box\n      sx={{\n        position: \"absolute\",\n        top: \"50%\",\n        right: \"90%\",\n        transform: \"translateY(-50%)\",\n        height: \"14px\",\n        display: \"flex\",\n        alignItems: \"center\",\n      }}\n    >\n      <Text\n        variant=\"caption\"\n        as=\"p\"\n        color=\"text\"\n        sx={{ fontSize: \"10px\", fontWeight: \"bold\" }}\n      >\n        {children}\n      </Text>\n    </Box>\n  );\n}\n\nexport default DiceButtonCount;\n","import React from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport Count from \"./DiceButtonCount\";\n\ntype DiceButtonProps = {\n  title: string;\n  children: React.ReactNode;\n  count?: number;\n  onClick: React.MouseEventHandler<HTMLButtonElement>;\n  disabled: boolean;\n};\n\nfunction DiceButton({\n  title,\n  children,\n  count,\n  onClick,\n  disabled,\n}: DiceButtonProps) {\n  return (\n    <IconButton\n      title={title}\n      aria-label={title}\n      onClick={onClick}\n      sx={{ position: \"relative\" }}\n      disabled={disabled}\n    >\n      {children}\n      {count && <Count>{count}</Count>}\n    </IconButton>\n  );\n}\n\nexport default DiceButton;\n","function SelectDiceIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z\" />\n    </svg>\n  );\n}\n\nexport default SelectDiceIcon;\n","import { Image } from \"theme-ui\";\n\nimport Tile from \"../tile/Tile\";\n\nimport { DefaultDice } from \"../../types/Dice\";\n\ntype DiceTileProps = {\n  dice: DefaultDice;\n  isSelected: boolean;\n  onDiceSelect: (dice: DefaultDice) => void;\n  onDone: (dice: DefaultDice) => void;\n};\n\nfunction DiceTile({ dice, isSelected, onDiceSelect, onDone }: DiceTileProps) {\n  return (\n    <div style={{ cursor: \"pointer\" }}>\n      <Tile\n        title={dice.name}\n        isSelected={isSelected}\n        onSelect={() => onDiceSelect(dice)}\n        onDoubleClick={() => onDone(dice)}\n      >\n        <Image src={dice.preview}></Image>\n      </Tile>\n    </div>\n  );\n}\n\nexport default DiceTile;\n","import { Grid } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport DiceTile from \"./DiceTile\";\n\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\nimport { DefaultDice } from \"../../types/Dice\";\nimport { DiceSelectEventHandler } from \"../../types/Events\";\n\ntype DiceTileProps = {\n  dice: DefaultDice[];\n  onDiceSelect: DiceSelectEventHandler;\n  selectedDice: DefaultDice;\n  onDone: DiceSelectEventHandler;\n};\n\nfunction DiceTiles({\n  dice,\n  onDiceSelect,\n  selectedDice,\n  onDone,\n}: DiceTileProps) {\n  const layout = useResponsiveLayout();\n\n  return (\n    <SimpleBar style={{ height: layout.tileContainerHeight }}>\n      <Grid\n        p={2}\n        pb={4}\n        bg=\"muted\"\n        sx={{\n          borderRadius: \"4px\",\n          minHeight: layout.screenSize === \"large\" ? \"600px\" : \"400px\",\n        }}\n        gap={2}\n        columns={`repeat(${layout.tileGridColumns}, 1fr)`}\n      >\n        {dice.map((dice) => (\n          <DiceTile\n            key={dice.key}\n            dice={dice}\n            isSelected={selectedDice && dice.key === selectedDice.key}\n            onDiceSelect={onDiceSelect}\n            onDone={onDone}\n          />\n        ))}\n      </Grid>\n    </SimpleBar>\n  );\n}\n\nexport default DiceTiles;\n","export default __webpack_public_path__ + \"static/media/albedo.0940cfaf.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.8c8e9d34.jpg\";","export default __webpack_public_path__ + \"static/media/normal.97ba4b6c.jpg\";","import { InstancedMesh, Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass GalaxyDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"galaxy_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene): InstancedMesh {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return super.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default GalaxyDice;\n","export default __webpack_public_path__ + \"static/media/albedo.b76f6b3b.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.d42c24eb.jpg\";","export default __webpack_public_path__ + \"static/media/normal.19a9c078.jpg\";","import { Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass IronDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static getDicePhysicalProperties(diceType: DiceType) {\n    let properties = super.getDicePhysicalProperties(diceType);\n    return { mass: properties.mass * 2, friction: properties.friction };\n  }\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"iron_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return Dice.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default IronDice;\n","export default __webpack_public_path__ + \"static/media/albedo.5479454b.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.316a71be.jpg\";","export default __webpack_public_path__ + \"static/media/normal.0dc207c6.jpg\";","import { Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass NebulaDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"neubula_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return Dice.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default NebulaDice;\n","export default __webpack_public_path__ + \"static/media/albedo.83b2adf8.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.a6c7a8ac.jpg\";","export default __webpack_public_path__ + \"static/media/normal.75d74d42.jpg\";","import { Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass SunriseDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"sunrise_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return super.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default SunriseDice;\n","export default __webpack_public_path__ + \"static/media/albedo.989c2eb0.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.c7c91f0a.jpg\";","export default __webpack_public_path__ + \"static/media/normal.55affda5.jpg\";","import { Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass SunsetDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"sunset_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return super.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default SunsetDice;\n","export default __webpack_public_path__ + \"static/media/albedo.f961edb0.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.6fe2dde8.jpg\";","export default __webpack_public_path__ + \"static/media/normal.8143036b.jpg\";","import { Material, Scene } from \"@babylonjs/core\";\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport d4Source from \"./d4.glb\";\nimport d6Source from \"./d6.glb\";\nimport d8Source from \"./d8.glb\";\nimport d10Source from \"./d10.glb\";\nimport d12Source from \"./d12.glb\";\nimport d20Source from \"./d20.glb\";\nimport d100Source from \"./d100.glb\";\nimport { DiceMeshes, DiceType } from \"../../types/Dice\";\n\nconst sourceOverrides = {\n  d4: d4Source,\n  d6: d6Source,\n  d8: d8Source,\n  d10: d10Source,\n  d12: d12Source,\n  d20: d20Source,\n  d100: d100Source,\n};\n\nclass WalnutDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static getDicePhysicalProperties(diceType: DiceType) {\n    let properties = super.getDicePhysicalProperties(diceType);\n    return { mass: properties.mass * 1.4, friction: properties.friction };\n  }\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"walnut_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(\n        this.material,\n        scene,\n        sourceOverrides\n      );\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return super.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default WalnutDice;\n","export default __webpack_public_path__ + \"static/media/d4.52896fe7.glb\";","export default __webpack_public_path__ + \"static/media/d6.9192a151.glb\";","export default __webpack_public_path__ + \"static/media/d8.b80ce954.glb\";","export default __webpack_public_path__ + \"static/media/d10.8948845e.glb\";","export default __webpack_public_path__ + \"static/media/d12.8dc2ee51.glb\";","export default __webpack_public_path__ + \"static/media/d20.45aa4a95.glb\";","export default __webpack_public_path__ + \"static/media/d100.e871721f.glb\";","export default __webpack_public_path__ + \"static/media/albedo.e36ca17f.jpg\";","export default __webpack_public_path__ + \"static/media/mask.1f48bf2d.png\";","export default __webpack_public_path__ + \"static/media/normal.5e14e52f.jpg\";","import { PBRMaterial } from \"@babylonjs/core/Materials/PBR/pbrMaterial\";\nimport { Color3 } from \"@babylonjs/core/Maths/math\";\nimport { Material, Scene } from \"@babylonjs/core\";\n\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport mask from \"./mask.png\";\nimport normal from \"./normal.jpg\";\n\nimport { importTextureAsync } from \"../../helpers/babylon\";\n\nimport { BaseDiceTextureSources, DiceMeshes, DiceType } from \"../../types/Dice\";\n\ntype GlassDiceTextureSources = Pick<\n  BaseDiceTextureSources,\n  \"albedo\" | \"normal\"\n> & { mask: string };\n\nclass GlassDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static getDicePhysicalProperties(diceType: DiceType) {\n    let properties = super.getDicePhysicalProperties(diceType);\n    return { mass: properties.mass * 1.5, friction: properties.friction };\n  }\n\n  static async loadGlassMaterial(\n    materialName: string,\n    textures: GlassDiceTextureSources,\n    scene: Scene\n  ) {\n    let pbr = new PBRMaterial(materialName, scene);\n    let [albedo, normal, mask] = await Promise.all([\n      importTextureAsync(textures.albedo),\n      importTextureAsync(textures.normal),\n      importTextureAsync(textures.mask),\n    ]);\n    pbr.albedoTexture = albedo;\n    pbr.bumpTexture = normal;\n    pbr.roughness = 0.25;\n    pbr.metallic = 0;\n    pbr.subSurface.isRefractionEnabled = true;\n    pbr.subSurface.indexOfRefraction = 2.0;\n    pbr.subSurface.refractionIntensity = 1.0;\n    pbr.subSurface.isTranslucencyEnabled = true;\n    pbr.subSurface.translucencyIntensity = 0.5;\n    pbr.subSurface.minimumThickness = 10;\n    pbr.subSurface.maximumThickness = 10;\n    pbr.subSurface.tintColor = new Color3(43 / 255, 1, 115 / 255);\n    pbr.subSurface.thicknessTexture = mask;\n    pbr.subSurface.useMaskFromThicknessTexture = true;\n\n    return pbr;\n  }\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadGlassMaterial(\n        \"glass_pbr\",\n        { albedo, mask, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return Dice.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default GlassDice;\n","export default __webpack_public_path__ + \"static/media/albedo.a5508be6.jpg\";","export default __webpack_public_path__ + \"static/media/metalRoughness.f8e641dc.jpg\";","export default __webpack_public_path__ + \"static/media/normal.4f52152c.jpg\";","import { PBRMaterial } from \"@babylonjs/core/Materials/PBR/pbrMaterial\";\nimport { Color3 } from \"@babylonjs/core/Maths/math\";\nimport { Material, Scene } from \"@babylonjs/core\";\n\nimport Dice from \"../Dice\";\n\nimport albedo from \"./albedo.jpg\";\nimport metalRoughness from \"./metalRoughness.jpg\";\nimport normal from \"./normal.jpg\";\n\nimport { importTextureAsync } from \"../../helpers/babylon\";\nimport { BaseDiceTextureSources, DiceMeshes, DiceType } from \"../../types/Dice\";\n\nclass GemstoneDice extends Dice {\n  static meshes: DiceMeshes;\n  static material: Material;\n\n  static getDicePhysicalProperties(diceType: DiceType) {\n    let properties = super.getDicePhysicalProperties(diceType);\n    return { mass: properties.mass * 1.5, friction: properties.friction };\n  }\n\n  static async loadMaterial(\n    materialName: string,\n    textures: BaseDiceTextureSources,\n    scene: Scene\n  ) {\n    let pbr = new PBRMaterial(materialName, scene);\n    let [albedo, normal, metalRoughness] = await Promise.all([\n      importTextureAsync(textures.albedo),\n      importTextureAsync(textures.normal),\n      importTextureAsync(textures.metalRoughness),\n    ]);\n    pbr.albedoTexture = albedo;\n    pbr.bumpTexture = normal;\n    pbr.metallicTexture = metalRoughness;\n    pbr.useRoughnessFromMetallicTextureAlpha = false;\n    pbr.useRoughnessFromMetallicTextureGreen = true;\n    pbr.useMetallnessFromMetallicTextureBlue = true;\n\n    pbr.subSurface.isTranslucencyEnabled = true;\n    pbr.subSurface.translucencyIntensity = 0.2;\n    pbr.subSurface.minimumThickness = 5;\n    pbr.subSurface.maximumThickness = 10;\n    pbr.subSurface.tintColor = new Color3(190 / 255, 0, 220 / 255);\n\n    return pbr;\n  }\n\n  static async load(scene: Scene) {\n    if (!this.material) {\n      this.material = await this.loadMaterial(\n        \"gemstone_pbr\",\n        { albedo, metalRoughness, normal },\n        scene\n      );\n    }\n    if (!this.meshes) {\n      this.meshes = await this.loadMeshes(this.material, scene);\n    }\n  }\n\n  static createInstance(diceType: DiceType, scene: Scene) {\n    if (!this.material || !this.meshes) {\n      throw Error(\"Dice not loaded, call load before creating an instance\");\n    }\n\n    return Dice.createInstanceMesh(\n      this.meshes[diceType],\n      this.getDicePhysicalProperties(diceType),\n      scene\n    );\n  }\n}\n\nexport default GemstoneDice;\n","export default __webpack_public_path__ + \"static/media/preview.90e03e4d.png\";","export default __webpack_public_path__ + \"static/media/preview.426a2aa1.png\";","export default __webpack_public_path__ + \"static/media/preview.797f7773.png\";","export default __webpack_public_path__ + \"static/media/preview.3f77b9e6.png\";","export default __webpack_public_path__ + \"static/media/preview.9a76b828.png\";","export default __webpack_public_path__ + \"static/media/preview.a548021a.png\";","export default __webpack_public_path__ + \"static/media/preview.7d921376.png\";","export default __webpack_public_path__ + \"static/media/preview.eb6266ff.png\";","import Case from \"case\";\n\nimport GalaxyDice from \"./galaxy/GalaxyDice\";\nimport IronDice from \"./iron/IronDice\";\nimport NebulaDice from \"./nebula/NebulaDice\";\nimport SunriseDice from \"./sunrise/SunriseDice\";\nimport SunsetDice from \"./sunset/SunsetDice\";\nimport WalnutDice from \"./walnut/WalnutDice\";\nimport GlassDice from \"./glass/GlassDice\";\nimport GemstoneDice from \"./gemstone/GemstoneDice\";\n\nimport GalaxyPreview from \"./galaxy/preview.png\";\nimport IronPreview from \"./iron/preview.png\";\nimport NebulaPreview from \"./nebula/preview.png\";\nimport SunrisePreview from \"./sunrise/preview.png\";\nimport SunsetPreview from \"./sunset/preview.png\";\nimport WalnutPreview from \"./walnut/preview.png\";\nimport GlassPreview from \"./glass/preview.png\";\nimport GemstonePreview from \"./gemstone/preview.png\";\nimport Dice from \"./Dice\";\n\nimport { DefaultDice } from \"../types/Dice\";\n\ntype DiceClasses = Record<string, typeof Dice>;\n\nexport const diceClasses: DiceClasses = {\n  galaxy: GalaxyDice,\n  nebula: NebulaDice,\n  sunrise: SunriseDice,\n  sunset: SunsetDice,\n  iron: IronDice,\n  walnut: WalnutDice,\n  glass: GlassDice,\n  gemstone: GemstoneDice,\n};\n\ntype DicePreview = Record<string, string>;\n\nexport const dicePreviews: DicePreview = {\n  galaxy: GalaxyPreview,\n  nebula: NebulaPreview,\n  sunrise: SunrisePreview,\n  sunset: SunsetPreview,\n  iron: IronPreview,\n  walnut: WalnutPreview,\n  glass: GlassPreview,\n  gemstone: GemstonePreview,\n};\n\nexport const dice: DefaultDice[] = Object.keys(diceClasses).map((key) => ({\n  key,\n  name: Case.capital(key),\n  class: diceClasses[key],\n  preview: dicePreviews[key],\n}));\n","import { useState } from \"react\";\nimport { Flex, Label, Button } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\nimport DiceTiles from \"../components/dice/DiceTiles\";\n\nimport { dice } from \"../dice\";\n\nimport useResponsiveLayout from \"../hooks/useResponsiveLayout\";\n\nimport {\n  DiceSelectEventHandler,\n  RequestCloseEventHandler,\n} from \"../types/Events\";\nimport { DefaultDice } from \"../types/Dice\";\n\ntype SelectDiceProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onDone: DiceSelectEventHandler;\n  defaultDice: DefaultDice;\n};\n\nfunction SelectDiceModal({\n  isOpen,\n  onRequestClose,\n  onDone,\n  defaultDice,\n}: SelectDiceProps) {\n  const [selectedDice, setSelectedDice] = useState(defaultDice);\n  const layout = useResponsiveLayout();\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{\n        content: { maxWidth: layout.modalSize, width: \"calc(100% - 16px)\" },\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n        }}\n      >\n        <Label pt={2} pb={1}>\n          Select a dice style\n        </Label>\n        <DiceTiles\n          dice={dice}\n          onDiceSelect={setSelectedDice}\n          selectedDice={selectedDice}\n          onDone={onDone}\n        />\n        <Button my={2} variant=\"primary\" onClick={() => onDone(selectedDice)}>\n          Select\n        </Button>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default SelectDiceModal;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport SelectDiceIcon from \"../../icons/SelectDiceIcon\";\nimport SelectDiceModal from \"../../modals/SelectDiceModal\";\n\nimport { DefaultDice } from \"../../types/Dice\";\n\ntype SelectDiceButtonProps = {\n  onDiceChange: (dice: DefaultDice) => void;\n  currentDice: DefaultDice;\n  disabled: boolean;\n};\n\nfunction SelectDiceButton({\n  onDiceChange,\n  currentDice,\n  disabled,\n}: SelectDiceButtonProps) {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  function openModal() {\n    setIsModalOpen(true);\n  }\n  function closeModal() {\n    setIsModalOpen(false);\n  }\n\n  function handleDone(dice: DefaultDice) {\n    onDiceChange(dice);\n    closeModal();\n  }\n\n  return (\n    <>\n      <IconButton\n        aria-label=\"Select Dice Style\"\n        title=\"Select Dice Style\"\n        onClick={openModal}\n        disabled={disabled}\n      >\n        <SelectDiceIcon />\n      </IconButton>\n      <SelectDiceModal\n        isOpen={isModalOpen}\n        onRequestClose={closeModal}\n        defaultDice={currentDice}\n        onDone={handleDone}\n      />\n    </>\n  );\n}\n\nSelectDiceButton.defaultProps = {\n  disabled: false,\n};\n\nexport default SelectDiceButton;\n","import { useState, useEffect } from \"react\";\nimport { Flex, IconButton, Box } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport D20Icon from \"../../icons/D20Icon\";\nimport D12Icon from \"../../icons/D12Icon\";\nimport D10Icon from \"../../icons/D10Icon\";\nimport D8Icon from \"../../icons/D8Icon\";\nimport D6Icon from \"../../icons/D6Icon\";\nimport D4Icon from \"../../icons/D4Icon\";\nimport D100Icon from \"../../icons/D100Icon\";\nimport ExpandMoreDiceTrayIcon from \"../../icons/ExpandMoreDiceTrayIcon\";\nimport ShareDiceOnIcon from \"../../icons/ShareDiceOnIcon\";\nimport ShareDiceOffIcon from \"../../icons/ShareDiceOffIcon\";\n\nimport DiceButton from \"./DiceButton\";\nimport SelectDiceButton from \"./SelectDiceButton\";\n\nimport Divider from \"../Divider\";\n\nimport Dice from \"../../dice/Dice\";\n\nimport { dice } from \"../../dice\";\nimport useSetting from \"../../hooks/useSetting\";\n\nimport { DefaultDice, DiceRoll, DiceType } from \"../../types/Dice\";\nimport { DiceShareChangeEventHandler } from \"../../types/Events\";\n\ntype DiceButtonsProps = {\n  diceRolls: DiceRoll[];\n  onDiceAdd: (style: typeof Dice, type: DiceType) => void;\n  onDiceLoad: (dice: DefaultDice) => void;\n  diceTraySize: \"single\" | \"double\";\n  onDiceTraySizeChange: (newSize: \"single\" | \"double\") => void;\n  shareDice: boolean;\n  onShareDiceChange: DiceShareChangeEventHandler;\n  loading: boolean;\n};\n\nfunction DiceButtons({\n  diceRolls,\n  onDiceAdd,\n  onDiceLoad,\n  diceTraySize,\n  onDiceTraySizeChange,\n  shareDice,\n  onShareDiceChange,\n  loading,\n}: DiceButtonsProps) {\n  const [currentDiceStyle, setCurrentDiceStyle] = useSetting(\"dice.style\");\n  const [currentDice, setCurrentDice] = useState<DefaultDice>(\n    dice.find((d) => d.key === currentDiceStyle) || dice[0]\n  );\n\n  useEffect(() => {\n    const initialDice = dice.find((d) => d.key === currentDiceStyle);\n    if (initialDice) {\n      onDiceLoad(initialDice);\n      setCurrentDice(initialDice);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const diceCounts: Partial<Record<DiceType, number>> = {};\n  for (let dice of diceRolls) {\n    if (dice.type in diceCounts) {\n      // TODO: Check type\n      diceCounts[dice.type]! += 1;\n    } else {\n      diceCounts[dice.type] = 1;\n    }\n  }\n\n  async function handleDiceChange(dice: DefaultDice) {\n    await onDiceLoad(dice);\n    setCurrentDice(dice);\n    setCurrentDiceStyle(dice.key);\n  }\n\n  let buttons = [\n    {\n      key: \"d20\",\n      title: \"Add D20\",\n      count: diceCounts.d20,\n      onClick: () => onDiceAdd(currentDice.class, \"d20\"),\n      children: <D20Icon />,\n    },\n    {\n      key: \"d12\",\n      title: \"Add D12\",\n      count: diceCounts.d12,\n      onClick: () => onDiceAdd(currentDice.class, \"d12\"),\n      children: <D12Icon />,\n    },\n    {\n      key: \"d10\",\n      title: \"Add D10\",\n      count: diceCounts.d10,\n      onClick: () => onDiceAdd(currentDice.class, \"d10\"),\n      children: <D10Icon />,\n    },\n    {\n      key: \"d8\",\n      title: \"Add D8\",\n      count: diceCounts.d8,\n      onClick: () => onDiceAdd(currentDice.class, \"d8\"),\n      children: <D8Icon />,\n    },\n    {\n      key: \"d6\",\n      title: \"Add D6\",\n      count: diceCounts.d6,\n      onClick: () => onDiceAdd(currentDice.class, \"d6\"),\n      children: <D6Icon />,\n    },\n    {\n      key: \"d4\",\n      title: \"Add D4\",\n      count: diceCounts.d4,\n      onClick: () => onDiceAdd(currentDice.class, \"d4\"),\n      children: <D4Icon />,\n    },\n    {\n      key: \"d100\",\n      title: \"Add D100\",\n      count: diceCounts.d100,\n      onClick: () => onDiceAdd(currentDice.class, \"d100\"),\n      children: <D100Icon />,\n    },\n  ];\n\n  return (\n    <Box\n      sx={{\n        borderRadius: \"4px\",\n        position: \"absolute\",\n        top: \"0\",\n        left: \"0\",\n        height: \"100%\",\n        maxHeight: \"390px\",\n        pointerEvents: \"all\",\n      }}\n      bg=\"overlay\"\n    >\n      <SimpleBar style={{ width: \"48px\", height: \"100%\" }}>\n        <Flex\n          sx={{\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            flexDirection: \"column\",\n          }}\n          p={2}\n        >\n          <SelectDiceButton\n            onDiceChange={handleDiceChange}\n            currentDice={currentDice}\n            disabled={loading}\n          />\n          <Divider />\n          {buttons.map((button) => (\n            <DiceButton disabled={loading} {...button} />\n          ))}\n          <Divider />\n          <IconButton\n            aria-label={\n              diceTraySize === \"single\"\n                ? \"Expand Dice Tray\"\n                : \"Shrink Dice Tray\"\n            }\n            title={\n              diceTraySize === \"single\"\n                ? \"Expand Dice Tray\"\n                : \"Shrink Dice Tray\"\n            }\n            sx={{\n              transform:\n                diceTraySize === \"single\" ? \"rotate(0)\" : \"rotate(180deg)\",\n            }}\n            onClick={() =>\n              onDiceTraySizeChange(\n                diceTraySize === \"single\" ? \"double\" : \"single\"\n              )\n            }\n            disabled={loading}\n          >\n            <ExpandMoreDiceTrayIcon />\n          </IconButton>\n          <Divider />\n          <IconButton\n            aria-label={shareDice ? \"Hide Dice Rolls\" : \"Share Dice Rolls\"}\n            title={shareDice ? \"Hide Dice Rolls\" : \"Share Dice Rolls\"}\n            onClick={() => onShareDiceChange(!shareDice)}\n            disabled={loading}\n          >\n            {shareDice ? <ShareDiceOnIcon /> : <ShareDiceOffIcon />}\n          </IconButton>\n        </Flex>\n      </SimpleBar>\n    </Box>\n  );\n}\n\nexport default DiceButtons;\n","function ClearDiceIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z\" />\n    </svg>\n  );\n}\n\nexport default ClearDiceIcon;\n","function RerollDiceIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M21 14c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1l-.116-.007A1.004 1.004 0 0120 19v-1.01A9.985 9.985 0 0112 22c-4.36 0-8.07-2.79-9.44-6.69-.22-.64.28-1.31.96-1.31l.122.007a.991.991 0 01.818.633C5.55 17.76 8.51 20 12 20c2.95 0 5.53-1.61 6.91-4H17c-.55 0-1-.45-1-1l.007-.116c.058-.496.482-.884.993-.884zm-7-5a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4a1 1 0 011-1h4zm-1 3a1 1 0 100 2 1 1 0 000-2zm-2-2a1 1 0 100 2 1 1 0 000-2zm1-8c4.36 0 8.07 2.79 9.44 6.69.22.64-.28 1.31-.96 1.31l-.122-.007a.991.991 0 01-.818-.633C18.45 6.24 15.49 4 12 4 9.05 4 6.47 5.61 5.09 8H7c.55 0 1 .45 1 1l-.007.116A1.004 1.004 0 017 10H3c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1l.116.007C3.612 4.065 4 4.489 4 5v1.01A9.985 9.985 0 0112 2z\" />\n    </svg>\n  );\n}\n\nexport default RerollDiceIcon;\n","import React, { useState } from \"react\";\nimport { Flex, Text, Button, IconButton } from \"theme-ui\";\n\nimport ClearDiceIcon from \"../../icons/ClearDiceIcon\";\nimport RerollDiceIcon from \"../../icons/RerollDiceIcon\";\n\nimport { getDiceRollTotal } from \"../../helpers/dice\";\nimport { DiceRoll } from \"../../types/Dice\";\n\nconst maxDiceRollsShown = 6;\n\ntype DiceResultsProps = {\n  diceRolls: DiceRoll[];\n  onDiceClear: () => void;\n  onDiceReroll: () => void;\n};\n\nfunction DiceResults({\n  diceRolls,\n  onDiceClear,\n  onDiceReroll,\n}: DiceResultsProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  if (diceRolls.length === 0) {\n    return null;\n  }\n\n  let rolls: React.ReactChild[] = [];\n  if (diceRolls.length > 1) {\n    rolls = diceRolls\n      .filter((dice) => dice.roll !== \"unknown\")\n      .map((dice, index) => (\n        <React.Fragment key={index}>\n          <Text variant=\"body2\" as=\"p\" color=\"hsl(210, 50%, 96%)\">\n            {dice.roll}\n          </Text>\n          <Text variant=\"body2\" as=\"p\" color=\"grey\">\n            {index === diceRolls.length - 1 ? \"\" : \"+\"}\n          </Text>\n        </React.Fragment>\n      ));\n  }\n\n  return (\n    <Flex\n      sx={{\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        position: \"absolute\",\n        bottom: \"5%\",\n        left: 0,\n        right: 0,\n        display: \"flex\",\n        color: \"white\",\n        pointerEvents: \"none\",\n      }}\n    >\n      <IconButton\n        ml=\"7%\"\n        title=\"Clear Dice\"\n        aria-label=\"Clear Dice\"\n        onClick={onDiceClear}\n        sx={{ pointerEvents: \"all\" }}\n      >\n        <ClearDiceIcon />\n      </IconButton>\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        <Text\n          variant=\"heading\"\n          as=\"h1\"\n          sx={{ fontSize: 5, userSelect: \"none\" }}\n        >\n          {getDiceRollTotal(diceRolls)}\n        </Text>\n        {rolls.length > maxDiceRollsShown ? (\n          <Button\n            aria-label={\"Show Dice Details\"}\n            title={\"Show Dice Details\"}\n            onClick={() => setIsExpanded(!isExpanded)}\n            variant=\"secondary\"\n            sx={{ display: \"flex\", height: \"24px\", pointerEvents: \"all\" }}\n          >\n            {isExpanded ? rolls : rolls.slice(0, maxDiceRollsShown)}\n            {!isExpanded && (\n              <Text variant=\"body2\" as=\"p\" color=\"hsl(210, 50%, 96%)\">\n                ...\n              </Text>\n            )}\n          </Button>\n        ) : (\n          <Flex sx={{ height: \"15px\" }}>{rolls}</Flex>\n        )}\n      </Flex>\n      <IconButton\n        mr=\"7%\"\n        title=\"Reroll Dice\"\n        aria-label=\"Reroll Dice\"\n        onClick={onDiceReroll}\n        sx={{ pointerEvents: \"all\" }}\n      >\n        <RerollDiceIcon />\n      </IconButton>\n    </Flex>\n  );\n}\n\nexport default DiceResults;\n","export default __webpack_public_path__ + \"static/media/single.2189bc7f.glb\";","export default __webpack_public_path__ + \"static/media/double.c0c4c48c.glb\";","export default __webpack_public_path__ + \"static/media/singleAlbedo.21816ea7.jpg\";","export default __webpack_public_path__ + \"static/media/singleMetalRoughness.7be5048e.jpg\";","export default __webpack_public_path__ + \"static/media/singleNormal.a88cbe7c.jpg\";","export default __webpack_public_path__ + \"static/media/doubleAlbedo.6c6fc3c8.jpg\";","export default __webpack_public_path__ + \"static/media/doubleMetalRoughness.29559b2e.jpg\";","export default __webpack_public_path__ + \"static/media/doubleNormal.9aaec73b.jpg\";","import { SceneLoader } from \"@babylonjs/core/Loading/sceneLoader\";\nimport { PBRMaterial } from \"@babylonjs/core/Materials/PBR/pbrMaterial\";\nimport { PhysicsImpostor } from \"@babylonjs/core/Physics/physicsImpostor\";\nimport { Mesh } from \"@babylonjs/core/Meshes/mesh\";\nimport { AbstractMesh, Scene, ShadowGenerator } from \"@babylonjs/core\";\n\nimport singleMeshSource from \"./single.glb\";\nimport doubleMeshSource from \"./double.glb\";\n\nimport singleAlbedo from \"./singleAlbedo.jpg\";\nimport singleMetalRoughness from \"./singleMetalRoughness.jpg\";\nimport singleNormal from \"./singleNormal.jpg\";\n\nimport doubleAlbedo from \"./doubleAlbedo.jpg\";\nimport doubleMetalRoughness from \"./doubleMetalRoughness.jpg\";\nimport doubleNormal from \"./doubleNormal.jpg\";\n\nimport { importTextureAsync } from \"../../helpers/babylon\";\n\nclass DiceTray {\n  _size;\n\n  get size() {\n    return this._size;\n  }\n\n  set size(newSize) {\n    this._size = newSize;\n    const wallOffsetWidth = this.collisionSize / 2 + this.width / 2 - 0.5;\n    const wallOffsetHeight = this.collisionSize / 2 + this.height / 2 - 0.5;\n    if (this.wallTop) this.wallTop.position.z = -wallOffsetHeight;\n    if (this.wallRight) this.wallRight.position.x = -wallOffsetWidth;\n    if (this.wallBottom) this.wallBottom.position.z = wallOffsetHeight;\n    if (this.wallLeft) this.wallLeft.position.x = wallOffsetWidth;\n    if (this.singleMesh) this.singleMesh.isVisible = newSize === \"single\";\n    if (this.doubleMesh) this.doubleMesh.isVisible = newSize === \"double\";\n  }\n\n  scene;\n  shadowGenerator;\n\n  get width() {\n    return this.size === \"single\" ? 10 : 20;\n  }\n\n  height = 20;\n  collisionSize = 50;\n  wallTop?: Mesh;\n  wallRight?: Mesh;\n  wallBottom?: Mesh;\n  wallLeft?: Mesh;\n  singleMesh?: AbstractMesh;\n  doubleMesh?: AbstractMesh;\n\n  constructor(\n    initialSize: string,\n    scene: Scene,\n    shadowGenerator: ShadowGenerator\n  ) {\n    this._size = initialSize;\n    this.scene = scene;\n    this.shadowGenerator = shadowGenerator;\n  }\n\n  async load() {\n    this.loadWalls();\n    await this.loadMeshes();\n  }\n\n  createCollision(\n    name: string,\n    x: number,\n    y: number,\n    z: number,\n    friction: number\n  ): Mesh {\n    let collision = Mesh.CreateBox(\n      name,\n      this.collisionSize,\n      this.scene,\n      true,\n      Mesh.DOUBLESIDE\n    );\n    collision.position.x = x;\n    collision.position.y = y;\n    collision.position.z = z;\n    collision.physicsImpostor = new PhysicsImpostor(\n      collision,\n      PhysicsImpostor.BoxImpostor,\n      { mass: 0, friction: friction },\n      this.scene\n    );\n    collision.isVisible = false;\n\n    return collision;\n  }\n\n  loadWalls() {\n    const wallOffsetWidth = this.collisionSize / 2 + this.width / 2 - 0.5;\n    const wallOffsetHeight = this.collisionSize / 2 + this.height / 2 - 0.5;\n    this.wallTop = this.createCollision(\"wallTop\", 0, 0, -wallOffsetHeight, 10);\n    this.wallRight = this.createCollision(\n      \"wallRight\",\n      -wallOffsetWidth,\n      0,\n      0,\n      10\n    );\n    this.wallBottom = this.createCollision(\n      \"wallBottom\",\n      0,\n      0,\n      wallOffsetHeight,\n      10\n    );\n    this.wallLeft = this.createCollision(\"wallLeft\", wallOffsetWidth, 0, 0, 10);\n    const diceTrayGroundOffset = 0.32;\n    this.createCollision(\n      \"ground\",\n      0,\n      -this.collisionSize / 2 + diceTrayGroundOffset,\n      0,\n      20\n    );\n    const diceTrayRoofOffset = 10;\n    this.createCollision(\n      \"roof\",\n      0,\n      this.collisionSize / 2 + diceTrayRoofOffset,\n      0,\n      100\n    );\n  }\n\n  async loadMeshes() {\n    let [\n      singleMeshes,\n      doubleMeshes,\n      singleAlbedoTexture,\n      singleNormalTexture,\n      singleMetalRoughnessTexture,\n      doubleAlbedoTexture,\n      doubleNormalTexture,\n      doubleMetalRoughnessTexture,\n    ] = await Promise.all([\n      SceneLoader.ImportMeshAsync(\"\", singleMeshSource, \"\", this.scene),\n      SceneLoader.ImportMeshAsync(\"\", doubleMeshSource, \"\", this.scene),\n      importTextureAsync(singleAlbedo),\n      importTextureAsync(singleNormal),\n      importTextureAsync(singleMetalRoughness),\n      importTextureAsync(doubleAlbedo),\n      importTextureAsync(doubleNormal),\n      importTextureAsync(doubleMetalRoughness),\n    ]);\n\n    this.singleMesh = singleMeshes.meshes[1];\n    this.singleMesh.id = \"dice_tray_single\";\n    this.singleMesh.name = \"dice_tray\";\n    let singleMaterial = new PBRMaterial(\"dice_tray_mat_single\", this.scene);\n    singleMaterial.albedoTexture = singleAlbedoTexture;\n    singleMaterial.bumpTexture = singleNormalTexture;\n    singleMaterial.metallicTexture = singleMetalRoughnessTexture;\n    singleMaterial.useRoughnessFromMetallicTextureAlpha = false;\n    singleMaterial.useRoughnessFromMetallicTextureGreen = true;\n    singleMaterial.useMetallnessFromMetallicTextureBlue = true;\n    this.singleMesh.material = singleMaterial;\n\n    this.singleMesh.receiveShadows = true;\n    this.shadowGenerator.addShadowCaster(this.singleMesh);\n    this.singleMesh.isVisible = this.size === \"single\";\n\n    this.doubleMesh = doubleMeshes.meshes[1];\n    this.doubleMesh.id = \"dice_tray_double\";\n    this.doubleMesh.name = \"dice_tray\";\n    let doubleMaterial = new PBRMaterial(\"dice_tray_mat_double\", this.scene);\n    doubleMaterial.albedoTexture = doubleAlbedoTexture;\n    doubleMaterial.bumpTexture = doubleNormalTexture;\n    doubleMaterial.metallicTexture = doubleMetalRoughnessTexture;\n    doubleMaterial.useRoughnessFromMetallicTextureAlpha = false;\n    doubleMaterial.useRoughnessFromMetallicTextureGreen = true;\n    doubleMaterial.useMetallnessFromMetallicTextureBlue = true;\n    this.doubleMesh.material = doubleMaterial;\n\n    this.doubleMesh.receiveShadows = true;\n    this.shadowGenerator.addShadowCaster(this.doubleMesh);\n    this.doubleMesh.isVisible = this.size === \"double\";\n  }\n}\n\nexport default DiceTray;\n","import { useRef, useCallback, useEffect, useState } from \"react\";\nimport { Vector3 } from \"@babylonjs/core/Maths/math\";\nimport { DirectionalLight } from \"@babylonjs/core/Lights/directionalLight\";\nimport { ShadowGenerator } from \"@babylonjs/core/Lights/Shadows/shadowGenerator\";\nimport { CubeTexture } from \"@babylonjs/core/Materials/Textures/cubeTexture\";\nimport { Scene } from \"@babylonjs/core\";\nimport { Box } from \"theme-ui\";\n\n// @ts-ignore\nimport environment from \"../../dice/environment.dds\";\n\nimport DiceInteraction from \"./DiceInteraction\";\nimport Dice from \"../../dice/Dice\";\nimport LoadingOverlay from \"../LoadingOverlay\";\nimport DiceButtons from \"./DiceButtons\";\nimport DiceResults from \"./DiceResults\";\n\nimport DiceTray from \"../../dice/diceTray/DiceTray\";\n\nimport { useDiceLoading } from \"../../contexts/DiceLoadingContext\";\n\nimport { getDiceRoll } from \"../../helpers/dice\";\n\nimport useSetting from \"../../hooks/useSetting\";\n\nimport { DefaultDice, DiceMesh, DiceRoll, DiceType } from \"../../types/Dice\";\nimport {\n  DiceRollsChangeEventHandler,\n  DiceShareChangeEventHandler,\n} from \"../../types/Events\";\n\ntype DiceTrayOverlayProps = {\n  isOpen: boolean;\n  shareDice: boolean;\n  onShareDiceChange: DiceShareChangeEventHandler;\n  diceRolls: DiceRoll[];\n  onDiceRollsChange: DiceRollsChangeEventHandler;\n};\n\nfunction DiceTrayOverlay({\n  isOpen,\n  shareDice,\n  onShareDiceChange,\n  diceRolls,\n  onDiceRollsChange,\n}: DiceTrayOverlayProps) {\n  const sceneRef = useRef<Scene>();\n  const shadowGeneratorRef = useRef<ShadowGenerator>();\n  const diceRefs = useRef<DiceMesh[]>([]);\n  const sceneVisibleRef = useRef(false);\n  const sceneInteractionRef = useRef(false);\n  // Add to the counter to ingore sleep values\n  const sceneKeepAwakeRef = useRef(0);\n  const diceTrayRef = useRef<DiceTray>();\n\n  const [diceTraySize, setDiceTraySize] =\n    useState<\"single\" | \"double\">(\"single\");\n  const { assetLoadStart, assetLoadFinish, isLoading } = useDiceLoading();\n  const [fullScreen] = useSetting(\"map.fullScreen\");\n\n  function handleAssetLoadStart() {\n    assetLoadStart();\n  }\n\n  function handleAssetLoadFinish() {\n    assetLoadFinish();\n    forceRender();\n  }\n\n  // Forces rendering for 1 second\n  function forceRender(): () => void {\n    // Force rerender\n    sceneKeepAwakeRef.current++;\n    let triggered = false;\n    let timeout = setTimeout(() => {\n      sceneKeepAwakeRef.current--;\n      triggered = true;\n    }, 1000);\n\n    return () => {\n      clearTimeout(timeout);\n      if (!triggered) {\n        sceneKeepAwakeRef.current--;\n      }\n    };\n  }\n\n  // Force render when changing dice tray size\n  useEffect(() => {\n    const diceTray = diceTrayRef.current;\n    let cleanup;\n    if (diceTray) {\n      diceTray.size = diceTraySize;\n      cleanup = forceRender();\n    }\n    return cleanup;\n  }, [diceTraySize]);\n\n  useEffect(() => {\n    let cleanup;\n    if (isOpen) {\n      sceneVisibleRef.current = true;\n      cleanup = forceRender();\n    } else {\n      sceneVisibleRef.current = false;\n    }\n\n    return cleanup;\n  }, [isOpen]);\n\n  const handleSceneMount = useCallback(async ({ scene, engine }) => {\n    sceneRef.current = scene;\n    await initializeScene(scene);\n    engine.runRenderLoop(() => update(scene));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  async function initializeScene(scene: Scene) {\n    handleAssetLoadStart();\n    let light = new DirectionalLight(\n      \"DirectionalLight\",\n      new Vector3(-0.5, -1, -0.5),\n      scene\n    );\n    light.position = new Vector3(5, 10, 5);\n    light.shadowMinZ = 1;\n    light.shadowMaxZ = 50;\n    let shadowGenerator = new ShadowGenerator(1024, light);\n    shadowGenerator.useCloseExponentialShadowMap = true;\n    shadowGenerator.darkness = 0.7;\n    shadowGeneratorRef.current = shadowGenerator;\n\n    scene.environmentTexture = CubeTexture.CreateFromPrefilteredData(\n      environment,\n      scene\n    );\n    scene.environmentIntensity = 1.0;\n\n    let diceTray = new DiceTray(\"single\", scene, shadowGenerator);\n    await diceTray.load();\n    diceTrayRef.current = diceTray;\n    handleAssetLoadFinish();\n  }\n\n  function update(scene: Scene) {\n    function getDiceSpeed(dice: DiceMesh) {\n      const diceSpeed =\n        dice.instance.physicsImpostor?.getLinearVelocity()?.length() || 0;\n      // If the dice is a d100 check the d10 as well\n      if (dice.d10Instance) {\n        const d10Speed =\n          dice.d10Instance.physicsImpostor?.getLinearVelocity()?.length() || 0;\n        return Math.max(diceSpeed, d10Speed);\n      } else {\n        return diceSpeed;\n      }\n    }\n\n    const die = diceRefs.current;\n    const sceneVisible = sceneVisibleRef.current;\n    if (!sceneVisible) {\n      return;\n    }\n    const forceSceneRender = sceneKeepAwakeRef.current > 0;\n    const sceneInteraction = sceneInteractionRef.current;\n    const diceAwake = die.map((dice) => dice.asleep).includes(false);\n    // Return early if scene doesn't need to be re-rendered\n    if (!forceSceneRender && !sceneInteraction && !diceAwake) {\n      return;\n    }\n\n    for (let i = 0; i < die.length; i++) {\n      const dice = die[i];\n      const speed = getDiceSpeed(dice);\n      // If the speed has been below 0.01 for 1s set dice to sleep\n      if (speed < 0.01 && !dice.sleepTimeout) {\n        dice.sleepTimeout = setTimeout(() => {\n          dice.asleep = true;\n        }, 1000);\n      } else if (speed > 0.5 && (dice.asleep || dice.sleepTimeout)) {\n        dice.asleep = false;\n        dice.sleepTimeout && clearTimeout(dice.sleepTimeout);\n        dice.sleepTimeout = undefined;\n      }\n    }\n\n    if (scene) {\n      scene.render();\n    }\n  }\n\n  function handleDiceAdd(style: typeof Dice, type: DiceType) {\n    const scene = sceneRef.current;\n    const shadowGenerator = shadowGeneratorRef.current;\n    if (scene && shadowGenerator) {\n      const instance = style.createInstance(type, scene);\n      shadowGenerator.addShadowCaster(instance);\n      style.roll(instance);\n      let dice: DiceMesh = { type, instance, asleep: false };\n      // If we have a d100 add a d10 as well\n      if (type === \"d100\") {\n        const d10Instance = style.createInstance(\"d10\", scene);\n        shadowGenerator.addShadowCaster(d10Instance);\n        Dice.roll(d10Instance);\n        dice.d10Instance = d10Instance;\n      }\n      diceRefs.current.push(dice);\n    }\n  }\n\n  function handleDiceClear() {\n    const die = diceRefs.current;\n    for (let dice of die) {\n      dice.instance.dispose();\n      if (dice.d10Instance) {\n        dice.d10Instance.dispose();\n      }\n    }\n    diceRefs.current = [];\n    forceRender();\n  }\n\n  function handleDiceReroll() {\n    const die = diceRefs.current;\n    for (let dice of die) {\n      Dice.roll(dice.instance);\n      if (dice.d10Instance) {\n        Dice.roll(dice.d10Instance);\n      }\n      dice.asleep = false;\n    }\n  }\n\n  async function handleDiceLoad(dice: DefaultDice) {\n    handleAssetLoadStart();\n    const scene = sceneRef.current;\n    if (scene) {\n      await dice.class.load(scene);\n    }\n    handleAssetLoadFinish();\n  }\n\n  const [traySize, setTraySize] = useState({\n    width: 0,\n    height: 0,\n  });\n\n  useEffect(() => {\n    let renderTimeout: NodeJS.Timeout;\n    let renderCleanup: () => void;\n    function handleResize() {\n      const map = document.querySelector(\".map\");\n      if (!map) {\n        return;\n      }\n      const mapRect = map.getBoundingClientRect();\n\n      const availableWidth = mapRect.width - 108; // Subtract padding\n      const availableHeight = mapRect.height - 80; // Subtract paddding and open icon\n\n      let height = Math.min(availableHeight, 1000);\n      let width = diceTraySize === \"single\" ? height / 2 : height;\n\n      if (width > availableWidth) {\n        width = availableWidth;\n        height = diceTraySize === \"single\" ? width * 2 : width;\n      }\n\n      // Debounce a timeout to force re-rendering on resize\n      renderTimeout = setTimeout(() => {\n        renderCleanup = forceRender();\n      }, 100);\n\n      setTraySize({ width, height });\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n\n    handleResize();\n\n    return () => {\n      window.removeEventListener(\"resize\", handleResize);\n      if (renderTimeout) {\n        clearTimeout(renderTimeout);\n      }\n      if (renderCleanup) {\n        renderCleanup();\n      }\n    };\n  }, [diceTraySize, fullScreen, isOpen]);\n\n  // Update dice rolls\n  useEffect(() => {\n    function updateDiceRolls() {\n      const die = diceRefs.current;\n      const sceneVisible = sceneVisibleRef.current;\n      if (!sceneVisible) {\n        return;\n      }\n      const diceAwake = die.map((dice) => dice.asleep).includes(false);\n      if (!diceAwake) {\n        return;\n      }\n\n      let newRolls: DiceRoll[] = [];\n      for (let i = 0; i < die.length; i++) {\n        const dice = die[i];\n        let roll = getDiceRoll(dice);\n        newRolls[i] = roll;\n      }\n      onDiceRollsChange(newRolls);\n    }\n\n    const updateInterval = setInterval(updateDiceRolls, 100);\n    return () => {\n      clearInterval(updateInterval);\n    };\n  }, [diceRefs, sceneVisibleRef, onDiceRollsChange]);\n\n  return (\n    <Box\n      sx={{\n        width: `${traySize.width}px`,\n        height: `${traySize.height}px`,\n        borderRadius: \"4px\",\n        display: isOpen ? \"block\" : \"none\",\n        position: \"relative\",\n        overflow: \"visible\",\n      }}\n    >\n      <Box\n        sx={{\n          transform: \"translateX(50px)\",\n          width: \"100%\",\n          height: \"100%\",\n          pointerEvents: \"all\",\n        }}\n      >\n        <DiceInteraction\n          onSceneMount={handleSceneMount}\n          onPointerDown={() => {\n            sceneInteractionRef.current = true;\n          }}\n          onPointerUp={() => {\n            sceneInteractionRef.current = false;\n          }}\n        />\n        <DiceResults\n          diceRolls={diceRolls}\n          onDiceClear={() => {\n            handleDiceClear();\n            onDiceRollsChange([]);\n          }}\n          onDiceReroll={handleDiceReroll}\n        />\n      </Box>\n      <DiceButtons\n        diceRolls={diceRolls}\n        onDiceAdd={(style, type) => {\n          handleDiceAdd(style, type);\n          onDiceRollsChange([...diceRolls, { type, roll: \"unknown\" }]);\n        }}\n        onDiceLoad={handleDiceLoad}\n        onDiceTraySizeChange={setDiceTraySize}\n        diceTraySize={diceTraySize}\n        shareDice={shareDice}\n        onShareDiceChange={onShareDiceChange}\n        loading={isLoading}\n      />\n      {isLoading && (\n        <Box\n          sx={{\n            width: \"100%\",\n            height: \"100%\",\n            position: \"absolute\",\n            top: 0,\n            left: \"50px\",\n          }}\n        >\n          <LoadingOverlay />\n        </Box>\n      )}\n    </Box>\n  );\n}\n\nexport default DiceTrayOverlay;\n"],"sourceRoot":""}
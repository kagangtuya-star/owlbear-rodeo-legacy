(this["webpackJsonpowlbear-rodeo"]=this["webpackJsonpowlbear-rodeo"]||[]).push([[8],{1052:function(e,t,n){"use strict";n.r(t);var a=n(9),i=n(10),r=n(4),s=n.n(r),c=n(12),o=n(3),l=n(0),u=n(1),h=n.n(u),d=n(199),p=n(802),f=n(882),b=n(949),m=n(72),j=n.p+"static/media/environment.6140ab69.dds",v=n(691),g=n(696),x=n(1042),O=n(952),y=n(1037),w=n.n(y),k=(n(1045),n(1043),n(1046),n(1039),n(1044),n(1040),n(1041),n(78));var M=function(e){Object(u.useEffect)(function(){function t(e){e.preventDefault()}var n=e.current;return n&&n.addEventListener("touchstart",t,!1),function(){n&&n.removeEventListener("touchstart",t)}},[e])},D=n(182),S=n(32);function C(e){var t=e.onSceneMount,n=e.onPointerDown,a=e.onPointerUp,r=Object(u.useState)(),s=Object(o.a)(r,2),c=s[0],h=s[1],p=Object(u.useRef)(),f=Object(u.useRef)(),b=Object(u.useRef)(null),m=Object(u.useRef)(null);Object(u.useEffect)(function(){var e=b.current;if(e)try{var n=new v.a(e,!S.e,{preserveDrawingBuffer:!0,stencil:!0,xrCompatible:!1}),a=new g.a(n);a.clearColor=new d.b(0,0,0,0),w()().then(function(){a.enablePhysics(new d.d(0,-98,0),new x.a(!1))});var i=new O.a("camera",new d.d(0,33.5,0),a);i.fov=.65,i.setTarget(d.d.Zero()),t&&t({scene:a,engine:n,canvas:e}),f.current=n,p.current=a,n.runRenderLoop(function(){var e=p.current,t=j.current;if(t&&e){var n=e.createPickingRay(e.pointerX,e.pointerY,d.c.Identity(),i),a=t.getAbsolutePosition(),r=n.origin.scale(i.globalPosition.y);r.y=a.y;var s=r.subtract(a);t.setAbsolutePosition(r);var c=s.scale(1e3/e.deltaTime);y.current=y.current.slice(Math.max(y.current.length-C,0)),y.current.push(c)}})}catch(c){c instanceof Error&&h(c)}},[t]);var j=Object(u.useRef)(null),y=Object(u.useRef)([]),C=4,R=Object(u.useRef)(0);function I(){var e=j.current,t=y.current,n=p.current;if(e&&n){var r,s,c,o,l=d.d.Zero(),u=Object(i.a)(t);try{for(u.s();!(o=u.n()).done;){var h=o.value;l.addInPlace(h)}}catch(f){u.e(f)}finally{u.f()}t.length>0&&l.scaleInPlace(1/t.length),null===(r=e.physicsImpostor)||void 0===r||r.setMass(R.current),null===(s=e.physicsImpostor)||void 0===s||s.forceUpdate(),null===(c=e.physicsImpostor)||void 0===c||c.applyImpulse(l.scale(2*e.physicsImpostor.mass),e.physicsImpostor.getObjectCenter())}j.current=null,y.current=[],R.current=0,a()}return M(m),Object(l.jsxs)("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"hidden"},ref:m,children:[Object(l.jsx)(k.a,{handleWidth:!0,handleHeight:!0,onResize:function(e,t){if(e&&t){var n=f.current;n&&b.current&&(n.resize(),b.current.width=e,b.current.height=t)}},targetRef:m,children:Object(l.jsx)("canvas",{onPointerDown:function(){var e=p.current;if(e){var t,a,i,r,s=e.pick(e.pointerX,e.pointerY);if(s&&s.hit&&s.pickedMesh&&"dice_tray"!==s.pickedMesh.name)null===(t=s.pickedMesh.physicsImpostor)||void 0===t||t.setLinearVelocity(d.d.Zero()),null===(a=s.pickedMesh.physicsImpostor)||void 0===a||a.setAngularVelocity(d.d.Zero()),R.current=(null===(i=s.pickedMesh.physicsImpostor)||void 0===i?void 0:i.mass)||0,null===(r=s.pickedMesh.physicsImpostor)||void 0===r||r.setMass(0),j.current=s.pickedMesh}n()},onPointerUp:I,onPointerCancel:I,onPointerLeave:I,ref:b,style:{outline:"none"}})}),Object(l.jsx)(D.a,{error:c,onRequestClose:function(){return h(void 0)}})]})}C.defaultProps={onPointerDown:function(){},onPointerUp:function(){}};var R=C,I=n(6),P=n(8),T=n(881),z=n(672),E=n(877),L=n.p+"static/media/d4.5f4a6b12.glb",_=n.p+"static/media/d6.01277ab0.glb",A=n.p+"static/media/d8.aef4e07e.glb",B=n.p+"static/media/d10.75162417.glb",V=n.p+"static/media/d12.0acb683a.glb",F=n.p+"static/media/d20.8be40bdc.glb",H=n.p+"static/media/d100.f247533e.glb",G=n(670);function q(e){return U.apply(this,arguments)}function U(){return(U=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var a=new G.a(t,null,void 0,!1,void 0,function(){e(a)},function(){n("Unable to load texture")})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e){return!!e.d4&&!!e.d6&&!!e.d8&&!!e.d10&&!!e.d12&&!!e.d20&&!!e.d100}var Z=function(){function e(){Object(I.a)(this,e)}return Object(P.a)(e,null,[{key:"loadMeshes",value:function(){var e=Object(c.a)(s.a.mark(function e(t,n,a){var i,r,o=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={},r=function(){var e=Object(c.a)(s.a.mark(function e(r,c){var l,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=a?a[r]:c,e.next=3,o.loadMesh(l,t,n);case 3:u=e.sent,i[r]=u;case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),e.next=4,Promise.all([r("d4",L),r("d6",_),r("d8",A),r("d10",B),r("d12",V),r("d20",F),r("d100",H)]);case 4:if(!W(i)){e.next=8;break}return e.abrupt("return",i);case 8:throw new Error("Dice meshes failed to load, missing mesh source");case 9:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"loadMesh",value:function(){var e=Object(c.a)(s.a.mark(function e(t,n,a){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.ImportMeshAsync("",t,"",a);case 2:return(i=e.sent.meshes[1]).setParent(null),i.material=n,i.receiveShadows=!0,i.isVisible=!1,e.abrupt("return",i);case 8:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"loadMaterial",value:function(){var e=Object(c.a)(s.a.mark(function e(t,n,a){var i,r,c,l,u,h;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new z.a(t,a),e.next=3,Promise.all([q(n.albedo),q(n.normal),q(n.metalRoughness)]);case 3:return r=e.sent,c=Object(o.a)(r,3),l=c[0],u=c[1],h=c[2],i.albedoTexture=l,i.bumpTexture=u,i.metallicTexture=h,i.useRoughnessFromMetallicTextureAlpha=!1,i.useRoughnessFromMetallicTextureGreen=!0,i.useMetallnessFromMetallicTextureBlue=!0,e.abrupt("return",i);case 15:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"createInstanceFromMesh",value:function(e,t,n,a){var r=e.createInstance(t);r.position=e.position;var s,c=Object(i.a)(e.getChildTransformNodes());try{for(c.s();!(s=c.n()).done;){var o=s.value,l=o.clone(o.name,r);if(!l)throw new Error("Unable to clone dice locator");l.setAbsolutePosition(o.getAbsolutePosition()),l.name=o.name,r.addChild(l)}}catch(u){c.e(u)}finally{c.f()}return r.physicsImpostor=new E.a(r,E.a.ConvexHullImpostor,n,a),r}},{key:"getDicePhysicalProperties",value:function(e){switch(e){case"d4":return{mass:4,friction:4};case"d6":return{mass:6,friction:4};case"d8":return{mass:6.2,friction:4};case"d10":case"d100":return{mass:7,friction:4};case"d12":return{mass:8,friction:4};default:return{mass:10,friction:4}}}},{key:"roll",value:function(e){var t,n,a;null===(t=e.physicsImpostor)||void 0===t||t.setLinearVelocity(d.d.Zero()),null===(n=e.physicsImpostor)||void 0===n||n.setAngularVelocity(d.d.Zero());var i=e.getScene(),r=i.getMeshByID("dice_tray_single"),s=i.getMeshByID("dice_tray_double"),c=(null===r||void 0===r?void 0:r.isVisible)?r:s;if(!c)throw new Error("No dice tray to roll in");var o=null===c||void 0===c?void 0:c.getBoundingInfo().boundingBox,l=new d.d(o.center.x+(2*Math.random()-1),8,o.center.z+(2*Math.random()-1));e.position=l,e.addRotation(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2);var u=new d.d(Object(S.g)(o.minimumWorld.x,o.maximumWorld.x,Math.random()),5,Object(S.g)(o.minimumWorld.z,o.maximumWorld.z,Math.random())),h=new d.d(0,0,0).subtract(u).normalizeToNew().scale(Object(S.g)(600,800,Math.random()));null===(a=e.physicsImpostor)||void 0===a||a.applyImpulse(h,e.physicsImpostor.getObjectCenter())}},{key:"createInstanceMesh",value:function(e,t,n){return this.instanceCount++,this.createInstanceFromMesh(e,"dice_instance_".concat(this.instanceCount),t,n)}},{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Unable to load ".concat(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){throw new Error("No instance available for ".concat(e," in ").concat(t))}}]),e}();Z.instanceCount=0;var N=Z,X=n(59),Y=n(2),J=n(69),K=n(321),Q=n(322),$=n(323),ee=n(324),te=n(325),ne=n(326),ae=n(327);var ie=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),Object(l.jsx)("path",{d:"M20.08,11.42l-4.04-5.65C15.7,5.29,15.15,5,14.56,5h0c-1.49,0-2.35,1.68-1.49,2.89L16,12l-2.93,4.11 c-0.87,1.21,0,2.89,1.49,2.89h0c0.59,0,1.15-0.29,1.49-0.77l4.04-5.65C20.33,12.23,20.33,11.77,20.08,11.42z"}),Object(l.jsx)("path",{d:"M13.08,11.42L9.05,5.77C8.7,5.29,8.15,5,7.56,5h0C6.07,5,5.2,6.68,6.07,7.89L9,12l-2.93,4.11C5.2,17.32,6.07,19,7.56,19h0 c0.59,0,1.15-0.29,1.49-0.77l4.04-5.65C13.33,12.23,13.33,11.77,13.08,11.42z"})]})};var re=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M24 24H0V0h24z",fill:"none"}),Object(l.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})]})};var se=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M24 24H0V0h24z",fill:"none"}),Object(l.jsx)("path",{d:"M11,8.17L6.49,3.66C8.07,2.61,9.96,2,12,2c5.52,0,10,4.48,10,10c0,2.04-0.61,3.93-1.66,5.51l-1.46-1.46 C19.59,14.87,20,13.48,20,12c0-3.35-2.07-6.22-5-7.41V5c0,1.1-0.9,2-2,2h-2V8.17z M20.49,21.9L20.49,21.9 c-0.39,0.39-1.02,0.39-1.41,0l-1.56-1.56c-2.07,1.37-4.68,2-7.45,1.48c-3.95-0.75-7.13-3.92-7.88-7.88 c-0.52-2.77,0.1-5.38,1.48-7.45L2.1,4.93c-0.39-0.39-0.39-1.02,0-1.41l0,0c0.39-0.39,1.02-0.39,1.41,0l16.97,16.97 C20.88,20.88,20.88,21.51,20.49,21.9z M11,18c-1.1,0-2-0.9-2-2v-1l-4.79-4.79C4.08,10.79,4,11.38,4,12c0,4.08,3.05,7.44,7,7.93V18z"})]})};var ce=function(e){var t=e.children;return Object(l.jsx)(m.b,{sx:{position:"absolute",top:"50%",right:"90%",transform:"translateY(-50%)",height:"14px",display:"flex",alignItems:"center"},children:Object(l.jsx)(m.q,{variant:"caption",as:"p",color:"text",sx:{fontSize:"10px",fontWeight:"bold"},children:t})})};var oe=function(e){var t=e.title,n=e.children,a=e.count,i=e.onClick,r=e.disabled;return Object(l.jsxs)(m.i,{title:t,"aria-label":t,onClick:i,sx:{position:"relative"},disabled:r,children:[n,a&&Object(l.jsx)(ce,{children:a})]})};var le=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(l.jsx)("path",{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"})]})},ue=n(36),he=n(111);var de=function(e){var t=e.dice,n=e.isSelected,a=e.onDiceSelect,i=e.onDone;return Object(l.jsx)("div",{style:{cursor:"pointer"},children:Object(l.jsx)(he.a,{title:t.name,isSelected:n,onSelect:function(){return a(t)},onDoubleClick:function(){return i(t)},children:Object(l.jsx)(m.j,{src:t.preview})})})},pe=n(56);var fe=function(e){var t=e.dice,n=e.onDiceSelect,a=e.selectedDice,i=e.onDone,r=Object(pe.a)();return Object(l.jsx)(J.a,{style:{height:r.tileContainerHeight},children:Object(l.jsx)(m.h,{p:2,pb:4,bg:"muted",sx:{borderRadius:"4px",minHeight:"large"===r.screenSize?"600px":"400px"},gap:2,columns:"repeat(".concat(r.tileGridColumns,", 1fr)"),children:t.map(function(e){return Object(l.jsx)(de,{dice:e,isSelected:a&&e.key===a.key,onDiceSelect:n,onDone:i},e.key)})})})},be=n(79),me=n.n(be),je=n(29),ve=n(27),ge=n(13),xe=n(14),Oe=n.p+"static/media/albedo.0940cfaf.jpg",ye=n.p+"static/media/metalRoughness.8c8e9d34.jpg",we=n.p+"static/media/normal.97ba4b6c.jpg",ke=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("galaxy_pbr",{albedo:Oe,metalRoughness:ye,normal:we},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return Object(je.a)(Object(ve.a)(n),"createInstanceMesh",this).call(this,this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);ke.meshes=void 0,ke.material=void 0;var Me=ke,De=n.p+"static/media/albedo.b76f6b3b.jpg",Se=n.p+"static/media/metalRoughness.d42c24eb.jpg",Ce=n.p+"static/media/normal.19a9c078.jpg",Re=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"getDicePhysicalProperties",value:function(e){var t=Object(je.a)(Object(ve.a)(n),"getDicePhysicalProperties",this).call(this,e);return{mass:2*t.mass,friction:t.friction}}},{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("iron_pbr",{albedo:De,metalRoughness:Se,normal:Ce},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return N.createInstanceMesh(this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);Re.meshes=void 0,Re.material=void 0;var Ie=Re,Pe=n.p+"static/media/albedo.5479454b.jpg",Te=n.p+"static/media/metalRoughness.316a71be.jpg",ze=n.p+"static/media/normal.0dc207c6.jpg",Ee=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("neubula_pbr",{albedo:Pe,metalRoughness:Te,normal:ze},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return N.createInstanceMesh(this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);Ee.meshes=void 0,Ee.material=void 0;var Le=Ee,_e=n.p+"static/media/albedo.83b2adf8.jpg",Ae=n.p+"static/media/metalRoughness.a6c7a8ac.jpg",Be=n.p+"static/media/normal.75d74d42.jpg",Ve=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("sunrise_pbr",{albedo:_e,metalRoughness:Ae,normal:Be},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return Object(je.a)(Object(ve.a)(n),"createInstanceMesh",this).call(this,this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);Ve.meshes=void 0,Ve.material=void 0;var Fe=Ve,He=n.p+"static/media/albedo.989c2eb0.jpg",Ge=n.p+"static/media/metalRoughness.c7c91f0a.jpg",qe=n.p+"static/media/normal.55affda5.jpg",Ue=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("sunset_pbr",{albedo:He,metalRoughness:Ge,normal:qe},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return Object(je.a)(Object(ve.a)(n),"createInstanceMesh",this).call(this,this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);Ue.meshes=void 0,Ue.material=void 0;var We=Ue,Ze=n.p+"static/media/albedo.f961edb0.jpg",Ne=n.p+"static/media/metalRoughness.6fe2dde8.jpg",Xe=n.p+"static/media/normal.8143036b.jpg",Ye={d4:n.p+"static/media/d4.52896fe7.glb",d6:n.p+"static/media/d6.9192a151.glb",d8:n.p+"static/media/d8.b80ce954.glb",d10:n.p+"static/media/d10.8948845e.glb",d12:n.p+"static/media/d12.8dc2ee51.glb",d20:n.p+"static/media/d20.45aa4a95.glb",d100:n.p+"static/media/d100.e871721f.glb"},Je=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"getDicePhysicalProperties",value:function(e){var t=Object(je.a)(Object(ve.a)(n),"getDicePhysicalProperties",this).call(this,e);return{mass:1.4*t.mass,friction:t.friction}}},{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("walnut_pbr",{albedo:Ze,metalRoughness:Ne,normal:Xe},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t,Ye);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return Object(je.a)(Object(ve.a)(n),"createInstanceMesh",this).call(this,this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);Je.meshes=void 0,Je.material=void 0;var Ke=Je,Qe=n.p+"static/media/albedo.e36ca17f.jpg",$e=n.p+"static/media/mask.1f48bf2d.png",et=n.p+"static/media/normal.5e14e52f.jpg",tt=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"getDicePhysicalProperties",value:function(e){var t=Object(je.a)(Object(ve.a)(n),"getDicePhysicalProperties",this).call(this,e);return{mass:1.5*t.mass,friction:t.friction}}},{key:"loadGlassMaterial",value:function(){var e=Object(c.a)(s.a.mark(function e(t,n,a){var i,r,c,l,u,h;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new z.a(t,a),e.next=3,Promise.all([q(n.albedo),q(n.normal),q(n.mask)]);case 3:return r=e.sent,c=Object(o.a)(r,3),l=c[0],u=c[1],h=c[2],i.albedoTexture=l,i.bumpTexture=u,i.roughness=.25,i.metallic=0,i.subSurface.isRefractionEnabled=!0,i.subSurface.indexOfRefraction=2,i.subSurface.refractionIntensity=1,i.subSurface.isTranslucencyEnabled=!0,i.subSurface.translucencyIntensity=.5,i.subSurface.minimumThickness=10,i.subSurface.maximumThickness=10,i.subSurface.tintColor=new d.a(43/255,1,115/255),i.subSurface.thicknessTexture=h,i.subSurface.useMaskFromThicknessTexture=!0,e.abrupt("return",i);case 23:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadGlassMaterial("glass_pbr",{albedo:Qe,mask:$e,normal:et},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return N.createInstanceMesh(this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);tt.meshes=void 0,tt.material=void 0;var nt=tt,at=n.p+"static/media/albedo.a5508be6.jpg",it=n.p+"static/media/metalRoughness.f8e641dc.jpg",rt=n.p+"static/media/normal.4f52152c.jpg",st=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"getDicePhysicalProperties",value:function(e){var t=Object(je.a)(Object(ve.a)(n),"getDicePhysicalProperties",this).call(this,e);return{mass:1.5*t.mass,friction:t.friction}}},{key:"loadMaterial",value:function(){var e=Object(c.a)(s.a.mark(function e(t,n,a){var i,r,c,l,u,h;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new z.a(t,a),e.next=3,Promise.all([q(n.albedo),q(n.normal),q(n.metalRoughness)]);case 3:return r=e.sent,c=Object(o.a)(r,3),l=c[0],u=c[1],h=c[2],i.albedoTexture=l,i.bumpTexture=u,i.metallicTexture=h,i.useRoughnessFromMetallicTextureAlpha=!1,i.useRoughnessFromMetallicTextureGreen=!0,i.useMetallnessFromMetallicTextureBlue=!0,i.subSurface.isTranslucencyEnabled=!0,i.subSurface.translucencyIntensity=.2,i.subSurface.minimumThickness=5,i.subSurface.maximumThickness=10,i.subSurface.tintColor=new d.a(190/255,0,220/255),e.abrupt("return",i);case 20:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.material){e.next=4;break}return e.next=3,this.loadMaterial("gemstone_pbr",{albedo:at,metalRoughness:it,normal:rt},t);case 3:this.material=e.sent;case 4:if(this.meshes){e.next=8;break}return e.next=7,this.loadMeshes(this.material,t);case 7:this.meshes=e.sent;case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createInstance",value:function(e,t){if(!this.material||!this.meshes)throw Error("Dice not loaded, call load before creating an instance");return N.createInstanceMesh(this.meshes[e],this.getDicePhysicalProperties(e),t)}}]),n}(N);st.meshes=void 0,st.material=void 0;var ct=st,ot=n.p+"static/media/preview.90e03e4d.png",lt=n.p+"static/media/preview.426a2aa1.png",ut=n.p+"static/media/preview.797f7773.png",ht=n.p+"static/media/preview.3f77b9e6.png",dt=n.p+"static/media/preview.9a76b828.png",pt=n.p+"static/media/preview.a548021a.png",ft=n.p+"static/media/preview.7d921376.png",bt=n.p+"static/media/preview.eb6266ff.png",mt={galaxy:Me,nebula:Le,sunrise:Fe,sunset:We,iron:Ie,walnut:Ke,glass:nt,gemstone:ct},jt={galaxy:ot,nebula:ut,sunrise:ht,sunset:dt,iron:lt,walnut:pt,glass:ft,gemstone:bt},vt=Object.keys(mt).map(function(e){return{key:e,name:me.a.capital(e),class:mt[e],preview:jt[e]}});var gt=function(e){var t=e.isOpen,n=e.onRequestClose,a=e.onDone,i=e.defaultDice,r=Object(u.useState)(i),s=Object(o.a)(r,2),c=s[0],h=s[1],d=Object(pe.a)();return Object(l.jsx)(ue.a,{isOpen:t,onRequestClose:n,style:{content:{maxWidth:d.modalSize,width:"calc(100% - 16px)"}},children:Object(l.jsxs)(m.g,{sx:{flexDirection:"column"},children:[Object(l.jsx)(m.l,{pt:2,pb:1,children:"Select a dice style"}),Object(l.jsx)(fe,{dice:vt,onDiceSelect:h,selectedDice:c,onDone:a}),Object(l.jsx)(m.c,{my:2,variant:"primary",onClick:function(){return a(c)},children:"Select"})]})})};function xt(e){var t=e.onDiceChange,n=e.currentDice,a=e.disabled,i=Object(u.useState)(!1),r=Object(o.a)(i,2),s=r[0],c=r[1];function h(){c(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(m.i,{"aria-label":"Select Dice Style",title:"Select Dice Style",onClick:function(){c(!0)},disabled:a,children:Object(l.jsx)(le,{})}),Object(l.jsx)(gt,{isOpen:s,onRequestClose:h,defaultDice:n,onDone:function(e){t(e),h()}})]})}xt.defaultProps={disabled:!1};var Ot=xt,yt=n(48),wt=n(35);var kt=function(e){var t=e.diceRolls,n=e.onDiceAdd,a=e.onDiceLoad,r=e.diceTraySize,h=e.onDiceTraySizeChange,d=e.shareDice,p=e.onShareDiceChange,f=e.loading,b=Object(wt.a)("dice.style"),j=Object(o.a)(b,2),v=j[0],g=j[1],x=Object(u.useState)(vt.find(function(e){return e.key===v})||vt[0]),O=Object(o.a)(x,2),y=O[0],w=O[1];Object(u.useEffect)(function(){var e=vt.find(function(e){return e.key===v});e&&(a(e),w(e))},[]);var k,M={},D=Object(i.a)(t);try{for(D.s();!(k=D.n()).done;){var S=k.value;S.type in M?M[S.type]+=1:M[S.type]=1}}catch(I){D.e(I)}finally{D.f()}function C(){return(C=Object(c.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t);case 2:w(t),g(t.key);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var R=[{key:"d20",title:"Add D20",count:M.d20,onClick:function(){return n(y.class,"d20")},children:Object(l.jsx)(K.a,{})},{key:"d12",title:"Add D12",count:M.d12,onClick:function(){return n(y.class,"d12")},children:Object(l.jsx)(Q.a,{})},{key:"d10",title:"Add D10",count:M.d10,onClick:function(){return n(y.class,"d10")},children:Object(l.jsx)($.a,{})},{key:"d8",title:"Add D8",count:M.d8,onClick:function(){return n(y.class,"d8")},children:Object(l.jsx)(ee.a,{})},{key:"d6",title:"Add D6",count:M.d6,onClick:function(){return n(y.class,"d6")},children:Object(l.jsx)(te.a,{})},{key:"d4",title:"Add D4",count:M.d4,onClick:function(){return n(y.class,"d4")},children:Object(l.jsx)(ne.a,{})},{key:"d100",title:"Add D100",count:M.d100,onClick:function(){return n(y.class,"d100")},children:Object(l.jsx)(ae.a,{})}];return Object(l.jsx)(m.b,{sx:{borderRadius:"4px",position:"absolute",top:"0",left:"0",height:"100%",maxHeight:"390px",pointerEvents:"all"},bg:"overlay",children:Object(l.jsx)(J.a,{style:{width:"48px",height:"100%"},children:Object(l.jsxs)(m.g,{sx:{justifyContent:"center",alignItems:"center",flexDirection:"column"},p:2,children:[Object(l.jsx)(Ot,{onDiceChange:function(e){return C.apply(this,arguments)},currentDice:y,disabled:f}),Object(l.jsx)(yt.a,{}),R.map(function(e){return Object(l.jsx)(oe,Object(Y.a)({disabled:f},e))}),Object(l.jsx)(yt.a,{}),Object(l.jsx)(m.i,{"aria-label":"single"===r?"Expand Dice Tray":"Shrink Dice Tray",title:"single"===r?"Expand Dice Tray":"Shrink Dice Tray",sx:{transform:"single"===r?"rotate(0)":"rotate(180deg)"},onClick:function(){return h("single"===r?"double":"single")},disabled:f,children:Object(l.jsx)(ie,{})}),Object(l.jsx)(yt.a,{}),Object(l.jsx)(m.i,{"aria-label":d?"Hide Dice Rolls":"Share Dice Rolls",title:d?"Hide Dice Rolls":"Share Dice Rolls",onClick:function(){return p(!d)},disabled:f,children:d?Object(l.jsx)(re,{}):Object(l.jsx)(se,{})})]})})})};var Mt=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),Object(l.jsx)("path",{d:"M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"})]})};var Dt=function(){return Object(l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24",fill:"currentcolor",children:[Object(l.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(l.jsx)("path",{d:"M21 14c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1l-.116-.007A1.004 1.004 0 0120 19v-1.01A9.985 9.985 0 0112 22c-4.36 0-8.07-2.79-9.44-6.69-.22-.64.28-1.31.96-1.31l.122.007a.991.991 0 01.818.633C5.55 17.76 8.51 20 12 20c2.95 0 5.53-1.61 6.91-4H17c-.55 0-1-.45-1-1l.007-.116c.058-.496.482-.884.993-.884zm-7-5a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4a1 1 0 011-1h4zm-1 3a1 1 0 100 2 1 1 0 000-2zm-2-2a1 1 0 100 2 1 1 0 000-2zm1-8c4.36 0 8.07 2.79 9.44 6.69.22.64-.28 1.31-.96 1.31l-.122-.007a.991.991 0 01-.818-.633C18.45 6.24 15.49 4 12 4 9.05 4 6.47 5.61 5.09 8H7c.55 0 1 .45 1 1l-.007.116A1.004 1.004 0 017 10H3c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1l.116.007C3.612 4.065 4 4.489 4 5v1.01A9.985 9.985 0 0112 2z"})]})},St=n(252);var Ct=function(e){var t=e.diceRolls,n=e.onDiceClear,a=e.onDiceReroll,i=Object(u.useState)(!1),r=Object(o.a)(i,2),s=r[0],c=r[1];if(0===t.length)return null;var d=[];return t.length>1&&(d=t.filter(function(e){return"unknown"!==e.roll}).map(function(e,n){return Object(l.jsxs)(h.a.Fragment,{children:[Object(l.jsx)(m.q,{variant:"body2",as:"p",color:"hsl(210, 50%, 96%)",children:e.roll}),Object(l.jsx)(m.q,{variant:"body2",as:"p",color:"grey",children:n===t.length-1?"":"+"})]},n)})),Object(l.jsxs)(m.g,{sx:{justifyContent:"space-between",alignItems:"center",position:"absolute",bottom:"5%",left:0,right:0,display:"flex",color:"white",pointerEvents:"none"},children:[Object(l.jsx)(m.i,{ml:"7%",title:"Clear Dice","aria-label":"Clear Dice",onClick:n,sx:{pointerEvents:"all"},children:Object(l.jsx)(Mt,{})}),Object(l.jsxs)(m.g,{sx:{flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(l.jsx)(m.q,{variant:"heading",as:"h1",sx:{fontSize:5,userSelect:"none"},children:Object(St.b)(t)}),d.length>6?Object(l.jsxs)(m.c,{"aria-label":"Show Dice Details",title:"Show Dice Details",onClick:function(){return c(!s)},variant:"secondary",sx:{display:"flex",height:"24px",pointerEvents:"all"},children:[s?d:d.slice(0,6),!s&&Object(l.jsx)(m.q,{variant:"body2",as:"p",color:"hsl(210, 50%, 96%)",children:"..."})]}):Object(l.jsx)(m.g,{sx:{height:"15px"},children:d})]}),Object(l.jsx)(m.i,{mr:"7%",title:"Reroll Dice","aria-label":"Reroll Dice",onClick:a,sx:{pointerEvents:"all"},children:Object(l.jsx)(Dt,{})})]})},Rt=n(676),It=n.p+"static/media/single.2189bc7f.glb",Pt=n.p+"static/media/double.c0c4c48c.glb",Tt=n.p+"static/media/singleAlbedo.21816ea7.jpg",zt=n.p+"static/media/singleMetalRoughness.7be5048e.jpg",Et=n.p+"static/media/singleNormal.a88cbe7c.jpg",Lt=n.p+"static/media/doubleAlbedo.6c6fc3c8.jpg",_t=n.p+"static/media/doubleMetalRoughness.29559b2e.jpg",At=n.p+"static/media/doubleNormal.9aaec73b.jpg",Bt=function(){function e(t,n,a){Object(I.a)(this,e),this._size=void 0,this.scene=void 0,this.shadowGenerator=void 0,this.height=20,this.collisionSize=50,this.wallTop=void 0,this.wallRight=void 0,this.wallBottom=void 0,this.wallLeft=void 0,this.singleMesh=void 0,this.doubleMesh=void 0,this._size=t,this.scene=n,this.shadowGenerator=a}return Object(P.a)(e,[{key:"size",get:function(){return this._size},set:function(e){this._size=e;var t=this.collisionSize/2+this.width/2-.5,n=this.collisionSize/2+this.height/2-.5;this.wallTop&&(this.wallTop.position.z=-n),this.wallRight&&(this.wallRight.position.x=-t),this.wallBottom&&(this.wallBottom.position.z=n),this.wallLeft&&(this.wallLeft.position.x=t),this.singleMesh&&(this.singleMesh.isVisible="single"===e),this.doubleMesh&&(this.doubleMesh.isVisible="double"===e)}},{key:"width",get:function(){return"single"===this.size?10:20}}]),Object(P.a)(e,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadWalls(),e.next=3,this.loadMeshes();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createCollision",value:function(e,t,n,a,i){var r=Rt.a.CreateBox(e,this.collisionSize,this.scene,!0,Rt.a.DOUBLESIDE);return r.position.x=t,r.position.y=n,r.position.z=a,r.physicsImpostor=new E.a(r,E.a.BoxImpostor,{mass:0,friction:i},this.scene),r.isVisible=!1,r}},{key:"loadWalls",value:function(){var e=this.collisionSize/2+this.width/2-.5,t=this.collisionSize/2+this.height/2-.5;this.wallTop=this.createCollision("wallTop",0,0,-t,10),this.wallRight=this.createCollision("wallRight",-e,0,0,10),this.wallBottom=this.createCollision("wallBottom",0,0,t,10),this.wallLeft=this.createCollision("wallLeft",e,0,0,10);this.createCollision("ground",0,-this.collisionSize/2+.32,0,20);this.createCollision("roof",0,this.collisionSize/2+10,0,100)}},{key:"loadMeshes",value:function(){var e=Object(c.a)(s.a.mark(function e(){var t,n,a,i,r,c,l,u,h,d,p,f;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([T.a.ImportMeshAsync("",It,"",this.scene),T.a.ImportMeshAsync("",Pt,"",this.scene),q(Tt),q(Et),q(zt),q(Lt),q(At),q(_t)]);case 2:t=e.sent,n=Object(o.a)(t,8),a=n[0],i=n[1],r=n[2],c=n[3],l=n[4],u=n[5],h=n[6],d=n[7],this.singleMesh=a.meshes[1],this.singleMesh.id="dice_tray_single",this.singleMesh.name="dice_tray",(p=new z.a("dice_tray_mat_single",this.scene)).albedoTexture=r,p.bumpTexture=c,p.metallicTexture=l,p.useRoughnessFromMetallicTextureAlpha=!1,p.useRoughnessFromMetallicTextureGreen=!0,p.useMetallnessFromMetallicTextureBlue=!0,this.singleMesh.material=p,this.singleMesh.receiveShadows=!0,this.shadowGenerator.addShadowCaster(this.singleMesh),this.singleMesh.isVisible="single"===this.size,this.doubleMesh=i.meshes[1],this.doubleMesh.id="dice_tray_double",this.doubleMesh.name="dice_tray",(f=new z.a("dice_tray_mat_double",this.scene)).albedoTexture=u,f.bumpTexture=h,f.metallicTexture=d,f.useRoughnessFromMetallicTextureAlpha=!1,f.useRoughnessFromMetallicTextureGreen=!0,f.useMetallnessFromMetallicTextureBlue=!0,this.doubleMesh.material=f,this.doubleMesh.receiveShadows=!0,this.shadowGenerator.addShadowCaster(this.doubleMesh),this.doubleMesh.isVisible="double"===this.size;case 40:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),Vt=Bt,Ft=n(328);t.default=function(e){var t=e.isOpen,n=e.shareDice,r=e.onShareDiceChange,h=e.diceRolls,v=e.onDiceRollsChange,g=Object(u.useRef)(),x=Object(u.useRef)(),O=Object(u.useRef)([]),y=Object(u.useRef)(!1),w=Object(u.useRef)(!1),k=Object(u.useRef)(0),M=Object(u.useRef)(),D=Object(u.useState)("single"),S=Object(o.a)(D,2),C=S[0],I=S[1],P=Object(Ft.b)(),T=P.assetLoadStart,z=P.assetLoadFinish,E=P.isLoading,L=Object(wt.a)("map.fullScreen"),_=Object(o.a)(L,1)[0];function A(){T()}function B(){z(),V()}function V(){k.current++;var e=!1,t=setTimeout(function(){k.current--,e=!0},1e3);return function(){clearTimeout(t),e||k.current--}}Object(u.useEffect)(function(){var e,t=M.current;return t&&(t.size=C,e=V()),e},[C]),Object(u.useEffect)(function(){var e;return t?(y.current=!0,e=V()):y.current=!1,e},[t]);var F=Object(u.useCallback)(function(){var e=Object(c.a)(s.a.mark(function e(t){var n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.scene,a=t.engine,g.current=n,e.next=4,H(n);case 4:a.runRenderLoop(function(){return q(n)});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[]);function H(e){return G.apply(this,arguments)}function G(){return(G=Object(c.a)(s.a.mark(function e(t){var n,a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A(),(n=new p.a("DirectionalLight",new d.d(-.5,-1,-.5),t)).position=new d.d(5,10,5),n.shadowMinZ=1,n.shadowMaxZ=50,(a=new f.a(1024,n)).useCloseExponentialShadowMap=!0,a.darkness=.7,x.current=a,t.environmentTexture=b.a.CreateFromPrefilteredData(j,t),t.environmentIntensity=1,i=new Vt("single",t,a),e.next=14,i.load();case 14:M.current=i,B();case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(e){var t=O.current;if(y.current){var n=k.current>0,a=w.current,i=t.map(function(e){return e.asleep}).includes(!1);if(n||a||i){for(var r=function(e){var n=t[e],a=function(e){var t,n,a=(null===(t=e.instance.physicsImpostor)||void 0===t||null===(n=t.getLinearVelocity())||void 0===n?void 0:n.length())||0;if(e.d10Instance){var i,r,s=(null===(i=e.d10Instance.physicsImpostor)||void 0===i||null===(r=i.getLinearVelocity())||void 0===r?void 0:r.length())||0;return Math.max(a,s)}return a}(n);a<.01&&!n.sleepTimeout?n.sleepTimeout=setTimeout(function(){n.asleep=!0},1e3):a>.5&&(n.asleep||n.sleepTimeout)&&(n.asleep=!1,n.sleepTimeout&&clearTimeout(n.sleepTimeout),n.sleepTimeout=void 0)},s=0;s<t.length;s++)r(s);e&&e.render()}}}function U(){return(U=Object(c.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(A(),!(n=g.current)){e.next=5;break}return e.next=5,t.class.load(n);case 5:B();case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var W=Object(u.useState)({width:0,height:0}),Z=Object(o.a)(W,2),Y=Z[0],J=Z[1];return Object(u.useEffect)(function(){var e,t;function n(){var n=document.querySelector(".map");if(n){var a=n.getBoundingClientRect(),i=a.width-108,r=a.height-80,s=Math.min(r,1e3),c="single"===C?s/2:s;c>i&&(c=i,s="single"===C?2*c:c),e=setTimeout(function(){t=V()},100),J({width:c,height:s})}}return window.addEventListener("resize",n),n(),function(){window.removeEventListener("resize",n),e&&clearTimeout(e),t&&t()}},[C,_,t]),Object(u.useEffect)(function(){var e=setInterval(function(){var e=O.current;if(y.current){var t=e.map(function(e){return e.asleep}).includes(!1);if(t){for(var n=[],a=0;a<e.length;a++){var i=e[a],r=Object(St.a)(i);n[a]=r}v(n)}}},100);return function(){clearInterval(e)}},[O,y,v]),Object(l.jsxs)(m.b,{sx:{width:"".concat(Y.width,"px"),height:"".concat(Y.height,"px"),borderRadius:"4px",display:t?"block":"none",position:"relative",overflow:"visible"},children:[Object(l.jsxs)(m.b,{sx:{transform:"translateX(50px)",width:"100%",height:"100%",pointerEvents:"all"},children:[Object(l.jsx)(R,{onSceneMount:F,onPointerDown:function(){w.current=!0},onPointerUp:function(){w.current=!1}}),Object(l.jsx)(Ct,{diceRolls:h,onDiceClear:function(){!function(){var e,t=O.current,n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.instance.dispose(),a.d10Instance&&a.d10Instance.dispose()}}catch(r){n.e(r)}finally{n.f()}O.current=[],V()}(),v([])},onDiceReroll:function(){var e,t=O.current,n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;N.roll(a.instance),a.d10Instance&&N.roll(a.d10Instance),a.asleep=!1}}catch(r){n.e(r)}finally{n.f()}}})]}),Object(l.jsx)(kt,{diceRolls:h,onDiceAdd:function(e,t){!function(e,t){var n=g.current,a=x.current;if(n&&a){var i=e.createInstance(t,n);a.addShadowCaster(i),e.roll(i);var r={type:t,instance:i,asleep:!1};if("d100"===t){var s=e.createInstance("d10",n);a.addShadowCaster(s),N.roll(s),r.d10Instance=s}O.current.push(r)}}(e,t),v([].concat(Object(a.a)(h),[{type:t,roll:"unknown"}]))},onDiceLoad:function(e){return U.apply(this,arguments)},onDiceTraySizeChange:I,diceTraySize:C,shareDice:n,onShareDiceChange:r,loading:E}),E&&Object(l.jsx)(m.b,{sx:{width:"100%",height:"100%",position:"absolute",top:0,left:"50px"},children:Object(l.jsx)(X.a,{})})]})}}}]);
//# sourceMappingURL=8.220fc723.chunk.js.map
{"version":3,"sources":["components/tile/Tile.tsx","components/banner/Banner.tsx","icons/EditTileIcon.tsx","components/banner/ErrorBanner.tsx","helpers/FakeStorage.ts","helpers/dice.ts","helpers/shared.ts","icons/D20Icon.tsx","icons/D12Icon.tsx","icons/D10Icon.tsx","icons/D8Icon.tsx","icons/D6Icon.tsx","icons/D4Icon.tsx","icons/D100Icon.tsx","contexts/DiceLoadingContext.tsx","hooks/useSetting.ts","components/Modal.tsx","components/Divider.tsx","hooks/useResponsiveLayout.ts","components/Spinner.tsx","images/Loading.png","components/LoadingOverlay.tsx","polyfills/xhrResponseText.ts","theme.ts","components/Link.tsx","components/Footer.tsx","contexts/AuthContext.tsx","modals/StartModal.tsx","modals/JoinModal.tsx","components/Markdown.tsx","modals/GettingStartedModal.tsx","icons/HelpIcon.tsx","icons/SocialRedditIcon.tsx","icons/SocialTwitterIcon.tsx","icons/SocialYouTubeIcon.tsx","icons/SocialPatreonIcon.tsx","images/Owlington.png","routes/Home.tsx","icons/ReconnectingIcon.tsx","components/banner/ReconnectBanner.tsx","icons/OfflineIcon.tsx","components/banner/OfflineBanner.tsx","contexts/MapLoadingContext.tsx","components/LoadingBar.tsx","components/map/MapLoadingOverlay.tsx","components/UpgradingLoadingOverlay.tsx","modals/AuthModal.tsx","modals/GameExpiredModal.tsx","modals/ForceUpdateModal.tsx","modals/MaintenanceModal.tsx","contexts/MapStageContext.tsx","ml/Model.ts","ml/gridSize/group1-shard1of1.bin","ml/gridSize/GridSizeModel.ts","helpers/Vector3.ts","helpers/Vector2.ts","helpers/Size.ts","helpers/grid.ts","helpers/image.ts","helpers/diff.ts","actions/Action.ts","actions/AddStatesAction.ts","helpers/actions.ts","actions/CutFogAction.ts","actions/EditStatesAction.ts","actions/RemoveStatesAction.ts","actions/SubtractFogAction.ts","maps/Blank.jpg","maps/Grass.jpg","maps/Sand.jpg","maps/Stone.jpg","maps/Water.jpg","maps/Wood.jpg","maps/index.ts","maps/Unknown.jpg","tokens/Aberration.png","tokens/index.ts","tokens/Barbarian.png","tokens/Bard.png","tokens/Cleric.png","tokens/Druid.png","tokens/Fighter.png","tokens/Monk.png","tokens/Paladin.png","tokens/Ranger.png","tokens/Rogue.png","tokens/Sorcerer.png","tokens/Warlock.png","tokens/Wizard.png","tokens/Artificer.png","tokens/Blood Hunter.png","tokens/Beast.png","tokens/Celestial.png","tokens/Construct.png","tokens/Dragon.png","tokens/Elemental.png","tokens/Fey.png","tokens/Fiend.png","tokens/Giant.png","tokens/Goblinoid.png","tokens/Humanoid.png","tokens/Monstrosity.png","tokens/Ooze.png","tokens/Plant.png","tokens/Shapechanger.png","tokens/Titan.png","tokens/Undead.png","upgrade.ts","helpers/monsters.ts","database.ts","contexts/DatabaseContext.tsx","workers/DatabaseWorker.ts","contexts/UserIdContext.tsx","hooks/useDebounce.ts","hooks/useNetworkedState.ts","contexts/PlayerContext.tsx","contexts/PartyContext.tsx","contexts/AssetsContext.tsx","helpers/group.ts","contexts/MapDataContext.tsx","contexts/TokenDataContext.tsx","hooks/useMapActions.ts","hooks/useTokenAttributes.ts","helpers/base64.ts","network/useAssetTransfer.ts","components/RadioIconButton.tsx","components/Select.tsx","components/map/MapSettings.tsx","hooks/useMapImage.ts","hooks/usePreventOverscroll.ts","contexts/KeyboardContext.tsx","shortcuts.ts","hooks/useStageInteraction.ts","hooks/useImageCenter.ts","contexts/MapInteractionContext.tsx","contexts/GridContext.tsx","helpers/KonvaBridge.tsx","icons/ResetMapIcon.tsx","icons/GridOnIcon.tsx","icons/GridOffIcon.tsx","components/konva/Grid.tsx","images/SquarePatternDark.png","images/SquarePatternLight.png","images/HexPatternDark.png","images/HexPatternLight.png","components/map/MapGrid.tsx","components/map/MapGridEditor.tsx","components/map/MapEditor.tsx","modals/EditMapModal.tsx","modals/ConfirmModal.tsx","components/DatabaseDisabledMessage.tsx","hooks/useImageDrop.ts","components/image/ImageDrop.tsx","components/map/MapTileImage.tsx","components/map/MapTile.tsx","components/map/MapTileGroup.tsx","contexts/DragContext.tsx","contexts/GroupContext.tsx","hooks/usePreventSelect.ts","contexts/TileDragContext.tsx","components/tile/SortableTile.tsx","components/tile/LazyTile.tsx","components/tile/SortableTiles.tsx","components/tile/SortableTilesDragOverlay.tsx","components/map/MapTiles.tsx","icons/RemoveMapIcon.tsx","components/map/MapEditBar.tsx","components/map/SelectMapSelectButton.tsx","icons/ChangeNicknameIcon.tsx","modals/GroupNameModal.tsx","components/drag/Droppable.tsx","components/tile/TilesOverlay.tsx","components/tile/TilesContainer.tsx","icons/AddIcon.tsx","icons/SelectMultipleIcon.tsx","icons/SelectSingleIcon.tsx","icons/SearchIcon.tsx","components/Search.tsx","components/tile/TileActionBar.tsx","helpers/url.ts","helpers/map.ts","modals/SelectMapModal.tsx","icons/SelectMapIcon.tsx","components/map/SelectMapButton.tsx","icons/FogBrushIcon.tsx","icons/FogPolygonIcon.tsx","icons/FogRemoveIcon.tsx","icons/FogRectangleIcon.tsx","icons/FogToggleIcon.tsx","icons/FogCutOnIcon.tsx","icons/FogCutOffIcon.tsx","icons/FogPreviewOffIcon.tsx","icons/FogPreviewOnIcon.tsx","icons/TokenShowIcon.tsx","components/controls/shared/ToolSection.tsx","icons/EraseAllIcon.tsx","components/map/MapMenu.tsx","components/controls/shared/EraseAllButton.tsx","components/Slider.tsx","components/controls/FogToolSettings.tsx","helpers/colors.ts","components/controls/shared/ColorControl.tsx","icons/BlendOnIcon.tsx","icons/BlendOffIcon.tsx","components/controls/shared/AlphaBlendToggle.tsx","icons/ShapeFillOnIcon.tsx","icons/ShapeFillOffIcon.tsx","components/controls/shared/ShapeFillToggle.tsx","icons/BrushToolIcon.tsx","icons/BrushPaintIcon.tsx","icons/BrushLineIcon.tsx","icons/BrushRectangleIcon.tsx","icons/BrushCircleIcon.tsx","icons/BrushTriangleIcon.tsx","icons/EraseToolIcon.tsx","icons/SettingsIcon.tsx","icons/PenToolIcon.tsx","icons/MoveToolIcon.tsx","components/controls/DrawingToolSettings.tsx","icons/SpellTemplateDragToolIcon.tsx","icons/RemoveTokenIcon.tsx","components/controls/SpellTemplateToolSettings.tsx","components/controls/PointerToolSettings.tsx","icons/SelectRectangleIcon.tsx","icons/SelectPathIcon.tsx","components/controls/SelectToolSettings.tsx","icons/FogToolIcon.tsx","icons/MeasureToolIcon.tsx","icons/ExpandMoreIcon.tsx","icons/PointerToolIcon.tsx","icons/FullScreenIcon.tsx","icons/FullScreenExitIcon.tsx","icons/NoteToolIcon.tsx","icons/NoteTextIcon.tsx","icons/SelectToolIcon.tsx","icons/PasteIcon.tsx","icons/SpellTemplateToolIcon.tsx","icons/UndoIcon.tsx","components/controls/shared/UndoButton.tsx","icons/RedoIcon.tsx","components/controls/shared/RedoButton.tsx","contexts/ImageImportContext.tsx","components/map/MapControls.tsx","hooks/usePreventContextMenu.ts","components/map/MapInteraction.tsx","helpers/visibility.ts","components/map/FogOfWarLayer.tsx","helpers/drawing.ts","helpers/konva.ts","hooks/useGridSnapping.ts","components/konva/Drawing.tsx","components/tools/DrawingTool.tsx","types/Drawing.ts","components/konva/Tick.tsx","components/tools/WallTool.tsx","components/konva/Ruler.tsx","components/tools/MeasureTool.tsx","components/konva/SpellTemplate.tsx","components/konva/SpellTemplateGridOverlay.tsx","helpers/spellTemplates.ts","components/spellTemplates/SpellTemplateHud.tsx","components/tools/SpellTemplateTool.tsx","components/konva/Pointer.tsx","components/tools/PointerTool.tsx","network/NetworkedMapPointer.tsx","hooks/usePrevious.ts","components/konva/TokenStatus.tsx","components/konva/TokenLabel.tsx","components/konva/TokenOutline.tsx","components/konva/TokenAttributeBubble.tsx","helpers/tokenAttributes.ts","helpers/token.ts","components/konva/Transformer.tsx","images/ScaleDark.png","images/RotateDark.png","components/konva/TokenAttachment.tsx","components/konva/Token.tsx","icons/TokenHideIcon.tsx","components/token/TokenAttributeEditor.tsx","icons/TokenLockIcon.tsx","icons/TokenUnlockIcon.tsx","icons/TokenCharacterIcon.tsx","icons/TokenPropIcon.tsx","icons/TokenMountIcon.tsx","icons/TokenAttachmentIcon.tsx","components/token/TokenMenu.tsx","components/map/DragOverlay.tsx","components/token/TokenDragOverlay.tsx","hooks/useMapTokens.tsx","helpers/notes.ts","components/konva/Note.tsx","components/note/NoteDragOverlay.tsx","components/TextareaAutoSize.tsx","components/note/NoteMenu.tsx","components/note/AdvancedTextHud.tsx","components/note/NoteEditor.tsx","components/note/NoteTextOverlay.tsx","components/konva/BlankNote.tsx","components/tools/NoteTool.tsx","hooks/useMapNotes.tsx","components/selection/SelectionDragOverlay.tsx","icons/CopyIcon.tsx","helpers/selection.ts","validators/Color.ts","validators/Vector2.ts","validators/Drawing.ts","validators/Fog.ts","validators/Note.ts","validators/TokenNote.ts","validators/SpellTemplate.ts","validators/Outline.ts","validators/TokenState.ts","validators/Wall.ts","validators/MapState.ts","validators/Selection.ts","components/selection/SelectionMenu.tsx","components/konva/Selection.tsx","components/tools/SelectTool.tsx","hooks/useMapSelection.tsx","network/TokenNoteLockProtocol.ts","components/token/TokenOutline.tsx","components/token/TokenImage.tsx","components/token/TokenNoteEditor.tsx","components/token/TokenNoteSheet.tsx","components/token/TokenNotePopover.tsx","hooks/useTokenNotes.tsx","components/map/Map.tsx","components/token/TokenBarToken.tsx","components/drag/Draggable.tsx","icons/GroupIcon.tsx","components/token/TokenBarTokenGroup.tsx","icons/SelectTokensIcon.tsx","components/token/TokenSettings.tsx","components/token/TokenPreview.tsx","modals/EditTokenModal.tsx","components/token/TokenTile.tsx","components/token/TokenTileGroup.tsx","components/token/TokenHiddenBadge.tsx","components/token/TokenTiles.tsx","components/token/TokenEditBar.tsx","modals/SelectTokensModal.tsx","components/token/SelectTokensButton.tsx","components/token/TokenBar.tsx","components/image/GlobalImageDrop.tsx","network/NetworkedMapAndTokens.tsx","modals/AddPartyMemberModal.tsx","icons/AddPartyMemberIcon.tsx","components/party/AddPartyMemberButton.tsx","icons/DiceRollsIcon.tsx","components/party/DiceRoll.tsx","components/party/DiceRolls.tsx","components/party/Nickname.tsx","modals/ChangeNicknameModal.tsx","components/party/ChangeNicknameButton.tsx","modals/SelectDataModal.tsx","modals/ImportExportModal.tsx","modals/SettingsModal.tsx","components/SettingsButton.tsx","helpers/timer.ts","modals/StartTimerModal.tsx","icons/StartTimerIcon.tsx","components/party/StartTimerButton.tsx","hooks/usePortal.ts","components/party/Timer.tsx","icons/ExpandMoreDiceIcon.tsx","components/party/DiceTrayButton.tsx","components/party/Party.tsx","network/NetworkedParty.tsx","network/AssetTransport.ts","network/StreamProtocol.ts","network/Session.ts","routes/Game.tsx","routes/About.tsx","docs/assets/index.ts","docs/assets/DefaultMaps.mp4","docs/assets/CustomMaps.mp4","docs/assets/EditingMapsAdvanced.jpg","docs/assets/ResetAndRemovingMaps.mp4","docs/assets/UsingDrawing.mp4","docs/assets/OpenDiceTray.mp4","docs/assets/DiceRolling.mp4","docs/assets/DiceStyles.mp4","docs/assets/DiceTraySize.mp4","docs/assets/UsingFog.mp4","docs/assets/UsingMeasure.mp4","docs/assets/DefaultTokens.mp4","docs/assets/WorkingWithTokens.mp4","docs/assets/DeletingTokens.mp4","docs/assets/CustomTokens.mp4","docs/assets/TokenEditor.mp4","docs/assets/AddPartyMember.mp4","docs/assets/ChangeNickname.mp4","docs/assets/SharingAudio.mp4","docs/assets/StartGame.mp4","docs/assets/DiceSharing.mp4","docs/assets/UsingTimer.mp4","docs/assets/UsingPointer.mp4","docs/assets/MapEditor.mp4","docs/assets/FilteringMaps.mp4","docs/assets/GroupAndRemovingTokens.mp4","docs/assets/FilteringTokens.mp4","docs/assets/UsingNotes.mp4","docs/assets/Settings.jpg","routes/FAQ.tsx","components/Accordion.tsx","routes/ReleaseNotes.tsx","routes/HowTo.tsx","components/Toast.tsx","App.tsx","serviceWorker.ts","index.tsx","helpers/Settings.ts","contexts/SettingsContext.tsx","settings.ts","helpers/blobToBuffer.ts"],"names":["Tile","title","isSelected","onSelect","onEdit","onDoubleClick","canEdit","badges","editTitle","children","sx","position","width","height","paddingTop","borderRadius","overflow","userSelect","bg","onClick","e","stopPropagation","top","left","right","bottom","background","alignItems","justifyContent","p","as","variant","color","textAlign","borderColor","borderStyle","borderWidth","pointerEvents","map","badge","i","m","preventDefault","defaultProps","size","columns","Banner","isOpen","onRequestClose","allowClose","backgroundColor","theme","useThemeUI","style","overlay","zIndex","content","colors","highlight","border","padding","margin","paddingRight","maxWidth","transform","EditTileIcon","xmlns","viewBox","fill","d","ErrorBanner","error","message","FakeStorage","data","index","Object","keys","this","keyName","keyValue","getDiceInstanceRoll","instance","highestDot","highestLocator","undefined","getChildTransformNodes","locator","direction","getAbsolutePosition","subtract","normalize","dot","Vector3","Dot","Up","parseInt","name","slice","getDiceRoll","dice","number","d10Instance","d10Number","type","roll","getDiceRollTotal","diceRolls","reduce","accumulator","omit","obj","tmp","entries","key","value","includes","roundTo","x","to","Math","round","floorTo","floor","toRadians","angle","PI","toDegrees","lerp","a","b","alpha","isEmpty","length","constructor","keyBy","array","prev","current","isMacLike","test","navigator","platform","isSafari","userAgent","shuffle","randomIndex","temp","currentIndex","random","clipboardSupported","clipboard","readText","writeText","permissions","query","state","timeout","ms","Promise","resolve","setTimeout","D20Icon","D12Icon","D10Icon","D8Icon","D6Icon","D4Icon","D100Icon","DiceLoadingContext","React","createContext","DiceLoadingProvider","useState","loadingAssetCount","setLoadingAssetCount","assetLoadStart","prevLoadingAssets","assetLoadFinish","isLoading","Provider","useDiceLoading","context","useContext","Error","useSetting","path","useSettings","settings","setSettings","get","set","StyledModal","props","openAnimation","useSpring","opacity","config","default","display","maxHeight","contentElement","div","overlayElement","onDragEnter","StyledDivider","vertical","my","mx","useResponsiveLayout","isMediumScreen","useMedia","isLargeScreen","screenSize","modalSize","tileSize","tileGridColumns","tileContainerHeight","groupGridColumns","Spinner","className","backgroundImage","backgroundSize","LoadingOverlay","flexDirection","window","descriptor","getOwnPropertyDescriptor","XMLHttpRequest","prototype","originalGet","defineProperty","configurable","enumerable","call","DOMException","responseType","useColorSchemeMediaQuery","text","primary","secondary","purple","muted","gray","modes","light","fonts","body","body2","heading","monospace","fontSizes","fontWeights","caption","lineHeights","breakpoints","fontFamily","fontWeight","lineHeight","fontSize","mt","styles","Container","root","h1","h2","h3","h4","h5","h6","pre","code","inlineCode","hr","borderBottom","img","progress","prism","fontStyle","forms","label","input","outlineColor","slider","textarea","buttons","cursor","outline","icon","close","links","footer","textDecoration","textDecorationColor","messages","warning","borderLeftColor","note","Link","rest","Footer","storage","paddingBottom","AuthContext","sessionStorage","setItem","removeItem","console","warn","AuthProvider","getItem","password","setPassword","useEffect","useAuth","StartModal","history","useHistory","usePassword","setUsePassword","inputRef","useRef","Modal","onAfterOpen","focus","flexGrow","onSubmit","event","push","shortid","generate","htmlFor","id","onChange","target","disabled","autoComplete","ref","mb","checked","JoinModal","gameId","setGameId","Paragraph","Heading","level","Image","alt","src","endsWith","autoPlay","playsInline","loop","controls","ListItem","Code","startsWith","Table","borderCollapse","TableHead","borderBottomWidth","TableBody","TableRow","borderBottomStyle","borderBottomColor","TableCell","href","Markdown","source","assets","renderers","paragraph","image","link","listItem","table","tableHead","tableBody","tableRow","tableCell","transformImageUri","uri","GettingStartedModal","py","HelpIcon","SocialRedditIcon","SocialTwitterIcon","SocialYouTubeIcon","SocialPatreonIcon","Home","isStartModalOpen","setIsStartModalOpen","isJoinModalOpen","setIsJoinModalOpen","isGettingStartedModalOpen","setIsGettingStartedModalOpen","minHeight","owlington","process","ReconnectingIcon","attributeName","attributeType","from","dur","repeatCount","ReconnectBanner","PointerToolIcon","OfflineBanner","OfflineIcon","MapLoadingContext","MapLoadingProvider","setIsLoading","assetProgressRef","loadingProgressRef","useCallback","count","total","assetProgressUpdate","complete","progresses","values","useMapLoading","LoadingBar","requestRef","progressBarRef","requestAnimationFrame","animate","cancelAnimationFrame","max","MapLoadingOverlay","facts","UpgradingLoadingOverlay","subText","setSubText","interval","randomFacts","updateFact","setInterval","clearTimeout","clearInterval","AuthModal","tmpPassword","setTempPassword","GameExpiredModal","ml","ForceUpdateModal","MaintenanceModal","MapStageContext","MapStageProvider","useMapStage","Model","weightsMapping","buffers","manifest","weightsManifest","paths","url","fetch","response","arrayBuffer","buffer","merged","Blob","blobToBuffer","weightData","weightSpecs","weights","modelArtifacts","modelTopology","format","generatedBy","convertedBy","GridSizeModel","imageData","tf","model","loadLayersModel","prediction","tidy","normalized","browser","fromPixels","toFloat","scalar","batched","expandDims","predict","y","z","cube","rX","rY","rZ","xDiff","abs","yDiff","zDiff","Vector2","sqrt","lengthSquared","l","magnitude","divide","point","origin","cos","sin","dif","rotate","min","roundToNumber","floorToNumber","sign","pow","pa","ba","h","distance","multiply","add","pos","A","B","C","c","kk","kx","ky","q","uv","t","dot2","v","acos","n","clamp","d1","d2","points","minX","Number","MAX_VALUE","maxX","MIN_VALUE","minY","maxY","center","bounds","getBoundingBox","isInside","j","threshold","lerpNumber","localPoints","intervalLength","pathLength","resampledPoints","currentDistance","newPoint","splice","prevDist","centroid","dist","distances","Size","radius","_radius","SQRT3","GRID_TYPE_NOT_IMPLEMENTED","getCellLocation","grid","col","row","cellSize","getNearestCellCoordinates","cubeXVert","cubeZVert","cubeVert","hexCubeToOffset","cubeRound","cubeXHorz","cubeZHorz","cubeHorz","getCellCorners","halfSize","up","getGridHeightFromWidth","gridWidth","cellHeightVert","cellHeightHroz","getGridDefaultInset","mapWidth","mapHeight","topLeft","bottomRight","getGridUpdatedInset","inset","insetHeightNorm","getGridMaxZoom","hexOffsetToCube","offset","parseGridScale","scale","match","integer","parseFloat","fractional","unit","isNaN","multiplier","digits","dividers","gcd","Array","_","filter","gridSizeMean","gridSizeStd","gridSizeVaild","gridSizeHeuristic","candidates","bestX","bestY","bestScore","xScore","yScore","gridSizeML","ratio","canvas","document","createElement","getContext","drawImage","getImageData","r","g","luma","bestScale","score","getGridSizeFromImage","canvasToImage","quality","toBlob","blob","file","mime","imageToWebp","resizeImage","createThumbnail","halfHeight","halfWidth","getImageOutline","maxPoints","defaultOutline","outlinePoints","imageOutline","opacityThreshold","resample","imageArea","rectangular","circular","flat","applyChanges","changes","change","kind","applyChange","diff","deepDiff","Action","update","newState","cloneDeep","revertedState","revertChange","revertChanges","AddStatesAction","states","statesById","addPolygonDifferenceToFog","fog","difference","shapes","newId","holes","addPolygonIntersectionToFog","shape","intersection","visible","fogToGeometry","shapePoints","shapeHoles","hole","CutFogAction","fogs","fogsById","actionGeom","cutFogs","fogGeom","polygonClipping","EditStatesAction","edits","edit","RemoveStatesAction","stateIds","SubtractFogAction","subtractedFogs","mapSources","blank","blankImage","grass","grassImage","sand","sandImage","stone","stoneImage","water","waterImage","wood","woodImage","getDefaultMaps","userId","mapKeys","maps","mapStates","Case","capital","owner","measurement","created","lastModified","Date","now","showGrid","snapToGrid","mapId","tokens","drawings","templates","editFlags","notes","tokenNotes","fogEnabled","tokenSources","barbarian","bard","cleric","druid","fighter","monk","paladin","ranger","rogue","sorcerer","warlock","wizard","artificer","bloodHunter","aberration","beast","celestial","construct","dragon","elemental","fey","fiend","giant","goblinoid","humanoid","monstrosity","ooze","plant","shapechanger","titan","undead","getDefaultTokenSize","getDefaultTokens","tokenKeys","token","defaultSize","defaultLabel","defaultCategory","hideInSidebar","versions","stores","user","onUpgrade","upgrade","tx","Dexie","waitFor","toArray","mapBuffers","toCollection","modify","mapTokenId","stateId","tokenId","lastEditedBy","rotation","fogDrawActions","fogAction","resolutions","lastModifiedBy","locked","category","isVehicle","lastUsed","group","gridX","gridY","gridType","tokenSizes","URL","createObjectURL","onload","action","textOnly","drawShapes","convertOldActionsToShapes","mapDrawActions","mapDrawActionIndex","fogShapes","fogDrawActionIndex","thumbnails","createDataThumbnail","thumbnail","all","createDataOutline","tokenOutlines","tokenOutline","find","el","primaryKeys","keyChunks","chunk","bulkGet","resolution","pop","uuid","prevId","prevType","mapRes","bulkAdd","mapUpdates","tokenUpdates","asset","res","camel","where","notEqual","delete","groups","groupItems","items","subGroups","item","sort","mapGroupItems","tokenGroupItems","_changes","_intercomm","_syncNodes","_uncommittedChanges","textVisible","visibility","ownerId","contentFormat","walls","explored","hasVision","visionRange","visionAngle","lightConfig","enabled","radiusBright","radiusDim","showExplored","actions","actionIndex","newShapes","newAction","shapeIds","execute","low","onerror","monsters","populate","db","on","nickname","getDatabase","options","versionNumber","populateData","upTo","version","loadVersions","DatabaseContext","worker","Comlink","Worker","DatabaseProvider","database","setDatabase","databaseStatus","setDatabaseStatus","databaseError","setDatabaseError","testDBRequest","indexedDB","open","handleDatabaseError","reason","DexieError","inner","onsuccess","result","autoOpen","location","reload","deleteDatabase","IDBKeyRange","addEventListener","removeEventListener","useDatabase","UserIdContext","UserIdProvider","setUserId","storedUserId","loadUserId","useUserId","useDebounce","delay","debouncedValue","setDebouncedValue","useNetworkedState","initialState","session","eventName","debounceRate","partialUpdates","partialUpdatesKey","_setState","dirtyRef","forceUpdateRef","updateLastSyncedRef","setState","sync","force","updateLastSynced","debouncedState","lastSyncedStateRef","socket","emit","handleSocketEvent","handleSocketUpdateEvent","prevState","off","PlayerStateContext","PlayerUpdaterContext","PlayerProvider","timer","share","rolls","sessionId","playerState","setPlayerState","storedNickname","loadNickname","updateSessionId","handleSocketConnect","handleSocketStatus","status","io","PartyContext","PartyProvider","partyState","setPartyState","handleSocketPartyState","otherMembersState","useParty","AssetsContext","AssetsProvider","cleanAssetCache","getAsset","assetId","addAssets","putAsset","BroadcastChannel","packedAsset","encode","putData","put","useAssets","AssetURLsStateContext","AssetURLsUpdaterContext","normalizeAssetFile","Uint8Array","ArrayBuffer","byteLength","isArray","AssetURLsProvider","assetURLs","setAssetURLs","assetKeys","setAssetKeys","loadingDebouncedAssetURLs","keysToLoad","useLiveQuery","prevURLs","newURLs","resolvedUrl","fileData","remoteUrl","cleanUpDebouncedAssetURLs","urlsToCleanup","references","revokeObjectURL","useAssetURL","defaultSources","unknownSource","increaseReferences","createReference","useDataURL","setAssetId","groupsFromIds","groupIds","groupsByIds","filteredGroups","groupId","getGroupItems","itemsFromGroups","allItems","itemKey","allItemsById","groupedItems","matched","combineGroups","moveGroupsInto","into","indices","newGroups","intoGroup","fromGroups","combined","fromGroup","findIndex","findGroup","getItemNames","names","removeGroupsItems","itemIds","MapDataContext","defaultMapState","MapDataProvider","mapsQuery","mapStatesQuery","useMemo","mapsLoading","mapGroupQuery","mapGroups","setMapGroups","updateMapGroups","getMap","getMapState","mapState","addMap","removeMaps","ids","assetIds","bulkDelete","resetMap","updateMap","updateMapState","mapsById","setMapsById","useMapData","TokenDataContext","TokenDataProvider","tokensQuery","tokensLoading","tokenGroupQuery","tokenGroups","setTokenGroups","updateTokenGroups","getToken","addToken","removeTokens","updateToken","updateTokensHidden","tokensById","setTokensById","useTokenData","defaultMapActions","useMapActions","setCurrentMapState","mapActions","setMapActions","applyMapActionsToState","mapAction","undoMapActionsToState","undo","resetActions","prevActions","newActions","prevMapState","prevIndex","newIndex","prevMapActions","TOKEN_ATTR_TOPICS","MAX_ID_LENGTH","isRecord","isFiniteNumber","isFinite","isValidVisibility","isValidString","maxLength","isValidLabel","isValidBar","showMinMax","isValidValue","rawValue","isValidPatch","attributes","bars","updatedAt","updatedBy","every","isValidAttributeState","normalizeIncomingUpdate","payload","record","tokenStateId","patch","changeId","applyUpdateToState","incoming","incomingAttributes","nextAttributes","useTokenAttributesSync","mapStateRef","seenChangeIdsRef","Map","registerChangeId","seen","excess","pruneSeenChangeIds","isChangeIdSeen","has","sendTokenAttributesUpdate","sendStream","includeSelf","sendTokenAttributesBulk","updates","handleUpdate","info","handleBulk","normalizedUpdates","normalizeIncomingBulk","nextState","onStream","uint8ToBase64","isView","view","byteOffset","toUint8Array","binary","subarray","String","fromCharCode","btoa","dedupeAssetsPath","replace","RadioIconButton","Select","creatable","Component","Creatable","ReactSelect","menu","provided","isDisabled","control","singleValue","option","dropdownIndicator","container","primary50","primary25","captureMenuScroll","qualitySettings","gridTypeSettings","gridSquareMeasurementTypeSettings","gridHexMeasurementTypeSettings","MapSettings","onSettingsChange","onStateSettingsChange","handleFlagChange","flag","f","mapURL","defaultMapSources","mapSize","setMapSize","toFixed","updateMapSize","mapEmpty","mapStateEmpty","mr","s","isSearchable","isOptionDisabled","Divider","useMapImage","useImage","mapImage","mapImageStatus","loadedMapImage","setLoadedMapImage","usePreventOverscroll","elementRef","preventOverscroll","composedPath","node","HTMLElement","dataset","noteScroll","element","passive","keyboardEmitter","EventEmitter","setMaxListeners","KeyboardContext","keyEmitter","KeyboardProvider","handleKeyDown","HTMLInputElement","HTMLTextAreaElement","handleKeyUp","tabIndex","useKeyboard","onKeyDown","onKeyUp","useBlur","onBlur","singleKey","altKey","ctrlKey","metaKey","shiftKey","hasModifier","toUpperCase","shortcuts","move","moveTool","drawingTool","fogTool","spellTemplateTool","measureTool","pointerTool","textTool","noteTool","gridNudgeUp","gridNudgeLeft","gridNudgeRight","gridNudgeDown","drawBrush","drawPaint","drawLine","drawRect","drawCircle","drawTriangle","drawPen","drawErase","drawBlend","drawFill","fogPolygon","fogRectangle","fogBrush","fogToggle","fogErase","fogLayer","fogPreview","fogCut","fogFinishPolygon","fogCancelPolygon","selectTool","selectPath","selectRect","stageZoomIn","stageZoomOut","stagePrecisionZoom","selectRange","selectMultiple","redo","copy","paste","disableSnapping","duplicate","useStageInteraction","stageRef","stageScale","onStageScaleChange","stageTranslateRef","layerRef","maxZoom","tool","preventInteraction","gesture","isInteractingWithCanvas","pinchPreviousDistanceRef","pinchPreviousOriginRef","zoomSpeed","setZoomSpeed","handleGesture","useGesture","onWheelStart","layer","getCanvas","_canvas","onWheel","stage","last","pixelY","normalizeWheel","newScale","innerHeight","pointer","getPointerPosition","newTranslate","onPinchStart","da","originX","originY","onPinch","distanceDelta","originXDelta","originYDelta","canvasRect","getBoundingClientRect","relativeOrigin","onDragStart","onDrag","delta","pinching","dx","dy","stageTranslate","draw","drag","domTarget","eventOptions","innerWidth","useImageCenter","stageWidth","stageHeight","setStageScale","imageLayerRef","containerRef","imageWidth","imageHeight","responsive","stageRatio","imageRatio","previousDataIdRef","previousStageRatioRef","containerRect","previousDataId","previousStageRatio","shouldUpdate","MapInteractionEmitter","TypedEmitter","StageScaleContext","DebouncedStageScaleContext","StageWidthContext","StageHeightContext","SetPreventMapInteractionContext","MapWidthContext","MapHeightContext","InteractionEmitterContext","MapInteractionProvider","setPreventMapInteraction","interactionEmitter","debouncedStageScale","useInteractionEmitter","useSetPreventMapInteraction","useMapWidth","useMapHeight","useStageScale","useDebouncedStageScale","leftMouseButton","evt","button","defaultValue","gridPixelSize","gridCellPixelSize","gridCellNormalizedSize","gridOffset","gridStrokeWidth","gridCellPixelOffset","gridSnappingSensitivity","GridContext","GridPixelSizeContext","GridCellPixelSizeContext","GridCellNormalizedSizeContext","GridOffsetContext","GridStrokeWidthContext","GridCellPixelOffsetContext","GridSnappingSensitivityContext","GridProvider","inputGrid","setGridPixelSize","setGridCellPixelSize","setGridCellNormalizedSize","setGridOffset","setGridStrokeWidth","setGridCellPixelOffset","_gridPixelSize","baseWidth","baseHeight","getGridPixelSize","_gridCellPixelSize","gridHeight","radiusVert","radiusHorz","getCellPixelSize","_gridCellNormalizedSize","_gridOffset","_gridStrokeWidth","_gridCellPixelOffset","setGridSnappingSensitivity","defaultSnappingSensitivity","useGrid","useGridPixelSize","useGridCellPixelSize","useGridCellNormalizedSize","useGridOffset","useGridStrokeWidth","useGridCellPixelOffset","useGridSnappingSensitivity","KonvaBridge","stageRender","mapStageRef","keyboardValue","useStageWidth","useStageHeight","SettingsContext","ResetMapIcon","GridOnIcon","GridOffIcon","Grid","imageSource","stroke","patternImage","negativeGridOffset","patternProps","fillPatternScaleX","fillPatternScaleY","fillPatternOffsetX","fillPatternOffsetY","fillPatternRotation","fillPatternImage","fillPatternRepeat","strokeWidth","MapGrid","mapLoadingStatus","isImageLight","setIsImageLight","lightPixels","darkPixels","getImageLightness","MapGridEditor","onGridChange","handlePositions","topRight","bottomLeft","getHandlePositions","handlePreviousPositionRef","handleInteractivePointerDown","handleInteractivePointerUp","getHandleInset","handle","previousPosition","getHandleNormalizedPosition","gridDirection","newPosition","nudgeGrid","gridSizeNormalized","nudgeAmount","editCircleRadius","editCircleProps","draggable","onDragMove","onDragEnd","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","editRectProps","MapEditor","setStageWidth","setStageHeight","defaultInset","mapLayerRef","preventMapInteraction","showGridControls","setShowGridControls","mapInteraction","gridChanged","gridValid","layout","touchAction","handleWidth","handleHeight","onResize","targetRef","EditMapModal","onDone","onUpdateMap","onUpdateMapState","applyMapChanges","mapSettingChanges","setMapSettingChanges","mapStateSettingChanges","setMapStateSettingChanges","handleMapSettingsChange","prevChanges","verifiedChanges","selectedMapWithChanges","selectedMapStateWithChanges","pt","pb","px","ConfirmModal","onConfirm","confirmText","description","DatabaseDisabledMessage","gridArea","useImageDrop","onImageDrop","supportFileTypes","addToast","useToasts","dragging","setDragging","imageFiles","html","dataTransfer","getData","urlMatch","altMatch","ok","File","files","dropPosition","clientX","clientY","overlayListeners","onDragLeave","onDragOver","dropEffect","onDrop","containerListeners","ImageDrop","dropText","MapTileImage","MapTile","MapTileGroup","gridGap","gridTemplateRows","DragPositionMonitor","overlayNode","useDndContext","overlayNodeClientRectRef","useDndMonitor","overlayNodeClientRect","nodeRef","DragContext","GroupContext","GroupProvider","itemNames","onGroupsChange","onGroupsSelect","selectedGroupIds","setSelectedGroupIds","selectMode","setSelectMode","openGroupId","setOpenGroupId","openGroupItems","setOpenGroupItems","openGroups","openGroup","setFilter","filteredGroupItems","setFilteredGroupItems","fuse","setFuse","namedItems","Fuse","search","activeGroups","onSelectModeChange","onGroupOpen","onGroupClose","onSubgroupChange","groupIndex","updatedGroups","onGroupSelect","lastIndex","idsToAdd","idsToRemove","onClearSelection","onFilterChange","onFilterClear","useGroup","usePreventSelect","getSelection","removeAllRanges","selection","empty","clearSelection","classList","remove","TileDragIdContext","TileOverGroupIdContext","TileDragCursorContext","GROUP_ID_PREFIX","UNGROUP_ID","ADD_TO_MAP_ID","rectIntersection","rects","rect","offsetLeft","offsetTop","TileDragProvider","onDragAdd","onDragCancel","mouseSensor","useSensor","MouseSensor","activationConstraint","touchSensor","TouchSensor","tolerance","keyboardSensor","KeyboardSensor","sensors","useSensors","dragId","setDragId","overId","setOverId","dragCursor","setDragCursor","preventSelect","resumeSelect","overGroupId","setOverGroupId","active","over","selectedIndices","overGroupIndex","fromId","fromIndex","ungroup","moveGroups","collisionDetection","rectCenter","addRect","ungroupRect","otherRects","closestCenter","useTileDragId","SortableTile","disableGrouping","disableSorting","hidden","isDragging","useSortable","listeners","setDroppableNodeRef","setDraggableNodeRef","setGroupNodeRef","useDroppable","setNodeRef","dragStyle","sortDropStyle","groupDropStyle","LazyTile","useInView","triggerOnce","inView","SortableTiles","renderTile","subgroup","useTileDragCursor","useTileOverGroupId","allSelectedIds","sortableId","renderSortableGroup","selectedGroups","previewGroup","selectedGroupIdsSet","Set","hasSelectedContainerGroup","disableTileGrouping","renderTiles","SortableTilesDragOverlay","dragBounce","wobbly","createPortal","activeIndex","coords","reverse","dropAnimation","renderDragOverlays","MapTiles","onMapEdit","onMapSelect","canOpen","RemoveMapIcon","MapEditBar","currentMap","onMapChange","onMapReset","onLoad","hasMapState","setHasMapState","getSelectedMaps","selectedMapStates","_hasMapState","isMapsRemoveModalOpen","setIsMapsRemoveModalOpen","selectedMaps","selectedMapIds","isMapsResetModalOpen","setIsMapsResetModalOpen","SelectMapSelectButton","ChangeNicknameIcon","GroupNameModal","tmpName","setTempName","Droppable","TilesOverlay","gentle","containerSize","setContinerSize","isGroupNameModalOpen","setIsGroupNameModalOpen","groupName","marginBottom","gap","newName","renameGroup","TilesContainer","AddIcon","large","SelectMultipleIcon","SelectSingleIcon","SearchIcon","Search","borderRight","placeholder","TileActionBar","onAdd","addTitle","outlineOffset","onFocus","imageMimeByExt","jpg","jpeg","png","webp","gif","bmp","svg","getFileNameFromUrl","fallback","segments","pathname","split","Boolean","decodeURIComponent","guessImageMimeFromUrl","toLowerCase","ext","webpMime","mapResolutions","clampQuality","scaleResolutionQuality","baseQuality","resolutionQuality","createMapFromFile","compressionQuality","reject","normalizedQuality","matchAll","gridMatches","matchX","matchY","gridSize","trim","resolutionPixelSize","targetQuality","componentMax","resized","resolvedImage","originalName","thumbnailImage","thumbnailId","compressedImage","fileAsset","createMapFromUrl","loadImage","useCors","crossOrigin","catch","fileName","SelectMapModal","imageCompressionQuality","mapNames","setMapNames","fileInputRef","isLargeImageWarningModalOpen","setShowLargeImageWarning","largeImageWarningFiles","handleImagesUpload","persist","mapFiles","some","handleImageUpload","clearFileInput","handleMapSelect","editingMapId","setEditingMapId","isDraggingMap","setIsDraggingMap","canAddDraggedMap","setCanAddDraggedMap","handleDragAdd","setModalSize","editingMap","editingMapState","shouldCloseOnEsc","accept","multiple","refreshMode","click","SelectMapIcon","SelectMapButton","currentMapState","isModalOpen","setIsModalOpen","FogBrushIcon","FogPolygonIcon","FogRemoveIcon","FogRectangleIcon","FogToggleIcon","FogCutOnIcon","FogCutOffIcon","FogPreviewOffIcon","FogPreviewOnIcon","TokenShowIcon","ToolSection","collapse","tools","onToolClick","showMore","setShowMore","collapsedTool","setCollapsedTool","handleToolClick","renderTool","selectedTool","prevTool","borderTop","borderTopColor","borderLeft","EraseAllIcon","MapMenu","onModalContent","excludeNode","modalContentNode","setModalContentNode","handleDragMove","handleInteraction","contentRef","EraseAllButton","onToolAction","isEraseAllConfirmOpen","setIsEraseAllConfirmOpen","buttonRef","menuLeft","setMenuLeft","menuTop","setMenuTop","Slider","labelFunc","percentValue","labelVisible","setLabelVisible","FogToolSettings","onSettingChange","disabledActions","showGmOpacity","gmOpacity","exploredVisible","previewOnDrag","autoVisionOnDrop","isSmallScreen","drawTools","step","blue","orange","red","yellow","green","pink","teal","black","darkGray","lightGray","white","colorOptions","ColorCircle","selected","ColorControl","onColorChange","exclude","allowCustom","showColorMenu","setShowColorMenu","colorMenuOptions","setColorMenuOptions","palette","displayColor","colorMenu","flexWrap","currentTarget","BlendOnIcon","BlendOffIcon","AlphaBlendToggle","useBlending","onBlendingChange","ShapeFillOnIcon","ShapeFillOffIcon","ShapeFillToggle","useShapeFill","onShapeFillChange","BrushToolIcon","BrushPaintIcon","BrushLineIcon","BrushRectangleIcon","BrushCircleIcon","BrushTriangleIcon","EraseToolIcon","SettingsIcon","PenToolIcon","strokeLinecap","strokeLinejoin","cx","cy","MoveToolIcon","DrawingToolSettings","nextBlending","dashStyle","dashInactive","showAdvancedMenu","setShowAdvancedMenu","advancedMenuOptions","setAdvancedMenuOptions","advancedMenu","next","dash","x1","y1","x2","y2","strokeDasharray","join","SpellTemplateDragToolIcon","RemoveTokenIcon","ruleOptions","SpellTemplateColorControl","SpellTemplateToolSettings","selectedTemplateId","onRemoveSelectedTemplate","hasTemplates","onRemoveAllTemplates","showSettingsMenu","setShowSettingsMenu","settingsMenuOptions","setSettingsMenuOptions","isClearAllConfirmOpen","setIsClearAllConfirmOpen","clearAllButtonRef","clearAllMenuPosition","setClearAllMenuPosition","toolIconSx","selectedRule","rule","settingsMenu","minWidth","flex","lineWidth","coneAngle","ringInnerRatio","previewOnRotate","PointerToolSettings","SelectRectangleIcon","SelectPathIcon","SelectToolSettings","FogToolIcon","MeasureToolIcon","ExpandMoreIcon","FullScreenIcon","NoteToolIcon","NoteTextIcon","SelectToolIcon","PasteIcon","SpellTemplateToolIcon","UndoIcon","UndoButton","RedoIcon","RedoButton","ImageImportContext","ImageImportProvider","openImportFromUrl","MapContols","allowMapChange","selectedToolId","onSelectedToolChange","toolSettings","onToolSettingChange","onUndo","onRedo","isExpanded","setIsExpanded","fullScreen","setFullScreen","imageImport","tokenNoteSettings","tokenNote","trigger","longPressMs","blur","defaultFont","defaultPermission","tokenNoteEnabled","disabledControls","isOwner","allowMapDrawing","allowFogDrawing","allowNoteEditing","disabledSettings","drawing","defaultSpellTemplateSettings","toolsById","select","SettingsComponent","effect","spellTemplates","measure","sections","component","section","Settings","selectedSettings","overflowX","getToolSettings","FullScreenExitIcon","usePreventContextMenu","preventContextMenu","MapInteraction","mapLoaded","setMapLoaded","mapImageRef","overlayLayerRef","previousSelectedToolRef","currentMouseButtons","setCurentMouseButtons","onPinchEnd","first","repeat","overlayLayer","mapLayer","batchDraw","getCursorForTool","listening","hitGraphEnabled","compute","bounded","polygon","sorted","sortPoints","heap","start","a1","a2","insert","extend","shorten","orig","vertex","oldSegment","epsilon","cur","intersectLines","equal","computeViewport","viewportMinCorner","viewportMaxCorner","brokenSegments","viewport","intersections","k","doLineSegmentsIntersect","intersect","endIndex","endDis","dis","viewportSegments","inViewport","eps","breakIntersections","output","destination","parentIndex","parent","lessThan","parentNode","child","index1","index2","inter1","inter2","end1","end2","angle2","a3","atan2","b1","b2","dbx","dby","dax","day","u_b","ua","isOnSegment","xi","yi","xj","yj","xk","yk","computeDirection","x3","y3","x4","y4","d3","d4","wallToSegments","wall","createEllipseSegments","radiusX","radiusY","steps","polygonToPoints","poly","FogOfWarLayer","fogSettings","onExploredChange","tokenPreview","useTokenPreview","baseFogOpacity","fogOpacity","exploredCutOpacity","dimCutOpacity","wallsSignature","wallSegments","flatMap","baseTokens","override","visionSources","range","lightSources","bright","dim","visibilityPolygons","viewportMin","viewportMax","polygons","ellipseSegments","lightBrightPolygons","lightDimPolygons","exploredPolygons","entry","exploredRef","visibilitySignatureRef","visibilitySignature","JSON","stringify","exploredTimeoutRef","newExplored","closed","globalCompositeOperation","getDefaultShapeData","brushPosition","getUpdatedShapeData","gridRatio","scaled","brushPositionPixel","startPixel","atan","sideLength","leftDir","rotateDirection","rightDir","leftDirNorm","rightDirNorm","simplifyPoints","simplify","getRelativePointerPosition","getAbsoluteTransform","invert","getStage","convertPointsToNumbers","acc","scaleAndFlattenPoints","useGridSnapping","snappingSensitivity","useCorners","offsetPosition","nearsetCell","cellPosition","cellCorners","snapPoints","snapPoint","componentMin","Drawing","getDashArray","resolvedColor","blend","tension","pathType","fillEnabled","lineCap","lineJoin","shapeType","minSide","DrawingTool","onShapeAdd","onDrawingAdd","onShapesRemove","onDrawingsRemove","onShapesEdit","onDrawingsEdit","setDrawing","penDrawing","setPenDrawing","isBrushDown","setIsBrushDown","erasingDrawings","setErasingDrawings","shouldHover","isPen","isDrag","isBrush","isShape","snapPositionToGrid","getBrushPosition","mapStage","findOne","handleBrushDown","handleBrushMove","handleBrushUp","commonShapeData","drawingToolIsShape","prevShape","prevPoints","compare","simplified","eraseHoveredShapes","removeLastPenPoint","handlePointerMove","handlePointerClick","finishPenDrawing","handleShapeOver","isDown","prevShapes","renderDrawing","isDraggingEnabled","onMouseMove","onTouchOver","hitStrokeWidth","isRect","isCircle","baseX","baseY","dxPx","dyPx","shiftPoint","updated","handlePenFinish","cancelBubble","handlePenUndo","controlSize","totalWidth","onTap","cornerRadius","renderPenControls","Tick","cross","setFill","scaleX","scaleY","onMouseEnter","onMouseLeave","offsetX","offsetY","WallTool","onWallsAdd","onWallsRemove","editable","drawingWall","setDrawingWall","penWall","setPenWall","erasingWalls","setErasingWalls","isLine","isErase","blocksVision","prevWall","lastPoint","firstPoint","eraseHoveredWalls","finishPenWall","handleWallOver","prevWalls","renderWall","renderDrawingWall","isCross","renderPenAcceptTick","Ruler","linePoints","lineCenter","MeasureTool","drawingShapeData","setDrawingShapeData","gridScale","aCoord","bCoord","aCube","bCube","gridDistance","SpellTemplateShape","template","params","outerRadius","innerRadius","ringWidth","ringRadius","hitWidth","SpellTemplateGridOverlay","cells","cell","toRing","approximateCircle","getMinSide","getTemplatePointsInPixels","half","corner","getTemplateGeom","outer","geoms","end","perpendicular","capSegments","CIRCLE_SEGMENTS","cap","union","buildStrokeGeom","getTemplateBoundingBox","pad","pointInRing","ring","inside","normalizeGeom","geom","pointInGeom","insideHole","polygonArea","area","geomArea","buildCellPolygon","gridCellOffset","cellCenter","formatScaled","formatted","SpellTemplateHud","affectedCells","cursorPosition","minCell","lines","radiusPx","radiusCells","widthPx","heightPx","widthCells","heightCells","lengthPx","lengthCells","preview","suffix","HUD_PADDING","line","DEFAULT_TEMPLATE_SETTINGS","SpellTemplateTool","incomingToolSettings","onTemplateAdd","onTemplateEdit","onSelectedTemplateIdChange","onTemplateDragStateChange","isPointOverTrash","drawingTemplate","setDrawingTemplate","rotatingTemplateId","setRotatingTemplateId","setCursorPosition","ignoreNextDragRef","drawStartRef","rotationStateRef","activeTemplate","templatesById","snapping","getWidthNormalized","widthPixels","createTemplate","base","handleDragStart","handleDragEnd","templateType","prevTemplate","originPixel","currentPixel","handlePointerDoubleClick","handleContextMenu","finishPath","handleCursorMove","handleRotateMove","handleRotateEnd","rotationState","pivot","startAngle","rotated","pixel","nextPixel","resolvedRule","resolveRule","minCoord","maxCoord","minCol","maxCol","minRow","maxRow","affected","cellGeom","cellArea","getAffectedCells","hitTokens","isPointInTemplate","renderRotationHandle","handlePosition","startRotate","finishDrag","nativeEvent","changedTouches","deltaNorm","handleTemplateDragEnd","dragBoundFunc","SpellTemplate","Pointer","duration","trailRef","pointsRef","prevPositionRef","positionRef","circleRef","transparentColorRef","Color","lighten","string","lifetime","prevTime","performance","request","time","deltaTime","expired","getLayer","sceneFunc","drawOffsetLine","forward","side","rotate90","toSize","toOffset","lineTo","beginPath","moveTo","closePath","gradientCenter","gradientEnd","gradientRadius","gradient","createRadialGradient","addColorStop","fillStyle","PointerTool","onPointerDown","onPointerMove","onPointerUp","brushDownRef","relativePosition","getRelativePointerPositionNormalized","NetworkedMapPointer","localPointerState","setLocalPointerState","pointerColor","sessionRef","ownPointerUpdateRef","updateOwnPointerState","handleOwnPointerDown","handleOwnPointerMove","handleOwnPointerUp","counter","volatile","interpolationsRef","handleSocketPlayerPointer","interpolations","interpolatedPointerState","interp","totalInterpTime","usePrevious","TokenStatus","tokenState","statuses","defaultFontSize","TokenLabel","labelSize","paddingY","paddingX","fontScale","setFontScale","textSizerRef","curr","getTextWidth","findFontScale","rectWidth","setRectWidth","textWidth","setTextWidth","textRef","overlayOffset","baseSize","barHeight","barPadding","barCount","availableBarHeight","stackDown","maxBars","barsToShowCount","baseBarY","bottomBarY","labelGap","labelY","wrap","ellipsis","hitFunc","TokenOutline","sharedProps","isVisible","isMapOwner","isTokenOwner","formatNumber","rounded","isInteger","buildValueText","trimmed","TokenAttributeBubble","onBarClick","onValueClick","visibleBars","bar","visibleValues","ringItems","markerRadius","minRingRadius","ringItemsCount","barGap","maxBarWidth","barWidth","barX","barRadius","barsToShow","centerX","centerY","handleBarClick","handleValueClick","barText","currentText","buildBarText","barRatio","currentValue","getBarRatio","baseFontSize","estimatedTextWidth","textScale","barFontSize","barY","align","verticalAlign","clipX","clipY","clipWidth","clipHeight","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","DEFAULT_BAR_COLOR","createEmptyAttributes","buildNextAttributes","nextBars","nextValues","cloneAttributesWithNewIds","parseNumericExpression","rawInput","firstOp","parsed","op","createTokenState","autoEnableVision","defaultAttributes","createTokenFromFile","sizeMatches","createTokenFromUrl","clientPositionToMapPosition","clientPosition","checkMapBounds","querySelector","mapRect","mapPosition","getScaledOutline","tokenWidth","tokenHeight","Intersection","pointInPolygon","DEFAULT_ENABLED_ANCHORS","CustomTransformer","attachments","newAttrs","oldAttrs","_getNodeRect","Konva","Util","_inRange","allowNegativeScale","flipEnabled","Transform","_movingAnchorName","indexOf","_anchorDragOffset","boundBoxFunc","oldTr","translate","newTr","_nodes","forEach","parentTransform","getParent","localTransform","getTransform","newLocalTransform","attrs","decompose","setAttrs","_fire","_getRotation","_resetTransformCache","Transformer","nodes","onTransformStart","onTransform","onTransformEnd","portalSelector","enabledAnchors","resizeEnabled","gridCellAbsoluteSizeRef","transformerRef","resolvedAnchors","resolvedResizeEnabled","transformer","centeredScaling","rotateAnchorOffset","ignoreStroke","borderStroke","anchorStroke","anchorCornerRadius","borderStrokeWidth","anchorSize","portal","destroy","handlePointerDown","handlePointerUp","oldBox","newBox","snapBox","movingAnchor","movingAnchorRef","nearestCellWidth","deltaWidth","deltaHeight","rotator","rotatedMin","snapDelta","rotationSnaps","transformTextRef","handleTransformStart","transformText","Label","tag","Tag","pointerDirection","pointerHeight","pointerWidth","Text","minSize","mapTransform","absoluteSize","updateGridCellAbsoluteSize","updateTransformText","getChildren","nodeRect","getClientRect","skipShadow","nodeScale","nodePosition","absolutePosition","handleTransform","handleTransformEnd","useAnchorImage","anchorScale","anchorScaleStatus","anchorRotate","anchorRotateStatus","setNodes","middleLeft","middleRight","rotater","fillPriority","strokeEnabled","setStatus","ctx","TokenAttachment","Token","onTokenStateChange","onTokenMenuOpen","onTokenMenuClose","onTokenDragStart","onTokenDragEnd","onTokenDragMove","onTokenTransformStart","onTokenTransformEnd","onTokenAttributeCountOpen","transforming","selectable","fadeOnHover","noteModeEnabled","noteTrigger","noteLongPressMs","onTokenNoteOpen","canEditAttributes","tokenURL","tokenImage","tokenAspectRatio","previousDragPositionRef","attachedTokensRef","attachmentOverCharacter","setAttachmentOverCharacter","attachmentCharactersRef","attachmentThreshold","handleClick","noteLongPressTriggeredRef","suppressNoteClickRef","mode","anchor","transformRootRef","tokenOpacity","setTokenOpacity","tokenPointerDownTimeRef","noteLongPressTimerRef","clearNoteLongPress","timeStamp","minCellSize","tokenX","tokenY","previousWidth","previousHeight","skipAnimation","immediate","getAttachedTokens","transformRoot","tokenGroup","attachedTokens","tokenIntersection","characters","other","intersects","attachment","overrideTransformActive","setOverrideTransformActive","transformerActive","transformerAttachments","tokenName","animatedGroupProps","AnimatedGroup","animated","Group","onDblClick","attachedTokenChanges","deltaPosition","overCharacter","character","numeric","tokenChanges","sizeChange","xChange","yChange","TokenHideIcon","TokenAttributeEditor","showHeader","compact","draftInputs","setDraftInputs","openColorPicker","setOpenColorPicker","setDraftInput","clearDraftInput","commitNumberField","onCommit","allowEmpty","appearance","updateBarsValues","updateBar","barId","updateValue","valueId","pickUnusedColor","usedColors","paletteColors","allVisible","showMinMaxAll","headerJustify","blockSpacing","blockPadding","smallFontSize","inputSx","labelSx","dotSize","nextShow","nextVisible","nextBar","nextValue","currentKey","maxKey","maxText","substring","valueKey","valueText","valueColor","TokenLockIcon","TokenUnlockIcon","TokenCharacterIcon","TokenPropIcon","TokenMountIcon","TokenAttachmentIcon","tokenCategories","prop","vehicle","TokenMenu","wasOpen","menuWidth","visionLightOpen","setVisionLightOpen","attributesOpen","setAttributesOpen","sidePanelRef","sidePanelStyle","setSidePanelStyle","sidePanelOpen","imageRect","mapElement","updateSidePanelPosition","panel","maxLeft","maxTop","lightEnabled","lightRadiusBright","lightRadiusDim","lightColor","handleLightChange","hasAttributes","tokenLabelInput","prevLeft","prevTop","handleStatusChange","nextHasVision","nextRange","nextBright","nextDim","handleLightToggle","DragOverlay","onRemove","isRemoveHovered","setIsRemoveHovered","removeTokenRef","handler","pointerPosition","screenSpacePointerPosition","removeIconPosition","transition","TokenDragOverlay","onTokenStateRemove","draggingOptions","attachedTokenStateIds","useMapTokens","onTokensStateCreate","previewOptions","disabledTokens","isTokenMenuOpen","setIsTokenMenuOpen","tokenMenuOptions","setTokenMenuOptions","tokenDraggingOptions","setTokenDraggingOptions","tokenAttributeCountMenu","setTokenAttributeCountMenu","countInput","setCountInput","countError","setCountError","countInputRef","handleTokenMenuOpen","handleTokenMenuClose","handleTokenAttributeCountOpen","anchorX","anchorY","countMenuWidth","closeTokenAttributeCountMenu","handleTokenDragStart","duplicateToken","newStates","enableTokenDragPreview","handleTokenDragEnd","onTokenDragPreviewEnd","setDuplicateToken","transformingTokensIds","setTransformingTokenIds","handleTokenTransformStart","handleTokenTransformEnd","tokenFromTokenState","sortMapTokenStates","propTokens","tokenMenu","expression","updatedBars","idx","updatedValues","commitCountInput","tokenDragOverlay","tokenStateIds","getMapTokenCategoryWeight","aWeight","resolveColor","getNoteContent","getNoteContentFormat","getNoteVisibility","isNoteOwner","canViewByVisibility","visibleByState","canView","canViewText","animatedFactory","Note","onNoteChange","onNoteMenuOpen","onNoteEditOpen","onNoteMenuClose","openOnClick","openOnDoubleClick","allowSingleClickEdit","onNoteDragStart","onNoteDragEnd","noteWidth","noteHeight","notePadding","showKonvaText","usesTextHud","fontScaleMap","xs","sm","md","lg","xl","huge","handleDoubleClick","noteNode","openHandler","noteOpacity","setNoteOpacity","textNode","sizes","ceil","findFontSize","noteRef","isTransforming","setIsTransforming","noteX","noteY","springProps","hasStyle","backgroundMode","backgroundFill","needsHitRect","textColor","noteFontFamily","noteName","onDblTap","noteGroup","shadowOffset","currentStyle","currentScale","nextScale","nextFontScale","closest","closestDistance","POSITIVE_INFINITY","resolveFontScale","nextStyle","NoteDragOverlay","onNoteRemove","noteId","StyledTextareaAutoSize","NoteMenu","onKeyPress","maxRows","handleColorChange","fontOptions","sizeOptions","AdvancedTextHud","draftStyle","canManage","attachMode","onStyleChange","onCommand","onToggleTextVisible","onToggleVisibility","onToggleAttach","hexValue","setHexValue","bold","italic","ul","ol","formatState","setFormatState","colorMenuOpen","setColorMenuOpen","fontMenuOpen","setFontMenuOpen","sizeMenuOpen","setSizeMenuOpen","hudRef","handleSelectionChange","queryCommandState","anyMenuOpen","contains","visibilityLabel","buttonSx","pillButtonSx","menuSx","boxShadow","swatchColor","currentFontLabel","currentSizeLabel","gridTemplateColumns","colorKey","handleHexCommit","attachedToTokenId","NoteEditor","editorRef","autoFocus","widthStyle","paddingStyle","innerHTML","contentEditable","suppressContentEditableWarning","onInput","whiteSpace","wordBreak","paddingLeft","NoteTextOverlay","activeNoteId","draftContent","isEditing","onContentChange","onRequestSizeChange","setTick","frameRef","debouncedContent","scheduleUpdate","activeNote","effectiveStyle","editorNode","scrollWidth","clientWidth","scrollHeight","clientHeight","maxSizePx","nextSize","clampedSize","renderedNotes","fontFactor","hasBackground","dimOpacity","absolute","isActive","transformOrigin","dangerouslySetInnerHTML","__html","BlankNote","NoteTool","onNoteCreate","noteData","setNoteData","creatingNoteRef","isText","defaultNoteStyle","htmlToPlain","textContent","resolveDraftStyle","resolveHtmlContent","escapeHtml","useMapNotes","noteDraggingOptions","setNoteDraggingOptions","isNoteMenuOpen","setIsNoteMenuOpen","noteMenuOptions","setNoteMenuOptions","setActiveNoteId","isHudOpen","setIsHudOpen","setIsEditing","setDraftContent","setDraftStyle","autoFocusEditor","setAutoFocusEditor","setAttachMode","hasEdited","setHasEdited","lastRemoteEditRef","handleNoteMenuOpen","handleTextHudOpen","_noteNode","commitDraftContent","handleNoteMenuClose","handleTextHudClose","handleNoteDragStart","duplicateNote","handleNoteDragEnd","setDuplicateNote","hudNode","getIntersection","handleContentChange","resolveAttachedNote","resolvedNotes","sortNotes","noteMenuEnabled","textHudEnabled","allowDoubleClickEdit","noteMenu","noteHud","command","execCommand","noteTextOverlay","noteDragOverlay","noteIds","onSelectionItemsRemove","tokenIds","CopyIcon","getSelectionPoints","ColorSchema","$id","anyOf","enum","pattern","Vector2Schema","Ajv","compile","properties","required","DrawingSchema","$ref","definitions","PointsData","RectData","CircleData","BaseDrawing","BaseShape","allOf","Line","Rectangle","Circle","Triangle","Shape","Path","FogSchema","schemas","FogData","NoteSchema","nullable","TokenNoteSchema","owners","lastEditedAt","editingBy","SpellTemplateSchema","OutlineSchema","CircleOutline","RectOutline","PathOutline","TokenStateSchema","TokenCategory","LightConfig","TokenAttributeVisibility","TokenAttributeBar","TokenAttributeValue","TokenAttributeState","BaseTokenState","DefaultTokenState","FileTokenState","WallSchema","MapStateSchema","TokenStates","propertyNames","additionalProperties","DrawingState","FogState","SpellTemplateState","Notes","TokenNotes","WallState","ExploredState","minItems","maxItems","isMapState","SelectionSchema","SelectionItemType","SelectionItem","BaseSelection","RectSelection","PathSelection","isSelection","SelectionMenu","effectMode","onRequestOpen","onSelectionChange","onSelectionItemsChange","onSelectionItemsCreate","selectionMenuWidth","menuPosition","openOnDownRef","downPositionRef","updateSelectedItems","noteChanges","MouseEvent","HTMLCanvasElement","itemsVisible","setItemsVisible","itemsLocked","setItemsLocked","effectLabel","setEffectLabel","effectExpression","setEffectExpression","addSuccessToast","numTokens","numNotes","tokenText","noteText","allLocked","localClipboardDataRef","handleCopy","handlePaste","clipboardText","parse","clipboardData","normalizedPosition","clipboardSelection","selectionDelta","clipboardState","tokenStates","selectionItems","barIndex","existing","Selection","onPreventSelectionChange","onSelectionDragStart","onSelectionDragEnd","intersectingNodesRef","initialDragPositionRef","hasItems","lineRef","rectRef","dashOffset","initialX","initialY","itemPosition","onMouseOut","SelectTool","onSelectionMenuOpen","disabledNotes","preventSelectionRef","prevSelection","tokensGroups","notesGroups","intersectingItems","prevent","useMapSelection","isSelectionMenuOpen","setIsSelectionMenuOpen","isSelectionDragging","setIsSelectionDragging","setSelection","handleSelectionItemsRemove","duplicateSelection","setDuplicateSelection","selectionTool","selectionMenu","selectionDragOverlay","SelectionDragOverlay","TOKEN_NOTE_LOCK_TOPICS","TokenOutlineSVG","preserveAspectRatio","TokenImage","defaultTokenSources","showOutline","setShowOutline","TokenNoteEditor","showToolbar","editor","useEditor","extensions","StarterKit","onUpdate","activeEditor","getHTML","commands","setContent","emitUpdate","setEditable","chain","toggleBold","run","can","toggleItalic","toggleStrike","overflowY","overscrollBehavior","scrollbarWidth","TokenNoteSheet","canRead","lockOwnerId","lockReleaseReason","onToggleExpanded","onRequestEdit","onEditorBlur","useColorMode","colorMode","sheetRef","isLocked","releaseMessage","blurAmount","sheetHeight","fontSizeValue","headerTitle","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","backdropFilter","WebkitBackdropFilter","alignSelf","onWheelCapture","onTouchMove","onTouchMoveCapture","nextTarget","relatedTarget","TokenNotePopover","anchorNode","onRequestExpand","popoverRef","anchorRectRef","setLeft","setTop","nextLeft","nextTop","anchorRect","desiredLeft","desiredTop","clampedLeft","clampedTop","LOCK_TTL_MS","useTokenNotes","onTokenNoteCreate","onTokenNoteChange","onTokenNoteRemove","lockState","setLockState","setLockReleaseReason","lockStateRef","openTokenStateIdRef","mapIdRef","userIdRef","canEditRef","draftContentRef","draftStyleRef","lastActivityRef","lockRequestAtRef","lockExpiryTimeoutRef","inactivityTimeoutRef","touchIntervalRef","releaseLockRef","previousOpenTokenStateIdRef","openTokenStateId","setOpenTokenStateId","openMode","setOpenMode","setAnchorNode","createdRef","noteOwners","isExplicitOwner","isLockOwner","ownerUserId","isEditingActive","isStyleEqual","clearLockTimers","scheduleLockExpiry","expiresAt","emitStream","topic","emitLockRequest","currentUserId","clientLockId","ts","emitLockGranted","emitLockDenied","emitLockTouch","lockId","lastTouchAt","emitUnlock","emitLockReleased","commitDraftIfNeeded","currentNote","nextContent","releaseLock","unlockPayload","registerActivity","handleRequestClose","newNote","previous","handleLockRequest","handleLockGranted","handleLockDenied","handleLockTouch","handleUnlock","handleLockReleased","tokenNoteSheet","tokenNotePopover","openTokenNote","onMapTokenStateChange","onMapTokenStateRemove","onMapTokensStateCreate","onMapStateChange","onMapDraw","onWallDraw","onMapTemplateDraw","onMapNoteCreate","onMapNoteChange","onMapNoteRemove","onMapTokenNoteCreate","onMapTokenNoteChange","onMapTokenNoteRemove","setSelectedToolId","setSelectedTemplateId","isTemplateDragging","setIsTemplateDragging","templateTrashRef","tokenDragPreview","setTokenDragPreview","tokenDragPreviewEnabled","tokenDragPreviewActive","handleTokenDragPreviewChange","handleTokenDragPreviewEnd","wallShapes","templateShapes","templateTokens","handleTemplateRemove","templateIds","handleRemoveSelectedTemplate","MapControls","prevSettings","trash","TokenBarToken","objectFit","Draggable","useDraggable","GroupIcon","TokenBarTokenGroup","setIsOpen","renderToken","clickDownPositionRef","handleOpenClick","newOpen","clickPosition","categorySettings","TokenSettings","tokenEmpty","showDefaultAttributes","setShowDefaultAttributes","TokenPreview","tokenSourceImage","tokenStageRef","tokenLayerRef","showGridPreview","setShowGridPreview","EditTokenModal","onUpdateToken","applyTokenChanges","tokenSettingChanges","setTokenSettingChanges","selectedTokenWithChanges","TokenTile","onTokenEdit","TokenTileGroup","TokenHiddenBadge","TokenTiles","TokenEditBar","allTokensVisible","setAllTokensVisisble","getSelectedTokens","selectedTokens","isTokensRemoveModalOpen","setIsTokensRemoveModalOpen","selectedTokenIds","hideTitle","handleTokensHide","SelectTokensModal","tokenNames","setTokenNames","tokenFiles","editingTokenId","setEditingTokenId","isDraggingToken","setIsDraggingToken","handleTokensAddToMap","newTokenStates","editingToken","SelectTokensButton","SelectTokensIcon","TokenBar","groupTokens","dragGroup","dragRect","autoScroll","GlobalImageDrop","droppedImagesRef","dropPositionRef","droppingType","setDroppingType","isUrlModalOpen","setUrlModalOpen","externalUrl","setExternalUrl","externalType","setExternalType","isUrlModalDragActive","setUrlModalDragActive","supportedFileTypes","isHttpUrl","protocol","extractFirstUrl","getSupportedFiles","nextFiles","queueImportFromFiles","handleMaps","handleTokens","handleUrlModalClose","trimmedUrl","handleExternalUrlImport","onPaste","getAsFile","pastedUrl","droppedUrl","uriUrl","textUrl","extractUrlFromDataTransfer","normalizeMapState","NetworkedMapAndTokens","setCurrentMap","assetManifest","setAssetManifest","loadAssetManifestFromMap","processedTokens","qualityId","addAssetsIfNeeded","prevManifest","newAssets","assetApiBase","brokerUrl","normalizeAssetBase","resolveRemoteUrl","baseRoot","raw","uploadAsset","method","headers","credentials","json","downloadAsset","finalUrl","useAssetTransfer","requestingAssetsRef","pendingAssetTimeoutsRef","assetDownloadFailuresRef","ownerEntry","ownerSessionId","ownerState","cachedAsset","targetSessionId","sendAssetTo","allowRelayFallback","existingTimeout","requestAssetsIfNeeded","debouncedMapState","handleMapChange","newMap","newMapState","addActions","updateActionIndex","previousMapIdRef","handleMapTokensStateCreate","buildAttributeUpdate","currentAttributes","baseBars","baseValues","currentVersion","requestedVersion","nextVersion","nextUpdatedBy","normalizedAttributes","updateInput","handlePeerData","peer","peerId","assetFromServer","isNetworkError","previousFailures","failureCount","forceRelay","pendingTimeout","handlePeerDataProgress","handleSocketMap","handleTokenPositions","nextTokens","handleExploredReset","canChangeMap","normalizedChanges","attributeUpdates","nextChange","allowedKeys","isTokenPositionOnly","normalizedTokenChanges","tokenEdits","tokenAction","noteEdits","noteAction","nextTokenNotes","AddPartyMemberModal","AddPartyMemberIcon","AddPartyMemberButton","isAddModalOpen","setIsAddModalOpen","DiceRollsIcon","DiceRoll","diceIcons","Icon","DiceRolls","expanded","setExpanded","expandedRolls","Nickname","ChangeNicknameModal","onChangeSubmit","ChangeNicknameButton","isChangeModalOpen","setIsChangeModalOpen","closeModal","changedNickname","setChangedNickname","SelectDataModal","databaseName","setMaps","tokensByMap","setTokensByMap","setTokens","hasMaps","hasTokens","addons","loadedMaps","loadedTokensByMap","loadedTokens","each","mapGroup","loadData","tokenUsedCount","setTokenUsedCount","getCheckedGroups","checkedGroups","handleMapsChanged","prevMaps","newMaps","tokensSelectChecked","prevTokens","newTokens","tempUsedCount","handleTokensChanged","tokensUsed","renderGroupContainer","renderItem","onGroupChange","renderMapGroup","pl","renderTokenGroup","checkedMaps","checkedTokens","checkedMapGroups","checkedTokenGroups","importDBName","MissingAssetError","ImportExportModal","setError","backgroundTaskRunningRef","showImportSelector","setShowImportSelector","showExportSelector","setShowExportSelector","mapText","addWarningToast","autoDismiss","handleDBProgress","completedRows","totalRows","importData","importDB","newTokenIds","newAssetIds","oldAssetIds","newMapIds","tokensToAdd","newFileId","newThumbnailId","itemName","itemId","assetType","mapIds","mapsToAdd","newResolutionIds","assetsToAdd","processedAssetIds","unprocessedAssets","unprocessedMaps","unprocessedTokens","unprocessedItems","unprocessedItem","stateIndex","newMapGroups","newTokenGroups","transaction","totalImportedMaps","totalImportedTokens","exportData","saveAs","handleBeforeUnload","returnValue","handleImportDatabase","SettingsModal","isDeleteModalOpen","setIsDeleteModalOpen","setLabelSize","showFogGuides","setShowFogGuides","fogEditOpacity","setFogEditOpacity","setImageCompressionQuality","setTokenNoteEnabled","tokenNoteTrigger","setTokenNoteTrigger","tokenNoteLongPressMs","setTokenNoteLongPressMs","tokenNoteBlur","setTokenNoteBlur","tokenNoteFontSize","setTokenNoteFontSize","tokenNoteDefaultFont","setTokenNoteDefaultFont","tokenNoteDefaultPermission","setTokenNoteDefaultPermission","storageEstimate","setStorageEstimate","isImportExportModalOpen","setIsImportExportModalOpen","localStorage","clear","inUse","persisted","isFirefox","estimate","estimateStorage","setColorMode","tokenNoteTriggerOptions","tokenNoteBlurOptions","tokenNoteFontSizeOptions","tokenNoteFontOptions","tokenNotePermissionOptions","marginRight","prettyBytes","usage","quota","SettingsButton","isSettingsModalOpen","setIsSettingsModalOpen","MILLISECONDS_IN_HOUR","MILLISECONDS_IN_MINUTE","StartTimerModal","onTimerStart","onTimerStop","hour","setHour","minute","setMinute","second","setSecond","inputStyle","parseValue","num","timerHMS","workingDuration","getDurationHMS","StartTimerIcon","StartTimerButton","isTimerModalOpen","setIsTimerModalOpen","usePortal","rootElemRef","existingParent","parentElem","rootContainer","setAttribute","createRootElement","rootElem","lastElementChild","insertBefore","nextElementSibling","addRootElement","appendChild","childNodes","Timer","previousTime","timerContainer","ReactDOM","ExpandMoreDiceIcon","DiceTrayOverlay","lazy","DiceTrayButton","shareDice","onShareDiceChange","onDiceRollsChange","Suspense","Party","usePlayerUpdater","usePlayerState","setShareDice","newTimer","newNickname","newShareDice","newDiceRolls","NetworkedParty","joinedPlayersRef","handlePlayerJoined","handlePlayerLeft","MAX_CHUNK_SIZE","AssetTransport","peers","incomingChunks","iceServers","icePromise","webrtcUnavailable","RTCPeerConnection","markWebRtcUnavailable","eventId","chunkId","isAvailable","ensurePeer","lastFailureAt","waitForChannel","timeoutMs","channel","sendChunks","log","sdp","acceptOffer","acceptAnswer","candidate","acceptIce","pc","cleanupIncomingChunks","removePeer","role","loadIceServers","localId","getLocalId","isInitiator","pendingCandidates","onicecandidate","localCandidateType","candidateType","sendSignal","onconnectionstatechange","connectionState","oniceconnectionstatechange","iceConnectionState","onicegatheringstatechange","iceGatheringState","onicecandidateerror","errorCode","errorText","createDataChannel","attachChannel","createOffer","ondatachannel","binaryType","onopen","readyResolve","onclose","onmessage","handleChannelMessage","offer","setLocalDescription","localDescription","setRemoteDescription","createAnswer","answer","flushPendingIce","remoteCandidateType","remoteDescription","addIceCandidate","readyState","readyPromise","race","compressed","deflate","chunks","encoded","send","normalizePayload","decoded","decode","chunkState","reply","replyData","replyChunkId","onPeerDataProgress","mergeChunks","decompressed","inflate","onPeerData","totalLength","buf","fetchIceServers","servers","STREAM_EVENT","STREAM_CHUNK_EVENT","topicRegex","textEncoder","TextEncoder","textDecoder","TextDecoder","isValidStreamTopic","normalizeIncomingEnvelope","enc","comp","meta","normalizedChunk","normalizedData","coerceUint8Array","normalizedMeta","normalizedFrom","buildStreamFrames","encoding","encodeData","compressThreshold","chunkSize","frames","decodeStreamEnvelope","envelope","dataOverride","decodeData","Session","_incomingChunks","_incomingStreamChunks","_gameId","_password","assetTransport","streamDebugEnabled","cleanupIncomingStreamChunks","handleJoinedGame","handleGameExpired","handleAuthError","handleForceUpdate","disconnect","handleSocketDisconnect","dispose","handleSocketReconnect","sendBuffer","joinGame","handleRelayChunk","sendTo","handleStreamEnvelope","debug","enableStreamDebug","disableStreamDebug","handleWebRtcOffer","handleOffer","handleWebRtcAnswer","handleAnswer","handleWebRtcIce","handleIce","installStreamDebugConsole","withCredentials","parser","msgParser","transports","registerSocketHandlers","sentViaP2P","frame","globalScope","OBRStreamDebug","__attached","__session","enable","disable","help","Game","useParams","sessionStatus","setSessionStatus","maintenance","setMaintenance","handleStatus","gameExpired","setGameExpired","connect","newPassword","About","defaultMaps","customMaps","editingMapsAdvanced","resetAndRemovingMaps","usingDrawing","openDiceTray","diceRolling","diceStyles","diceTraySize","usingFog","usingMeasure","defaultTokens","workingWithTokens","deletingTokens","customTokens","tokenEditor","addPartyMember","changeNickname","sharingAudio","startGame","diceSharing","usingTimer","usingPointer","mapEditor","filteringMaps","groupAndRemovingTokens","filteringTokens","usingNotes","FAQ","Accordion","defaultOpen","setOpen","ReleaseNotes","useLocation","hash","HowTo","getToastAppearance","colour","CustomToast","ToastProvider","components","Toast","autoDismissTimeout","placement","App","hostname","setAppElement","render","getElementById","serviceWorker","ready","then","registration","unregister","upgradeFunction","setAll","getAll","newSettings","__version","settingsProvider","useEdgeSnapping","useFogCut","game","multilayer","showGuides","editOpacity","getSettings","SettingsProvider","reader","FileReader","onLoadEnd","Buffer","readAsArrayBuffer"],"mappings":"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ACA,aACA,gBACA,eACA,gBACA,cACA,iBACA,SACA,MACA,WACA,WACA,iBACA,gBACA,WACA,OACA,SACA,SACA,QACA,SACA,iBACA,eACA,WACA,MACA,gBACA,QACA,YACA,aACA,gBACA,YACA,aACA,OACA,aACA,aACA,UACA,UACA,QACA,MACA,UACA,cACA,UACA,QACA,aACA,UACA,cACA,aACA,WACA,oBACA,SACA,OACA,YACA,eACA,UACA,aACA,YACA,aACA,OACA,OACA,YACA,qBACA,SACA,eACA,cACA,gBACA,SACA,SACA,OACA,QACA,QACA,UACA,cACA,QACA,kBACA,UACA,WACA,MACA,UACA,WACA,QACA,iBACA,aACA,cACA,eACA,eACA,OACA,cACA,WACA,kBACA,QACA,QACA,QACA,YACA,eACA,YACA,aACA,kBACA,0BACA,aACA,kBACA,cACA,YACA,oBACA,aACA,aACA,cACA,eACA,gBACA,YACA,wBACA,YACA,iBACA,kBACA,cACA,eACA,aACA,gBACA,aACA,eACA,oBACA,oBACA,WACA,YACA,QACA,OACA,SACA,SACA,YACA,YACA,QACA,UACA,WACA,QACA,gBACA,aACA,QACA,OACA,aACA,SACA,aACA,aACA,YACA,aACA,eACA,eACA,QACA,QACA,YACA,aACA,MACA,UACA,oBACA,aACA,SACA,eACA,SACA,SACA,SACA,QACA,SACA,OACA,OACA,SACA,aACA,OACA,eACA,SACA,UACA,YACA,WACA,UACA,SACA,UACA,SACA,QACA,WACA,oBACA,OACA,QACA,aACA,aACA,YACA,YACA,QACA,cACA,UACA,OACA,cACA,MACA,MACA,SACA,MACA,UACA,UACA,UACA,eACA,YACA,WACA,eACA,kBACA,aACA,OACA,SACA,eACA,cACA,SACA,UACA,WACA,MACA,QACA,aACA,WACA,aACA,eACA,MACA,QACA,oBACA,eACA,sBACA,WACA,aACA,QACA,WACA,QACA,UACA,YACA,SACA,kBACA,kBACA,WACA,WACA,QACA,UACA,SACA,cACA,SAC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","file":"static/js/main.86adb3ea.chunk.js","sourcesContent":["import React from \"react\";\nimport { Flex, IconButton, Box, Text, Badge } from \"theme-ui\";\n\nimport EditTileIcon from \"../../icons/EditTileIcon\";\n\ntype TileProps = {\n  title: string;\n  isSelected: boolean;\n  onSelect: () => void;\n  onEdit: () => void;\n  onDoubleClick: () => void;\n  canEdit: boolean;\n  badges: React.ReactChild[];\n  editTitle: string;\n  children: React.ReactNode;\n};\n\nfunction Tile({\n  title,\n  isSelected,\n  onSelect,\n  onEdit,\n  onDoubleClick,\n  canEdit,\n  badges,\n  editTitle,\n  children,\n}: TileProps) {\n  return (\n    <Box\n      sx={{\n        position: \"relative\",\n        width: \"100%\",\n        height: \"0\",\n        paddingTop: \"100%\",\n        borderRadius: \"4px\",\n        overflow: \"hidden\",\n        userSelect: \"none\",\n      }}\n      bg=\"background\"\n      onClick={(e) => {\n        e.stopPropagation();\n        onSelect();\n      }}\n      onDoubleClick={onDoubleClick}\n      aria-label={title}\n    >\n      <Box\n        sx={{\n          width: \"100%\",\n          height: \"100%\",\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n        }}\n      >\n        {children}\n      </Box>\n      <Flex\n        sx={{\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background:\n            \"linear-gradient(to bottom, rgba(0,0,0,0) 70%, rgba(0,0,0,0.65) 100%);\",\n          alignItems: \"flex-end\",\n          justifyContent: \"center\",\n        }}\n        p={2}\n      >\n        <Text\n          as=\"p\"\n          variant=\"heading\"\n          color=\"hsl(210, 50%, 96%)\"\n          sx={{ textAlign: \"center\" }}\n        >\n          {title}\n        </Text>\n      </Flex>\n      <Box\n        sx={{\n          width: \"100%\",\n          height: \"100%\",\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          borderColor: \"primary\",\n          borderStyle: isSelected ? \"solid\" : \"none\",\n          borderWidth: \"4px\",\n          pointerEvents: \"none\",\n          borderRadius: \"4px\",\n        }}\n      />\n      <Flex\n        sx={{\n          position: \"absolute\",\n          top: \"6px\",\n          left: \"6px\",\n        }}\n      >\n        {badges.map((badge, i) => (\n          <Badge\n            m=\"2px\"\n            key={i}\n            bg=\"overlay\"\n            color=\"text\"\n            sx={{ width: \"fit-content\" }}\n          >\n            {badge}\n          </Badge>\n        ))}\n      </Flex>\n      {canEdit && (\n        <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\n          <IconButton\n            aria-label={editTitle}\n            title={editTitle}\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              onEdit();\n            }}\n            bg=\"overlay\"\n            sx={{ borderRadius: \"50%\" }}\n            m={2}\n          >\n            <EditTileIcon />\n          </IconButton>\n        </Box>\n      )}\n    </Box>\n  );\n}\n\nTile.defaultProps = {\n  title: \"\",\n  isSelected: false,\n  onSelect: () => {},\n  onEdit: () => {},\n  onDoubleClick: () => {},\n  size: \"medium\",\n  canEdit: false,\n  badges: [],\n  editTitle: \"Edit\",\n  columns: \"1fr\",\n};\n\nexport default Tile;\n","import Modal from \"react-modal\";\nimport { useThemeUI, Close } from \"theme-ui\";\nimport { RequestCloseEventHandler } from \"../../types/Events\";\nimport CSS from \"csstype\";\n\ntype BannerProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  children: React.ReactNode;\n  allowClose: boolean;\n  backgroundColor?: CSS.Property.Color;\n};\n\nfunction Banner({\n  isOpen,\n  onRequestClose,\n  children,\n  allowClose,\n  backgroundColor,\n}: BannerProps) {\n  const { theme } = useThemeUI();\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{\n        overlay: { bottom: \"0\", top: \"initial\", zIndex: 2000 },\n        content: {\n          backgroundColor:\n            backgroundColor || (theme.colors?.highlight as CSS.Property.Color),\n          color: \"hsl(210, 50%, 96%)\",\n          top: \"initial\",\n          left: \"50%\",\n          right: \"initial\",\n          // Offset for iOS safe zone\n          bottom: \"env(safe-area-inset-bottom)\",\n          border: \"none\",\n          padding: \"8px\",\n          margin: \"8px 0\",\n          paddingRight: allowClose ? \"24px\" : \"8px\",\n          maxWidth: \"500px\",\n          transform: \"translateX(-50%)\",\n        },\n      }}\n    >\n      {children}\n      {allowClose && (\n        <Close\n          m={0}\n          sx={{ position: \"absolute\", top: \"4px\", right: 0 }}\n          onClick={onRequestClose}\n        />\n      )}\n    </Modal>\n  );\n}\n\nBanner.defaultProps = {\n  allowClose: true,\n};\n\nexport default Banner;\n","function EditTileIcon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\" />\n    </svg>\n  );\n}\n\nexport default EditTileIcon;\n","import { Box, Text } from \"theme-ui\";\n\nimport Banner from \"./Banner\";\n\nimport { RequestCloseEventHandler } from \"../../types/Events\";\n\ntype ErrorBannerProps = {\n  error: Error | undefined;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction ErrorBanner({ error, onRequestClose }: ErrorBannerProps) {\n  return (\n    <Banner isOpen={!!error} onRequestClose={onRequestClose}>\n      <Box p={1}>\n        <Text as=\"p\" variant=\"body2\">\n          Error: {error && error.message}\n        </Text>\n      </Box>\n    </Banner>\n  );\n}\n\nexport default ErrorBanner;\n","/**\n * A faked local or session storage used when the user has disabled storage\n */\nclass FakeStorage {\n  data: { [keyName: string]: any } = {};\n  key(index: number) {\n    return Object.keys(this.data)[index] || null;\n  }\n  getItem(keyName: string) {\n    return this.data[keyName] || null;\n  }\n  setItem(keyName: string, keyValue: any) {\n    this.data[keyName] = keyValue;\n  }\n  removeItem(keyName: string) {\n    delete this.data[keyName];\n  }\n  clear() {\n    this.data = {};\n  }\n}\n\nexport default FakeStorage;\n","import { InstancedMesh, TransformNode } from \"@babylonjs/core\";\nimport { Vector3 } from \"@babylonjs/core/Maths/math\";\n\nimport { DiceMesh, DiceRoll } from \"../types/Dice\";\n\n/**\n * Find the number facing up on a mesh instance of a dice\n * @param {Object} instance The dice instance\n */\nexport function getDiceInstanceRoll(instance: InstancedMesh) {\n  let highestDot = -1;\n  let highestLocator: TransformNode | undefined = undefined;\n  for (let locator of instance.getChildTransformNodes()) {\n    let dif = locator\n      .getAbsolutePosition()\n      .subtract(instance.getAbsolutePosition());\n    let direction = dif.normalize();\n    const dot = Vector3.Dot(direction, Vector3.Up());\n    if (dot > highestDot) {\n      highestDot = dot;\n      highestLocator = locator;\n    }\n  }\n  if (highestLocator) {\n    return parseInt(highestLocator.name.slice(12));\n  } else {\n    return 0;\n  }\n}\n\n/**\n * Find the number facing up on a dice object\n */\nexport function getDiceRoll(dice: DiceMesh) {\n  let number = getDiceInstanceRoll(dice.instance);\n  // If the dice is a d100 add the d10\n  if (dice.d10Instance) {\n    const d10Number = getDiceInstanceRoll(dice.d10Instance);\n    // Both zero set to 100\n    if (d10Number === 0 && number === 0) {\n      number = 100;\n    } else {\n      number += d10Number;\n    }\n  } else if (dice.type === \"d10\" && number === 0) {\n    number = 10;\n  }\n  return { type: dice.type, roll: number };\n}\n\nexport function getDiceRollTotal(diceRolls: DiceRoll[]) {\n  return diceRolls.reduce((accumulator: number, dice) => {\n    if (dice.roll === \"unknown\") {\n      return accumulator;\n    } else {\n      return accumulator + dice.roll;\n    }\n  }, 0);\n}\n","export function omit(obj: Record<PropertyKey, any>, keys: string[]) {\n  let tmp: Record<PropertyKey, any> = {};\n  for (let [key, value] of Object.entries(obj)) {\n    if (keys.includes(key)) {\n      continue;\n    }\n    tmp[key] = value;\n  }\n  return tmp;\n}\n\nexport function fromEntries(iterable: Iterable<[string | number, any]>) {\n  if (Object.fromEntries) {\n    return Object.fromEntries(iterable);\n  }\n  return [...iterable].reduce(\n    (obj: Record<string | number, any>, [key, val]) => {\n      obj[key] = val;\n      return obj;\n    },\n    {}\n  );\n}\n\n// Check to see if all tracks are muted\nexport function isStreamStopped(stream: MediaStream): boolean {\n  // TODO: Check what this thing actually does\n  return stream.getTracks().reduce((a, b) => a && b, { muted: true }).muted;\n}\n\nexport function roundTo(x: number, to: number): number {\n  return Math.round(x / to) * to;\n}\n\nexport function floorTo(x: number, to: number): number {\n  return Math.floor(x / to) * to;\n}\n\nexport function toRadians(angle: number): number {\n  return angle * (Math.PI / 180);\n}\n\nexport function toDegrees(angle: number): number {\n  return angle * (180 / Math.PI);\n}\n\nexport function lerp(a: number, b: number, alpha: number): number {\n  return a * (1 - alpha) + b * alpha;\n}\n\n// Console log an image\nexport function logImage(url: string, width: number, height: number): void {\n  const style = [\n    \"font-size: 1px;\",\n    `padding: ${height}px ${width}px;`,\n    `background: url(${url}) no-repeat;`,\n    \"background-size: contain;\",\n  ].join(\" \");\n  console.log(\"%c \", style);\n}\n\nexport function isEmpty(obj: Object): boolean {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n\nexport function keyBy<Type extends Record<PropertyKey, any>>(\n  array: Type[],\n  key: string\n): Record<string, Type> {\n  return array.reduce(\n    (prev, current) => ({\n      ...prev,\n      [key ? current[key] : current]: current,\n    }),\n    {}\n  );\n}\n\nexport function groupBy(array: Record<PropertyKey, any>[], key: string) {\n  return array.reduce((prev: Record<string, any[]>, current) => {\n    const k = current[key];\n    (prev[k] || (prev[k] = [])).push(current);\n    return prev;\n  }, {});\n}\n\nexport const isMacLike = /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);\n\nexport const isSafari = /^((?!chrome|android).)*safari/i.test(\n  navigator.userAgent\n);\n\nexport function shuffle<Type>(array: Type[]) {\n  let temp = [...array];\n  var currentIndex = temp.length,\n    randomIndex;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex--;\n\n    // And swap it with the current element.\n    [temp[currentIndex], temp[randomIndex]] = [\n      temp[randomIndex],\n      temp[currentIndex],\n    ];\n  }\n\n  return temp;\n}\n\n/**\n * Check that read and write permission is granted for clipboard.\n * If permission has yet to be granted or denied request it.\n * This will also return false if the browser does not support reading\n * and writing to the clipboard e.g. for Safari or Firefox\n */\nexport async function clipboardSupported(): Promise<boolean> {\n  // Reason: we're already handling the case where clipboard-read is not supported\n  // @ts-ignore\n  if (navigator.clipboard?.readText && navigator.clipboard?.writeText) {\n    if (navigator.permissions) {\n      // @ts-ignore\n      let query = await navigator.permissions.query({ name: \"clipboard-read\" });\n      if (query.state === \"prompt\") {\n        try {\n          await navigator.clipboard.readText();\n          // @ts-ignore\n          query = await navigator.permissions.query({ name: \"clipboard-read\" });\n          // Wait 300ms before returning when permission has been accepted to prevent immediate calls\n          // to the clipboard api to fail with a document not focused error\n          await timeout(300);\n        } catch {\n          return false;\n        }\n      }\n      return query.state === \"granted\";\n    }\n  }\n  return false;\n}\n\nexport function timeout(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n","function D20Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M13.014 1.292l7.98 4.577A2 2 0 0122 7.604v8.767a2 2 0 01-.997 1.73l-7.978 4.626a2 2 0 01-2.003.002L3.001 18.1A2 2 0 012 16.369V7.58a2 2 0 011.013-1.74l8.019-4.553a2 2 0 011.982.004zm-.995 1.736L4 7.58v8.788l8.021 4.628L20 16.37V7.604l-7.981-4.576zm3.504 5.256c.491 0 .894.06 1.21.181.315.121.572.278.771.472.2.194.356.397.47.611.115.214.207.463.277.748.136.543.204 1.109.204 1.698 0 1.322-.224 2.289-.672 2.901-.448.613-1.22.92-2.314.92-.614 0-1.11-.099-1.488-.294a2.407 2.407 0 01-.931-.86c-.176-.268-.313-.634-.41-1.1a7.506 7.506 0 01-.147-1.542c0-1.384.25-2.353.749-2.906.499-.553 1.26-.83 2.281-.83zm-6.887 0c.713 0 1.268.08 1.665.243.396.162.708.412.935.748.227.336.341.713.341 1.13 0 .444-.13.867-.39 1.271-.261.404-.735.848-1.421 1.332-.409.281-.681.478-.82.59-.137.113-.299.26-.484.443h3.165v1.649H5.545l.039-.255c.094-.505.293-.984.596-1.436.353-.529 1.016-1.152 1.988-1.87.594-.441.974-.775 1.14-1.004.166-.228.249-.445.249-.65a.76.76 0 00-.247-.57.86.86 0 00-.62-.235.864.864 0 00-.634.243c-.164.162-.274.449-.33.86l-2.031-.165.038-.236c.084-.458.218-.823.4-1.097.212-.32.511-.565.898-.735.386-.17.921-.256 1.605-.256zm6.818 1.346c-.335 0-.578.17-.727.51-.15.338-.224.967-.224 1.884 0 .927.082 1.56.247 1.9.164.34.402.51.714.51a.75.75 0 00.535-.217c.15-.144.262-.372.333-.683.071-.311.107-.796.107-1.455 0-.967-.082-1.617-.246-1.95-.165-.333-.41-.5-.74-.5z\" />\n    </svg>\n  );\n}\n\nexport default D20Icon;\n","function D12Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12.297 2.037l5.578 1.734a1 1 0 01.5.35l3.421 4.504A1 1 0 0122 9.23v5.54a1 1 0 01-.204.605l-3.422 4.504a1 1 0 01-.5.35l-5.577 1.734a1 1 0 01-.594 0l-5.578-1.734a1 1 0 01-.5-.35l-3.421-4.504A1 1 0 012 14.77V9.23a1 1 0 01.204-.605L5.626 4.12a1 1 0 01.5-.35l5.577-1.734a1 1 0 01.594 0zM12 4.048L7.059 5.565 4 9.54v4.917l3.059 3.976 4.94 1.517 4.941-1.517L20 14.457V9.542l-3.06-3.977L12 4.048zM10.364 8v7.636h-2.14v-5.003l-.258.185a6.092 6.092 0 01-.748.444A7.92 7.92 0 016 11.723v-1.71l.263-.088c.595-.21 1.066-.456 1.415-.737A3.37 3.37 0 008.613 8h1.75zm4.417 0c.768 0 1.365.084 1.792.251.426.167.762.424 1.007.77.244.347.366.736.366 1.166 0 .457-.14.895-.42 1.311-.28.417-.79.874-1.53 1.373-.438.29-.732.493-.88.61a7.954 7.954 0 00-.523.455H18v1.7h-6.545l.035-.23a3.856 3.856 0 01.647-1.514c.38-.544 1.094-1.187 2.14-1.928.64-.454 1.048-.799 1.227-1.034.178-.236.268-.46.268-.671a.768.768 0 00-.265-.587.949.949 0 00-.667-.243c-.279 0-.506.084-.683.25-.177.168-.296.464-.356.887l-2.186-.17.041-.243c.091-.472.235-.849.43-1.131.23-.33.551-.582.967-.758.416-.176.992-.264 1.728-.264z\" />\n    </svg>\n  );\n}\n\nexport default D12Icon;\n","function D10Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12.596 2.067l.107.068 9.883 7.154a1 1 0 01.407.691l.007.12v4.14a1 1 0 01-.324.737l-.093.075L12.7 22.15a1 1 0 01-1.038.079l-.12-.073-10.117-7.104a1 1 0 01-.418-.698L1 14.234v-4.128a1 1 0 01.328-.74l.094-.076L11.54 2.129a1 1 0 011.057-.062zm-.488 2.217L3 10.55v3.236L12.109 20 21 13.798v-3.26l-8.892-6.254zm2.746 3.858c.527 0 .96.065 1.298.193.338.128.614.296.828.501.214.206.382.422.505.65.122.226.221.491.296.794A7.33 7.33 0 0118 12.084c0 1.404-.24 2.431-.721 3.082-.48.651-1.308.976-2.483.976-.659 0-1.191-.103-1.597-.311a2.574 2.574 0 01-.999-.913c-.189-.285-.335-.674-.44-1.169a7.897 7.897 0 01-.158-1.638c0-1.47.268-2.5.804-3.087.536-.588 1.352-.882 2.448-.882zm-4.368 0v7.868h-2.2v-5.155l-.265.19a6.26 6.26 0 01-.769.459c-.333.165-.75.324-1.252.475v-1.763l.27-.09c.612-.217 1.097-.47 1.455-.76.41-.33.73-.738.961-1.224h1.8zm4.294 1.43c-.36 0-.62.18-.78.541-.16.361-.24 1.029-.24 2.003 0 .985.088 1.658.264 2.018.176.361.432.541.766.541.221 0 .412-.076.574-.23.162-.152.282-.394.358-.725.077-.33.115-.846.115-1.546 0-1.027-.088-1.718-.264-2.071-.177-.354-.44-.53-.793-.53z\" />\n    </svg>\n  );\n}\n\nexport default D10Icon;\n","function D8Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12.76 1.093l.088.088 8.997 10.156a1 1 0 01.077 1.228l-.077.098-8.997 10.156a1 1 0 01-1.4.096l-.09-.088-9.2-10.156a1 1 0 01-.079-1.243l.08-.1 9.2-10.155a1 1 0 011.4-.08zm-.669 2.249l-7.843 8.657 7.843 8.658L19.759 12l-7.668-8.658zM11.88 8c.981 0 1.707.172 2.176.517.469.345.704.779.704 1.302 0 .305-.094.59-.28.854-.141.197-.361.388-.662.573.397.176.694.408.889.697.195.29.293.61.293.96 0 .34-.084.656-.253.95a1.952 1.952 0 01-.621.68c-.245.16-.55.278-.916.354a5.782 5.782 0 01-1.17.113c-.778 0-1.372-.085-1.783-.254-.41-.17-.723-.419-.936-.748A1.984 1.984 0 019 12.894c0-.397.1-.733.3-1.008.2-.276.51-.49.927-.64-.32-.157-.554-.332-.701-.526-.2-.265-.3-.57-.3-.915 0-.566.288-1.03.866-1.39C10.542 8.14 11.139 8 11.88 8zm.1 3.805a.918.918 0 00-.664.277c-.188.184-.283.434-.283.748a.97.97 0 00.296.732c.197.189.422.284.676.284a.908.908 0 00.656-.289.988.988 0 00.29-.732.982.982 0 00-.292-.734.942.942 0 00-.679-.286zm0-2.66a.855.855 0 00-.604.215.722.722 0 00-.232.556c0 .234.079.423.237.566.16.143.37.215.634.215.234 0 .426-.071.576-.213a.72.72 0 00.225-.55.744.744 0 00-.235-.57.847.847 0 00-.601-.219z\" />\n    </svg>\n  );\n}\n\nexport default D8Icon;\n","function D6Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M19 3a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h14zm0 2H5v14h14V5zm-6.87 3c.579 0 1.036.075 1.372.224.337.15.616.369.837.657.222.288.391.65.507 1.086l-2.012.277-.029-.15c-.054-.235-.133-.407-.236-.515a.612.612 0 00-.46-.194c-.328 0-.583.185-.765.554-.132.266-.23.835-.293 1.707.242-.273.49-.476.745-.607s.55-.197.884-.197c.65 0 1.198.26 1.647.776.449.517.673 1.173.673 1.967 0 .536-.113 1.025-.34 1.469a2.35 2.35 0 01-.944 1.005c-.402.227-.906.341-1.512.341-.729 0-1.313-.139-1.754-.416-.44-.277-.792-.719-1.055-1.327C9.132 14.05 9 13.245 9 12.244c0-1.466.276-2.54.83-3.222C10.381 8.341 11.148 8 12.13 8zm-.016 4.239a.88.88 0 00-.708.349c-.19.233-.285.565-.285.997 0 .44.1.784.298 1.034.199.249.442.374.73.374.265 0 .487-.113.666-.338.178-.226.268-.562.268-1.009 0-.458-.093-.807-.278-1.047-.186-.24-.416-.36-.69-.36z\" />\n    </svg>\n  );\n}\n\nexport default D6Icon;\n","function D4Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12.485 2.24a1 1 0 01.39.389l9.922 17.886A1 1 0 0121.923 22H2.077a1 1 0 01-.875-1.485l9.923-17.886a1 1 0 011.36-.39zM12 5.173L3.775 20h16.449L12 5.174zM13.995 10v5.076H15v1.78h-1.005V18.4h-1.94v-1.544H8V14.97L12.055 10h1.94zm-1.94 2.479l-2.142 2.597h2.142V12.48z\" />\n    </svg>\n  );\n}\n\nexport default D4Icon;\n","function D100Icon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M11.148 1.157l.104.076 1.134.949 1.067-.914a1 1 0 011.214-.068l.097.075L23.66 9.09a1 1 0 01.333.63L24 9.84v4.789a1 1 0 01-.255.668l-.088.086-8.895 7.752a1 1 0 01-1.208.08l-.098-.073-1.069-.91-1.138.945a1 1 0 01-1.164.081l-.105-.074-9.61-7.8a1 1 0 01-.362-.648L0 14.609V9.862a1 1 0 01.273-.687l.094-.087 9.61-7.862a1 1 0 011.17-.07zm-.546 2.545L2 10.48v3.5l8.603 6.722L19 13.993v-3.526l-8.398-6.765zm-4.002 5v6H5.325v-3.931l-.154.145c-.152.139-.3.255-.445.35a4.096 4.096 0 01-.726.362v-1.344l.207-.093c.33-.16.595-.345.793-.555.237-.252.423-.564.557-.934H6.6zm3.07 0c.356 0 .65.048.878.145.23.096.416.221.561.376.145.154.259.316.342.486.083.17.15.37.2.596.1.433.149.884.149 1.354 0 1.052-.163 1.823-.488 2.311-.326.488-.887.732-1.682.732-.446 0-.807-.078-1.082-.233a1.823 1.823 0 01-.676-.685c-.128-.214-.227-.506-.299-.877a6.538 6.538 0 01-.106-1.229c0-1.102.181-1.874.544-2.315.363-.44.916-.66 1.659-.66zm5.2 0c.356 0 .65.048.878.145.23.096.416.221.561.376.145.154.259.316.342.486.083.17.15.37.2.596.1.433.149.884.149 1.354 0 1.052-.163 1.823-.488 2.311-.326.488-.887.732-1.682.732-.446 0-.807-.078-1.082-.233a1.823 1.823 0 01-.676-.685c-.128-.214-.227-.506-.299-.877a6.538 6.538 0 01-.106-1.229c0-1.102.181-1.874.544-2.315.363-.44.916-.66 1.659-.66zm-5.252 1c-.3 0-.517.142-.65.424-.134.283-.201.806-.201 1.57 0 .772.073 1.3.22 1.582.147.283.36.424.64.424.184 0 .343-.06.479-.18.135-.12.234-.31.298-.569.064-.259.096-.663.096-1.212 0-.805-.074-1.346-.22-1.623-.148-.277-.368-.416-.662-.416zm5.2 0c-.3 0-.517.142-.65.424-.134.283-.201.806-.201 1.57 0 .772.073 1.3.22 1.582.147.283.36.424.64.424.184 0 .343-.06.479-.18.135-.12.234-.31.298-.569.064-.259.096-.663.096-1.212 0-.805-.074-1.346-.22-1.623-.148-.277-.368-.416-.662-.416z\" />\n    </svg>\n  );\n}\n\nexport default D100Icon;\n","import React, { useState, useContext, ReactChild } from \"react\";\n\nexport type AssetLoadStartEventHandler = () => void;\nexport type AssetLoadFinishEventHandler = () => void;\n\ntype DiceLoadingContextValue = {\n  assetLoadStart: AssetLoadStartEventHandler;\n  assetLoadFinish: AssetLoadFinishEventHandler;\n  isLoading: boolean;\n};\n\nconst DiceLoadingContext =\n  React.createContext<DiceLoadingContextValue | undefined>(undefined);\n\nexport function DiceLoadingProvider({ children }: { children: ReactChild }) {\n  const [loadingAssetCount, setLoadingAssetCount] = useState(0);\n\n  function assetLoadStart() {\n    setLoadingAssetCount((prevLoadingAssets) => prevLoadingAssets + 1);\n  }\n\n  function assetLoadFinish() {\n    setLoadingAssetCount((prevLoadingAssets) => prevLoadingAssets - 1);\n  }\n\n  const isLoading = loadingAssetCount > 0;\n\n  const value = {\n    assetLoadStart,\n    assetLoadFinish,\n    isLoading,\n  };\n\n  return (\n    <DiceLoadingContext.Provider value={value}>\n      {children}\n    </DiceLoadingContext.Provider>\n  );\n}\n\nexport function useDiceLoading() {\n  const context = useContext(DiceLoadingContext);\n  if (context === undefined) {\n    throw new Error(\"useDiceLoading must be used within a DiceLoadingProvider\");\n  }\n  return context;\n}\n\nexport default DiceLoadingContext;\n","import get from \"lodash.get\";\nimport set from \"lodash.set\";\n\nimport { useSettings } from \"../contexts/SettingsContext\";\n\n/**\n * Helper to get and set nested settings that are saved in local storage\n * @param {string} path The path to the setting within the Settings object provided by the SettingsContext\n */\nfunction useSetting<Type>(path: string): [Type, (value: Type) => void] {\n  const { settings, setSettings } = useSettings();\n\n  const setting = get(settings, path) as Type;\n\n  const setSetting = (value: Type) =>\n    setSettings((prev) => {\n      const updated = set({ ...prev }, path, value);\n      return updated;\n    });\n\n  return [setting, setSetting];\n}\n\nexport default useSetting;\n","import React, { ReactChild } from \"react\";\nimport Modal, { Props } from \"react-modal\";\nimport { useThemeUI, Close } from \"theme-ui\";\nimport { useSpring, animated, config } from \"react-spring\";\nimport CSS from \"csstype\";\n\ntype ModalProps = Props & {\n  children: ReactChild | ReactChild[];\n  allowClose: boolean;\n};\n\nfunction StyledModal({\n  isOpen,\n  onRequestClose,\n  children,\n  allowClose,\n  style,\n  ...props\n}: ModalProps) {\n  const { theme } = useThemeUI();\n\n  const openAnimation = useSpring({\n    opacity: isOpen ? 1 : 0,\n    transform: isOpen ? \"scale(1)\" : \"scale(0.99)\",\n    config: config.default,\n  });\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{\n        overlay: {\n          backgroundColor: \"rgba(0, 0, 0, 0.73)\",\n          zIndex: 100,\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          ...(style?.overlay || {}),\n        },\n        content: {\n          backgroundColor: theme.colors?.background as CSS.Property.Color,\n          top: \"initial\",\n          left: \"initial\",\n          bottom: \"initial\",\n          right: \"initial\",\n          maxHeight: \"100%\",\n          ...(style?.content || {}),\n        } as React.CSSProperties,\n      }}\n      contentElement={(props, content) => (\n        <animated.div {...props} style={{ ...props.style, ...openAnimation }}>\n          {content}\n        </animated.div>\n      )}\n      overlayElement={(props, content) => (\n        <div\n          onDragEnter={(e) => {\n            // Prevent drag event from triggering with a modal open\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n          {...props}\n        >\n          {content}\n        </div>\n      )}\n      {...props}\n    >\n      {children}\n      {allowClose && (\n        <Close\n          m={0}\n          sx={{ position: \"absolute\", top: 0, right: 0 }}\n          onClick={onRequestClose}\n        />\n      )}\n    </Modal>\n  );\n}\n\nStyledModal.defaultProps = {\n  allowClose: true,\n  style: {},\n};\n\nexport default StyledModal;\n","import { Divider, DividerProps } from \"theme-ui\";\n\ntype StyledDividerProps = {\n  vertical: boolean;\n  fill: boolean;\n} & DividerProps;\n\nfunction StyledDivider({\n  vertical,\n  color,\n  fill,\n  ...props\n}: StyledDividerProps) {\n  return (\n    <Divider\n      my={vertical ? 0 : 2}\n      mx={vertical ? 2 : 0}\n      bg={color}\n      sx={{\n        height: vertical ? (fill ? \"100%\" : \"24px\") : \"2px\",\n        width: vertical ? \"2px\" : fill ? \"100%\" : \"24px\",\n        borderRadius: \"2px\",\n        opacity: 0.5,\n      }}\n      {...props}\n    />\n  );\n}\n\nStyledDivider.defaultProps = {\n  vertical: false,\n  color: \"text\",\n  fill: false,\n};\n\nexport default StyledDivider;\n","import { useMedia } from \"react-media\";\n\nfunction useResponsiveLayout() {\n  const isMediumScreen = useMedia({ query: \"(min-width: 500px)\" });\n  const isLargeScreen = useMedia({ query: \"(min-width: 1500px)\" });\n  const screenSize = isLargeScreen\n    ? \"large\"\n    : isMediumScreen\n    ? \"medium\"\n    : \"small\";\n\n  const modalSize = isLargeScreen\n    ? \"842px\"\n    : isMediumScreen\n    ? \"642px\"\n    : \"500px\";\n\n  const tileSize = isLargeScreen\n    ? \"small\"\n    : isMediumScreen\n    ? \"medium\"\n    : \"large\";\n\n  const tileGridColumns = isLargeScreen ? 4 : isMediumScreen ? 3 : 2;\n\n  const groupGridColumns = isLargeScreen ? 3 : 2;\n\n  const tileContainerHeight = isLargeScreen ? \"600px\" : \"400px\";\n\n  return {\n    screenSize,\n    modalSize,\n    tileSize,\n    tileGridColumns,\n    tileContainerHeight,\n    groupGridColumns,\n  };\n}\n\nexport default useResponsiveLayout;\n","import { Box } from \"theme-ui\";\n\nimport \"./Spinner.css\";\nimport spinnerImage from \"../images/Loading.png\";\n\nfunction Spinner() {\n  return (\n    <Box className=\"spinner\">\n      <Box\n        sx={{\n          backgroundImage: `url(${spinnerImage})`,\n          width: \"100%\",\n          height: \"100%\",\n          position: \"absolute\",\n          top: 0,\n          backgroundSize: \"contain\",\n        }}\n      ></Box>\n    </Box>\n  );\n}\n\nexport default Spinner;\n","export default \"data:image/png;base64,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\"","import React from \"react\";\nimport { Box } from \"theme-ui\";\n\nimport Spinner from \"./Spinner\";\n\ntype LoadingOverlayProps = {\n  bg: string;\n  children?: React.ReactNode;\n};\n\nfunction LoadingOverlay({ bg, children }: LoadingOverlayProps) {\n  return (\n    <Box\n      sx={{\n        position: \"absolute\",\n        width: \"100%\",\n        height: \"100%\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        top: 0,\n        left: 0,\n        flexDirection: \"column\",\n        zIndex: 2,\n      }}\n      bg={bg}\n    >\n      <Spinner />\n      {children}\n    </Box>\n  );\n}\n\nLoadingOverlay.defaultProps = {\n  bg: \"muted\",\n};\n\nexport default LoadingOverlay;\n","//  XMLHttpRequest  arraybuffer/ responseText \nif (typeof window !== \"undefined\" && \"XMLHttpRequest\" in window) {\n  const descriptor = Object.getOwnPropertyDescriptor(\n    XMLHttpRequest.prototype,\n    \"responseText\"\n  );\n\n  if (descriptor?.get) {\n    const originalGet = descriptor.get;\n\n    Object.defineProperty(XMLHttpRequest.prototype, \"responseText\", {\n      configurable: descriptor.configurable ?? true,\n      enumerable: descriptor.enumerable ?? false,\n      get: function responseTextPatched(this: XMLHttpRequest) {\n        try {\n          return originalGet.call(this);\n        } catch (error) {\n          if (\n            error instanceof DOMException &&\n            error.name === \"InvalidStateError\"\n          ) {\n            const type = this.responseType as XMLHttpRequestResponseType;\n            if (\n              type === \"arraybuffer\" ||\n              type === \"blob\" ||\n              type === \"document\" ||\n              type === \"json\"\n            ) {\n              return \"\";\n            }\n          }\n          throw error;\n        }\n      },\n    });\n  }\n}\n\nexport {};\n","const theme = {\n  config: {\n    useColorSchemeMediaQuery: false,\n  },\n  colors: {\n    text: \"hsl(210, 50%, 96%)\",\n    background: \"hsl(230, 25%, 18%)\",\n    primary: \"hsl(260, 100%, 80%)\",\n    secondary: \"hsl(290, 100%, 80%)\",\n    highlight: \"hsl(260, 20%, 40%)\",\n    purple: \"hsl(290, 100%, 80%)\",\n    muted: \"hsla(230, 20%, 0%, 20%)\",\n    gray: \"hsl(0, 0%, 70%)\",\n    overlay: \"hsla(230, 25%, 15%, 80%)\",\n    border: \"hsla(210, 50%, 96%, 0.5)\",\n    modes: {\n      light: {\n        text: \"hsl(10, 20%, 20%)\",\n        background: \"hsl(10, 10%, 98%)\",\n        primary: \"hsl(260, 100%, 80%)\",\n        secondary: \"hsl(290, 100%, 80%)\",\n        highlight: \"hsl(260, 20%, 70%)\",\n        muted: \"hsla(230, 20%, 60%, 20%)\",\n        overlay: \"hsla(230, 100%, 97%, 80%)\",\n        border: \"hsla(10, 20%, 20%, 0.5)\",\n      },\n    },\n  },\n  fonts: {\n    body: \"'Bree Serif', Georgia, serif\",\n    body2:\n      \"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif\",\n    heading: \"'Bree Serif', serif\",\n    monospace: \"Menlo, monospace\",\n    display: \"'Pacifico', Helvetica, sans-serif\",\n  },\n  fontSizes: [12, 14, 16, 20, 24, 32, 48, 64, 72],\n  fontWeights: {\n    caption: 200,\n    body: 400,\n    heading: 400,\n    display: 400,\n  },\n  lineHeights: {\n    body: 1.3,\n    body2: 1.5,\n    display: 1.1,\n    heading: 1.25,\n  },\n  breakpoints: [\"12em\", \"24em\", \"40em\", \"56em\", \"64em\"],\n  text: {\n    heading: {\n      fontFamily: \"heading\",\n      fontWeight: \"heading\",\n      lineHeight: \"heading\",\n      fontSize: 1,\n    },\n    display: {\n      variant: \"text.heading\",\n      fontFamily: \"display\",\n      fontSize: [5, 6],\n      fontWeight: \"display\",\n      mt: 3,\n    },\n    caption: {\n      fontFamily: \"body2\",\n      fontWeight: \"caption\",\n      fontSize: 0,\n      color: \"gray\",\n    },\n    body2: {\n      fontFamily: \"body2\",\n      fontSize: 0,\n      fontWeight: \"body\",\n      lineHeight: \"body2\",\n    },\n  },\n  styles: {\n    Container: {\n      p: 3,\n      maxWidth: 1024,\n    },\n    root: {\n      fontFamily: \"body\",\n      lineHeight: \"body\",\n      fontWeight: \"body\",\n    },\n    h1: {\n      variant: \"text.display\",\n    },\n    h2: {\n      variant: \"text.heading\",\n      fontSize: 5,\n    },\n    h3: {\n      variant: \"text.heading\",\n      fontSize: 4,\n    },\n    h4: {\n      variant: \"text.heading\",\n      fontSize: 3,\n    },\n    h5: {\n      variant: \"text.heading\",\n      fontSize: 2,\n    },\n    h6: {\n      variant: \"text.heading\",\n      fontSize: 1,\n    },\n    a: {\n      variant: \"text.body2\",\n      color: \"text\",\n      \"&:hover\": {\n        color: \"primary\",\n      },\n      \"&:active\": {\n        color: \"secondary\",\n      },\n    },\n    pre: {\n      variant: \"prism\",\n      fontFamily: \"monospace\",\n      fontSize: 1,\n      p: 3,\n      color: \"text\",\n      bg: \"muted\",\n      overflow: \"auto\",\n      code: {\n        color: \"inherit\",\n      },\n    },\n    code: {\n      fontFamily: \"monospace\",\n      color: \"secondary\",\n      fontSize: 1,\n    },\n    inlineCode: {\n      fontFamily: \"monospace\",\n      color: \"secondary\",\n      bg: \"muted\",\n    },\n    hr: {\n      border: 0,\n      borderBottom: \"1px solid\",\n      borderColor: \"muted\",\n    },\n    img: {\n      maxWidth: \"100%\",\n    },\n    progress: {\n      color: \"text\",\n      backgroundColor: \"overlay\",\n    },\n  },\n  prism: {\n    \".comment,.prolog,.doctype,.cdata,.punctuation,.operator,.entity,.url\": {\n      color: \"gray\",\n    },\n    \".comment\": {\n      fontStyle: \"italic\",\n    },\n    \".property,.tag,.boolean,.number,.constant,.symbol,.deleted,.function,.class-name,.regex,.important,.variable\":\n      {\n        color: \"purple\",\n      },\n    \".atrule,.attr-value,.keyword\": {\n      color: \"primary\",\n    },\n    \".selector,.attr-name,.string,.char,.bultin,.inserted\": {\n      color: \"secondary\",\n    },\n  },\n  forms: {\n    label: {\n      fontWeight: 400,\n    },\n    input: {\n      \"&:focus\": {\n        outlineColor: \"primary\",\n      },\n      \"&:disabled\": {\n        backgroundColor: \"muted\",\n        opacity: 0.5,\n        borderColor: \"text\",\n      },\n      fontFamily: \"body2\",\n    },\n    slider: {\n      \"&:disabled\": {\n        opacity: 0.5,\n      },\n    },\n    textarea: {\n      \"&:focus\": {\n        outlineColor: \"primary\",\n      },\n      \"&:disabled\": {\n        backgroundColor: \"muted\",\n        opacity: 0.5,\n        borderColor: \"text\",\n      },\n      fontFamily: \"body2\",\n    },\n  },\n  buttons: {\n    primary: {\n      color: \"text\",\n      bg: \"transparent\",\n      borderStyle: \"solid\",\n      borderWidth: \"1px\",\n      borderColor: \"text\",\n      \"&:hover\": {\n        borderColor: \"highlight\",\n        cursor: \"pointer\",\n      },\n      fontFamily: \"body\",\n      \"&:focus\": {\n        outline: \"none\",\n      },\n      \"&:active\": {\n        borderColor: \"primary\",\n      },\n      \"&:disabled\": {\n        borderColor: \"text\",\n        opacity: 0.5,\n      },\n    },\n    secondary: {\n      color: \"text\",\n      bg: \"transparent\",\n      border: \"none\",\n      fontFamily: \"body\",\n      \"&:focus\": {\n        outline: \"none\",\n      },\n      \"&:disabled\": {\n        opacity: 0.5,\n      },\n      \"&:hover\": {\n        color: \"primary\",\n        cursor: \"pointer\",\n      },\n      \"&:active\": {\n        color: \"secondary\",\n      },\n    },\n    icon: {\n      \"&:hover\": {\n        cursor: \"pointer\",\n        color: \"primary\",\n      },\n      \"&:focus\": {\n        outline: \"none\",\n      },\n      \"&:active\": {\n        color: \"secondary\",\n      },\n      \"&:disabled\": {\n        opacity: 0.5,\n        color: \"text\",\n      },\n    },\n    close: {\n      \"&:hover\": {\n        cursor: \"pointer\",\n        color: \"primary\",\n      },\n      \"&:focus\": {\n        outline: \"none\",\n      },\n      \"&:active\": {\n        color: \"secondary\",\n      },\n    },\n  },\n  links: {\n    footer: {\n      variant: \"text.caption\",\n      textDecoration: \"underline\",\n      \"&:hover\": {\n        textDecorationColor: \"hsl(260, 100%, 80%)\",\n        cursor: \"pointer\",\n      },\n      \"&:active\": {\n        textDecorationColor: \"hsl(290, 100%, 80%)\",\n      },\n    },\n  },\n  messages: {\n    warning: {\n      backgroundColor: \"#d65c64\",\n      borderLeftColor: \"#ff939b\",\n    },\n    note: {\n      backgroundColor: \"#ca871e\",\n      borderLeftColor: \"#ebd2ac\",\n    },\n  },\n};\n\nexport default theme;\n","import { Link as ThemeLink, LinkProps } from \"theme-ui\";\nimport { HashLink as RouterLink } from \"react-router-hash-link\";\n\nfunction Link({ to, ...rest }: { to: string } & LinkProps) {\n  return (\n    <RouterLink to={to}>\n      <ThemeLink as=\"span\" {...rest} />\n    </RouterLink>\n  );\n}\n\nexport default Link;\n","import { Flex } from \"theme-ui\";\n\nimport Link from \"./Link\";\n\nfunction Footer() {\n  return (\n    <Flex\n      bg=\"muted\"\n      sx={{\n        height: \"48px\",\n        width: \"100%\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        paddingBottom: \"env(safe-area-inset-bottom)\",\n      }}\n    >\n      <Link m={2} to=\"/about\" variant=\"footer\">\n        About\n      </Link>\n      <Link m={2} to=\"/\" variant=\"footer\">\n        Home\n      </Link>\n      <Link m={2} to=\"/faq\" variant=\"footer\">\n        FAQ\n      </Link>\n      <Link m={2} to=\"/release-notes\" variant=\"footer\">\n        Release Notes\n      </Link>\n      <Link m={2} to=\"/how-to\" variant=\"footer\">\n        How To\n      </Link>\n    </Flex>\n  );\n}\n\nexport default Footer;\n","import React, { useState, useEffect, useContext } from \"react\";\n\nimport FakeStorage from \"../helpers/FakeStorage\";\n\ntype AuthContextValue = {\n  password: string;\n  setPassword: React.Dispatch<React.SetStateAction<string>>;\n};\n\nconst AuthContext =\n  React.createContext<AuthContextValue | undefined>(undefined);\n\nlet storage: Storage | FakeStorage;\ntry {\n  sessionStorage.setItem(\"__test\", \"__test\");\n  sessionStorage.removeItem(\"__test\");\n  storage = sessionStorage;\n} catch (e) {\n  console.warn(\"Session storage is disabled, no authentication will be saved\");\n  storage = new FakeStorage();\n}\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [password, setPassword] = useState<string>(\n    storage.getItem(\"auth\") || \"\"\n  );\n\n  useEffect(() => {\n    storage.setItem(\"auth\", password);\n  }, [password]);\n\n  const value = {\n    password,\n    setPassword,\n  };\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within a AuthProvider\");\n  }\n  return context;\n}\n\nexport default AuthContext;\n","import { ChangeEvent, useRef } from \"react\";\nimport { Box, Label, Input, Button, Flex, Checkbox } from \"theme-ui\";\nimport { useHistory } from \"react-router-dom\";\nimport shortid from \"shortid\";\n\nimport { useAuth } from \"../contexts/AuthContext\";\n\nimport useSetting from \"../hooks/useSetting\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype StartModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction StartModal({ isOpen, onRequestClose }: StartModalProps) {\n  let history = useHistory();\n  const { password, setPassword } = useAuth();\n\n  function handlePasswordChange(event: ChangeEvent<HTMLInputElement>) {\n    setPassword(event.target.value);\n  }\n\n  const [usePassword, setUsePassword] = useSetting<boolean>(\"game.usePassword\");\n  function handleUsePasswordChange(event: ChangeEvent<HTMLInputElement>) {\n    setUsePassword(event.target.checked);\n  }\n\n  function handleSubmit(event: ChangeEvent<HTMLInputElement>) {\n    event.preventDefault();\n    if (!usePassword) {\n      setPassword(\"\");\n    }\n    history.push(`/game/${shortid.generate()}`);\n  }\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput() {\n    inputRef.current && inputRef.current.focus();\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      onAfterOpen={focusInput}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          maxWidth: \"300px\",\n          flexGrow: 1,\n        }}\n        m={2}\n      >\n        <Box as=\"form\" onSubmit={handleSubmit}>\n          <Label htmlFor=\"password\">Game Password</Label>\n          <Input\n            my={1}\n            id=\"password\"\n            name=\"password\"\n            value={usePassword ? password : \"\"}\n            onChange={handlePasswordChange}\n            disabled={!usePassword}\n            autoComplete=\"off\"\n            ref={inputRef}\n          />\n          <Box>\n            <Label mb={3}>\n              <Checkbox\n                checked={usePassword}\n                onChange={handleUsePasswordChange}\n              />\n              Use password\n            </Label>\n          </Box>\n          <Flex>\n            <Button sx={{ flexGrow: 1 }} disabled={!password && usePassword}>\n              Start\n            </Button>\n          </Flex>\n        </Box>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default StartModal;\n","import { useState, useRef, FormEvent, ChangeEvent } from \"react\";\nimport { Box, Label, Input, Button, Flex } from \"theme-ui\";\nimport { useHistory } from \"react-router-dom\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype JoinModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction JoinModal({ isOpen, onRequestClose }: JoinModalProps) {\n  let history = useHistory();\n  const [gameId, setGameId] = useState(\"\");\n\n  function handleChange(event: ChangeEvent<HTMLInputElement>) {\n    setGameId(event.target?.value);\n  }\n\n  function handleSubmit(event: FormEvent<HTMLDivElement>) {\n    event.preventDefault();\n    history.push(`/game/${gameId}`);\n  }\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput() {\n    inputRef.current?.focus();\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      onAfterOpen={focusInput}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          maxWidth: \"300px\",\n          flexGrow: 1,\n        }}\n        m={2}\n      >\n        <Box as=\"form\" onSubmit={handleSubmit}>\n          <Label htmlFor=\"id\">Let me see your identification</Label>\n          <Input\n            mt={1}\n            mb={3}\n            id=\"id\"\n            name=\"id\"\n            value={gameId || \"\"}\n            onChange={handleChange}\n            ref={inputRef}\n          />\n          <Flex>\n            <Button sx={{ flexGrow: 1 }} disabled={!gameId}>\n              Join\n            </Button>\n          </Flex>\n        </Box>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default JoinModal;\n","import React from \"react\";\nimport {\n  Text,\n  TextProps,\n  Image as UIImage,\n  ImageProps,\n  Link as UILink,\n  Message,\n  Box,\n} from \"theme-ui\";\nimport ReactMarkdown from \"react-markdown\";\n\nfunction Paragraph(props: TextProps) {\n  return <Text as=\"p\" my={2} variant=\"body2\" {...props} />;\n}\n\nfunction Heading({ level, ...props }: { level: number } & TextProps) {\n  const fontSize = level === 1 ? 5 : level === 2 ? 3 : 1;\n  return (\n    <Text\n      mt={2}\n      mb={1}\n      as={`h${level}` as React.ElementType}\n      sx={{ fontSize }}\n      variant=\"heading\"\n      {...props}\n    />\n  );\n}\n\nfunction Image(props: ImageProps) {\n  if (props.alt === \"embed:\") {\n    return (\n      <Box\n        as=\"span\"\n        sx={{\n          display: \"block\",\n          width: \"100%\",\n          height: 0,\n          paddingBottom: \"56.25%\",\n          position: \"relative\",\n        }}\n        my={2}\n      >\n        <iframe\n          src={props.src}\n          style={{\n            position: \"absolute\",\n            width: \"100%\",\n            height: \"100%\",\n            top: 0,\n            bottom: 0,\n            left: 0,\n            border: 0,\n          }}\n          title=\"Video\"\n        />\n      </Box>\n    );\n  }\n  if (props.src?.endsWith(\".mp4\")) {\n    return (\n      <video\n        style={{ width: \"100%\", margin: \"8px 0\" }}\n        autoPlay\n        muted\n        playsInline\n        loop\n        controls\n        src={props.src}\n      />\n    );\n  }\n\n  return <UIImage mt={2} sx={{ borderRadius: \"4px\" }} {...props} />;\n}\n\nfunction ListItem(props: TextProps) {\n  return <Text as=\"li\" variant=\"body2\" my={1} {...props} />;\n}\n\nfunction Code({\n  children,\n  value,\n}: {\n  value: string;\n  children: React.ReactNode;\n}) {\n  let variant = \"\";\n  if (value.startsWith(\"Warning:\")) {\n    variant = \"warning\";\n  } else if (value.startsWith(\"Note:\")) {\n    variant = \"note\";\n  }\n  return (\n    <Message\n      variant={variant}\n      color=\"hsl(210, 50%, 96%)\"\n      my={2}\n      as=\"span\"\n      sx={{ display: \"block\" }}\n    >\n      {children}\n    </Message>\n  );\n}\n\nfunction Table({ children }: { children: React.ReactNode }) {\n  return (\n    <Text\n      as=\"table\"\n      my={4}\n      style={{ borderCollapse: \"collapse\", width: \"100%\" }}\n    >\n      {children}\n    </Text>\n  );\n}\n\nfunction TableHead(props: TextProps) {\n  return (\n    <Text\n      as=\"thead\"\n      variant=\"heading\"\n      sx={{ textAlign: \"left\", \"& > tr\": { borderBottomWidth: \"2px\" } }}\n      {...props}\n    />\n  );\n}\n\nfunction TableBody(props: TextProps) {\n  return (\n    <Text\n      as=\"tbody\"\n      variant=\"body2\"\n      sx={{ borderBottomWidth: \"1px\", \"& > tr\": { borderBottomWidth: \"1px\" } }}\n      {...props}\n    />\n  );\n}\n\nfunction TableRow({ children }: { children: React.ReactNode }) {\n  return (\n    <Text\n      as=\"tr\"\n      sx={{\n        borderBottomStyle: \"solid\",\n        borderBottomColor: \"border\",\n      }}\n    >\n      {children}\n    </Text>\n  );\n}\n\nfunction TableCell({ children }: { children: React.ReactNode }) {\n  return (\n    <Text as=\"td\" p={2}>\n      {children}\n    </Text>\n  );\n}\n\nfunction Link({ href, children }: { href: string; children: React.ReactNode }) {\n  return <UILink href={href}>{children}</UILink>;\n}\n\nfunction Markdown({\n  source,\n  assets,\n}: {\n  source: string;\n  assets: Record<string, string>;\n}) {\n  const renderers = {\n    paragraph: Paragraph,\n    heading: Heading,\n    image: Image,\n    link: Link,\n    listItem: ListItem,\n    inlineCode: Code,\n    table: Table,\n    tableHead: TableHead,\n    tableBody: TableBody,\n    tableRow: TableRow,\n    tableCell: TableCell,\n  };\n  return (\n    <ReactMarkdown\n      source={source}\n      renderers={renderers}\n      transformImageUri={(uri) => assets[uri] || uri}\n    />\n  );\n}\n\nMarkdown.defaultProps = {\n  assets: {},\n};\n\nexport default Markdown;\n","import { Box, Label, Text } from \"theme-ui\";\nimport raw from \"raw.macro\";\n\nimport Modal from \"../components/Modal\";\nimport Markdown from \"../components/Markdown\";\nimport Link from \"../components/Link\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\nconst gettingStarted = raw(\"../docs/howTo/gettingStarted.md\");\n\ntype GettingStartedModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction GettingStartedModal({\n  isOpen,\n  onRequestClose,\n}: GettingStartedModalProps) {\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{ content: { maxWidth: \"450px\" } }}\n    >\n      <Box>\n        <Label py={2}>Getting Started</Label>\n        <Markdown source={gettingStarted} />\n        <Text variant=\"body2\" my={2}>\n          For more tutorials visit the <Link to=\"/how-to\">How To</Link> page\n        </Text>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default GettingStartedModal;\n","function HelpIcon() {\n  return (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n      style={{ margin: \"0 4px\" }}\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-4h2v2h-2zm1.61-9.96c-2.06-.3-3.88.97-4.43 2.79-.18.58.26 1.17.87 1.17h.2c.41 0 .74-.29.88-.67.32-.89 1.27-1.5 2.3-1.28.95.2 1.65 1.13 1.57 2.1-.1 1.34-1.62 1.63-2.45 2.88 0 .01-.01.01-.01.02-.01.02-.02.03-.03.05-.09.15-.18.32-.25.5-.01.03-.03.05-.04.08-.01.02-.01.04-.02.07-.12.34-.2.75-.2 1.25h2c0-.42.11-.77.28-1.07.02-.03.03-.06.05-.09.08-.14.18-.27.28-.39.01-.01.02-.03.03-.04.1-.12.21-.23.33-.34.96-.91 2.26-1.65 1.99-3.56-.24-1.74-1.61-3.21-3.35-3.47z\" />\n    </svg>\n  );\n}\n\nexport default HelpIcon;\n","function SocialRedditIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zm5 4.75c-.491 0-.912.286-1.116.698l-2.908-.619a.312.312 0 00-.37.24l-.891 4.186c-1.863.052-3.537.61-4.749 1.483a1.75 1.75 0 10-1.926 2.858c-.027.174-.042.35-.042.529 0 2.692 3.134 4.875 7 4.875s7-2.183 7-4.875c0-.178-.014-.353-.041-.526a1.75 1.75 0 10-1.923-2.858c-1.196-.863-2.844-1.42-4.68-1.485l.797-3.75 2.605.553A1.247 1.247 0 0018.25 6c0-.69-.56-1.25-1.25-1.25zM9.492 16.095c.538.538 1.688.728 2.51.728.821 0 1.972-.19 2.51-.728a.324.324 0 01.458.458c-.853.852-2.488.918-2.969.918-.48 0-2.115-.066-2.967-.918a.324.324 0 01.458-.458zM14.75 12c.69 0 1.25.561 1.25 1.25 0 .69-.56 1.25-1.25 1.25s-1.25-.56-1.25-1.25c0-.689.56-1.25 1.25-1.25zm-5.5 0c.69 0 1.25.56 1.25 1.25s-.56 1.25-1.25 1.25c-.689 0-1.25-.56-1.25-1.25S8.561 12 9.25 12z\" />\n    </svg>\n  );\n}\n\nexport default SocialRedditIcon;\n","function SocialTwitterIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 12c0 6.63-5.37 12-12 12S0 18.63 0 12 5.37 0 12 0s12 5.37 12 12zM9.804 18.33c5.322 0 8.232-4.41 8.232-8.232 0-.126 0-.252-.006-.372a5.927 5.927 0 001.446-1.5 5.872 5.872 0 01-1.662.456c.6-.36 1.056-.924 1.272-1.602-.558.33-1.176.57-1.836.702a2.894 2.894 0 00-4.926 2.64A8.208 8.208 0 016.36 7.398c-.246.426-.39.924-.39 1.452 0 1.002.51 1.89 1.29 2.406a2.842 2.842 0 01-1.308-.36v.036c0 1.404.996 2.568 2.322 2.838a2.884 2.884 0 01-1.308.048 2.889 2.889 0 002.7 2.01 5.816 5.816 0 01-4.284 1.194 8.06 8.06 0 004.422 1.308\" />\n    </svg>\n  );\n}\n\nexport default SocialTwitterIcon;\n","function SocialYouTubeIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M12 0c6.63 0 12 5.37 12 12s-5.37 12-12 12S0 18.63 0 12 5.37 0 12 0zm.28 6.001h-.56c-1.073.006-4.902.047-5.971.336A2.01 2.01 0 004.334 7.76c-.297 1.117-.33 3.31-.334 3.785v.183c.004.474.037 2.668.334 3.784a2.01 2.01 0 001.415 1.424c1.105.298 5.156.332 6.068.336h.366c.912-.004 4.963-.038 6.068-.336a2.01 2.01 0 001.415-1.424C20 14.257 20 11.636 20 11.636s0-2.62-.334-3.876a2.01 2.01 0 00-1.415-1.423c-1.07-.289-4.898-.33-5.97-.336zm-1.916 3.256l4.181 2.38-4.181 2.378V9.257z\" />\n    </svg>\n  );\n}\n\nexport default SocialYouTubeIcon;\n","function SocialPatreonIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 12c0 6.63-5.37 12-12 12S0 18.63 0 12 5.37 0 12 0s12 5.37 12 12Zm-9.491-7A5.515 5.515 0 0 0 9 10.508C9 13.536 11.471 16 14.509 16A5.498 5.498 0 0 0 20 10.508C20 7.471 17.537 5 14.509 5M6 19h2V5H6v14Z\" />\n    </svg>\n  );\n}\n\nexport default SocialPatreonIcon;\n","export default __webpack_public_path__ + \"static/media/Owlington.bb5589cf.png\";","import { useState, useEffect } from \"react\";\nimport { Flex, Button, Image, Text, IconButton, Link } from \"theme-ui\";\n\nimport Footer from \"../components/Footer\";\n\nimport StartModal from \"../modals/StartModal\";\nimport JoinModal from \"../modals/JoinModal\";\nimport GettingStartedModal from \"../modals/GettingStartedModal\";\n\nimport HelpIcon from \"../icons/HelpIcon\";\n\nimport { useAuth } from \"../contexts/AuthContext\";\n\nimport RedditIcon from \"../icons/SocialRedditIcon\";\nimport TwitterIcon from \"../icons/SocialTwitterIcon\";\nimport YouTubeIcon from \"../icons/SocialYouTubeIcon\";\nimport SocialPatreonIcon from \"../icons/SocialPatreonIcon\";\n\nimport owlington from \"../images/Owlington.png\";\n\nfunction Home() {\n  const [isStartModalOpen, setIsStartModalOpen] = useState(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState(false);\n  const [isGettingStartedModalOpen, setIsGettingStartedModalOpen] =\n    useState(false);\n\n  // Reset password on visiting home\n  const { setPassword } = useAuth();\n  useEffect(() => {\n    setPassword(\"\");\n  }, [setPassword]);\n\n  return (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"100%\",\n        alignItems: \"center\",\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          maxWidth: \"300px\",\n          flexGrow: 1,\n        }}\n        mb={2}\n      >\n        <Text variant=\"display\" as=\"h1\" sx={{ textAlign: \"center\" }}>\n          Owlbear Rodeo\n        </Text>\n        <Image src={owlington} m={2} />\n        <Button\n          variant=\"secondary\"\n          m={2}\n          onClick={() => setIsGettingStartedModalOpen(true)}\n          sx={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n          }}\n        >\n          Getting Started <HelpIcon />\n        </Button>\n        <Button m={2} onClick={() => setIsStartModalOpen(true)}>\n          Start Game\n        </Button>\n        <Button m={2} onClick={() => setIsJoinModalOpen(true)}>\n          Join Game\n        </Button>\n        <Text variant=\"caption\" as=\"p\" sx={{ textAlign: \"center\" }}>\n          Legacy v{process.env.REACT_APP_VERSION}\n        </Text>\n        <Button\n          as=\"a\"\n          // @ts-ignore\n          href=\"https://owlbear.rodeo/\"\n          mt={4}\n          mx={2}\n          mb={2}\n          sx={{\n            display: \"flex\",\n            alignItems: \"flex-end\",\n            justifyContent: \"center\",\n          }}\n        >\n          Owlbear Rodeo 2.0\n        </Button>\n        <Flex mb={4} mt={0} sx={{ justifyContent: \"center\" }}>\n          <Link href=\"https://www.reddit.com/r/OwlbearRodeo/\">\n            <IconButton title=\"Reddit\" aria-label=\"Reddit\">\n              <RedditIcon />\n            </IconButton>\n          </Link>\n          <Link href=\"https://twitter.com/OwlbearRodeo\">\n            <IconButton title=\"Twitter\" aria-label=\"Twitter\">\n              <TwitterIcon />\n            </IconButton>\n          </Link>\n          <Link href=\"https://www.youtube.com/channel/UCePe1wJC53_7fbBbSECG7YQ\">\n            <IconButton title=\"YouTube\" aria-label=\"YouTube\">\n              <YouTubeIcon />\n            </IconButton>\n          </Link>\n          <Link href=\"https://patreon.com/owlbearrodeo\">\n            <IconButton title=\"Patreon\" aria-label=\"Patreon\">\n              <SocialPatreonIcon />\n            </IconButton>\n          </Link>\n        </Flex>\n        <JoinModal\n          isOpen={isJoinModalOpen}\n          onRequestClose={() => setIsJoinModalOpen(false)}\n        />\n        <StartModal\n          isOpen={isStartModalOpen}\n          onRequestClose={() => setIsStartModalOpen(false)}\n        />\n        <GettingStartedModal\n          isOpen={isGettingStartedModalOpen}\n          onRequestClose={() => setIsGettingStartedModalOpen(false)}\n        />\n      </Flex>\n      <Footer />\n    </Flex>\n  );\n}\n\nexport default Home;\n","function ReconnectingIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M.01 0h24v24h-24V0z\" fill=\"none\" />\n      <path d=\"M12 4V2.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V6c3.31 0 6 2.69 6 6 0 .79-.15 1.56-.44 2.25-.15.36-.04.77.23 1.04.51.51 1.37.33 1.64-.34.37-.91.57-1.91.57-2.95 0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-.79.15-1.56.44-2.25.15-.36.04-.77-.23-1.04-.51-.51-1.37-.33-1.64.34C4.2 9.96 4 10.96 4 12c0 4.42 3.58 8 8 8v1.79c0 .45.54.67.85.35l2.79-2.79c.2-.2.2-.51 0-.71l-2.79-2.79c-.31-.31-.85-.09-.85.36V18z\">\n        <animateTransform\n          attributeName=\"transform\"\n          attributeType=\"XML\"\n          type=\"rotate\"\n          from=\"360 12 12\"\n          to=\"0 12 12\"\n          dur=\"2s\"\n          repeatCount=\"indefinite\"\n        />\n      </path>\n    </svg>\n  );\n}\n\nexport default ReconnectingIcon;\n","import { Flex } from \"theme-ui\";\n\nimport Banner from \"./Banner\";\nimport ReconnectingIcon from \"../../icons/ReconnectingIcon\";\n\nfunction ReconnectBanner({ isOpen }: { isOpen: boolean }) {\n  return (\n    <Banner\n      isOpen={isOpen}\n      onRequestClose={() => {}}\n      allowClose={false}\n      backgroundColor=\"transparent\"\n    >\n      <Flex\n        sx={{\n          width: \"28px\",\n          height: \"28px\",\n          borderRadius: \"28px\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n        bg=\"overlay\"\n        title=\"Disconnected. Attempting to reconnect...\"\n        aria-label=\"Disconnected. Attempting to reconnect...\"\n      >\n        <ReconnectingIcon />\n      </Flex>\n    </Banner>\n  );\n}\n\nexport default ReconnectBanner;\n","function PointerToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0zm0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M10 5.74v-.19c0-.68-.71-1.11-1.32-.82-.19.09-.36.2-.54.3L9.6 6.49c.24-.18.4-.45.4-.75zM20 12c0-2.21-.91-4.2-2.36-5.64l1.51-1.51c.31-.31.09-.85-.36-.85H14v4.79c0 .45.54.67.85.35l1.39-1.39C17.32 8.85 18 10.34 18 12c0 .85-.18 1.66-.5 2.39l1.48 1.48C19.62 14.72 20 13.41 20 12zM3.57 4.7c-.39.39-.39 1.02 0 1.41l1.65 1.65C4.45 9 4 10.44 4 12c0 2.21.91 4.2 2.36 5.64l-1.51 1.51c-.31.31-.09.85.36.85H9.5c.28 0 .5-.22.5-.5v-4.29c0-.45-.54-.67-.85-.35l-1.39 1.39C6.68 15.15 6 13.66 6 12c0-1 .26-1.93.69-2.76l8.07 8.07c-.01.02-.01.02-.01.04-.43.12-.75.48-.75.91v.18c0 .68.71 1.11 1.32.82.31-.14.61-.31.9-.49l1.87 1.87c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L4.98 4.7c-.39-.39-1.02-.39-1.41 0z\" />\n    </svg>\n  );\n}\n\nexport default PointerToolIcon;\n","import { Flex } from \"theme-ui\";\n\nimport Banner from \"./Banner\";\nimport OfflineIcon from \"../../icons/OfflineIcon\";\n\nfunction OfflineBanner({ isOpen }: { isOpen: boolean }) {\n  return (\n    <Banner\n      isOpen={isOpen}\n      onRequestClose={() => {}}\n      allowClose={false}\n      backgroundColor=\"transparent\"\n    >\n      <Flex\n        sx={{\n          width: \"28px\",\n          height: \"28px\",\n          borderRadius: \"28px\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n        bg=\"overlay\"\n        title=\"Unable to connect to game, refresh to reconnect.\"\n        aria-label=\"Unable to connect to game, refresh to reconnect.\"\n      >\n        <OfflineIcon />\n      </Flex>\n    </Banner>\n  );\n}\n\nexport default OfflineBanner;\n","import React, { useState, useRef, useContext, useCallback } from \"react\";\n\ntype MapLoadingProgress = {\n  count: number;\n  total: number;\n};\n\ntype MapLoadingProgressUpdate = MapLoadingProgress & {\n  id: string;\n};\n\ntype MapLoadingContextValue = {\n  isLoading: boolean;\n  assetLoadStart: (id: string) => void;\n  assetProgressUpdate: (update: MapLoadingProgressUpdate) => void;\n  loadingProgressRef: React.MutableRefObject<number>;\n};\n\nconst MapLoadingContext =\n  React.createContext<MapLoadingContextValue | undefined>(undefined);\n\nexport function MapLoadingProvider({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const [isLoading, setIsLoading] = useState(false);\n  // Mapping from asset id to the count and total number of pieces loaded\n  const assetProgressRef = useRef<Record<string, MapLoadingProgress>>({});\n  // Loading progress of all assets between 0 and 1\n  const loadingProgressRef = useRef<number>(0);\n\n  const assetLoadStart = useCallback((id) => {\n    setIsLoading(true);\n    // Add asset at a 0% progress\n    assetProgressRef.current = {\n      ...assetProgressRef.current,\n      [id]: { count: 0, total: 1 },\n    };\n  }, []);\n\n  const assetProgressUpdate = useCallback(({ id, count, total }) => {\n    assetProgressRef.current = {\n      ...assetProgressRef.current,\n      [id]: { count, total },\n    };\n    // Update loading progress\n    let complete = 0;\n    const progresses = Object.values(assetProgressRef.current);\n    for (let progress of progresses) {\n      complete += progress.count / progress.total;\n    }\n    loadingProgressRef.current = complete / progresses.length;\n    // All loading is complete\n    if (loadingProgressRef.current === 1) {\n      setIsLoading(false);\n      assetProgressRef.current = {};\n    }\n  }, []);\n\n  const value = {\n    assetLoadStart,\n    isLoading,\n    assetProgressUpdate,\n    loadingProgressRef,\n  };\n\n  return (\n    <MapLoadingContext.Provider value={value}>\n      {children}\n    </MapLoadingContext.Provider>\n  );\n}\n\nexport function useMapLoading() {\n  const context = useContext(MapLoadingContext);\n  if (context === undefined) {\n    throw new Error(\"useMapLoading must be used within a MapLoadingProvider\");\n  }\n  return context;\n}\n\nexport default MapLoadingContext;\n","import React, { useEffect, useRef } from \"react\";\nimport { Progress } from \"theme-ui\";\n\ntype LoadingBarProps = {\n  isLoading: boolean;\n  loadingProgressRef: React.MutableRefObject<number>;\n};\n\nfunction LoadingBar({ isLoading, loadingProgressRef }: LoadingBarProps) {\n  const requestRef = useRef<number>();\n  const progressBarRef = useRef<HTMLProgressElement>(null);\n\n  // Use an animation frame to update the progress bar\n  // This bypasses react allowing the animation to be smooth\n  useEffect(() => {\n    function animate() {\n      if (!isLoading) {\n        return;\n      }\n      requestRef.current = requestAnimationFrame(animate);\n      if (progressBarRef.current) {\n        progressBarRef.current.value = loadingProgressRef.current;\n      }\n    }\n\n    requestRef.current = requestAnimationFrame(animate);\n\n    return () => {\n      if (requestRef.current !== undefined) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isLoading]);\n\n  return (\n    <Progress\n      ref={progressBarRef}\n      max={1}\n      value={0}\n      m={0}\n      sx={{ width: \"100%\", borderRadius: 0, height: \"4px\" }}\n      color=\"primary\"\n    />\n  );\n}\n\nexport default LoadingBar;\n","import { Box } from \"theme-ui\";\n\nimport { useMapLoading } from \"../../contexts/MapLoadingContext\";\n\nimport LoadingBar from \"../LoadingBar\";\n\nfunction MapLoadingOverlay() {\n  const { isLoading, loadingProgressRef } = useMapLoading();\n\n  if (!isLoading) {\n    return null;\n  }\n\n  return (\n      <Box\n        sx={{\n          position: \"absolute\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          top: 0,\n          left: 0,\n          right: 0,\n          flexDirection: \"column\",\n          zIndex: 2,\n        }}\n        bg=\"overlay\"\n      >\n        <LoadingBar\n          isLoading={isLoading}\n          loadingProgressRef={loadingProgressRef}\n        />\n      </Box>\n    );\n}\n\nexport default MapLoadingOverlay;\n","import { useState, useEffect } from \"react\";\nimport { Text } from \"theme-ui\";\n\nimport LoadingOverlay from \"./LoadingOverlay\";\n\nimport { shuffle } from \"../helpers/shared\";\n\nconst facts = [\n  \"Owls can rotate their necks 270 degrees\",\n  \"Not all owls hoot\",\n  \"Owl flight is almost completely silent\",\n  \"Owls are used to represent the Goddess Athena in Greek mythology\",\n  \"Owls have the best night vision of any animal\",\n  \"Bears can run up to 40 mi (~64 km) per hour \",\n  \"A hibernating bears heart beats at 8 bpm\",\n  \"Bears can see in colour\",\n  \"Koala bears are not bears\",\n  \"A polar bear can swim up to 100 mi (~161 km) without resting\",\n  \"A group of bears is called a sleuth or sloth\",\n  \"Not all bears hibernate\",\n];\n\nfunction UpgradingLoadingOverlay() {\n  const [subText, setSubText] = useState<string>();\n\n  useEffect(() => {\n    let index = 0;\n    let randomFacts = shuffle(facts);\n\n    function updateFact() {\n      setSubText(randomFacts[index % (randomFacts.length - 1)]);\n      index += 1;\n    }\n\n    // Show first fact after 10 seconds then every 20 seconds after that\n    let interval: NodeJS.Timeout;\n    let timeout = setTimeout(() => {\n      updateFact();\n      interval = setInterval(() => {\n        updateFact();\n      }, 20 * 1000);\n    }, 10 * 1000);\n\n    return () => {\n      clearTimeout(timeout);\n      if (interval) {\n        clearInterval(interval);\n      }\n    };\n  }, []);\n\n  return (\n    <LoadingOverlay>\n      <Text as=\"p\" variant=\"body2\" m={1}>\n        Database upgrading, please wait...\n      </Text>\n      {subText && (\n        <>\n          <Text\n            sx={{ maxWidth: \"200px\", textAlign: \"center\" }}\n            as=\"p\"\n            variant=\"caption\"\n            m={1}\n          >\n            We're still working on the upgrade. In the meantime, did you know?\n          </Text>\n          <Text\n            sx={{ maxWidth: \"200px\", textAlign: \"center\" }}\n            as=\"p\"\n            variant=\"body2\"\n          >\n            {subText}\n          </Text>\n        </>\n      )}\n    </LoadingOverlay>\n  );\n}\n\nexport default UpgradingLoadingOverlay;\n","import { useState, useRef, ChangeEvent, FormEvent } from \"react\";\nimport { Box, Input, Button, Label, Flex } from \"theme-ui\";\n\nimport { useAuth } from \"../contexts/AuthContext\";\n\nimport Modal from \"../components/Modal\";\n\ntype AuthModalProps = {\n  isOpen: boolean;\n  onSubmit: (newPassword: string) => void;\n};\n\nfunction AuthModal({ isOpen, onSubmit }: AuthModalProps) {\n  const { password, setPassword } = useAuth();\n  const [tmpPassword, setTempPassword] = useState<string>(password);\n\n  function handleChange(event: ChangeEvent<HTMLInputElement>): void {\n    setTempPassword(event.target?.value);\n  }\n\n  function handleSubmit(event: FormEvent<HTMLElement>): void {\n    event.preventDefault();\n    setPassword(tmpPassword);\n    onSubmit(tmpPassword);\n  }\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput(): void {\n    inputRef.current && inputRef.current?.focus();\n  }\n\n  return (\n    <Modal isOpen={isOpen} allowClose={false} onAfterOpen={focusInput}>\n      <Box as=\"form\" onSubmit={handleSubmit}>\n        <Label py={2} htmlFor=\"password\">\n          Enter password\n        </Label>\n        <Input\n          id=\"password\"\n          value={tmpPassword}\n          onChange={handleChange}\n          ref={inputRef}\n          autoComplete=\"off\"\n        />\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }}>Join</Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default AuthModal;\n","import { Box, Label, Flex, Button, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype GameExpiredModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction GameExpiredModal({ isOpen, onRequestClose }: GameExpiredModalProps) {\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{ content: { maxWidth: \"450px\" } }}\n    >\n      <Box>\n        <Label py={2}>Game Timed Out</Label>\n        <Text as=\"p\" mb={2} variant=\"caption\">\n          Reselect your map to pick up where you left off.\n        </Text>\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }} m={1} ml={0} onClick={onRequestClose}>\n            Ok\n          </Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default GameExpiredModal;\n","import { Box, Label, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nfunction ForceUpdateModal({ isOpen }: { isOpen: boolean }) {\n  return (\n    <Modal\n      isOpen={isOpen}\n      allowClose={false}\n      style={{ content: { maxWidth: \"450px\" } }}\n    >\n      <Box>\n        <Label py={2}>New Update Available</Label>\n        <Text as=\"p\" mb={2} variant=\"caption\">\n          Please refresh your browser to update to the latest version.\n        </Text>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default ForceUpdateModal;\n","import { Box, Label, Flex, Button, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype MaintenanceModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction MaintenanceModal({ isOpen, onRequestClose }: MaintenanceModalProps) {\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{ content: { maxWidth: \"450px\" } }}\n    >\n      <Box>\n        <Label py={2}>Site under maintenance</Label>\n        <Text as=\"p\" mb={2} variant=\"caption\">\n          Continue offline?\n        </Text>\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }} m={1} ml={0} onClick={onRequestClose}>\n            Ok\n          </Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default MaintenanceModal;\n","import React, { useContext } from \"react\";\nimport Konva from \"konva\";\n\nexport type MapStage = React.MutableRefObject<Konva.Stage | null>;\n\nconst MapStageContext = React.createContext<MapStage | undefined>(undefined);\nexport const MapStageProvider = MapStageContext.Provider;\n\nexport function useMapStage() {\n  const context = useContext(MapStageContext);\n  if (context === undefined) {\n    throw new Error(\"useMapStage must be used within a MapStageProvider\");\n  }\n  return context;\n}\n\nexport default MapStageContext;\n","import { ModelJSON } from \"@tensorflow/tfjs-core/dist/io/types\";\nimport blobToBuffer from \"../helpers/blobToBuffer\";\n\nclass Model {\n  config: ModelJSON;\n  weightsMapping: { [path: string]: string };\n  constructor(config: ModelJSON, weightsMapping: { [path: string]: string }) {\n    this.config = config;\n    this.weightsMapping = weightsMapping;\n  }\n\n  async load() {\n    // Load weights from the manifest then fetch them into an ArrayBuffer\n    let buffers: ArrayBuffer[] = [];\n    if (this.config === undefined) {\n      return;\n    }\n    const manifest = this.config?.weightsManifest[0];\n    for (let path of manifest.paths) {\n      const url = this.weightsMapping[path];\n      const response = await fetch(url);\n      const buffer = await response.arrayBuffer();\n      buffers.push(buffer);\n    }\n    const merged = new Blob(buffers);\n    const weightData = await blobToBuffer(merged);\n    const weightSpecs = manifest.weights;\n\n    const modelArtifacts = {\n      modelTopology: this.config.modelTopology,\n      format: this.config.format,\n      generatedBy: this.config.generatedBy,\n      convertedBy: this.config.convertedBy,\n      weightData,\n      weightSpecs,\n    };\n    return modelArtifacts;\n  }\n}\n\nexport default Model;\n","export default __webpack_public_path__ + \"static/media/group1-shard1of1.3e53df0b.bin\";","import Model from \"../Model\";\n\nimport config from \"./model.json\";\nimport weights from \"./group1-shard1of1.bin\";\nimport { LayersModel } from \"@tensorflow/tfjs\";\nimport { ModelJSON } from \"@tensorflow/tfjs-core/dist/io/types\";\n\nclass GridSizeModel extends Model {\n  // Store model as static to prevent extra network requests\n  static model: LayersModel;\n  // Load tensorflow dynamically\n  static tf: any;\n  constructor() {\n    super(config as ModelJSON, { \"group1-shard1of1.bin\": weights });\n  }\n\n  async predict(imageData: ImageData) {\n    if (!GridSizeModel.tf) {\n      GridSizeModel.tf = await import(\"@tensorflow/tfjs\");\n    }\n    const tf = GridSizeModel.tf;\n\n    if (!GridSizeModel.model) {\n      GridSizeModel.model = await tf.loadLayersModel(this);\n    }\n    const model = GridSizeModel.model;\n\n    const prediction = tf.tidy(() => {\n      const image = tf.browser.fromPixels(imageData, 1).toFloat();\n      const normalized = image.div(tf.scalar(255.0));\n      const batched = tf.expandDims(normalized);\n      return model.predict(batched);\n    });\n    const data = await prediction.data();\n    return data[0];\n  }\n}\n\nexport default GridSizeModel;\n","/**\n * Vector class with x, y, z and static helper methods\n */\nclass Vector3 {\n  /**\n   * @type {number} x - X component of the vector\n   */\n  x: number;\n  /**\n   * @type {number} y - Y component of the vector\n   */\n  y: number;\n  /**\n   * @type {number} z - Z component of the vector\n   */\n  z: number;\n\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} z\n   */\n  constructor(x: number, y: number, z: number) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n\n  /**\n   * Round a Vector3 to the nearest integer while maintaining x + y + z = 0\n   * @param {Vector3} cube\n   * @returns {Vector3}\n   */\n  static cubeRound(cube: Vector3): Vector3 {\n    var rX = Math.round(cube.x);\n    var rY = Math.round(cube.y);\n    var rZ = Math.round(cube.z);\n\n    var xDiff = Math.abs(rX - cube.x);\n    var yDiff = Math.abs(rY - cube.y);\n    var zDiff = Math.abs(rZ - cube.z);\n\n    if (xDiff > yDiff && xDiff > zDiff) {\n      rX = -rY - rZ;\n    } else if (yDiff > zDiff) {\n      rY = -rX - rZ;\n    } else {\n      rZ = -rX - rY;\n    }\n\n    return new Vector3(rX, rY, rZ);\n  }\n}\n\nexport default Vector3;\n","import {\n  toRadians,\n  roundTo as roundToNumber,\n  lerp as lerpNumber,\n  floorTo as floorToNumber,\n} from \"./shared\";\n\nexport type BoundingBox = {\n  min: Vector2;\n  max: Vector2;\n  width: number;\n  height: number;\n  center: Vector2;\n};\n\n/**\n * Vector class with x, y and static helper methods\n */\nclass Vector2 {\n  /**\n   * @type {number} x - X component of the vector\n   */\n  x: number;\n  /**\n   * @type {number} y - Y component of the vector\n   */\n  y: number;\n\n  /**\n   * @param {number} x\n   * @param {number} y\n   */\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  /**\n   * @param {Vector2} p\n   * @returns {number} Length squared of `p`\n   */\n  static lengthSquared(p: Vector2): number {\n    return p.x * p.x + p.y * p.y;\n  }\n\n  /**\n   * Returns the length of vector `p` Note: magnitude to not conflict with native length property\n   * @param {Vector2} p\n   * @returns {number} Length of `p`\n   */\n  static magnitude(p: Vector2): number {\n    return Math.sqrt(this.lengthSquared(p));\n  }\n\n  /**\n   * @param {Vector2} p\n   * @returns {Vector2} `p` normalized, if length of `p` is 0 `{x: 0, y: 0}` is returned\n   */\n  static normalize(p: Vector2): Vector2 {\n    const l = this.magnitude(p);\n    if (l === 0) {\n      return { x: 0, y: 0 };\n    }\n    return this.divide(p, l);\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {Vector2} b\n   * @returns {number}  Dot product between `a` and `b`\n   */\n  static dot(a: Vector2, b: Vector2): number {\n    return a.x * b.x + a.y * b.y;\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {(Vector2 | number)} b\n   * @returns {Vector2} a - b\n   */\n  static subtract(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: a.x - b, y: a.y - b };\n    } else {\n      return { x: a.x - b.x, y: a.y - b.y };\n    }\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {(Vector2 | number)} b\n   * @returns {Vector2} a + b\n   */\n  static add(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: a.x + b, y: a.y + b };\n    } else {\n      return { x: a.x + b.x, y: a.y + b.y };\n    }\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {(Vector2 | number)} b\n   * @returns {Vector2} a * b\n   */\n  static multiply(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: a.x * b, y: a.y * b };\n    } else {\n      return { x: a.x * b.x, y: a.y * b.y };\n    }\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {(Vector2 | number)} b\n   * @returns {Vector2} a / b\n   */\n  static divide(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: a.x / b, y: a.y / b };\n    } else {\n      return { x: a.x / b.x, y: a.y / b.y };\n    }\n  }\n\n  /**\n   * Rotates a point around a given origin by an angle in degrees\n   * @param {Vector2} point Point to rotate\n   * @param {Vector2} origin Origin of the rotation\n   * @param {number} angle Angle of rotation in degrees\n   * @returns {Vector2} Rotated point\n   */\n  static rotate(point: Vector2, origin: Vector2, angle: number): Vector2 {\n    const cos = Math.cos(toRadians(angle));\n    const sin = Math.sin(toRadians(angle));\n    const dif = this.subtract(point, origin);\n    return {\n      x: origin.x + cos * dif.x - sin * dif.y,\n      y: origin.y + sin * dif.x + cos * dif.y,\n    };\n  }\n\n  /**\n   * Rotates a direction by a given angle in degrees\n   * @param {Vector2} direction Direction to rotate\n   * @param {number} angle Angle of rotation in degrees\n   * @returns {Vector2} Rotated direction\n   */\n  static rotateDirection(direction: Vector2, angle: number): Vector2 {\n    return this.rotate(direction, { x: 0, y: 0 }, angle);\n  }\n\n  /**\n   * Returns the min of `a` and `b`\n   * @param {Vector2} a\n   * @param {Vector2 | number} b Value to compare\n   * @returns {Vector2}\n   */\n  static min(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: Math.min(a.x, b), y: Math.min(a.y, b) };\n    } else {\n      return { x: Math.min(a.x, b.x), y: Math.min(a.y, b.y) };\n    }\n  }\n\n  /**\n   * Returns the component wise minimum of `a`\n   * @param {Vector2} a\n   * @returns {number}\n   */\n  static componentMin(a: Vector2): number {\n    return a.x < a.y ? a.x : a.y;\n  }\n\n  /**\n   * Returns the max of `a` and `b`\n   * @param {Vector2} a\n   * @param {Vector2 | number} b Value to compare\n   * @returns {Vector2}\n   */\n  static max(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: Math.max(a.x, b), y: Math.max(a.y, b) };\n    } else {\n      return { x: Math.max(a.x, b.x), y: Math.max(a.y, b.y) };\n    }\n  }\n\n  /**\n   * Returns the component wise maximum of `a`\n   * @param {Vector2} a\n   * @returns {number)}\n   */\n  static componentMax(a: Vector2): number {\n    return a.x > a.y ? a.x : a.y;\n  }\n\n  /**\n   * Rounds `p` to the nearest value of `to`\n   * @param {Vector2} p\n   * @param {Vector2} to\n   * @returns {Vector2}\n   */\n  static roundTo(p: Vector2, to: Vector2): Vector2 {\n    return {\n      x: roundToNumber(p.x, to.x),\n      y: roundToNumber(p.y, to.y),\n    };\n  }\n\n  /**\n   * Floors `p` to the nearest value of `to`\n   * @param {Vector2} p\n   * @param {Vector2} to\n   * @returns {Vector2}\n   */\n  static floorTo(p: Vector2, to: Vector2): Vector2 {\n    return {\n      x: floorToNumber(p.x, to.x),\n      y: floorToNumber(p.y, to.y),\n    };\n  }\n\n  /**\n   * @param {Vector2} a\n   * @returns {Vector2} The component wise sign of `a`\n   */\n  static sign(a: Vector2): Vector2 {\n    return { x: Math.sign(a.x), y: Math.sign(a.y) };\n  }\n\n  /**\n   * @param {Vector2} a\n   * @returns {Vector2} The component wise absolute of `a`\n   */\n  static abs(a: Vector2): Vector2 {\n    return { x: Math.abs(a.x), y: Math.abs(a.y) };\n  }\n\n  /**\n   * @param {Vector2} a\n   * @param {(Vector2 | number)} b\n   * @returns {Vector2} `a` to the power of `b`\n   */\n  static pow(a: Vector2, b: Vector2 | number): Vector2 {\n    if (typeof b === \"number\") {\n      return { x: Math.pow(a.x, b), y: Math.pow(a.y, b) };\n    } else {\n      return { x: Math.pow(a.x, b.x), y: Math.pow(a.y, b.y) };\n    }\n  }\n\n  /**\n   * @param {Vector2} a\n   * @returns {number} The dot product between `a` and `a`\n   */\n  static dot2(a: Vector2): number {\n    return this.dot(a, a);\n  }\n\n  /**\n   * Clamps `a` between `min` and `max`\n   * @param {Vector2} a\n   * @param {number} min\n   * @param {number} max\n   * @returns {Vector2}\n   */\n  static clamp(a: Vector2, min: number, max: number): Vector2 {\n    return {\n      x: Math.min(Math.max(a.x, min), max),\n      y: Math.min(Math.max(a.y, min), max),\n    };\n  }\n\n  /**\n   * Calculates the distance between a point and a line segment\n   * See more at {@link https://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm}\n   * @param {Vector2} p Point\n   * @param {Vector2} a Start of the line\n   * @param {Vector2} b End of the line\n   * @returns {Object} The distance to and the closest point on the line segment\n   */\n  static distanceToLine(p: Vector2, a: Vector2, b: Vector2): Object {\n    const pa = this.subtract(p, a);\n    const ba = this.subtract(b, a);\n    const h = Math.min(Math.max(this.dot(pa, ba) / this.dot(ba, ba), 0), 1);\n    const distance = this.magnitude(this.subtract(pa, this.multiply(ba, h)));\n    const point = this.add(a, this.multiply(ba, h));\n    return { distance, point };\n  }\n\n  /**\n   * Calculates the distance between a point and a quadratic bezier curve\n   * See more at {@link https://www.shadertoy.com/view/MlKcDD}\n   * @todo Fix the robustness of this to allow smoothing on fog layers\n   * @param {Vector2} pos Position\n   * @param {Vector2} A Start of the curve\n   * @param {Vector2} B Control point of the curve\n   * @param {Vector2} C End of the curve\n   * @returns {Object} The distance to and the closest point on the curve\n   */\n  static distanceToQuadraticBezier(\n    pos: Vector2,\n    A: Vector2,\n    B: Vector2,\n    C: Vector2\n  ): Object {\n    let distance = 0;\n    let point = { x: pos.x, y: pos.y };\n\n    const a = this.subtract(B, A);\n    const b = this.add(this.subtract(A, this.multiply(B, 2)), C);\n    const c = this.multiply(a, 2);\n    const d = this.subtract(A, pos);\n\n    // Solve cubic roots to find closest points\n    const kk = 1 / this.dot(b, b);\n    const kx = kk * this.dot(a, b);\n    const ky = (kk * (2 * this.dot(a, a) + this.dot(d, b))) / 3;\n    const kz = kk * this.dot(d, a);\n\n    const p = ky - kx * kx;\n    const p3 = p * p * p;\n    const q = kx * (2 * kx * kx - 3 * ky) + kz;\n    let h = q * q + 4 * p3;\n\n    if (h >= 0) {\n      // 1 root\n      h = Math.sqrt(h);\n      const x = this.divide(this.subtract({ x: h, y: -h }, q), 2);\n      const uv = this.multiply(this.sign(x), this.pow(this.abs(x), 1 / 3));\n      const t = Math.min(Math.max(uv.x + uv.y - kx, 0), 1);\n      point = this.add(A, this.multiply(this.add(c, this.multiply(b, t)), t));\n      distance = this.dot2(\n        this.add(d, this.multiply(this.add(c, this.multiply(b, t)), t))\n      );\n    } else {\n      // 3 roots but ignore the 3rd one as it will never be closest\n      // https://www.shadertoy.com/view/MdXBzB\n      const z = Math.sqrt(-p);\n      const v = Math.acos(q / (p * z * 2)) / 3;\n      const m = Math.cos(v);\n      const n = Math.sin(v) * 1.732050808;\n\n      const t = this.clamp(\n        this.subtract(this.multiply({ x: m + m, y: -n - m }, z), kx),\n        0,\n        1\n      );\n      const d1 = this.dot2(\n        this.add(d, this.multiply(this.add(c, this.multiply(b, t.x)), t.x))\n      );\n      const d2 = this.dot2(\n        this.add(d, this.multiply(this.add(c, this.multiply(b, t.y)), t.y))\n      );\n      distance = Math.min(d1, d2);\n      if (d1 < d2) {\n        point = this.add(\n          d,\n          this.multiply(this.add(c, this.multiply(b, t.x)), t.x)\n        );\n      } else {\n        point = this.add(\n          d,\n          this.multiply(this.add(c, this.multiply(b, t.y)), t.y)\n        );\n      }\n    }\n\n    return { distance: Math.sqrt(distance), point: point };\n  }\n\n  /**\n   * @typedef BoundingBox\n   * @property {Vector2} min\n   * @property {Vector2} max\n   * @property {number} width\n   * @property {number} height\n   * @property {Vector2} center\n   */\n\n  /**\n   * Calculates an axis-aligned bounding box around an array of point\n   * @param {Vector2[]} points\n   * @returns {BoundingBox}\n   */\n  static getBoundingBox(points: Vector2[]): BoundingBox {\n    let minX = Number.MAX_VALUE;\n    let maxX = Number.MIN_VALUE;\n    let minY = Number.MAX_VALUE;\n    let maxY = Number.MIN_VALUE;\n    for (let point of points) {\n      minX = point.x < minX ? point.x : minX;\n      maxX = point.x > maxX ? point.x : maxX;\n      minY = point.y < minY ? point.y : minY;\n      maxY = point.y > maxY ? point.y : maxY;\n    }\n    let width = maxX - minX;\n    let height = maxY - minY;\n    let center = { x: (minX + maxX) / 2, y: (minY + maxY) / 2 };\n    return {\n      min: { x: minX, y: minY },\n      max: { x: maxX, y: maxY },\n      width,\n      height,\n      center,\n    };\n  }\n\n  /**\n   * Checks to see if a point is in a polygon using ray casting\n   * See more at {@link https://en.wikipedia.org/wiki/Point_in_polygon#Ray_casting_algorithm}\n   * and {@link https://stackoverflow.com/questions/217578/how-can-i-determine-whether-a-2d-point-is-within-a-polygon/2922778}\n   * @param {Vector2} p\n   * @param {Vector2[]} points\n   * @returns {boolean}\n   */\n  static pointInPolygon(p: Vector2, points: Vector2[]): boolean {\n    const bounds = this.getBoundingBox(points);\n    if (\n      p.x < bounds.min.x ||\n      p.x > bounds.max.x ||\n      p.y < bounds.min.y ||\n      p.y > bounds.max.y\n    ) {\n      return false;\n    }\n\n    let isInside = false;\n    for (let i = 0, j = points.length - 1; i < points.length; j = i++) {\n      const a = points[i].y > p.y;\n      const b = points[j].y > p.y;\n      if (\n        a !== b &&\n        p.x <\n          ((points[j].x - points[i].x) * (p.y - points[i].y)) /\n            (points[j].y - points[i].y) +\n            points[i].x\n      ) {\n        isInside = !isInside;\n      }\n    }\n    return isInside;\n  }\n\n  /**\n   * Returns true if a the distance between `a` and `b` is under `threshold`\n   * @param {Vector2} a\n   * @param {Vector2} b\n   * @param {number} threshold\n   * @returns {boolean}\n   */\n  static compare(a: Vector2, b: Vector2, threshold: number): boolean {\n    return this.lengthSquared(this.subtract(a, b)) < threshold * threshold;\n  }\n\n  /**\n   * Returns the distance between two vectors\n   * @param {Vector2} a\n   * @param {Vector2} b\n   * @returns {number}\n   */\n  static distance(a: Vector2, b: Vector2): number {\n    return this.magnitude(this.subtract(a, b));\n  }\n\n  /**\n   * Linear interpolate between `a` and `b` by `alpha`\n   * @param {Vector2} a\n   * @param {Vector2} b\n   * @param {number} alpha\n   * @returns {Vector2}\n   */\n  static lerp(a: Vector2, b: Vector2, alpha: number): Vector2 {\n    return { x: lerpNumber(a.x, b.x, alpha), y: lerpNumber(a.y, b.y, alpha) };\n  }\n\n  /**\n   * Returns total length of a an array of points treated as a path\n   * @param {Vector2[]} points the array of points in the path\n   * @returns {number}\n   */\n  static pathLength(points: Vector2[]): number {\n    let l = 0;\n    for (let i = 1; i < points.length; i++) {\n      l += this.distance(points[i - 1], points[i]);\n    }\n    return l;\n  }\n\n  /**\n   * Resample a path to n number of evenly distributed points\n   * based off of http://depts.washington.edu/acelab/proj/dollar/index.html\n   * @param {Vector2[]} points the points to resample\n   * @param {number} n the number of new points\n   * @returns {Vector2[]}\n   */\n  static resample(points: Vector2[], n: number): Vector2[] {\n    if (points.length === 0 || n <= 0) {\n      return [];\n    }\n    let localPoints = [...points];\n    const intervalLength = this.pathLength(localPoints) / (n - 1);\n    let resampledPoints = [localPoints[0]];\n    let currentDistance = 0;\n    for (let i = 1; i < localPoints.length; i++) {\n      let d = this.distance(localPoints[i - 1], localPoints[i]);\n      if (currentDistance + d >= intervalLength) {\n        let newPoint = this.lerp(\n          localPoints[i - 1],\n          localPoints[i],\n          (intervalLength - currentDistance) / d\n        );\n        resampledPoints.push(newPoint);\n        localPoints.splice(i, 0, newPoint);\n        currentDistance = 0;\n      } else {\n        currentDistance += d;\n      }\n    }\n    if (resampledPoints.length === n - 1) {\n      resampledPoints.push(localPoints[localPoints.length - 1]);\n    }\n\n    return resampledPoints;\n  }\n\n  /**\n   * Rotate a vector 90 degrees\n   * @param {Vector2} p Point\n   * @param {(\"counterClockwise\"|\"clockwise\")=} direction Direction to rotate the vector\n   * @returns {Vector2}\n   */\n  static rotate90(\n    p: Vector2,\n    direction: \"counterClockwise\" | \"clockwise\" = \"clockwise\"\n  ): Vector2 {\n    if (direction === \"clockwise\") {\n      return { x: p.y, y: -p.x };\n    } else {\n      return { x: -p.y, y: p.x };\n    }\n  }\n\n  /**\n   * Returns the centroid of the given points\n   * @param {Vector2[]} points\n   * @returns {Vector2}\n   */\n  static centroid(points: Vector2[]): Vector2 {\n    let center = { x: 0, y: 0 };\n    for (let point of points) {\n      center.x += point.x;\n      center.y += point.y;\n    }\n    if (points.length > 0) {\n      center = { x: center.x / points.length, y: center.y / points.length };\n    }\n    return center;\n  }\n\n  /**\n   * Determine whether given points are rectangular\n   * @param {Vector2[]} points\n   * @returns {boolean}\n   */\n  static rectangular(points: Vector2[]): boolean {\n    if (points.length !== 4) {\n      return false;\n    }\n    // Check whether distance to the center is the same for all four points\n    const centroid = this.centroid(points);\n    let prevDist;\n    for (let point of points) {\n      const dist = this.distance(point, centroid);\n      if (prevDist && dist !== prevDist) {\n        return false;\n      } else {\n        prevDist = dist;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Determine whether given points are circular\n   * @param {Vector2[]} points\n   * @returns {boolean}\n   */\n  static circular(points: Vector2[], threshold = 0.1): boolean {\n    const centroid = this.centroid(points);\n    let distances = [];\n    for (let point of points) {\n      distances.push(this.distance(point, centroid));\n    }\n    if (distances.length > 0) {\n      const maxDistance = Math.max(...distances);\n      const minDistance = Math.min(...distances);\n      return maxDistance - minDistance < threshold;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default Vector2;\n","import Vector2 from \"./Vector2\";\n\n/**\n * Wrapper for Vector2 that provides width, height and radius properties\n */\nclass Size extends Vector2 {\n  _radius;\n  /**\n   * @param {number} width\n   * @param {number} height\n   * @param {number} radius Used to represent hexagon sizes\n   */\n  constructor(width: number, height: number, radius?: number) {\n    super(width, height);\n    this._radius = radius;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get width(): number {\n    return this.x;\n  }\n\n  /**\n   * @param {number} width\n   */\n  set width(width: number) {\n    this.x = width;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get height(): number {\n    return this.y;\n  }\n\n  /**\n   * @param {number} height\n   */\n  set height(height: number) {\n    this.y = height;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get radius(): number {\n    if (this._radius) {\n      return this._radius;\n    } else {\n      return Math.min(this.x, this.y) / 2;\n    }\n  }\n\n  /**\n   * @param {number} radius\n   */\n  set radius(radius: number) {\n    this._radius = radius;\n  }\n}\n\nexport default Size;\n","import GridSizeModel from \"../ml/gridSize/GridSizeModel\";\nimport Vector3 from \"./Vector3\";\nimport Vector2 from \"./Vector2\";\nimport Size from \"./Size\";\n\nimport { Grid, GridInset, GridScale } from \"../types/Grid\";\n\nconst SQRT3 = 1.73205;\nconst GRID_TYPE_NOT_IMPLEMENTED = new Error(\"Grid type not implemented\");\n\n/**\n * Gets the size of a grid in pixels taking into account the inset\n * @param {Grid} grid\n * @param {number} baseWidth Width of the grid in pixels before inset\n * @param {number} baseHeight Height of the grid in pixels before inset\n * @returns {Size}\n */\nexport function getGridPixelSize(\n  grid: Required<Grid>,\n  baseWidth: number,\n  baseHeight: number\n): Size {\n  const width = (grid.inset.bottomRight.x - grid.inset.topLeft.x) * baseWidth;\n  const height = (grid.inset.bottomRight.y - grid.inset.topLeft.y) * baseHeight;\n  return new Size(width, height);\n}\n\n/**\n * Gets the cell size for a grid in pixels for each grid type\n * @param {Grid} grid\n * @param {number} gridWidth Width of the grid in pixels after inset\n * @param {number} gridHeight Height of the grid in pixels after inset\n * @returns {Size}\n */\nexport function getCellPixelSize(\n  grid: Grid,\n  gridWidth: number,\n  gridHeight: number\n): Size {\n  if (grid.size.x === 0 || grid.size.y === 0) {\n    return new Size(0, 0);\n  }\n  switch (grid.type) {\n    case \"square\":\n      return new Size(gridWidth / grid.size.x, gridHeight / grid.size.y);\n    case \"hexVertical\":\n      const radiusVert = gridWidth / grid.size.x / SQRT3;\n      return new Size(radiusVert * SQRT3, radiusVert * 2, radiusVert);\n    case \"hexHorizontal\":\n      const radiusHorz = gridHeight / grid.size.y / SQRT3;\n      return new Size(radiusHorz * 2, radiusHorz * SQRT3, radiusHorz);\n    default:\n      throw GRID_TYPE_NOT_IMPLEMENTED;\n  }\n}\n\n/**\n * Find the center location of a cell in the grid.\n * Hex is addressed in an offset coordinate system with even numbered columns/rows offset to the right\n * @param {Grid} grid\n * @param {number} col X-axis coordinate of the cell\n * @param {number} row Y-axis coordinate of the cell\n * @param {Size} cellSize Cell size in pixels\n * @returns {Vector2}\n */\nexport function getCellLocation(\n  grid: Grid,\n  col: number,\n  row: number,\n  cellSize: Size\n): Vector2 {\n  switch (grid.type) {\n    case \"square\":\n      return {\n        x: col * cellSize.width + cellSize.width / 2,\n        y: row * cellSize.height + cellSize.height / 2,\n      };\n    case \"hexVertical\":\n      return {\n        x: cellSize.radius * SQRT3 * (col - 0.5 * (row & 1)),\n        y: ((cellSize.radius * 3) / 2) * row,\n      };\n    case \"hexHorizontal\":\n      return {\n        x: ((cellSize.radius * 3) / 2) * col,\n        y: cellSize.radius * SQRT3 * (row - 0.5 * (col & 1)),\n      };\n    default:\n      throw GRID_TYPE_NOT_IMPLEMENTED;\n  }\n}\n\n/**\n * Find the coordinates of the nearest cell in the grid to a point in pixels\n * @param {Grid} grid\n * @param {number} x X location to look for in pixels\n * @param {number} y Y location to look for in pixels\n * @param {Size} cellSize Cell size in pixels\n * @returns {Vector2}\n */\nexport function getNearestCellCoordinates(\n  grid: Grid,\n  x: number,\n  y: number,\n  cellSize: Size\n): Vector2 {\n  switch (grid.type) {\n    case \"square\":\n      return Vector2.divide(Vector2.floorTo({ x, y }, cellSize), cellSize);\n    case \"hexVertical\":\n      // Find nearest cell in cube coordinates the convert to offset coordinates\n      const cubeXVert = ((SQRT3 / 3) * x - (1 / 3) * y) / cellSize.radius;\n      const cubeZVert = ((2 / 3) * y) / cellSize.radius;\n      const cubeYVert = -cubeXVert - cubeZVert;\n      const cubeVert = new Vector3(cubeXVert, cubeYVert, cubeZVert);\n      return hexCubeToOffset(Vector3.cubeRound(cubeVert), \"hexVertical\");\n    case \"hexHorizontal\":\n      const cubeXHorz = ((2 / 3) * x) / cellSize.radius;\n      const cubeZHorz = (-(1 / 3) * x + (SQRT3 / 3) * y) / cellSize.radius;\n      const cubeYHorz = -cubeXHorz - cubeZHorz;\n      const cubeHorz = new Vector3(cubeXHorz, cubeYHorz, cubeZHorz);\n      return hexCubeToOffset(Vector3.cubeRound(cubeHorz), \"hexHorizontal\");\n    default:\n      throw GRID_TYPE_NOT_IMPLEMENTED;\n  }\n}\n\n/**\n * Find the corners of a grid cell\n * @param {Grid} grid\n * @param {number} x X location of the cell in pixels\n * @param {number} y Y location of the cell in pixels\n * @param {Size} cellSize Cell size in pixels\n * @returns {Vector2[]}\n */\nexport function getCellCorners(\n  grid: Grid,\n  x: number,\n  y: number,\n  cellSize: Size\n): Vector2[] {\n  const position = new Vector2(x, y);\n  switch (grid.type) {\n    case \"square\":\n      const halfSize = Vector2.multiply(cellSize, 0.5);\n      return [\n        Vector2.add(position, Vector2.multiply(halfSize, { x: -1, y: -1 })),\n        Vector2.add(position, Vector2.multiply(halfSize, { x: 1, y: -1 })),\n        Vector2.add(position, Vector2.multiply(halfSize, { x: 1, y: 1 })),\n        Vector2.add(position, Vector2.multiply(halfSize, { x: -1, y: 1 })),\n      ];\n    case \"hexVertical\":\n      const up = Vector2.subtract(position, { x: 0, y: cellSize.radius });\n      return [\n        up,\n        Vector2.rotate(up, position, 60),\n        Vector2.rotate(up, position, 120),\n        Vector2.rotate(up, position, 180),\n        Vector2.rotate(up, position, 240),\n        Vector2.rotate(up, position, 300),\n      ];\n    case \"hexHorizontal\":\n      const right = Vector2.add(position, { x: cellSize.radius, y: 0 });\n      return [\n        right,\n        Vector2.rotate(right, position, 60),\n        Vector2.rotate(right, position, 120),\n        Vector2.rotate(right, position, 180),\n        Vector2.rotate(right, position, 240),\n        Vector2.rotate(right, position, 300),\n      ];\n    default:\n      throw GRID_TYPE_NOT_IMPLEMENTED;\n  }\n}\n\n/**\n * Get the height of a grid based off of its width\n * @param {Grid} grid\n * @param {number} gridWidth Width of the grid in pixels after inset\n * @returns {number}\n */\nfunction getGridHeightFromWidth(\n  grid: Pick<Grid, \"type\" | \"size\">,\n  gridWidth: number\n): number {\n  switch (grid.type) {\n    case \"square\":\n      return (grid.size.y * gridWidth) / grid.size.x;\n    case \"hexVertical\":\n      const cellHeightVert = (gridWidth / grid.size.x / SQRT3) * 2;\n      return grid.size.y * cellHeightVert * (3 / 4) + cellHeightVert * (1 / 4);\n    case \"hexHorizontal\":\n      const cellHeightHroz = gridWidth / ((grid.size.x - 1) * (3 / 4) + 1);\n      return grid.size.y * cellHeightHroz * (SQRT3 / 2);\n    default:\n      throw GRID_TYPE_NOT_IMPLEMENTED;\n  }\n}\n\n/**\n * Get the default inset for a grid\n * @param {Grid} grid Grid with no inset property set\n * @param {number} mapWidth Width of the map in pixels before inset\n * @param {number} mapHeight Height of the map in pixels before inset\n * @returns {GridInset}\n */\nexport function getGridDefaultInset(\n  grid: Pick<Grid, \"type\" | \"size\">,\n  mapWidth: number,\n  mapHeight: number\n): GridInset {\n  // Max the width of the inset and figure out the resulting height value\n  const insetHeightNorm = getGridHeightFromWidth(grid, mapWidth) / mapHeight;\n  return { topLeft: { x: 0, y: 0 }, bottomRight: { x: 1, y: insetHeightNorm } };\n}\n\n/**\n * Get an updated inset for a grid when its size changes\n * @param {Grid} grid Grid with an inset property set\n * @param {number} mapWidth Width of the map in pixels before inset\n * @param {number} mapHeight Height of the map in pixels before inset\n * @returns {GridInset}\n */\nexport function getGridUpdatedInset(\n  grid: Grid,\n  mapWidth: number,\n  mapHeight: number\n): GridInset {\n  let inset = {\n    topLeft: { ...grid.inset.topLeft },\n    bottomRight: { ...grid.inset.bottomRight },\n  };\n  // Take current inset width and use it to calculate the new height\n  if (grid.size.x > 0 && grid.size.x > 0) {\n    // Convert to px relative to map size\n    const gridWidth = (inset.bottomRight.x - inset.topLeft.x) * mapWidth;\n    // Calculate the new inset height and convert back to normalized form\n    const insetHeightNorm = getGridHeightFromWidth(grid, gridWidth) / mapHeight;\n    inset.bottomRight.y = inset.topLeft.y + insetHeightNorm;\n  }\n  return inset;\n}\n\n/**\n * Get the max zoom for a grid\n * @param {Grid=} grid\n * @returns {number}\n */\nexport function getGridMaxZoom(grid?: Grid): number {\n  if (!grid) {\n    return 10;\n  }\n  // Return max grid size / 2\n  return Math.max(Math.max(grid.size.x, grid.size.y) / 2, 5);\n}\n\n/**\n * Convert from a 3D cube hex representation to a 2D offset one\n * @param {Vector3} cube Cube representation of the hex cell\n * @param {(\"hexVertical\"|\"hexHorizontal\")} type\n * @returns {Vector2}\n */\nexport function hexCubeToOffset(\n  cube: Vector3,\n  type: \"hexVertical\" | \"hexHorizontal\"\n) {\n  if (type === \"hexVertical\") {\n    const x = cube.x + (cube.z + (cube.z & 1)) / 2;\n    const y = cube.z;\n    return new Vector2(x, y);\n  } else {\n    const x = cube.x;\n    const y = cube.z + (cube.x + (cube.x & 1)) / 2;\n    return new Vector2(x, y);\n  }\n}\n/**\n * Convert from a 2D offset hex representation to a 3D cube one\n * @param {Vector2} offset Offset representation of the hex cell\n * @param {(\"hexVertical\"|\"hexHorizontal\")} type\n * @returns {Vector3}\n */\nexport function hexOffsetToCube(\n  offset: Vector2,\n  type: \"hexVertical\" | \"hexHorizontal\"\n) {\n  if (type === \"hexVertical\") {\n    const x = offset.x - (offset.y + (offset.y & 1)) / 2;\n    const z = offset.y;\n    const y = -x - z;\n    return { x, y, z };\n  } else {\n    const x = offset.x;\n    const z = offset.y - (offset.x + (offset.x & 1)) / 2;\n    const y = -x - z;\n    return { x, y, z };\n  }\n}\n\n/**\n * Get the distance between a and b on the grid\n * @param {Grid} grid\n * @param {Vector2} a\n * @param {Vector2} b\n * @param {Size} cellSize\n */\nexport function gridDistance(\n  grid: Grid,\n  a: Vector2,\n  b: Vector2,\n  cellSize: Size\n) {\n  // Get grid coordinates\n  const aCoord = getNearestCellCoordinates(grid, a.x, a.y, cellSize);\n  const bCoord = getNearestCellCoordinates(grid, b.x, b.y, cellSize);\n  if (grid.type === \"square\") {\n    if (grid.measurement.type === \"chebyshev\") {\n      return Vector2.componentMax(\n        Vector2.abs(Vector2.subtract(aCoord, bCoord))\n      );\n    } else if (grid.measurement.type === \"alternating\") {\n      // Alternating diagonal distance like D&D 3.5 and Pathfinder\n      const delta = Vector2.abs(Vector2.subtract(aCoord, bCoord));\n      const max = Vector2.componentMax(delta);\n      const min = Vector2.componentMin(delta);\n      return max + Math.floor(0.5 * min);\n    } else if (grid.measurement.type === \"euclidean\") {\n      return Vector2.magnitude(\n        Vector2.divide(Vector2.subtract(a, b), cellSize)\n      );\n    } else if (grid.measurement.type === \"manhattan\") {\n      return Math.abs(aCoord.x - bCoord.x) + Math.abs(aCoord.y - bCoord.y);\n    }\n  } else {\n    if (grid.measurement.type === \"manhattan\") {\n      // Convert to cube coordinates to get distance easier\n      const aCube = hexOffsetToCube(aCoord, grid.type);\n      const bCube = hexOffsetToCube(bCoord, grid.type);\n      return (\n        (Math.abs(aCube.x - bCube.x) +\n          Math.abs(aCube.y - bCube.y) +\n          Math.abs(aCube.z - bCube.z)) /\n        2\n      );\n    } else if (grid.measurement.type === \"euclidean\") {\n      return Vector2.magnitude(\n        Vector2.divide(Vector2.subtract(a, b), cellSize)\n      );\n    }\n  }\n  return 0;\n}\n\n/**\n * Parse a string representation of scale e.g. 5ft into a `GridScale`\n * @param {string} scale\n * @returns {GridScale}\n */\n\nexport function parseGridScale(scale: string | null): GridScale {\n  if (typeof scale === \"string\") {\n    const match = scale.match(/(\\d*)(\\.\\d*)?([a-zA-Z]*)/);\n    if (match) {\n      const integer = parseFloat(match[1]);\n      const fractional = parseFloat(match[2]);\n      const unit = match[3] || \"\";\n      if (!isNaN(integer) && !isNaN(fractional)) {\n        return {\n          multiplier: integer + fractional,\n          unit: unit,\n          digits: match[2].length - 1,\n        };\n      } else if (!isNaN(integer) && isNaN(fractional)) {\n        return { multiplier: integer, unit: unit, digits: 0 };\n      }\n    }\n  }\n  return { multiplier: 1, unit: \"\", digits: 0 };\n}\n\n/**\n * Get all factors of a number\n * @param {number} n\n * @returns {number[]}\n */\nfunction factors(n: number): number[] {\n  const numbers = Array.from(Array(n + 1), (_, i) => i);\n  return numbers.filter((i) => n % i === 0);\n}\n\n/**\n * Greatest common divisor\n * Uses the Euclidean algorithm https://en.wikipedia.org/wiki/Euclidean_algorithm\n * @param {number} a\n * @param {number} b\n * @returns {number}\n */\nfunction gcd(a: number, b: number): number {\n  while (b !== 0) {\n    const t = b;\n    b = a % b;\n    a = t;\n  }\n  return a;\n}\n\n/**\n * Find all dividers that fit into two numbers\n * @param {number} a\n * @param {number} b\n * @returns {number[]}\n */\nfunction dividers(a: number, b: number): number[] {\n  const d = gcd(a, b);\n  return factors(d);\n}\n\n// The mean and standard deviation of > 1500 maps from the web\nconst gridSizeMean = { x: 31.567792, y: 32.597987 };\nconst gridSizeStd = { x: 14.438842, y: 15.582376 };\n\n// Most grid sizes are above 10 and below 200\nconst minGridSize = 10;\nconst maxGridSize = 200;\n\n/**\n * Get whether the grid size is likely valid by checking whether it exceeds a bounds\n * @param {number} x\n * @param {number} y\n * @returns {boolean}\n */\nexport function gridSizeVaild(x: number, y: number): boolean {\n  return (\n    x > minGridSize && y > minGridSize && x < maxGridSize && y < maxGridSize\n  );\n}\n\n/**\n * Finds a grid size for an image by finding the closest size to the average grid size\n * @param {HTMLImageElement} image\n * @param {number[]} candidates\n * @returns {Vector2 | null}\n */\nfunction gridSizeHeuristic(\n  image: HTMLImageElement,\n  candidates: number[]\n): Vector2 | null {\n  const width = image.width;\n  const height = image.height;\n  // Find the best candidate by comparing the absolute z-scores of each axis\n  let bestX = 1;\n  let bestY = 1;\n  let bestScore = Number.MAX_VALUE;\n  for (let scale of candidates) {\n    const x = Math.floor(width / scale);\n    const y = Math.floor(height / scale);\n    const xScore = Math.abs((x - gridSizeMean.x) / gridSizeStd.x);\n    const yScore = Math.abs((y - gridSizeMean.y) / gridSizeStd.y);\n    if (xScore < bestScore || yScore < bestScore) {\n      bestX = x;\n      bestY = y;\n      bestScore = Math.min(xScore, yScore);\n    }\n  }\n\n  if (gridSizeVaild(bestX, bestY)) {\n    return { x: bestX, y: bestY };\n  } else {\n    return null;\n  }\n}\n\n/**\n * Finds the grid size of an image by running the image through a machine learning model\n * @param {HTMLImageElement} image\n * @param {number[]} candidates\n * @returns {Vector2 | null}\n */\nasync function gridSizeML(\n  image: HTMLImageElement,\n  candidates: number[]\n): Promise<Vector2 | null> {\n  // TODO: check this function because of context and CanvasImageSource -> JSDoc and Typescript do not match\n  const width = image.width;\n  const height = image.height;\n  const ratio = width / height;\n  let canvas = document.createElement(\"canvas\");\n  let context = canvas.getContext(\"2d\");\n  canvas.width = 2048;\n  canvas.height = Math.floor(2048 / ratio);\n\n  // TODO: handle if context is null\n  if (!context) {\n    return null;\n  }\n\n  context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  let imageData = context.getImageData(\n    0,\n    Math.floor(canvas.height / 2) - 16,\n    2048,\n    32\n  );\n  for (let i = 0; i < imageData.data.length; i += 4) {\n    const r = imageData.data[i];\n    const g = imageData.data[i + 1];\n    const b = imageData.data[i + 2];\n    // ITU-R 601-2 Luma Transform\n    const luma = (r * 299) / 1000 + (g * 587) / 1000 + (b * 114) / 1000;\n\n    imageData.data[i] = imageData.data[i + 1] = imageData.data[i + 2] = luma;\n  }\n\n  const model = new GridSizeModel();\n  const prediction = await model.predict(imageData);\n\n  // Find the candidate that is closest to the prediction\n  let bestScale = 1;\n  let bestScore = Number.MAX_VALUE;\n  for (let scale of candidates) {\n    const x = Math.floor(width / scale);\n    const score = Math.abs(x - prediction);\n    if (score < bestScore && x > minGridSize && x < maxGridSize) {\n      bestScale = scale;\n      bestScore = score;\n    }\n  }\n\n  let x = Math.floor(width / bestScale);\n  let y = Math.floor(height / bestScale);\n\n  if (gridSizeVaild(x, y)) {\n    return { x, y };\n  } else {\n    // Fallback to raw prediction\n    x = Math.round(prediction);\n    y = Math.floor(x / ratio);\n  }\n\n  if (gridSizeVaild(x, y)) {\n    return { x, y };\n  } else {\n    return null;\n  }\n}\n\n/**\n * Finds the grid size of an image by either using a ML model or falling back to a heuristic\n * @param {HTMLImageElement} image\n * @returns {Vector2}\n */\nexport async function getGridSizeFromImage(image: HTMLImageElement) {\n  const width = image.width;\n  const height = image.height;\n  const candidates = dividers(width, height);\n  let prediction;\n\n  // Try and use ML grid detection\n  try {\n    prediction = await gridSizeML(image, candidates);\n  } catch (error) {\n    if (error instanceof Error) {\n      console.error(error);\n    }\n  }\n\n  if (!prediction) {\n    prediction = gridSizeHeuristic(image, candidates);\n  }\n  if (!prediction) {\n    prediction = { x: 22, y: 22 };\n  }\n\n  return prediction;\n}\n","import imageOutline from \"image-outline\";\n\nimport blobToBuffer from \"./blobToBuffer\";\nimport Vector2 from \"./Vector2\";\n\nimport { Outline } from \"../types/Outline\";\n\nconst lightnessDetectionOffset = 0.1;\n\n/**\n * @param {HTMLImageElement} image\n * @returns {boolean} True is the image is light\n */\nexport function getImageLightness(image: HTMLImageElement): boolean {\n  const width = image.width;\n  const height = image.height;\n  let canvas = document.createElement(\"canvas\");\n  canvas.width = width;\n  canvas.height = height;\n  let context = canvas.getContext(\"2d\");\n  if (!context) {\n    return false;\n  }\n\n  context.drawImage(image, 0, 0);\n  const imageData = context.getImageData(0, 0, width, height);\n\n  const data = imageData.data;\n  let lightPixels = 0;\n  let darkPixels = 0;\n  // Loop over every pixels rgba values\n  for (let i = 0; i < data.length; i += 4) {\n    const r = data[i];\n    const g = data[i + 1];\n    const b = data[i + 2];\n\n    const max = Math.max(Math.max(r, g), b);\n    if (max < 128) {\n      darkPixels++;\n    } else {\n      lightPixels++;\n    }\n  }\n\n  const norm = (lightPixels - darkPixels) / (width * height);\n  return norm + lightnessDetectionOffset >= 0;\n}\n\ntype CanvasImage = {\n  file: Uint8Array;\n  width: number;\n  height: number;\n  mime: string;\n};\n\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {string} type\n * @param {number} quality\n * @returns {Promise<CanvasImage>}\n */\nexport async function canvasToImage(\n  canvas: HTMLCanvasElement,\n  type: string,\n  quality: number\n): Promise<CanvasImage | undefined> {\n  return new Promise((resolve) => {\n    canvas.toBlob(\n      async (blob) => {\n        if (blob) {\n          const file = await blobToBuffer(blob);\n          resolve({\n            file,\n            width: canvas.width,\n            height: canvas.height,\n            mime: type,\n          });\n        } else {\n          resolve(undefined);\n        }\n      },\n      type,\n      quality\n    );\n  });\n}\n\n/**\n * Encode a full-size image as webp without resizing.\n * @param {HTMLImageElement} image\n * @param {number} quality\n * @returns {Promise<CanvasImage | undefined>}\n */\nexport async function imageToWebp(\n  image: HTMLImageElement,\n  quality: number\n): Promise<CanvasImage | undefined> {\n  let canvas = document.createElement(\"canvas\");\n  canvas.width = image.width;\n  canvas.height = image.height;\n  const context = canvas.getContext(\"2d\");\n  if (!context) {\n    return undefined;\n  }\n  context.drawImage(image, 0, 0, canvas.width, canvas.height);\n  return await canvasToImage(canvas, \"image/webp\", quality);\n}\n\n/**\n * @param {HTMLImageElement} image the image to resize\n * @param {number} size the size of the longest edge of the new image\n * @param {string} type the mime type of the image\n * @param {number} quality if image is a jpeg or webp this is the quality setting\n * @returns {Promise<CanvasImage | undefined>}\n */\nexport async function resizeImage(\n  image: HTMLImageElement,\n  size: number,\n  type: string,\n  quality: number\n): Promise<CanvasImage | undefined> {\n  const width = image.width;\n  const height = image.height;\n  const ratio = width / height;\n  let canvas = document.createElement(\"canvas\");\n  if (ratio > 1) {\n    canvas.width = size;\n    canvas.height = Math.round(size / ratio);\n  } else {\n    canvas.width = Math.round(size * ratio);\n    canvas.height = size;\n  }\n  let context = canvas.getContext(\"2d\");\n  if (context) {\n    context.drawImage(image, 0, 0, canvas.width, canvas.height);\n  } else {\n    return undefined;\n  }\n  return await canvasToImage(canvas, type, quality);\n}\n\n/**\n * Create a image file with resolution `size`x`size` with cover cropping\n * @param {HTMLImageElement} image the image to resize\n * @param {string} type the mime type of the image\n * @param {number} size the width and height of the thumbnail\n * @param {number} quality if image is a jpeg or webp this is the quality setting\n */\nexport async function createThumbnail(\n  image: HTMLImageElement,\n  type: string,\n  size = 300,\n  quality = 0.5\n): Promise<CanvasImage | undefined> {\n  let canvas = document.createElement(\"canvas\");\n  canvas.width = size;\n  canvas.height = size;\n  let context = canvas.getContext(\"2d\");\n  const ratio = image.width / image.height;\n  if (ratio > 1) {\n    const center = image.width / 2;\n    const halfHeight = image.height / 2;\n    if (context) {\n      context.drawImage(\n        image,\n        center - halfHeight,\n        0,\n        image.height,\n        image.height,\n        0,\n        0,\n        canvas.width,\n        canvas.height\n      );\n    }\n  } else {\n    const center = image.height / 2;\n    const halfWidth = image.width / 2;\n    if (context) {\n      context.drawImage(\n        image,\n        0,\n        center - halfWidth,\n        image.width,\n        image.width,\n        0,\n        0,\n        canvas.width,\n        canvas.height\n      );\n    }\n  }\n\n  return await canvasToImage(canvas, type, quality);\n}\n\n/**\n * Get the outline of an image\n * @param {HTMLImageElement} image\n * @returns {Outline}\n */\nexport function getImageOutline(\n  image: HTMLImageElement,\n  maxPoints: number = 100\n): Outline {\n  // Basic rect outline for fail conditions\n  const defaultOutline: Outline = {\n    type: \"rect\",\n    x: 0,\n    y: 0,\n    width: image.width,\n    height: image.height,\n  };\n  try {\n    let outlinePoints = imageOutline(image, {\n      opacityThreshold: 1, // Allow everything except full transparency\n    });\n\n    if (outlinePoints) {\n      if (outlinePoints.length > maxPoints) {\n        outlinePoints = Vector2.resample(outlinePoints, maxPoints);\n      }\n      const bounds = Vector2.getBoundingBox(outlinePoints);\n\n      // Reject outline if it's area is less than 5% of the image\n      const imageArea = image.width * image.height;\n      const area = bounds.width * bounds.height;\n      if (area < imageArea * 0.05) {\n        return defaultOutline;\n      }\n\n      // Detect if the outline is a rectangle or circle\n      if (Vector2.rectangular(outlinePoints)) {\n        return {\n          type: \"rect\",\n          x: Math.round(bounds.min.x),\n          y: Math.round(bounds.min.y),\n          width: Math.round(bounds.width),\n          height: Math.round(bounds.height),\n        };\n      } else if (\n        Vector2.circular(\n          outlinePoints,\n          Math.max(bounds.width / 10, bounds.height / 10)\n        )\n      ) {\n        return {\n          type: \"circle\",\n          x: Math.round(bounds.center.x),\n          y: Math.round(bounds.center.y),\n          radius: Math.round(Math.min(bounds.width, bounds.height) / 2),\n        };\n      } else {\n        // Flatten and round outline to save on storage size\n        const points = outlinePoints\n          .map(({ x, y }) => [Math.round(x), Math.round(y)])\n          .flat();\n        return { type: \"path\", points };\n      }\n    } else {\n      return defaultOutline;\n    }\n  } catch {\n    return defaultOutline;\n  }\n}\n","import { applyChange, Diff, revertChange, diff as deepDiff } from \"deep-diff\";\nimport get from \"lodash.get\";\n\nexport function applyChanges<LHS>(target: LHS, changes: Diff<LHS>[]) {\n  for (let change of changes) {\n    if (change.path && (change.kind === \"E\" || change.kind === \"A\")) {\n      // If editing an object or array ensure that the value exists\n      const valid = get(target, change.path) !== undefined;\n      if (valid) {\n        applyChange(target, true, change);\n      }\n    } else {\n      applyChange(target, true, change);\n    }\n  }\n}\n\nexport function revertChanges<LHS>(target: LHS, changes: Diff<LHS>[]) {\n  for (let change of changes) {\n    revertChange(target, true, change);\n  }\n}\n\nexport const diff = deepDiff;\n","import { Diff } from \"deep-diff\";\n\nimport { diff, revertChanges } from \"../helpers/diff\";\nimport cloneDeep from \"lodash.clonedeep\";\n\n/**\n * Implementation of the Command Pattern\n * Wraps an update function with internal state to support undo\n */\nclass Action<State> {\n  /**\n   * The update function called with the current state and should return the updated state\n   * This is implemented in the child class\n   */\n  update(state: State): State {\n    return state;\n  }\n\n  /**\n   * The changes caused by the last state update\n   */\n  changes: Diff<State, State>[] | undefined;\n\n  /**\n   * Executes the action update on the state\n   * @param {State} state The current state to update\n   */\n  execute(state: State): State {\n    if (state && this.update) {\n      let newState = this.update(cloneDeep(state));\n      this.changes = diff(state, newState);\n      return newState;\n    }\n    return state;\n  }\n\n  /**\n   * Reverts the changes caused by the last call of `execute`\n   * @param {State} state The current state to perform the undo on\n   * @returns {State} The state with the last changes reverted\n   */\n  undo(state: State): State {\n    if (state && this.changes) {\n      let revertedState = cloneDeep(state);\n      revertChanges(revertedState, this.changes);\n      return revertedState;\n    }\n    return state;\n  }\n}\n\nexport default Action;\n","import Action from \"./Action\";\n\nimport { ID } from \"../types/Action\";\n\nclass AddStatesAction<State extends ID> extends Action<Record<string, State>> {\n  states: State[];\n\n  constructor(states: State[]) {\n    super();\n    this.states = states;\n  }\n\n  update(statesById: Record<string, State>) {\n    for (let state of this.states) {\n      statesById[state.id] = state;\n    }\n    return statesById;\n  }\n}\n\nexport default AddStatesAction;\n","import { MultiPolygon, Ring, Polygon, Geom } from \"polygon-clipping\";\nimport shortid from \"shortid\";\nimport { Fog, FogState } from \"../types/Fog\";\n\nexport function addPolygonDifferenceToFog(\n  fog: Fog,\n  difference: MultiPolygon,\n  shapes: FogState\n) {\n  for (let i = 0; i < difference.length; i++) {\n    let newId = shortid.generate();\n    // Holes detected\n    let holes = [];\n    if (difference[i].length > 1) {\n      for (let j = 1; j < difference[i].length; j++) {\n        holes.push(\n          difference[i][j].map(([x, y]: [x: number, y: number]) => ({ x, y }))\n        );\n      }\n    }\n\n    const points = difference[i][0].map(([x, y]: [x: number, y: number]) => ({\n      x,\n      y,\n    }));\n\n    shapes[newId] = {\n      ...fog,\n      id: newId,\n      data: {\n        points,\n        holes,\n      },\n    };\n  }\n}\n\nexport function addPolygonIntersectionToFog(\n  shape: Fog,\n  intersection: MultiPolygon,\n  shapes: FogState\n) {\n  for (let i = 0; i < intersection.length; i++) {\n    let newId = shortid.generate();\n\n    const points = intersection[i][0].map(([x, y]: [x: number, y: number]) => ({\n      x,\n      y,\n    }));\n\n    shapes[newId] = {\n      ...shape,\n      id: newId,\n      data: {\n        points,\n        holes: [],\n      },\n      // Default intersection visibility to false\n      visible: false,\n    };\n  }\n}\n\nexport function fogToGeometry(fog: Fog): Geom {\n  const shapePoints: Ring = fog.data.points.map(({ x, y }) => [x, y]);\n  const shapeHoles: Polygon = fog.data.holes.map((hole) =>\n    hole.map(({ x, y }) => [x, y])\n  );\n  return [[shapePoints, ...shapeHoles]];\n}\n","import polygonClipping from \"polygon-clipping\";\n\nimport Action from \"./Action\";\nimport {\n  addPolygonDifferenceToFog,\n  addPolygonIntersectionToFog,\n  fogToGeometry,\n} from \"../helpers/actions\";\n\nimport { Fog, FogState } from \"../types/Fog\";\n\nclass CutFogAction extends Action<FogState> {\n  fogs: Fog[];\n\n  constructor(fog: Fog[]) {\n    super();\n    this.fogs = fog;\n  }\n\n  update(fogsById: FogState): FogState {\n    let actionGeom = this.fogs.map(fogToGeometry);\n    let cutFogs: FogState = {};\n    for (let fog of Object.values(fogsById)) {\n      const fogGeom = fogToGeometry(fog);\n      try {\n        const difference = polygonClipping.difference(fogGeom, ...actionGeom);\n        const intersection = polygonClipping.intersection(\n          fogGeom,\n          ...actionGeom\n        );\n        addPolygonDifferenceToFog(fog, difference, cutFogs);\n        addPolygonIntersectionToFog(fog, intersection, cutFogs);\n      } catch {\n        console.error(\"Unable to find intersection for fogs\");\n      }\n    }\n    return cutFogs;\n  }\n}\n\nexport default CutFogAction;\n","import Action from \"./Action\";\n\nimport { ID } from \"../types/Action\";\n\nclass EditStatesAction<State extends ID> extends Action<Record<string, State>> {\n  edits: Partial<State>[];\n\n  constructor(edits: Partial<State>[]) {\n    super();\n    this.edits = edits;\n  }\n\n  update(statesById: Record<string, State>) {\n    for (let edit of this.edits) {\n      if (edit.id !== undefined && edit.id in statesById) {\n        statesById[edit.id] = { ...statesById[edit.id], ...edit };\n      }\n    }\n    return statesById;\n  }\n}\n\nexport default EditStatesAction;\n","import Action from \"./Action\";\nimport { omit } from \"../helpers/shared\";\n\nimport { ID } from \"../types/Action\";\n\nclass RemoveStatesAction<State extends ID> extends Action<\n  Record<string, State>\n> {\n  stateIds: string[];\n\n  constructor(stateIds: string[]) {\n    super();\n    this.stateIds = stateIds;\n  }\n\n  update(statesById: Record<string, State>) {\n    return omit(statesById, this.stateIds);\n  }\n}\n\nexport default RemoveStatesAction;\n","import polygonClipping from \"polygon-clipping\";\n\nimport Action from \"./Action\";\nimport { addPolygonDifferenceToFog, fogToGeometry } from \"../helpers/actions\";\n\nimport { Fog, FogState } from \"../types/Fog\";\n\nclass SubtractFogAction extends Action<FogState> {\n  fogs: Fog[];\n\n  constructor(fogs: Fog[]) {\n    super();\n    this.fogs = fogs;\n  }\n\n  update(fogsById: FogState): FogState {\n    const actionGeom = this.fogs.map(fogToGeometry);\n    let subtractedFogs: FogState = {};\n    for (let fog of Object.values(fogsById)) {\n      const fogGeom = fogToGeometry(fog);\n      try {\n        const difference = polygonClipping.difference(fogGeom, ...actionGeom);\n        addPolygonDifferenceToFog(fog, difference, subtractedFogs);\n      } catch {\n        console.error(\"Unable to find difference for fogs\");\n      }\n    }\n    return subtractedFogs;\n  }\n}\n\nexport default SubtractFogAction;\n","export default __webpack_public_path__ + \"static/media/Blank.a2523542.jpg\";","export default __webpack_public_path__ + \"static/media/Grass.c8fbf8b3.jpg\";","export default __webpack_public_path__ + \"static/media/Sand.afb8a587.jpg\";","export default __webpack_public_path__ + \"static/media/Stone.0950a99c.jpg\";","export default __webpack_public_path__ + \"static/media/Water.557990a0.jpg\";","export default __webpack_public_path__ + \"static/media/Wood.49f7ad7c.jpg\";","import Case from \"case\";\n\nimport { DefaultMap } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\n\nimport blankImage from \"./Blank.jpg\";\nimport grassImage from \"./Grass.jpg\";\nimport sandImage from \"./Sand.jpg\";\nimport stoneImage from \"./Stone.jpg\";\nimport waterImage from \"./Water.jpg\";\nimport woodImage from \"./Wood.jpg\";\n\nimport unknownImage from \"./Unknown.jpg\";\n\nexport const mapSources = {\n  blank: blankImage,\n  grass: grassImage,\n  sand: sandImage,\n  stone: stoneImage,\n  water: waterImage,\n  wood: woodImage,\n};\n\nexport function getDefaultMaps(userId: string): {\n  maps: DefaultMap[];\n  mapStates: MapState[];\n} {\n  const mapKeys = Object.keys(mapSources);\n  let maps: DefaultMap[] = [];\n  let mapStates: MapState[] = [];\n  for (let i = 0; i < mapKeys.length; i++) {\n    const key = mapKeys[i];\n    const name = Case.capital(key);\n    const id = `__default-${name}`;\n    const map: DefaultMap = {\n      id,\n      key,\n      name,\n      owner: userId,\n      grid: {\n        size: { x: 22, y: 22 },\n        inset: { topLeft: { x: 0, y: 0 }, bottomRight: { x: 1, y: 1 } },\n        type: \"square\",\n        measurement: { type: \"chebyshev\", scale: \"5ft\" },\n      },\n      width: 1024,\n      height: 1024,\n      type: \"default\",\n      created: mapKeys.length - i,\n      lastModified: Date.now(),\n      showGrid: key !== \"stone\",\n      snapToGrid: true,\n    };\n    maps.push(map);\n    const state: MapState = {\n      mapId: id,\n      tokens: {},\n      drawings: {},\n      fogs: {},\n      templates: {},\n      editFlags: [\"drawing\", \"tokens\", \"notes\"],\n      notes: {},\n      tokenNotes: {},\n      fogEnabled: false,\n    };\n    mapStates.push(state);\n  }\n  return { maps, mapStates };\n}\n\nexport const unknownSource = unknownImage;\n","export default __webpack_public_path__ + \"static/media/Unknown.65718e15.jpg\";","export default __webpack_public_path__ + \"static/media/Aberration.f9592c94.png\";","import Case from \"case\";\nimport { DefaultToken } from \"../types/Token\";\n\nimport aberration from \"./Aberration.png\";\nimport artificer from \"./Artificer.png\";\nimport barbarian from \"./Barbarian.png\";\nimport bard from \"./Bard.png\";\nimport beast from \"./Beast.png\";\nimport bloodHunter from \"./Blood Hunter.png\";\nimport celestial from \"./Celestial.png\";\nimport cleric from \"./Cleric.png\";\nimport construct from \"./Construct.png\";\nimport dragon from \"./Dragon.png\";\nimport druid from \"./Druid.png\";\nimport elemental from \"./Elemental.png\";\nimport fey from \"./Fey.png\";\nimport fiend from \"./Fiend.png\";\nimport fighter from \"./Fighter.png\";\nimport giant from \"./Giant.png\";\nimport goblinoid from \"./Goblinoid.png\";\nimport humanoid from \"./Humanoid.png\";\nimport monk from \"./Monk.png\";\nimport monstrosity from \"./Monstrosity.png\";\nimport ooze from \"./Ooze.png\";\nimport paladin from \"./Paladin.png\";\nimport plant from \"./Plant.png\";\nimport ranger from \"./Ranger.png\";\nimport rogue from \"./Rogue.png\";\nimport shapechanger from \"./Shapechanger.png\";\nimport sorcerer from \"./Sorcerer.png\";\nimport titan from \"./Titan.png\";\nimport undead from \"./Undead.png\";\nimport warlock from \"./Warlock.png\";\nimport wizard from \"./Wizard.png\";\nimport unknown from \"./Unknown.png\";\n\nexport const tokenSources = {\n  barbarian,\n  bard,\n  cleric,\n  druid,\n  fighter,\n  monk,\n  paladin,\n  ranger,\n  rogue,\n  sorcerer,\n  warlock,\n  wizard,\n  artificer,\n  bloodHunter,\n  aberration,\n  beast,\n  celestial,\n  construct,\n  dragon,\n  elemental,\n  fey,\n  fiend,\n  giant,\n  goblinoid,\n  humanoid,\n  monstrosity,\n  ooze,\n  plant,\n  shapechanger,\n  titan,\n  undead,\n};\n\nfunction getDefaultTokenSize(key: string) {\n  switch (key) {\n    case \"dragon\":\n    case \"elemental\":\n    case \"giant\":\n    case \"ooze\":\n    case \"titan\":\n      return 2;\n    default:\n      return 1;\n  }\n}\n\nexport function getDefaultTokens(userId: string): DefaultToken[] {\n  const tokenKeys = Object.keys(tokenSources);\n  let tokens: DefaultToken[] = [];\n  for (let i = 0; i < tokenKeys.length; i++) {\n    const key = tokenKeys[i];\n    const name = Case.capital(key);\n    const token: DefaultToken = {\n      key,\n      name,\n      id: `__default-${name}`,\n      type: \"default\",\n      defaultSize: getDefaultTokenSize(key),\n      defaultLabel: \"\",\n      defaultCategory: \"character\",\n      hideInSidebar: false,\n      width: 256,\n      height: 256,\n      outline: { type: \"circle\", x: 128, y: 128, radius: 128 },\n      owner: userId,\n      created: tokenKeys.length - i,\n      lastModified: Date.now(),\n    };\n    tokens.push(token);\n  }\n  return tokens;\n}\n\nexport const unknownSource = unknown;\n","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/Bard.f6b83678.png\";","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","// eslint-disable-next-line no-unused-vars\nimport Dexie, { Version } from \"dexie\";\nimport shortid from \"shortid\";\nimport { v4 as uuid } from \"uuid\";\nimport Case from \"case\";\nimport chunk from \"lodash.chunk\";\n\nimport blobToBuffer from \"./helpers/blobToBuffer\";\nimport { getGridDefaultInset } from \"./helpers/grid\";\nimport { createThumbnail, getImageOutline } from \"./helpers/image\";\nimport {\n  AddStatesAction,\n  EditStatesAction,\n  RemoveStatesAction,\n  SubtractFogAction,\n  CutFogAction,\n} from \"./actions\";\nimport { getDefaultMaps } from \"./maps\";\nimport { getDefaultTokens } from \"./tokens\";\nimport { Outline } from \"./types/Outline\";\nimport { Group, GroupContainer } from \"./types/Group\";\nimport cloneDeep from \"lodash.clonedeep\";\n\nexport type UpgradeEventHandler = (versionNumber: number) => void;\n\ntype VersionCallback = (\n  version: Version,\n  onUpgrade?: UpgradeEventHandler\n) => void;\n\n/**\n * Mapping of version number to their upgrade function\n */\nexport const versions: Record<number, VersionCallback> = {\n  // v1.2.0\n  1(v) {\n    v.stores({\n      maps: \"id, owner\",\n      states: \"mapId\",\n      tokens: \"id, owner\",\n      user: \"key\",\n    });\n  },\n  // v1.2.1 - Move from blob files to array buffers\n  2(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(2);\n      const maps = await Dexie.waitFor(tx.table(\"maps\").toArray());\n      let mapBuffers: Record<string, ArrayBuffer> = {};\n      for (let map of maps) {\n        mapBuffers[map.id] = await Dexie.waitFor(blobToBuffer(map.file));\n      }\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.file = mapBuffers[map.id];\n        });\n    });\n  },\n  // v1.3.0 - Added new default tokens\n  3(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(3);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          function mapTokenId(id: string) {\n            switch (id) {\n              case \"__default-Axes\":\n                return \"__default-Barbarian\";\n              case \"__default-Bird\":\n                return \"__default-Druid\";\n              case \"__default-Book\":\n                return \"__default-Wizard\";\n              case \"__default-Crown\":\n                return \"__default-Humanoid\";\n              case \"__default-Dragon\":\n                return \"__default-Dragon\";\n              case \"__default-Eye\":\n                return \"__default-Warlock\";\n              case \"__default-Fist\":\n                return \"__default-Monk\";\n              case \"__default-Horse\":\n                return \"__default-Fey\";\n              case \"__default-Leaf\":\n                return \"__default-Druid\";\n              case \"__default-Lion\":\n                return \"__default-Monstrosity\";\n              case \"__default-Money\":\n                return \"__default-Humanoid\";\n              case \"__default-Moon\":\n                return \"__default-Cleric\";\n              case \"__default-Potion\":\n                return \"__default-Sorcerer\";\n              case \"__default-Shield\":\n                return \"__default-Paladin\";\n              case \"__default-Skull\":\n                return \"__default-Undead\";\n              case \"__default-Snake\":\n                return \"__default-Beast\";\n              case \"__default-Sun\":\n                return \"__default-Cleric\";\n              case \"__default-Swords\":\n                return \"__default-Fighter\";\n              case \"__default-Tree\":\n                return \"__default-Plant\";\n              case \"__default-Triangle\":\n                return \"__default-Sorcerer\";\n              default:\n                return \"__default-Fighter\";\n            }\n          }\n          for (let stateId in state.tokens) {\n            state.tokens[stateId].tokenId = mapTokenId(\n              state.tokens[stateId].tokenId\n            );\n            state.tokens[stateId].lastEditedBy = \"\";\n            state.tokens[stateId].rotation = 0;\n          }\n        });\n    });\n  },\n  // v1.3.1 - Added show grid option\n  4(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(4);\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.showGrid = false;\n        });\n    });\n  },\n  // v1.4.0 - Added fog subtraction\n  5(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(5);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let fogAction of state.fogDrawActions) {\n            if (fogAction.type === \"add\" || fogAction.type === \"edit\") {\n              for (let shape of fogAction.shapes) {\n                shape.data.holes = [];\n              }\n            }\n          }\n        });\n    });\n  },\n  // v1.4.2 - Added map resolutions\n  6(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(6);\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.resolutions = {};\n          map.quality = \"original\";\n        });\n    });\n  },\n  // v1.5.0 - Fixed default token rogue spelling\n  7(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(7);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.tokens) {\n            if (state.tokens[id].tokenId === \"__default-Rouge\") {\n              state.tokens[id].tokenId = \"__default-Rogue\";\n            }\n          }\n        });\n    });\n  },\n  // v1.5.0 - Added map snap to grid option\n  8(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(8);\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.snapToGrid = true;\n        });\n    });\n  },\n  // v1.5.1 - Added lock, visibility and modified to tokens\n  9(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(9);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.tokens) {\n            state.tokens[id].lastModifiedBy = state.tokens[id].lastEditedBy;\n            delete state.tokens[id].lastEditedBy;\n            state.tokens[id].lastModified = Date.now();\n            state.tokens[id].locked = false;\n            state.tokens[id].visible = true;\n          }\n        });\n    });\n  },\n  // v1.5.1 - Added token prop category and remove isVehicle bool\n  10(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(10);\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          token.category = token.isVehicle ? \"vehicle\" : \"character\";\n          delete token.isVehicle;\n        });\n    });\n  },\n  // v1.5.2 - Added automatic cache invalidation to maps\n  11(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(11);\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.lastUsed = map.lastModified;\n        });\n    });\n  },\n  // v1.5.2 - Added automatic cache invalidation to tokens\n  12(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(12);\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          token.lastUsed = token.lastModified;\n        });\n    });\n  },\n  // v1.6.0 - Added map grouping and grid scale and offset\n  13(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(13);\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.group = \"\";\n          map.grid = {\n            size: { x: map.gridX, y: map.gridY },\n            inset: getGridDefaultInset(\n              { size: { x: map.gridX, y: map.gridY }, type: \"square\" },\n              map.width,\n              map.height\n            ),\n            type: \"square\",\n          };\n          delete map.gridX;\n          delete map.gridY;\n          delete map.gridType;\n        });\n    });\n  },\n  // v1.6.0 - Added token grouping\n  14(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(14);\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          token.group = \"\";\n        });\n    });\n  },\n  // v1.6.1 - Added width and height to tokens\n  15(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(15);\n      const tokens = await Dexie.waitFor(tx.table(\"tokens\").toArray());\n      let tokenSizes: Record<string, { width: number; height: number }> = {};\n      for (let token of tokens) {\n        const url = URL.createObjectURL(new Blob([token.file]));\n        let image = new Image();\n        tokenSizes[token.id] = await Dexie.waitFor(\n          new Promise((resolve) => {\n            image.onload = () => {\n              resolve({ width: image.width, height: image.height });\n            };\n            image.src = url;\n          })\n        );\n      }\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          token.width = tokenSizes[token.id].width;\n          token.height = tokenSizes[token.id].height;\n        });\n    });\n  },\n  // v1.7.0 - Added note tool\n  16(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(16);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          state.notes = {};\n          state.editFlags = [...state.editFlags, \"notes\"];\n        });\n    });\n  },\n  // 1.7.0 (hotfix) - Optimized fog shape edits to only include needed data\n  17(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(17);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let i = 0; i < state.fogDrawActions.length; i++) {\n            const action = state.fogDrawActions[i];\n            if (action && action.type === \"edit\") {\n              for (let j = 0; j < action.shapes.length; j++) {\n                const shape = action.shapes[j];\n                const temp = { ...shape };\n                state.fogDrawActions[i].shapes[j] = {\n                  id: temp.id,\n                  visible: temp.visible,\n                };\n              }\n            }\n          }\n        });\n    });\n  },\n  // 1.8.0 - Added note text only mode, converted draw and fog representations\n  18(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(18);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.notes) {\n            state.notes[id].textOnly = false;\n          }\n\n          state.drawShapes = convertOldActionsToShapes(\n            state.mapDrawActions,\n            state.mapDrawActionIndex\n          );\n          state.fogShapes = convertOldActionsToShapes(\n            state.fogDrawActions,\n            state.fogDrawActionIndex\n          );\n\n          delete state.mapDrawActions;\n          delete state.mapDrawActionIndex;\n          delete state.fogDrawActions;\n          delete state.fogDrawActionIndex;\n        });\n    });\n  },\n  // 1.8.0 - Add thumbnail to maps and add measurement to grid\n  19(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(19);\n      const userId = (await Dexie.waitFor(tx.table(\"user\").get(\"userId\")))\n        .value;\n      const maps = await Dexie.waitFor(tx.table(\"maps\").toArray());\n      const thumbnails: Record<string, any> = {};\n      for (let map of maps) {\n        try {\n          if (map.owner === userId) {\n            thumbnails[map.id] = await createDataThumbnail(map);\n          }\n        } catch {}\n      }\n      return tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          map.thumbnail = thumbnails[map.id];\n          map.grid.measurement = { type: \"chebyshev\", scale: \"5ft\" };\n        });\n    });\n  },\n  // 1.8.0 - Add thumbnail to tokens\n  20(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(20);\n      const userId = (await Dexie.waitFor(tx.table(\"user\").get(\"userId\")))\n        .value;\n      const tokens = await Dexie.waitFor(tx.table(\"tokens\").toArray());\n      const thumbnails: Record<string, any> = {};\n      for (let token of tokens) {\n        try {\n          if (token.owner === userId) {\n            thumbnails[token.id] = await createDataThumbnail(token);\n          }\n        } catch {}\n      }\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          token.thumbnail = thumbnails[token.id];\n        });\n    });\n  },\n  // 1.8.0 - Upgrade for Dexie.Observable\n  21(v) {\n    v.stores({});\n  },\n  // v1.8.1 - Shorten fog shape ids\n  22(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(22);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id of Object.keys(state.fogShapes)) {\n            const newId = shortid.generate();\n            state.fogShapes[newId] = state.fogShapes[id];\n            state.fogShapes[newId].id = newId;\n            delete state.fogShapes[id];\n          }\n        });\n    });\n  },\n  // v1.9.0 - Add outlines to tokens\n  23(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(23);\n      const tokens = await Dexie.waitFor(tx.table(\"tokens\").toArray());\n      const tokenOutlines = await Dexie.waitFor(\n        Promise.all(tokens.map(createDataOutline))\n      );\n\n      return tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          const tokenOutline = tokenOutlines.find((el) => el.id === token.id);\n          if (tokenOutline) {\n            token.outline = tokenOutline.outline;\n          } else {\n            token.outline = {\n              type: \"rect\",\n              width: token.width,\n              height: token.height,\n              x: 0,\n              y: 0,\n            };\n          }\n        });\n    });\n  },\n  // v1.9.0 - Move map assets into new table\n  24(v, onUpgrade) {\n    v.stores({ assets: \"id, owner\" }).upgrade(async (tx) => {\n      onUpgrade?.(24);\n\n      const primaryKeys = await Dexie.waitFor(\n        tx.table(\"maps\").toCollection().primaryKeys()\n      );\n      const keyChunks = chunk(primaryKeys, 4);\n\n      for (let keys of keyChunks) {\n        let assets = [];\n        let maps = await Dexie.waitFor(tx.table(\"maps\").bulkGet(keys));\n        while (maps.length > 0) {\n          const map = maps.pop();\n          assets.push({\n            id: uuid(),\n            owner: map.owner,\n            file: map.file,\n            width: map.width,\n            height: map.height,\n            mime: \"\",\n            prevId: map.id,\n            prevType: \"map\",\n          });\n\n          for (let resolution in map.resolutions) {\n            const mapRes = map.resolutions[resolution];\n            assets.push({\n              id: uuid(),\n              owner: map.owner,\n              file: mapRes.file,\n              width: mapRes.width,\n              height: mapRes.height,\n              mime: \"\",\n              prevId: map.id,\n              prevType: \"mapResolution\",\n              resolution,\n            });\n          }\n          if (map.thumbnail) {\n            assets.push({\n              id: uuid(),\n              owner: map.owner,\n              file: map.thumbnail.file,\n              width: map.thumbnail.width,\n              height: map.thumbnail.height,\n              mime: \"\",\n              prevId: map.id,\n              prevType: \"mapThumbnail\",\n            });\n          }\n        }\n        await tx.table(\"assets\").bulkAdd(assets);\n      }\n    });\n  },\n  // v1.9.0 - Move token assets into new table\n  25(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(25);\n\n      const primaryKeys = await Dexie.waitFor(\n        tx.table(\"tokens\").toCollection().primaryKeys()\n      );\n      const keyChunks = chunk(primaryKeys, 4);\n\n      for (let keys of keyChunks) {\n        let assets = [];\n        let tokens = await Dexie.waitFor(tx.table(\"tokens\").bulkGet(keys));\n        while (tokens.length > 0) {\n          let token = tokens.pop();\n          assets.push({\n            id: uuid(),\n            owner: token.owner,\n            file: token.file,\n            width: token.width,\n            height: token.height,\n            mime: \"\",\n            prevId: token.id,\n            prevType: \"token\",\n          });\n          if (token.thumbnail) {\n            assets.push({\n              id: uuid(),\n              owner: token.owner,\n              file: token.thumbnail.file,\n              width: token.thumbnail.width,\n              height: token.thumbnail.height,\n              mime: \"\",\n              prevId: token.id,\n              prevType: \"tokenThumbnail\",\n            });\n          }\n        }\n        await tx.table(\"assets\").bulkAdd(assets);\n      }\n    });\n  },\n  // v1.9.0 - Create foreign keys for assets\n  26(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(26);\n\n      let mapUpdates: Record<string, any> = {};\n      let tokenUpdates: Record<string, any> = {};\n\n      const primaryKeys = await Dexie.waitFor(\n        tx.table(\"assets\").toCollection().primaryKeys()\n      );\n      const keyChunks = chunk(primaryKeys, 4);\n\n      for (let keys of keyChunks) {\n        let assets = await Dexie.waitFor(tx.table(\"assets\").bulkGet(keys));\n        while (assets.length > 0) {\n          const asset = assets.pop();\n          const { prevId, id, prevType, resolution } = asset;\n          if (prevType === \"token\" || prevType === \"tokenThumbnail\") {\n            if (!(prevId in tokenUpdates)) {\n              tokenUpdates[prevId] = {};\n            }\n          } else {\n            if (!(prevId in mapUpdates)) {\n              mapUpdates[prevId] = {};\n            }\n          }\n\n          if (prevType === \"map\") {\n            mapUpdates[prevId].file = id;\n          } else if (prevType === \"token\") {\n            tokenUpdates[prevId].file = id;\n          } else if (prevType === \"mapThumbnail\") {\n            mapUpdates[prevId].thumbnail = id;\n          } else if (prevType === \"tokenThumbnail\") {\n            tokenUpdates[prevId].thumbnail = id;\n          } else if (prevType === \"mapResolution\") {\n            mapUpdates[prevId][resolution] = id;\n          }\n        }\n      }\n\n      await tx\n        .table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          if (map.id in mapUpdates) {\n            for (let key in mapUpdates[map.id]) {\n              map[key] = mapUpdates[map.id][key];\n            }\n          }\n          delete map.resolutions;\n        });\n      await tx\n        .table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          if (token.id in tokenUpdates) {\n            for (let key in tokenUpdates[token.id]) {\n              token[key] = tokenUpdates[token.id][key];\n            }\n          }\n        });\n    });\n  },\n  // v1.9.0 - Remove asset migration helpers\n  27(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(27);\n      tx.table(\"assets\").toCollection().modify({\n        prevId: undefined,\n        prevType: undefined,\n        resolution: undefined,\n      });\n    });\n  },\n  // v1.9.0 - Remap map resolution assets\n  28(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(28);\n      tx.table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          const resolutions = [\"low\", \"medium\", \"high\", \"ultra\"];\n          map.resolutions = {};\n          for (let res of resolutions) {\n            if (res in map) {\n              map.resolutions[res] = map[res];\n              delete map[res];\n            }\n          }\n          delete map.lastUsed;\n        });\n    });\n  },\n  // v1.9.0 - Move tokens to use more defaults\n  29(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(29);\n      tx.table(\"tokens\")\n        .toCollection()\n        .modify(async (token) => {\n          token.defaultCategory = token.category;\n          delete token.category;\n          token.defaultLabel = \"\";\n          delete token.lastUsed;\n        });\n    });\n  },\n  // v1.9.0 - Move tokens to use more defaults and add token outline to token states\n  30(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(30);\n      const tokens = await Dexie.waitFor(tx.table(\"tokens\").toArray());\n      tx.table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.tokens) {\n            if (!state.tokens[id]?.tokenId) {\n              delete state.tokens[id];\n              continue;\n            }\n            if (!state.tokens[id].tokenId.startsWith(\"__default\")) {\n              const token = tokens.find(\n                (token) => token.id === state.tokens[id].tokenId\n              );\n              if (token) {\n                state.tokens[id].category = token.defaultCategory;\n                state.tokens[id].file = token.file;\n                state.tokens[id].type = \"file\";\n                state.tokens[id].outline = token.outline;\n                state.tokens[id].width = token.width;\n                state.tokens[id].height = token.height;\n                state.tokens[id].owner = token.owner;\n              } else {\n                state.tokens[id].category = \"character\";\n                state.tokens[id].type = \"file\";\n                state.tokens[id].file = \"\";\n                state.tokens[id].outline = {\n                  type: \"rect\",\n                  width: 256,\n                  height: 256,\n                  x: 0,\n                  y: 0,\n                };\n                state.tokens[id].width = 256;\n                state.tokens[id].height = 256;\n              }\n            } else {\n              state.tokens[id].category = \"character\";\n              state.tokens[id].type = \"default\";\n              state.tokens[id].key = Case.camel(\n                state.tokens[id].tokenId.slice(10)\n              );\n              state.tokens[id].outline = {\n                type: \"circle\",\n                x: 128,\n                y: 128,\n                radius: 128,\n              };\n              state.tokens[id].width = 256;\n              state.tokens[id].height = 256;\n            }\n          }\n        });\n    });\n  },\n  // v1.9.0 - Remove maps not owned by user as cache is now done on the asset level\n  31(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(31);\n      const userId = (await Dexie.waitFor(tx.table(\"user\").get(\"userId\")))\n        ?.value;\n      if (userId) {\n        tx.table(\"maps\").where(\"owner\").notEqual(userId).delete();\n      }\n    });\n  },\n  // v1.9.0 - Remove tokens not owned by user as cache is now done on the asset level\n  32(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(32);\n      const userId = (await Dexie.waitFor(tx.table(\"user\").get(\"userId\")))\n        ?.value;\n      if (userId) {\n        tx.table(\"tokens\").where(\"owner\").notEqual(userId).delete();\n      }\n    });\n  },\n  // v1.9.0 - Store default maps and tokens in db\n  33(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(33);\n      const userId = (await Dexie.waitFor(tx.table(\"user\").get(\"userId\")))\n        ?.value;\n      if (!userId) {\n        return;\n      }\n      const { maps } = getDefaultMaps(userId);\n      tx.table(\"maps\").bulkAdd(maps);\n      const tokens = getDefaultTokens(userId);\n      tx.table(\"tokens\").bulkAdd(tokens);\n    });\n  },\n  // v1.9.0 - Add new group table\n  34(v, onUpgrade) {\n    v.stores({ groups: \"id\" }).upgrade(async (tx) => {\n      onUpgrade?.(34);\n      function groupItems(items: { id: string; group: string }[]) {\n        let groups: Group[] = [];\n        let subGroups: Record<string, GroupContainer> = {};\n        for (let item of items) {\n          if (!item.group) {\n            groups.push({ id: item.id, type: \"item\" });\n          } else if (item.group in subGroups) {\n            subGroups[item.group].items.push({ id: item.id, type: \"item\" });\n          } else {\n            subGroups[item.group] = {\n              id: uuid(),\n              type: \"group\",\n              name: item.group,\n              items: [{ id: item.id, type: \"item\" }],\n            };\n          }\n        }\n        groups.push(...Object.values(subGroups));\n        return groups;\n      }\n\n      let maps = await Dexie.waitFor(tx.table(\"maps\").toArray());\n      maps = maps.sort((a, b) => b.created - a.created);\n      const mapGroupItems = groupItems(maps);\n      tx.table(\"groups\").add({ id: \"maps\", items: mapGroupItems });\n\n      let tokens = await Dexie.waitFor(tx.table(\"tokens\").toArray());\n      tokens = tokens.sort((a, b) => b.created - a.created);\n      const tokenGroupItems = groupItems(tokens);\n      tx.table(\"groups\").add({ id: \"tokens\", items: tokenGroupItems });\n    });\n  },\n  // v1.9.0 - Remove map and token group in respective tables\n  35(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(35);\n      tx.table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          delete map.group;\n        });\n      tx.table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          delete token.group;\n        });\n    });\n  },\n  36(v) {\n    v.stores({\n      _changes: null,\n      _intercomm: null,\n      _syncNodes: null,\n      _uncommittedChanges: null,\n    });\n  },\n  // v1.10.0 - Add rotation to notes\n  37(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(37);\n      tx.table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.notes) {\n            state.notes[id].rotation = 0;\n          }\n        });\n    });\n  },\n  // v1.10.0 - Delete groups again\n  38(v, onUpgrade) {\n    v.stores({}).upgrade(async (tx) => {\n      onUpgrade?.(38);\n      tx.table(\"maps\")\n        .toCollection()\n        .modify((map) => {\n          delete map.group;\n        });\n      tx.table(\"tokens\")\n        .toCollection()\n        .modify((token) => {\n          delete token.group;\n        });\n    });\n  },\n  // v1.10.0 - Rename drawShapes and fogShapes in state\n  39(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(39);\n      tx.table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          state.drawings = state.drawShapes;\n          state.fogs = state.fogShapes;\n\n          delete state.drawShapes;\n          delete state.fogShapes;\n        });\n    });\n  },\n  // v1.10.0 (patch 1) - Rename drawShapes and fogShapes in state again (some people's didn't work)\n  40(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(40);\n      tx.table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (state.drawShapes) {\n            state.drawings = cloneDeep(state.drawShapes);\n            delete state.drawShapes;\n          }\n          if (state.fogShapes) {\n            state.fogs = cloneDeep(state.fogShapes);\n            delete state.fogShapes;\n          }\n        });\n    });\n  },\n  // v1.10.0 (patch 2) - Rename drawShapes and fogShapes in state again again (some people's still didn't work)\n  41(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(41);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (state.drawShapes) {\n            state.drawings = cloneDeep(state.drawShapes);\n            delete state.drawShapes;\n          }\n          if (state.fogShapes) {\n            state.fogs = cloneDeep(state.fogShapes);\n            delete state.fogShapes;\n          }\n        });\n    });\n  },\n  // v1.12.0 - Add spell templates to state\n  42(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(42);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (!state.templates) {\n            state.templates = {};\n          }\n        });\n    });\n  },\n  // v1.13.0 - Add token notes to state\n  43(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(43);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (!state.tokenNotes) {\n            state.tokenNotes = {};\n          }\n        });\n    });\n  },\n  // v1.14.0 - Add advanced note fields\n  44(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(44);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          for (let id in state.notes) {\n            const note = state.notes[id];\n            if (note.textVisible === undefined) {\n              note.textVisible = true;\n            }\n            if (!note.visibility) {\n              note.visibility = \"all\";\n            }\n            if (!note.ownerId && note.lastModifiedBy) {\n              note.ownerId = note.lastModifiedBy;\n            }\n            if (!note.contentFormat) {\n              note.contentFormat = \"plain\";\n            }\n            if (note.content === undefined) {\n              note.content = note.text;\n            }\n          }\n        });\n    });\n  },\n  // v1.15.0 - Add walls/vision/light/explored and clear legacy fogs\n  45(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(45);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (!state.walls) {\n            state.walls = {};\n          }\n          if (!state.explored) {\n            state.explored = [];\n          }\n          if (state.fogEnabled === undefined) {\n            state.fogEnabled = true;\n          }\n          if (state.fogs) {\n            state.fogs = {};\n          }\n          for (let id in state.tokens) {\n            const token = state.tokens[id];\n            if (token.hasVision === undefined) {\n              token.hasVision = false;\n            }\n            if (token.visionRange === undefined) {\n              token.visionRange = 0;\n            }\n            if (token.visionAngle === undefined) {\n              token.visionAngle = 360;\n            }\n            if (!token.lightConfig) {\n              token.lightConfig = {\n                enabled: false,\n                radiusBright: 0,\n                radiusDim: 0,\n              };\n            }\n          }\n        });\n    });\n  },\n  // v1.15.1 - Add explored visibility toggle\n  46(v, onUpgrade) {\n    v.stores({}).upgrade((tx) => {\n      onUpgrade?.(46);\n      return tx\n        .table(\"states\")\n        .toCollection()\n        .modify((state) => {\n          if (state.showExplored === undefined) {\n            state.showExplored = false;\n          }\n        });\n    });\n  },\n};\n\nexport const latestVersion = 46;\n\n/**\n * Load versions onto a database up to a specific version number\n * @param {Dexie} db\n * @param {number=} upTo version number to load up to, latest version if undefined\n * @param {UpgradeEventHandler=} onUpgrade\n */\nexport function loadVersions(\n  db: Dexie,\n  upTo: number | undefined = latestVersion,\n  onUpgrade: UpgradeEventHandler | undefined\n) {\n  for (let versionNumber = 1; versionNumber <= upTo; versionNumber++) {\n    versions[versionNumber](db.version(versionNumber), onUpgrade);\n  }\n}\n\n/**\n * Convert from the previous representation of actions (1.7.0) to the new representation (1.8.0)\n * and combine into shapes\n */\nfunction convertOldActionsToShapes(actions: any[], actionIndex: number) {\n  let newShapes = {};\n  for (let i = 0; i <= actionIndex; i++) {\n    const action = actions[i];\n    if (!action) {\n      continue;\n    }\n    let newAction;\n    if (action.shapes) {\n      if (action.type === \"add\") {\n        newAction = new AddStatesAction(action.shapes);\n      } else if (action.type === \"edit\") {\n        newAction = new EditStatesAction(action.shapes);\n      } else if (action.type === \"remove\") {\n        newAction = new RemoveStatesAction(action.shapes);\n      } else if (action.type === \"subtract\") {\n        newAction = new SubtractFogAction(action.shapes);\n      } else if (action.type === \"cut\") {\n        newAction = new CutFogAction(action.shapes);\n      }\n    } else if (action.type === \"remove\" && action.shapeIds) {\n      newAction = new RemoveStatesAction(action.shapeIds);\n    }\n\n    if (newAction) {\n      newShapes = newAction.execute(newShapes);\n    }\n  }\n  return newShapes;\n}\n\n// Helper to create a thumbnail for a file in a db\nasync function createDataThumbnail(data: any): Promise<{\n  file: Uint8Array;\n  width: number;\n  height: number;\n  type: \"file\";\n  id: \"thumbnail\";\n}> {\n  let url: string;\n  if (data?.resolutions?.low?.file) {\n    url = URL.createObjectURL(new Blob([data.resolutions.low.file]));\n  } else {\n    url = URL.createObjectURL(new Blob([data.file]));\n  }\n  return await Dexie.waitFor(\n    new Promise((resolve) => {\n      let image = new Image();\n      image.onload = async () => {\n        const thumbnail = await createThumbnail(image, \"\");\n        if (thumbnail) {\n          resolve({\n            file: thumbnail.file,\n            width: thumbnail.width,\n            height: thumbnail.height,\n            type: \"file\",\n            id: \"thumbnail\",\n          });\n        }\n      };\n      image.src = url;\n    }),\n    60000 * 10 // 10 minute timeout\n  );\n}\n\nasync function createDataOutline(\n  data: any\n): Promise<{ id: string; outline: Outline }> {\n  const url = URL.createObjectURL(new Blob([data.file]));\n  return await Dexie.waitFor(\n    new Promise((resolve) => {\n      let image = new Image();\n      image.onload = async () => {\n        resolve({ id: data.id, outline: getImageOutline(image) });\n      };\n      image.onerror = () => {\n        resolve({\n          id: data.id,\n          outline: {\n            type: \"rect\",\n            width: data.width,\n            height: data.height,\n            x: 0,\n            y: 0,\n          },\n        });\n      };\n      image.src = url;\n    })\n  );\n}\n","const monsters: string[] = [\n  \"Aboleth\",\n  \"Acolyte\",\n  \"Black Dragon\",\n  \"Blue Dragon\",\n  \"Brass Dragon\",\n  \"Bronze Dragon\",\n  \"Copper Dragon\",\n  \"Gold Dragon\",\n  \"Green Dragon\",\n  \"Red Dragon\",\n  \"Silver Dragon\",\n  \"White Dragon\",\n  \"Air Elemental\",\n  \"Androsphinx\",\n  \"Animated Armor\",\n  \"Ankheg\",\n  \"Ape\",\n  \"Archmage\",\n  \"Assassin\",\n  \"Awakened Shrub\",\n  \"Awakened Tree\",\n  \"Axe Beak\",\n  \"Azer\",\n  \"Baboon\",\n  \"Badger\",\n  \"Balor\",\n  \"Bandit\",\n  \"Bandit Captain\",\n  \"Barbed Devil\",\n  \"Basilisk\",\n  \"Bat\",\n  \"Bearded Devil\",\n  \"Behir\",\n  \"Berserker\",\n  \"Black Bear\",\n  \"Black Pudding\",\n  \"Blink Dog\",\n  \"Blood Hawk\",\n  \"Boar\",\n  \"Bone Devil\",\n  \"Brown Bear\",\n  \"Bugbear\",\n  \"Bulette\",\n  \"Camel\",\n  \"Cat\",\n  \"Centaur\",\n  \"Chain Devil\",\n  \"Chimera\",\n  \"Chuul\",\n  \"Clay Golem\",\n  \"Cloaker\",\n  \"Cloud Giant\",\n  \"Cockatrice\",\n  \"Commoner\",\n  \"Constrictor Snake\",\n  \"Couatl\",\n  \"Crab\",\n  \"Crocodile\",\n  \"Cult Fanatic\",\n  \"Cultist\",\n  \"Darkmantle\",\n  \"Death Dog\",\n  \"Deep Gnome\",\n  \"Deer\",\n  \"Deva\",\n  \"Dire Wolf\",\n  \"Diseased Giant Rat\",\n  \"Djinni\",\n  \"Doppelganger\",\n  \"Draft Horse\",\n  \"Dragon Turtle\",\n  \"Dretch\",\n  \"Drider\",\n  \"Drow\",\n  \"Druid\",\n  \"Dryad\",\n  \"Duergar\",\n  \"Dust Mephit\",\n  \"Eagle\",\n  \"Earth Elemental\",\n  \"Efreeti\",\n  \"Elephant\",\n  \"Elk\",\n  \"Erinyes\",\n  \"Ettercap\",\n  \"Ettin\",\n  \"Fire Elemental\",\n  \"Fire Giant\",\n  \"Flesh Golem\",\n  \"Flying Snake\",\n  \"Flying Sword\",\n  \"Frog\",\n  \"Frost Giant\",\n  \"Gargoyle\",\n  \"Gelatinous Cube\",\n  \"Ghast\",\n  \"Ghost\",\n  \"Ghoul\",\n  \"Giant Ape\",\n  \"Giant Badger\",\n  \"Giant Bat\",\n  \"Giant Boar\",\n  \"Giant Centipede\",\n  \"Giant Constrictor Snake\",\n  \"Giant Crab\",\n  \"Giant Crocodile\",\n  \"Giant Eagle\",\n  \"Giant Elk\",\n  \"Giant Fire Beetle\",\n  \"Giant Frog\",\n  \"Giant Goat\",\n  \"Giant Hyena\",\n  \"Giant Lizard\",\n  \"Giant Octopus\",\n  \"Giant Owl\",\n  \"Giant Poisonous Snake\",\n  \"Giant Rat\",\n  \"Giant Scorpion\",\n  \"Giant Sea Horse\",\n  \"Giant Shark\",\n  \"Giant Spider\",\n  \"Giant Toad\",\n  \"Giant Vulture\",\n  \"Giant Wasp\",\n  \"Giant Weasel\",\n  \"Giant Wolf Spider\",\n  \"Gibbering Mouther\",\n  \"Glabrezu\",\n  \"Gladiator\",\n  \"Gnoll\",\n  \"Goat\",\n  \"Goblin\",\n  \"Gorgon\",\n  \"Gray Ooze\",\n  \"Green Hag\",\n  \"Grick\",\n  \"Griffon\",\n  \"Grimlock\",\n  \"Guard\",\n  \"Guardian Naga\",\n  \"Gynosphinx\",\n  \"Harpy\",\n  \"Hawk\",\n  \"Hell Hound\",\n  \"Hezrou\",\n  \"Hill Giant\",\n  \"Hippogriff\",\n  \"Hobgoblin\",\n  \"Homunculus\",\n  \"Horned Devil\",\n  \"Hunter Shark\",\n  \"Hydra\",\n  \"Hyena\",\n  \"Ice Devil\",\n  \"Ice Mephit\",\n  \"Imp\",\n  \"Incubus\",\n  \"Invisible Stalker\",\n  \"Iron Golem\",\n  \"Jackal\",\n  \"Killer Whale\",\n  \"Knight\",\n  \"Kobold\",\n  \"Kraken\",\n  \"Lamia\",\n  \"Lemure\",\n  \"Lich\",\n  \"Lion\",\n  \"Lizard\",\n  \"Lizardfolk\",\n  \"Mage\",\n  \"Magma Mephit\",\n  \"Magmin\",\n  \"Mammoth\",\n  \"Manticore\",\n  \"Marilith\",\n  \"Mastiff\",\n  \"Medusa\",\n  \"Merfolk\",\n  \"Merrow\",\n  \"Mimic\",\n  \"Minotaur\",\n  \"Minotaur Skeleton\",\n  \"Mule\",\n  \"Mummy\",\n  \"Mummy Lord\",\n  \"Nalfeshnee\",\n  \"Night Hag\",\n  \"Nightmare\",\n  \"Noble\",\n  \"Ochre Jelly\",\n  \"Octopus\",\n  \"Ogre\",\n  \"Ogre Zombie\",\n  \"Oni\",\n  \"Orc\",\n  \"Otyugh\",\n  \"Owl\",\n  \"Owlbear\",\n  \"Panther\",\n  \"Pegasus\",\n  \"Phase Spider\",\n  \"Pit Fiend\",\n  \"Planetar\",\n  \"Plesiosaurus\",\n  \"Poisonous Snake\",\n  \"Polar Bear\",\n  \"Pony\",\n  \"Priest\",\n  \"Pseudodragon\",\n  \"Purple Worm\",\n  \"Quasit\",\n  \"Quipper\",\n  \"Rakshasa\",\n  \"Rat\",\n  \"Raven\",\n  \"Reef Shark\",\n  \"Remorhaz\",\n  \"Rhinoceros\",\n  \"Riding Horse\",\n  \"Roc\",\n  \"Roper\",\n  \"Rug of Smothering\",\n  \"Rust Monster\",\n  \"Saber-Toothed Tiger\",\n  \"Sahuagin\",\n  \"Salamander\",\n  \"Satyr\",\n  \"Scorpion\",\n  \"Scout\",\n  \"Sea Hag\",\n  \"Sea Horse\",\n  \"Shadow\",\n  \"Shambling Mound\",\n  \"Shield Guardian\",\n  \"Shrieker\",\n  \"Skeleton\",\n  \"Solar\",\n  \"Specter\",\n  \"Spider\",\n  \"Spirit Naga\",\n  \"Sprite\",\n  \"Spy\",\n  \"Steam Mephit\",\n  \"Stirge\",\n  \"Stone Giant\",\n  \"Stone Golem\",\n  \"Storm Giant\",\n  \"Succubus\",\n  \"Swarm of Bats\",\n  \"Swarm of Beetles\",\n  \"Swarm of Centipedes\",\n  \"Swarm of Insects\",\n  \"Swarm of Poisonous Snakes\",\n  \"Swarm of Quippers\",\n  \"Swarm of Rats\",\n  \"Swarm of Ravens\",\n  \"Swarm of Spiders\",\n  \"Swarm of Wasps\",\n  \"Tarrasque\",\n  \"Thug\",\n  \"Tiger\",\n  \"Treant\",\n  \"Tribal Warrior\",\n  \"Triceratops\",\n  \"Troll\",\n  \"Tyrannosaurus Rex\",\n  \"Unicorn\",\n  \"Vampire\",\n  \"Vampire Spawn\",\n  \"Veteran\",\n  \"Violet Fungus\",\n  \"Vrock\",\n  \"Vulture\",\n  \"Warhorse\",\n  \"Warhorse Skeleton\",\n  \"Water Elemental\",\n  \"Weasel\",\n  \"Werebear\",\n  \"Wereboar\",\n  \"Wererat\",\n  \"Weretiger\",\n  \"Werewolf\",\n  \"Wight\",\n  \"Will-o'-Wisp\",\n  \"Winter Wolf\",\n  \"Wolf\",\n  \"Worg\",\n  \"Wraith\",\n  \"Wyvern\",\n  \"Xorn\",\n  \"Zombie\"\n];\n\nexport default monsters;\n\nexport function getRandomMonster(): string {\n  return monsters[Math.floor(Math.random() * monsters.length)];\n}\n","// eslint-disable-next-line no-unused-vars\nimport Dexie, { DexieOptions } from \"dexie\";\nimport { v4 as uuid } from \"uuid\";\n\nimport { loadVersions, UpgradeEventHandler } from \"./upgrade\";\nimport { getDefaultMaps } from \"./maps\";\nimport { getDefaultTokens } from \"./tokens\";\nimport { getRandomMonster } from \"./helpers/monsters\";\n\n/**\n * Populate DB with initial data\n * @param {Dexie} db\n */\nfunction populate(db: Dexie) {\n  db.on(\"populate\", () => {\n    const userId = uuid();\n    db.table(\"user\").add({ key: \"userId\", value: userId });\n    const nickname = getRandomMonster();\n    db.table(\"user\").add({ key: \"nickname\", value: nickname });\n    const { maps, mapStates } = getDefaultMaps(userId);\n    db.table(\"maps\").bulkAdd(maps);\n    db.table(\"states\").bulkAdd(mapStates);\n    const tokens = getDefaultTokens(userId);\n    db.table(\"tokens\").bulkAdd(tokens);\n    db.table(\"groups\").bulkAdd([\n      { id: \"maps\", items: maps.map((map) => ({ id: map.id, type: \"item\" })) },\n      {\n        id: \"tokens\",\n        items: tokens.map((token) => ({ id: token.id, type: \"item\" })),\n      },\n    ]);\n  });\n}\n\n/**\n * Get a Dexie database with a name and versions applied\n * @param {DexieOptions} options\n * @param {string=} name\n * @param {number=} versionNumber\n * @param {boolean=} populateData\n * @param {UpgradeEventHandler=} onUpgrade\n * @returns {Dexie}\n */\nexport function getDatabase(\n  options: DexieOptions,\n  name: string | undefined = \"OwlbearRodeoDB\",\n  versionNumber: number | undefined = undefined,\n  populateData: boolean | undefined = true,\n  onUpgrade: UpgradeEventHandler | undefined = undefined\n): Dexie {\n  let db = new Dexie(name, options);\n  loadVersions(db, versionNumber, onUpgrade);\n  if (populateData) {\n    populate(db);\n  }\n  return db;\n}\n","import React, { useState, useEffect, useContext } from \"react\";\nimport Dexie from \"dexie\";\nimport * as Comlink from \"comlink\";\n\nimport ErrorBanner from \"../components/banner/ErrorBanner\";\n\nimport { getDatabase } from \"../database\";\n\n//@ts-ignore\nimport DatabaseWorker from \"worker-loader!../workers/DatabaseWorker\"; // eslint-disable-line import/no-webpack-loader-syntax\nimport { DatabaseWorkerService } from \"../workers/DatabaseWorker\";\n\nexport type DatabaseStatus = \"loading\" | \"disabled\" | \"upgrading\" | \"loaded\";\n\ntype DatabaseContextValue = {\n  database: Dexie | undefined;\n  databaseStatus: DatabaseStatus;\n  databaseError: Error | undefined;\n  worker: Comlink.Remote<DatabaseWorkerService>;\n};\n\nconst DatabaseContext =\n  React.createContext<DatabaseContextValue | undefined>(undefined);\n\nconst worker: Comlink.Remote<DatabaseWorkerService> = Comlink.wrap(\n  new DatabaseWorker()\n);\n\nexport function DatabaseProvider({ children }: { children: React.ReactNode }) {\n  const [database, setDatabase] = useState<Dexie>();\n  const [databaseStatus, setDatabaseStatus] =\n    useState<DatabaseStatus>(\"loading\");\n  const [databaseError, setDatabaseError] = useState<Error>();\n\n  useEffect(() => {\n    // Create a test database and open it to see if indexedDB is enabled\n    let testDBRequest = window.indexedDB.open(\"__test\");\n    testDBRequest.onsuccess = async function () {\n      testDBRequest.result.close();\n      let db = getDatabase(\n        { autoOpen: false },\n        undefined,\n        undefined,\n        true,\n        () => {\n          setDatabaseStatus(\"upgrading\");\n        }\n      );\n      setDatabase(db);\n      db.on(\"ready\", () => {\n        setDatabaseStatus(\"loaded\");\n      });\n      db.on(\"versionchange\", () => {\n        // When another tab loads a new version of the database refresh the page\n        window.location.reload();\n      });\n      await db.open();\n      window.indexedDB.deleteDatabase(\"__test\");\n    };\n    // If indexedb disabled create an in memory database\n    testDBRequest.onerror = async function () {\n      console.warn(\"Database is disabled, no state will be saved\");\n      const indexedDB = await import(\"fake-indexeddb\");\n      const IDBKeyRange = await import(\"fake-indexeddb/lib/FDBKeyRange\");\n      let db = getDatabase({ indexedDB, IDBKeyRange, autoOpen: false });\n      setDatabase(db);\n      db.on(\"ready\", () => {\n        setDatabaseStatus(\"disabled\");\n      });\n      await db.open();\n      window.indexedDB.deleteDatabase(\"__test\");\n    };\n\n    function handleDatabaseError(event: PromiseRejectionEvent) {\n      if (event) {\n        event.preventDefault();\n        if (event.reason instanceof Dexie.DexieError) {\n          if (event.reason?.inner?.name === \"QuotaExceededError\") {\n            setDatabaseError({\n              name: event.reason?.name,\n              message:\n                \"Storage Quota Exceeded Please Clear Space and Try Again.\",\n            });\n          } else if (event.reason?.inner?.name === \"DatabaseClosedError\") {\n            setDatabaseError({\n              name: event.reason?.name,\n              message: \"Database closed, please refresh your browser.\",\n            });\n          } else {\n            setDatabaseError({\n              name: event.reason?.name,\n              message: \"Something went wrong, please refresh your browser.\",\n            });\n          }\n        } else {\n          setDatabaseError({\n            name: event.reason?.name,\n            message: \"Something went wrong, please refresh your browser.\",\n          });\n        }\n        console.error(event.reason);\n      }\n    }\n    window.addEventListener(\"unhandledrejection\", handleDatabaseError);\n\n    return () => {\n      window.removeEventListener(\"unhandledrejection\", handleDatabaseError);\n    };\n  }, []);\n\n  const value = {\n    database,\n    databaseStatus,\n    databaseError,\n    worker,\n  };\n  return (\n    <DatabaseContext.Provider value={value}>\n      <>\n        {children}\n        <ErrorBanner\n          error={databaseError}\n          onRequestClose={() => setDatabaseError(undefined)}\n        />\n      </>\n    </DatabaseContext.Provider>\n  );\n}\n\nexport function useDatabase() {\n  const context = useContext(DatabaseContext);\n  if (context === undefined) {\n    throw new Error(\"useDatabase must be used within a DatabaseProvider\");\n  }\n  return context;\n}\n\nexport default DatabaseContext;\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/DatabaseWorker.d47a991b.worker.js\");\n}\n","import React, { useEffect, useState, useContext } from \"react\";\n\nimport { useDatabase } from \"./DatabaseContext\";\n\nconst UserIdContext = React.createContext<string | undefined>(undefined);\n\nexport function UserIdProvider({ children }: { children: React.ReactNode }) {\n  const { database, databaseStatus } = useDatabase();\n\n  const [userId, setUserId] = useState();\n  useEffect(() => {\n    if (!database || databaseStatus === \"loading\") {\n      return;\n    }\n    async function loadUserId() {\n      if (database) {\n        const storedUserId = await database.table(\"user\").get(\"userId\");\n        if (storedUserId) {\n          setUserId(storedUserId.value);\n        }\n      }\n    }\n\n    loadUserId();\n  }, [database, databaseStatus]);\n\n  return (\n    <UserIdContext.Provider value={userId}>{children}</UserIdContext.Provider>\n  );\n}\n\nexport function useUserId() {\n  return useContext(UserIdContext);\n}\n\nexport default UserIdContext;\n","import { useEffect, useState } from \"react\";\n\nfunction useDebounce<Type>(value: Type, delay: number): Type | undefined {\n  const [debouncedValue, setDebouncedValue] = useState<Type>();\n\n  useEffect(() => {\n    const timeout = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n\nexport default useDebounce;\n","import { useEffect, useState, useRef, useCallback } from \"react\";\nimport cloneDeep from \"lodash.clonedeep\";\nimport { Diff } from \"deep-diff\";\n\nimport useDebounce from \"./useDebounce\";\nimport { diff, applyChanges } from \"../helpers/diff\";\nimport Session from \"../network/Session\";\n\n/**\n * @param update The updated state or a state function passed into setState\n * @param sync Whether to sync the update with the session\n * @param force Whether to force a full update, usefull when partialUpdates is enabled\n */\nexport type SetNetworkedState<S> = (\n  update: React.SetStateAction<S>,\n  sync?: boolean,\n  force?: boolean,\n  updateLastSynced?: boolean\n) => void;\n\ntype Update<T> = {\n  id: string;\n  changes: Diff<T>[];\n};\n\n/**\n * Helper to sync a react state to a `Session`\n *\n * @param {S} initialState\n * @param {Session} session `Session` instance\n * @param {string} eventName Name of the event to send to the session\n * @param {number} debounceRate Amount to debounce before sending to the session (ms)\n * @param {boolean} partialUpdates Allow sending of partial updates to the session\n * @param {string} partialUpdatesKey Key to lookup in the state to identify a partial update\n */\nfunction useNetworkedState<S extends { readonly [x: string]: any } | null>(\n  initialState: S,\n  session: Session,\n  eventName: string,\n  debounceRate: number = 500,\n  partialUpdates: boolean = true,\n  partialUpdatesKey: string = \"id\",\n  normalize?: (state: S) => S\n): [S, SetNetworkedState<S>] {\n  const [state, _setState] = useState(initialState);\n  // Used to control whether the state needs to be sent to the socket\n  const dirtyRef = useRef(false);\n\n  // Used to force a full update\n  const forceUpdateRef = useRef(false);\n  const updateLastSyncedRef = useRef(false);\n\n  // Update dirty at the same time as state\n  const setState = useCallback<SetNetworkedState<S>>(\n    (update, sync = true, force = false, updateLastSynced = false) => {\n      dirtyRef.current = dirtyRef.current || sync;\n      forceUpdateRef.current = forceUpdateRef.current || force;\n      updateLastSyncedRef.current =\n        updateLastSyncedRef.current || updateLastSynced;\n      _setState(update);\n    },\n    []\n  );\n\n  const debouncedState = useDebounce(state, debounceRate);\n  const lastSyncedStateRef = useRef<S>();\n  useEffect(() => {\n    if (dirtyRef.current) {\n      // If partial updates enabled, send just the changes to the socket\n      if (\n        lastSyncedStateRef.current &&\n        debouncedState &&\n        partialUpdates &&\n        !forceUpdateRef.current\n      ) {\n        const changes = diff(lastSyncedStateRef.current, debouncedState);\n        if (changes) {\n          if (!debouncedState) {\n            return;\n          }\n          const update = { id: debouncedState[partialUpdatesKey], changes };\n          session.socket?.emit(`${eventName}_update`, update);\n        }\n      } else {\n        session.socket?.emit(eventName, debouncedState);\n      }\n      dirtyRef.current = false;\n      forceUpdateRef.current = false;\n      lastSyncedStateRef.current = cloneDeep(debouncedState);\n      updateLastSyncedRef.current = false;\n      return;\n    }\n    if (updateLastSyncedRef.current) {\n      lastSyncedStateRef.current = cloneDeep(debouncedState);\n      updateLastSyncedRef.current = false;\n    }\n  }, [\n    session.socket,\n    eventName,\n    debouncedState,\n    partialUpdates,\n    partialUpdatesKey,\n  ]);\n\n  useEffect(() => {\n    function handleSocketEvent(data: S) {\n      const normalized = normalize ? normalize(data) : data;\n      _setState(normalized);\n      lastSyncedStateRef.current = normalized;\n    }\n\n    function handleSocketUpdateEvent(update: Update<S>) {\n      _setState((prevState) => {\n        if (prevState && prevState[partialUpdatesKey] === update.id) {\n          let newState = { ...prevState } as S;\n          applyChanges(newState, update.changes);\n          if (normalize) {\n            newState = normalize(newState);\n          }\n          if (lastSyncedStateRef.current) {\n            applyChanges(lastSyncedStateRef.current, update.changes);\n            if (normalize) {\n              lastSyncedStateRef.current = normalize(lastSyncedStateRef.current);\n            }\n          }\n          return newState;\n        } else {\n          return prevState;\n        }\n      });\n    }\n\n    session.socket?.on(eventName, handleSocketEvent);\n    session.socket?.on(`${eventName}_update`, handleSocketUpdateEvent);\n    return () => {\n      session.socket?.off(eventName, handleSocketEvent);\n      session.socket?.off(`${eventName}_update`, handleSocketUpdateEvent);\n    };\n  }, [session.socket, eventName, partialUpdatesKey, normalize]);\n\n  return [state, setState];\n}\n\nexport default useNetworkedState;\n","import React, { useEffect, useContext } from \"react\";\n\nimport { useDatabase } from \"./DatabaseContext\";\nimport { useUserId } from \"./UserIdContext\";\n\nimport useNetworkedState, {\n  SetNetworkedState,\n} from \"../hooks/useNetworkedState\";\nimport Session, { SessionStatus } from \"../network/Session\";\nimport { PlayerState } from \"../types/PlayerState\";\n\nexport const PlayerStateContext = React.createContext<PlayerState | undefined>(\n  undefined\n);\nexport const PlayerUpdaterContext = React.createContext<\n  SetNetworkedState<PlayerState> | undefined\n>(undefined);\n\ntype PlayerProviderProps = {\n  session: Session;\n  children: React.ReactNode;\n};\n\nexport function PlayerProvider({ session, children }: PlayerProviderProps) {\n  const userId = useUserId();\n  const { database, databaseStatus } = useDatabase();\n\n  const [playerState, setPlayerState] = useNetworkedState<PlayerState>(\n    {\n      nickname: \"\",\n      timer: undefined,\n      dice: { share: false, rolls: [] },\n      sessionId: undefined,\n      userId,\n    },\n    session,\n    \"player_state\",\n    500,\n    false\n  );\n\n  useEffect(() => {\n    if (!database || databaseStatus === \"loading\") {\n      return;\n    }\n    async function loadNickname() {\n      const storedNickname = await database?.table(\"user\").get(\"nickname\");\n      if (storedNickname !== undefined) {\n        setPlayerState((prevState) => ({\n          ...prevState,\n          nickname: storedNickname.value,\n        }));\n      }\n    }\n\n    loadNickname();\n  }, [database, databaseStatus, setPlayerState]);\n\n  useEffect(() => {\n    if (\n      playerState.nickname &&\n      database !== undefined &&\n      (databaseStatus === \"loaded\" || databaseStatus === \"disabled\")\n    ) {\n      database\n        .table(\"user\")\n        .update(\"nickname\", { value: playerState.nickname });\n    }\n  }, [playerState, database, databaseStatus]);\n\n  useEffect(() => {\n    if (userId) {\n      setPlayerState((prevState) => {\n        if (prevState) {\n          return {\n            ...prevState,\n            userId,\n          };\n        }\n        return prevState;\n      });\n    }\n  }, [userId, setPlayerState]);\n\n  useEffect(() => {\n    function updateSessionId() {\n      setPlayerState((prevState) => {\n        if (prevState) {\n          return {\n            ...prevState,\n            sessionId: session.id,\n          };\n        }\n        return prevState;\n      });\n    }\n    function handleSocketConnect() {\n      // Set the player state to trigger a sync\n      updateSessionId();\n    }\n\n    function handleSocketStatus(status: SessionStatus) {\n      if (status === \"joined\") {\n        updateSessionId();\n      }\n    }\n\n    session.on(\"status\", handleSocketStatus);\n    session.socket?.on(\"connect\", handleSocketConnect);\n    session.socket?.io.on(\"reconnect\", handleSocketConnect);\n\n    return () => {\n      session.off(\"status\", handleSocketStatus);\n      session.socket?.off(\"connect\", handleSocketConnect);\n      session.socket?.io.off(\"reconnect\", handleSocketConnect);\n    };\n  });\n\n  return (\n    <PlayerStateContext.Provider value={playerState}>\n      <PlayerUpdaterContext.Provider value={setPlayerState}>\n        {children}\n      </PlayerUpdaterContext.Provider>\n    </PlayerStateContext.Provider>\n  );\n}\n\nexport function usePlayerState() {\n  const context = useContext(PlayerStateContext);\n  if (context === undefined) {\n    throw new Error(\"usePlayerState must be used within a PlayerProvider\");\n  }\n  return context;\n}\n\nexport function usePlayerUpdater() {\n  const context = useContext(PlayerUpdaterContext);\n  if (context === undefined) {\n    throw new Error(\"usePlayerUpdater must be used within a PlayerProvider\");\n  }\n  return context;\n}\n","import React, { useState, useEffect, useContext } from \"react\";\nimport Session from \"../network/Session\";\n\nimport { PartyState } from \"../types/PartyState\";\n\nconst PartyContext = React.createContext<PartyState | undefined>(undefined);\n\ntype PartyProviderProps = {\n  session: Session;\n  children: React.ReactNode;\n};\n\nexport function PartyProvider({ session, children }: PartyProviderProps) {\n  const [partyState, setPartyState] = useState<PartyState>({});\n\n  useEffect(() => {\n    function handleSocketPartyState(partyState: PartyState) {\n      if (partyState && session.id) {\n        const { [session.id]: _, ...otherMembersState } = partyState;\n        setPartyState(otherMembersState);\n      } else {\n        setPartyState({});\n      }\n    }\n\n    session.socket?.on(\"party_state\", handleSocketPartyState);\n\n    return () => {\n      session.socket?.off(\"party_state\", handleSocketPartyState);\n    };\n  });\n\n  return (\n    <PartyContext.Provider value={partyState}>{children}</PartyContext.Provider>\n  );\n}\n\nexport function useParty() {\n  const context = useContext(PartyContext);\n  if (context === undefined) {\n    throw new Error(\"useParty must be used within a PartyProvider\");\n  }\n  return context;\n}\n\nexport default PartyContext;\n","import React, { useState, useContext, useCallback, useEffect } from \"react\";\nimport * as Comlink from \"comlink\";\nimport { encode } from \"@msgpack/msgpack\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\n\nimport { useDatabase } from \"./DatabaseContext\";\n\nimport useDebounce from \"../hooks/useDebounce\";\n\nimport { omit } from \"../helpers/shared\";\nimport { Asset } from \"../types/Asset\";\n\nexport type GetAssetEventHanlder = (\n  assetId: string\n) => Promise<Asset | undefined>;\nexport type AddAssetsEventHandler = (assets: Asset[]) => Promise<void>;\nexport type PutAssetEventsHandler = (asset: Asset) => Promise<void>;\n\ntype AssetsContextValue = {\n  getAsset: GetAssetEventHanlder;\n  addAssets: AddAssetsEventHandler;\n  putAsset: PutAssetEventsHandler;\n};\n\nconst AssetsContext =\n  React.createContext<AssetsContextValue | undefined>(undefined);\n\n// 100 MB max cache size\nconst maxCacheSize = 1e8;\n\nexport function AssetsProvider({\n  children,\n  gameId: _gameId,\n}: {\n  children: React.ReactNode;\n  gameId: string;\n}) {\n  const { worker, database, databaseStatus } = useDatabase();\n\n  useEffect(() => {\n    if (databaseStatus === \"loaded\") {\n      worker.cleanAssetCache(maxCacheSize);\n    }\n  }, [worker, databaseStatus]);\n\n  const getAsset = useCallback<GetAssetEventHanlder>(\n    async (assetId) => {\n      if (database) {\n        return await database.table(\"assets\").get(assetId);\n      }\n    },\n    [database]\n  );\n\n  const addAssets = useCallback<AddAssetsEventHandler>(\n    async (assets) => {\n      if (!database) {\n        return;\n      }\n\n      await database.table(\"assets\").bulkAdd(assets);\n    },\n    [database]\n  );\n\n  const putAsset = useCallback<PutAssetEventsHandler>(\n    async (asset) => {\n      if (database) {\n        // Check for broadcast channel and attempt to use worker to put map to avoid UI lockup\n        // Safari doesn't support BC so fallback to single thread\n        if (window.BroadcastChannel) {\n          const packedAsset = encode(asset);\n          const success = await worker.putData(\n            Comlink.transfer(packedAsset, [packedAsset.buffer]),\n            \"assets\"\n          );\n          if (!success) {\n            await database.table(\"assets\").put(asset);\n          }\n        } else {\n          await database.table(\"assets\").put(asset);\n        }\n      }\n    },\n    [database, worker]\n  );\n\n  const value = {\n    getAsset,\n    addAssets,\n    putAsset,\n  };\n\n  return (\n    <AssetsContext.Provider value={value}>{children}</AssetsContext.Provider>\n  );\n}\n\nexport function useAssets() {\n  const context = useContext(AssetsContext);\n  if (context === undefined) {\n    throw new Error(\"useAssets must be used within a AssetsProvider\");\n  }\n  return context;\n}\n\n/**\n * @typedef AssetURL\n * @property {string} url\n * @property {string} id\n * @property {number} references\n */\n\ntype AssetURL = {\n  url: string | null;\n  id: string;\n  references: number;\n};\n\ntype AssetURLs = Record<string, AssetURL>;\n\nexport const AssetURLsStateContext =\n  React.createContext<AssetURLs | undefined>(undefined);\n\nexport const AssetURLsUpdaterContext =\n  React.createContext<\n    React.Dispatch<React.SetStateAction<AssetURLs>> | undefined\n  >(undefined);\n\nfunction normalizeAssetFile(file: any): Uint8Array | ArrayBuffer | null {\n  if (!file) {\n    return null;\n  }\n  if (file instanceof Uint8Array || file instanceof ArrayBuffer) {\n    if (file.byteLength === 0) {\n      return null;\n    }\n    return file;\n  }\n  if (Array.isArray(file)) {\n    const buffer = new Uint8Array(file);\n    return buffer.byteLength === 0 ? null : buffer;\n  }\n  if (file && typeof file === \"object\" && \"buffer\" in file) {\n    const buffer = (file as any).buffer;\n    if (buffer instanceof ArrayBuffer) {\n      if (buffer.byteLength === 0) {\n        return null;\n      }\n      return buffer;\n    }\n  }\n  return null;\n}\n\n/**\n * Helper to manage sharing of custom image sources between uses of useAssetURL\n */\nexport function AssetURLsProvider({ children }: { children: React.ReactNode }) {\n  const [assetURLs, setAssetURLs] = useState<AssetURLs>({});\n  const { database } = useDatabase();\n\n  // Keep track of the assets that need to be loaded\n  const [assetKeys, setAssetKeys] = useState<string[]>([]);\n\n  // Load assets after 100ms\n  const loadingDebouncedAssetURLs = useDebounce(assetURLs, 100);\n\n  // Update the asset keys to load when a url is added without an asset attached\n  useEffect(() => {\n    if (!loadingDebouncedAssetURLs) {\n      return;\n    }\n    let keysToLoad: string[] = [];\n    for (let url of Object.values(loadingDebouncedAssetURLs)) {\n      if (url.url === null) {\n        keysToLoad.push(url.id);\n      }\n    }\n    if (keysToLoad.length > 0) {\n      setAssetKeys(keysToLoad);\n    }\n  }, [loadingDebouncedAssetURLs]);\n\n  // Get the new assets whenever the keys change\n  const assets = useLiveQuery<Asset[]>(\n    () => database?.table(\"assets\").bulkGet(assetKeys) || [],\n    [database, assetKeys]\n  );\n\n  // Update asset URLs when assets are loaded\n  useEffect(() => {\n    if (!assets || assets.length === 0) {\n      return;\n    }\n\n    // Assets are about to be loaded so clear the keys to load\n    setAssetKeys([]);\n\n    setAssetURLs((prevURLs) => {\n      let newURLs = { ...prevURLs };\n      for (let asset of assets) {\n        if (asset && newURLs[asset.id]?.url === null) {\n          let resolvedUrl: string;\n          const fileData = normalizeAssetFile(asset.file);\n          if (fileData) {\n            resolvedUrl = URL.createObjectURL(\n              new Blob([fileData], { type: asset.mime })\n            );\n          } else if (asset.remoteUrl) {\n            resolvedUrl = asset.remoteUrl;\n          } else {\n            continue;\n          }\n          newURLs[asset.id] = {\n            ...newURLs[asset.id],\n            url: resolvedUrl,\n          };\n        }\n      }\n      return newURLs;\n    });\n  }, [assets]);\n\n  // Clean up asset URLs every minute\n  const cleanUpDebouncedAssetURLs = useDebounce(assetURLs, 60 * 1000);\n\n  // Revoke url when no more references\n  useEffect(() => {\n    setAssetURLs((prevURLs) => {\n      let urlsToCleanup = [];\n      for (let url of Object.values(prevURLs)) {\n        if (url.references <= 0) {\n          if (url.url && url.url.startsWith(\"blob:\")) {\n            URL.revokeObjectURL(url.url);\n          }\n          urlsToCleanup.push(url.id);\n        }\n      }\n      if (urlsToCleanup.length > 0) {\n        return omit(prevURLs, urlsToCleanup);\n      } else {\n        return prevURLs;\n      }\n    });\n  }, [cleanUpDebouncedAssetURLs]);\n\n  return (\n    <AssetURLsStateContext.Provider value={assetURLs}>\n      <AssetURLsUpdaterContext.Provider value={setAssetURLs}>\n        {children}\n      </AssetURLsUpdaterContext.Provider>\n    </AssetURLsStateContext.Provider>\n  );\n}\n\n/**\n * Helper function to load either file or default asset into a URL\n */\nexport function useAssetURL(\n  assetId: string | null,\n  type: \"file\" | \"default\" | null,\n  defaultSources: Record<string, string>,\n  unknownSource?: string\n) {\n  const assetURLs = useContext(AssetURLsStateContext);\n  if (assetURLs === undefined) {\n    throw new Error(\"useAssetURL must be used within a AssetURLsProvider\");\n  }\n  const setAssetURLs = useContext(AssetURLsUpdaterContext);\n  if (setAssetURLs === undefined) {\n    throw new Error(\"useAssetURL must be used within a AssetURLsProvider\");\n  }\n\n  useEffect(() => {\n    if (!assetId || type !== \"file\") {\n      return;\n    }\n    const updateAssetURL = () => {\n      const increaseReferences = (prevURLs: AssetURLs): AssetURLs => {\n        return {\n          ...prevURLs,\n          [assetId]: {\n            ...prevURLs[assetId],\n            references: prevURLs[assetId].references + 1,\n          },\n        };\n      };\n\n      const createReference = (prevURLs: AssetURLs): AssetURLs => {\n        return {\n          ...prevURLs,\n          [assetId]: { url: null, id: assetId, references: 1 },\n        };\n      };\n      setAssetURLs?.((prevURLs) => {\n        if (assetId in prevURLs) {\n          // Check if the asset url is already added and increase references\n          return increaseReferences(prevURLs);\n        } else {\n          return createReference(prevURLs);\n        }\n      });\n    };\n\n    updateAssetURL();\n\n    return () => {\n      // Decrease references\n      setAssetURLs((prevURLs) => {\n        if (assetId in prevURLs) {\n          return {\n            ...prevURLs,\n            [assetId]: {\n              ...prevURLs[assetId],\n              references: prevURLs[assetId].references - 1,\n            },\n          };\n        } else {\n          return prevURLs;\n        }\n      });\n    };\n  }, [assetId, setAssetURLs, type]);\n\n  if (!assetId) {\n    return unknownSource;\n  }\n\n  if (type === \"default\") {\n    return defaultSources[assetId];\n  }\n\n  if (type === \"file\") {\n    return assetURLs[assetId]?.url || unknownSource;\n  }\n\n  return unknownSource;\n}\n\ntype FileData = {\n  file: string;\n  type: \"file\";\n  thumbnail?: string;\n  quality?: string;\n  resolutions?: Record<string, string>;\n};\n\ntype DefaultData = {\n  key: string;\n  type: \"default\";\n};\n\n/**\n * Load a map or token into a URL taking into account a thumbnail and multiple resolutions\n */\nexport function useDataURL(\n  data: FileData | DefaultData | null,\n  defaultSources: Record<string, string>,\n  unknownSource: string | undefined = undefined,\n  thumbnail = false\n) {\n  const [assetId, setAssetId] = useState<string | null>(null);\n\n  useEffect(() => {\n    function loadAssetId() {\n      if (!data) {\n        return;\n      }\n      if (data.type === \"default\") {\n        setAssetId(data.key);\n      } else {\n        if (thumbnail && data.thumbnail) {\n          setAssetId(data.thumbnail);\n        } else if (\n          data.resolutions &&\n          data.quality &&\n          data.quality !== \"original\"\n        ) {\n          setAssetId(data.resolutions[data.quality]);\n        } else {\n          setAssetId(data.file);\n        }\n      }\n    }\n\n    loadAssetId();\n  }, [data, thumbnail]);\n\n  const assetURL = useAssetURL(\n    assetId || null,\n    data?.type || null,\n    defaultSources,\n    unknownSource\n  );\n  return assetURL;\n}\n\nexport default AssetsContext;\n","import { v4 as uuid } from \"uuid\";\nimport cloneDeep from \"lodash.clonedeep\";\n\nimport { keyBy } from \"./shared\";\nimport { Group, GroupContainer, GroupItem } from \"../types/Group\";\n\n/**\n * Transform an array of group ids to their groups\n */\nexport function groupsFromIds(groupIds: string[], groups: Group[]): Group[] {\n  const groupsByIds = keyBy(groups, \"id\");\n  const filteredGroups: Group[] = [];\n  for (let groupId of groupIds) {\n    if (groupId in groupsByIds) {\n      filteredGroups.push(groupsByIds[groupId]);\n    }\n  }\n  return filteredGroups;\n}\n\n/**\n * Get all items from a group including all sub groups\n */\nexport function getGroupItems(group: Group): GroupItem[] {\n  if (group.type === \"group\") {\n    let groups = [];\n    for (let item of group.items) {\n      groups.push(...getGroupItems(item));\n    }\n    return groups;\n  } else {\n    return [group];\n  }\n}\n\n/**\n * Transform an array of groups into their assosiated items\n */\nexport function itemsFromGroups<Item extends Record<PropertyKey, any>>(\n  groups: Group[],\n  allItems: Item[],\n  itemKey = \"id\"\n): Item[] {\n  const allItemsById = keyBy(allItems, itemKey);\n  const groupedItems: Item[] = [];\n\n  for (let group of groups) {\n    const groupItems = getGroupItems(group);\n    for (let item of groupItems) {\n      const matched = allItemsById[item.id];\n      if (matched) {\n        groupedItems.push(matched);\n      }\n    }\n  }\n\n  return groupedItems;\n}\n\n/**\n * Combine a group and a group item\n */\nexport function combineGroups(a: Group, b: Group): GroupContainer {\n  switch (a.type) {\n    case \"item\":\n      if (b.type !== \"item\") {\n        throw new Error(\"Unable to combine two GroupContainers\");\n      }\n      return {\n        id: uuid(),\n        type: \"group\",\n        items: [a, b],\n        name: \"\",\n      };\n    case \"group\":\n      if (b.type !== \"item\") {\n        throw new Error(\"Unable to combine two GroupContainers\");\n      }\n      return {\n        id: a.id,\n        type: \"group\",\n        items: [...a.items, b],\n        name: a.name,\n      };\n    default:\n      throw new Error(\"Group type not implemented\");\n  }\n}\n\n/**\n * Immutably move group at indices `indices` into group at index `into`\n */\nexport function moveGroupsInto(\n  groups: Group[],\n  into: number,\n  indices: number[]\n): Group[] {\n  const newGroups = cloneDeep(groups);\n\n  const intoGroup = newGroups[into];\n  let fromGroups: Group[] = [];\n  for (let i of indices) {\n    fromGroups.push(newGroups[i]);\n  }\n\n  let combined: Group = intoGroup;\n  for (let fromGroup of fromGroups) {\n    combined = combineGroups(combined, fromGroup);\n  }\n\n  // Replace and remove old groups\n  newGroups[into] = combined;\n  for (let fromGroup of fromGroups) {\n    const i = newGroups.findIndex((group) => group.id === fromGroup.id);\n    newGroups.splice(i, 1);\n  }\n\n  return newGroups;\n}\n\n/**\n * Immutably move group at indices `indices` to index `to`\n */\nexport function moveGroups(\n  groups: Group[],\n  to: number,\n  indices: number[]\n): Group[] {\n  const newGroups = cloneDeep(groups);\n\n  let fromGroups = [];\n  for (let i of indices) {\n    fromGroups.push(newGroups[i]);\n  }\n\n  // Remove old groups\n  for (let fromGroup of fromGroups) {\n    const i = newGroups.findIndex((group) => group.id === fromGroup.id);\n    newGroups.splice(i, 1);\n  }\n\n  // Add back at new index\n  newGroups.splice(to, 0, ...fromGroups);\n\n  return newGroups;\n}\n\n/**\n * Move items from a sub group to the start of the base group\n * @param fromId The id of the group to move from\n * @param indices The indices of the items in the group\n */\nexport function ungroup(groups: Group[], fromId: string, indices: number[]) {\n  const newGroups = cloneDeep(groups);\n\n  const fromIndex = newGroups.findIndex((group) => group.id === fromId);\n  const from = newGroups[fromIndex];\n  if (from.type !== \"group\") {\n    throw new Error(`Unable to ungroup ${fromId}, not a group`);\n  }\n\n  let items: GroupItem[] = [];\n  for (let i of indices) {\n    items.push(from.items[i]);\n  }\n\n  // Remove items from previous group\n  for (let item of items) {\n    const i = from.items.findIndex((el) => el.id === item.id);\n    from.items.splice(i, 1);\n  }\n\n  // If we have no more items in the group delete it\n  if (from.items.length === 0) {\n    newGroups.splice(fromIndex, 1);\n  }\n\n  // Add to base group\n  newGroups.splice(0, 0, ...items);\n\n  return newGroups;\n}\n\n/**\n * Recursively find a group within a group array\n */\nexport function findGroup(groups: Group[], groupId: string): Group | undefined {\n  for (let group of groups) {\n    if (group.id === groupId) {\n      return group;\n    }\n    const items = getGroupItems(group);\n    for (let item of items) {\n      if (item.id === groupId) {\n        return item;\n      }\n    }\n  }\n}\n\n/**\n * Transform and item array to a record of item ids to item names\n */\nexport function getItemNames<Item extends { name: string; id: string }>(\n  items: Item[]\n) {\n  let names: Record<string, string> = {};\n  for (let item of items) {\n    names[item.id] = item.name;\n  }\n  return names;\n}\n\n/**\n * Immutably rename a group\n */\nexport function renameGroup(\n  groups: Group[],\n  groupId: string,\n  newName: string\n): Group[] {\n  let newGroups = cloneDeep(groups);\n  const groupIndex = newGroups.findIndex((group) => group.id === groupId);\n  const group = newGroups[groupIndex];\n  if (group.type !== \"group\") {\n    throw new Error(`Unable to rename group ${groupId}, not of type group`);\n  }\n  if (groupIndex >= 0) {\n    group.name = newName;\n  }\n  return newGroups;\n}\n\n/**\n * Remove items from groups including sub groups\n * @param {Group[]} groups\n * @param {string[]} itemIds\n */\nexport function removeGroupsItems(groups: Group[], itemIds: string[]): Group[] {\n  let newGroups = cloneDeep(groups);\n\n  for (let i = newGroups.length - 1; i >= 0; i--) {\n    const group = newGroups[i];\n    if (group.type === \"item\") {\n      if (itemIds.includes(group.id)) {\n        newGroups.splice(i, 1);\n      }\n    } else {\n      const items = group.items;\n      for (let j = items.length - 1; j >= 0; j--) {\n        const item = items[j];\n        if (itemIds.includes(item.id)) {\n          group.items.splice(j, 1);\n        }\n      }\n      // Remove group if no items are left\n      if (group.items.length === 0) {\n        newGroups.splice(i, 1);\n      }\n    }\n  }\n\n  return newGroups;\n}\n","import React, {\n  useEffect,\n  useState,\n  useContext,\n  useCallback,\n  useMemo,\n} from \"react\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\n\nimport { useDatabase } from \"./DatabaseContext\";\n\nimport { Map } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\n\nimport { removeGroupsItems } from \"../helpers/group\";\n\nimport { Group } from \"../types/Group\";\n\nexport type AddMapEventHandler = (map: Map) => Promise<void>;\nexport type RemoveMapsEventHandler = (ids: string[]) => Promise<void>;\nexport type ResetMapEventHandler = (id: string) => Promise<MapState>;\nexport type UpdateMapEventHanlder = (\n  id: string,\n  update: Partial<Map>\n) => Promise<void>;\nexport type UpdateMapStateEventHandler = (\n  id: string,\n  update: Partial<MapState>\n) => Promise<void>;\nexport type GetMapStateEventHandler = (\n  id: string\n) => Promise<MapState | undefined>;\nexport type GetMapEventHandler = (id: string) => Promise<Map | undefined>;\nexport type UpdateMapGroupsEventHandler = (groups: Group[]) => Promise<void>;\n\ntype MapDataContextValue = {\n  maps: Array<Map>;\n  mapStates: MapState[];\n  /** Adds a map to the database, also adds an assosiated state and group for that map */\n  addMap: AddMapEventHandler;\n  removeMaps: RemoveMapsEventHandler;\n  resetMap: ResetMapEventHandler;\n  updateMap: UpdateMapEventHanlder;\n  updateMapState: UpdateMapStateEventHandler;\n  getMapState: GetMapStateEventHandler;\n  getMap: GetMapEventHandler;\n  mapsLoading: boolean;\n  updateMapGroups: UpdateMapGroupsEventHandler;\n  mapsById: Record<string, Map>;\n  mapGroups: Group[];\n};\n\nconst MapDataContext =\n  React.createContext<MapDataContextValue | undefined>(undefined);\n\nconst defaultMapState: Omit<MapState, \"mapId\"> = {\n  tokens: {},\n  drawings: {},\n  fogs: {},\n  templates: {},\n  editFlags: [\"drawing\", \"tokens\", \"notes\"],\n  notes: {},\n  tokenNotes: {},\n  walls: {},\n  explored: [],\n  fogEnabled: false,\n  showExplored: false,\n};\n\nexport function MapDataProvider({ children }: { children: React.ReactNode }) {\n  const { database } = useDatabase();\n\n  const mapsQuery = useLiveQuery<Map[]>(\n    () => database?.table(\"maps\").toArray() || [],\n    [database]\n  );\n  const mapStatesQuery = useLiveQuery<MapState[]>(\n    () => database?.table(\"states\").toArray() || [],\n    [database]\n  );\n\n  const maps = useMemo(() => mapsQuery || [], [mapsQuery]);\n  const mapStates = useMemo(() => mapStatesQuery || [], [mapStatesQuery]);\n  const mapsLoading = useMemo(\n    () => !mapsQuery || !mapStatesQuery,\n    [mapsQuery, mapStatesQuery]\n  );\n\n  const mapGroupQuery = useLiveQuery(\n    () => database?.table(\"groups\").get(\"maps\"),\n    [database]\n  );\n\n  const [mapGroups, setMapGroups] = useState<Group[]>([]);\n  useEffect(() => {\n    async function updateMapGroups() {\n      const group = await database?.table(\"groups\").get(\"maps\");\n      setMapGroups(group.items);\n    }\n    if (database && mapGroupQuery) {\n      updateMapGroups();\n    }\n  }, [mapGroupQuery, database]);\n\n  const getMap = useCallback<GetMapEventHandler>(\n    async (mapId) => {\n      let map = await database?.table(\"maps\").get(mapId);\n      return map;\n    },\n    [database]\n  );\n\n  const getMapState = useCallback<GetMapStateEventHandler>(\n    async (mapId) => {\n      let mapState = await database?.table(\"states\").get(mapId);\n      return mapState;\n    },\n    [database]\n  );\n\n  const addMap = useCallback<AddMapEventHandler>(\n    async (map) => {\n      if (database) {\n        // Just update map database as react state will be updated with an Observable\n        const state = { ...defaultMapState, mapId: map.id };\n        await database.table(\"maps\").add(map);\n        await database.table(\"states\").add(state);\n        const group = await database.table(\"groups\").get(\"maps\");\n        await database.table(\"groups\").update(\"maps\", {\n          items: [{ id: map.id, type: \"item\" }, ...group.items],\n        });\n      }\n    },\n    [database]\n  );\n\n  const removeMaps = useCallback<RemoveMapsEventHandler>(\n    async (ids) => {\n      if (database) {\n        const maps = await database.table(\"maps\").bulkGet(ids);\n        // Remove assets linked with maps\n        let assetIds = [];\n        for (let map of maps) {\n          if (map.type === \"file\") {\n            assetIds.push(map.file);\n            assetIds.push(map.thumbnail);\n            for (let res of Object.values(map.resolutions)) {\n              assetIds.push(res);\n            }\n          }\n        }\n\n        const group = await database.table(\"groups\").get(\"maps\");\n        let items = removeGroupsItems(group.items, ids);\n        await database.table(\"groups\").update(\"maps\", { items });\n\n        await database.table(\"maps\").bulkDelete(ids);\n        await database.table(\"states\").bulkDelete(ids);\n        await database.table(\"assets\").bulkDelete(assetIds);\n      }\n    },\n    [database]\n  );\n\n  const resetMap = useCallback<ResetMapEventHandler>(\n    async (id) => {\n      const state: MapState = { ...defaultMapState, mapId: id };\n      await database?.table(\"states\").put(state);\n      return state;\n    },\n    [database]\n  );\n\n  const updateMap = useCallback<UpdateMapEventHanlder>(\n    async (id, update) => {\n      await database?.table(\"maps\").update(id, update);\n    },\n    [database]\n  );\n\n  const updateMapState = useCallback<UpdateMapStateEventHandler>(\n    async (id, update) => {\n      await database?.table(\"states\").update(id, update);\n    },\n    [database]\n  );\n\n  const updateMapGroups = useCallback<UpdateMapGroupsEventHandler>(\n    async (groups) => {\n      // Update group state immediately to avoid animation delay\n      setMapGroups(groups);\n      await database?.table(\"groups\").update(\"maps\", { items: groups });\n    },\n    [database]\n  );\n\n  const [mapsById, setMapsById] = useState<Record<string, Map>>({});\n  useEffect(() => {\n    setMapsById(\n      maps.reduce((obj: Record<string, Map>, map) => {\n        obj[map.id] = map;\n        return obj;\n      }, {})\n    );\n  }, [maps]);\n\n  const value = {\n    maps,\n    mapStates,\n    mapGroups,\n    addMap,\n    removeMaps,\n    resetMap,\n    updateMap,\n    updateMapState,\n    getMap,\n    mapsLoading,\n    getMapState,\n    updateMapGroups,\n    mapsById,\n  };\n  return (\n    <MapDataContext.Provider value={value}>{children}</MapDataContext.Provider>\n  );\n}\n\nexport function useMapData() {\n  const context = useContext(MapDataContext);\n  if (context === undefined) {\n    throw new Error(\"useMapData must be used within a MapDataProvider\");\n  }\n  return context;\n}\n\nexport default MapDataContext;\n","import React, {\n  useEffect,\n  useState,\n  useContext,\n  useCallback,\n  useMemo,\n} from \"react\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\n\nimport { useDatabase } from \"./DatabaseContext\";\n\nimport { removeGroupsItems } from \"../helpers/group\";\n\nimport { Token } from \"../types/Token\";\nimport { Group } from \"../types/Group\";\n\nexport type AddTokenEventHandler = (token: Token) => Promise<void>;\nexport type RemoveTokensEventHandler = (ids: string[]) => Promise<void>;\nexport type UpdateTokenEventHandler = (\n  id: string,\n  update: Partial<Token>\n) => Promise<void>;\nexport type GetTokenEventHandler = (\n  tokenId: string\n) => Promise<Token | undefined>;\nexport type UpdateTokenGroupsEventHandler = (groups: Group[]) => Promise<void>;\nexport type UpdateTokensHiddenEventHandler = (\n  ids: string[],\n  hideInSidebar: boolean\n) => Promise<void>;\n\ntype TokenDataContextValue = {\n  tokens: Token[];\n  addToken: AddTokenEventHandler;\n  tokenGroups: Group[];\n  removeTokens: RemoveTokensEventHandler;\n  updateToken: UpdateTokenEventHandler;\n  getToken: GetTokenEventHandler;\n  tokensById: Record<string, Token>;\n  tokensLoading: boolean;\n  updateTokenGroups: UpdateTokenGroupsEventHandler;\n  updateTokensHidden: UpdateTokensHiddenEventHandler;\n};\n\nconst TokenDataContext =\n  React.createContext<TokenDataContextValue | undefined>(undefined);\n\nexport function TokenDataProvider({ children }: { children: React.ReactNode }) {\n  const { database } = useDatabase();\n\n  const tokensQuery = useLiveQuery<Token[]>(\n    () => database?.table(\"tokens\").toArray() || [],\n    [database]\n  );\n\n  const tokens = useMemo(() => tokensQuery || [], [tokensQuery]);\n  const tokensLoading = useMemo(() => !tokensQuery, [tokensQuery]);\n\n  const tokenGroupQuery = useLiveQuery(\n    () => database?.table(\"groups\").get(\"tokens\"),\n    [database]\n  );\n\n  const [tokenGroups, setTokenGroups] = useState<Group[]>([]);\n  useEffect(() => {\n    async function updateTokenGroups() {\n      const group = await database?.table(\"groups\").get(\"tokens\");\n      setTokenGroups(group.items);\n    }\n    if (database && tokenGroupQuery) {\n      updateTokenGroups();\n    }\n  }, [tokenGroupQuery, database]);\n\n  const getToken = useCallback<GetTokenEventHandler>(\n    async (tokenId) => {\n      let token = await database?.table(\"tokens\").get(tokenId);\n      return token;\n    },\n    [database]\n  );\n\n  // Add token and add it to the token group\n  const addToken = useCallback<AddTokenEventHandler>(\n    async (token) => {\n      if (database) {\n        await database.table(\"tokens\").add(token);\n        const group = await database.table(\"groups\").get(\"tokens\");\n        await database.table(\"groups\").update(\"tokens\", {\n          items: [{ id: token.id, type: \"item\" }, ...group.items],\n        });\n      }\n    },\n    [database]\n  );\n\n  const removeTokens = useCallback<RemoveTokensEventHandler>(\n    async (ids) => {\n      if (database) {\n        const tokens = await database.table(\"tokens\").bulkGet(ids);\n        let assetIds = [];\n        for (let token of tokens) {\n          if (token.type === \"file\") {\n            assetIds.push(token.file);\n            assetIds.push(token.thumbnail);\n          }\n        }\n\n        const group = await database.table(\"groups\").get(\"tokens\");\n        let items = removeGroupsItems(group.items, ids);\n        await database.table(\"groups\").update(\"tokens\", { items });\n\n        await database.table(\"tokens\").bulkDelete(ids);\n        await database.table(\"assets\").bulkDelete(assetIds);\n      }\n    },\n    [database]\n  );\n\n  const updateToken = useCallback<UpdateTokenEventHandler>(\n    async (id, update) => {\n      await database?.table(\"tokens\").update(id, update);\n    },\n    [database]\n  );\n\n  const updateTokensHidden = useCallback<UpdateTokensHiddenEventHandler>(\n    async (ids: string[], hideInSidebar: boolean) => {\n      await Promise.all(\n        ids.map((id) => database?.table(\"tokens\").update(id, { hideInSidebar }))\n      );\n    },\n    [database]\n  );\n\n  const updateTokenGroups = useCallback<UpdateTokenGroupsEventHandler>(\n    async (groups: Group[]) => {\n      // Update group state immediately to avoid animation delay\n      setTokenGroups(groups);\n      await database?.table(\"groups\").update(\"tokens\", { items: groups });\n    },\n    [database]\n  );\n\n  const [tokensById, setTokensById] = useState({});\n  useEffect(() => {\n    setTokensById(\n      tokens.reduce((obj: Record<string, Token>, token: Token) => {\n        obj[token.id] = token;\n        return obj;\n      }, {})\n    );\n  }, [tokens]);\n\n  const value = {\n    tokens,\n    addToken,\n    tokenGroups,\n    removeTokens,\n    updateToken,\n    tokensById,\n    tokensLoading,\n    getToken,\n    updateTokenGroups,\n    updateTokensHidden,\n  };\n\n  return (\n    <TokenDataContext.Provider value={value}>\n      {children}\n    </TokenDataContext.Provider>\n  );\n}\n\nexport function useTokenData() {\n  const context = useContext(TokenDataContext);\n  if (context === undefined) {\n    throw new Error(\"useTokenData must be used within a TokenDataProvider\");\n  }\n  return context;\n}\n\nexport default TokenDataContext;\n","import { useState, useCallback } from \"react\";\nimport Action from \"../actions/Action\";\nimport { DrawingState } from \"../types/Drawing\";\nimport { FogState } from \"../types/Fog\";\nimport { MapState } from \"../types/MapState\";\nimport { Notes } from \"../types/Note\";\nimport { TokenNotes } from \"../types/TokenNote\";\nimport { SpellTemplateState } from \"../types/SpellTemplate\";\nimport { TokenStates } from \"../types/TokenState\";\nimport { WallState } from \"../types/Wall\";\nimport { SetNetworkedState } from \"./useNetworkedState\";\n\nexport type DrawingsAction = {\n  type: \"drawings\";\n  action: Action<DrawingState>;\n};\nexport type FogsAction = { type: \"fogs\"; action: Action<FogState> };\nexport type WallsAction = { type: \"walls\"; action: Action<WallState> };\nexport type TemplatesAction = {\n  type: \"templates\";\n  action: Action<SpellTemplateState>;\n};\nexport type TokensAction = { type: \"tokens\"; action: Action<TokenStates> };\nexport type NotesAction = { type: \"notes\"; action: Action<Notes> };\nexport type TokenNotesAction = {\n  type: \"tokenNotes\";\n  action: Action<TokenNotes>;\n};\n\nexport type MapAction =\n  | DrawingsAction\n  | FogsAction\n  | WallsAction\n  | TemplatesAction\n  | TokensAction\n  | NotesAction\n  | TokenNotesAction;\n\nexport type MapActions = {\n  actions: MapAction[][];\n  actionIndex: number;\n};\n\nexport type AddActionsEventHandler = (\n  actions: MapAction[],\n  sync?: boolean,\n  updateLastSynced?: boolean\n) => void;\nexport type UpdateActionIndexEventHandler = (change: number) => void;\nexport type ResetActionsEventHandler = () => void;\n\nconst defaultMapActions: MapActions = {\n  actions: [],\n  actionIndex: -1,\n};\n\nfunction useMapActions(\n  setCurrentMapState: SetNetworkedState<MapState | null>\n): [\n  MapActions,\n  AddActionsEventHandler,\n  UpdateActionIndexEventHandler,\n  ResetActionsEventHandler\n] {\n  const [mapActions, setMapActions] = useState(defaultMapActions);\n\n  function applyMapActionsToState(\n    mapState: MapState,\n    actions: MapAction[]\n  ): MapState {\n    if (!mapState.templates) {\n      mapState.templates = {};\n    }\n    if (!mapState.tokenNotes) {\n      mapState.tokenNotes = {};\n    }\n    if (!mapState.walls) {\n      mapState.walls = {};\n    }\n    for (let mapAction of actions) {\n      if (mapAction.type === \"drawings\") {\n        mapState.drawings = mapAction.action.execute(mapState.drawings);\n      } else if (mapAction.type === \"fogs\") {\n        mapState.fogs = mapAction.action.execute(mapState.fogs);\n      } else if (mapAction.type === \"walls\") {\n        mapState.walls = mapAction.action.execute(mapState.walls);\n      } else if (mapAction.type === \"templates\") {\n        mapState.templates = mapAction.action.execute(mapState.templates);\n      } else if (mapAction.type === \"tokens\") {\n        mapState.tokens = mapAction.action.execute(mapState.tokens);\n      } else if (mapAction.type === \"notes\") {\n        mapState.notes = mapAction.action.execute(mapState.notes);\n      } else if (mapAction.type === \"tokenNotes\") {\n        mapState.tokenNotes = mapAction.action.execute(mapState.tokenNotes);\n      }\n    }\n    return mapState;\n  }\n\n  function undoMapActionsToState(\n    mapState: MapState,\n    actions: MapAction[]\n  ): MapState {\n    if (!mapState.templates) {\n      mapState.templates = {};\n    }\n    if (!mapState.tokenNotes) {\n      mapState.tokenNotes = {};\n    }\n    if (!mapState.walls) {\n      mapState.walls = {};\n    }\n    for (let mapAction of actions) {\n      if (mapAction.type === \"drawings\") {\n        mapState.drawings = mapAction.action.undo(mapState.drawings);\n      } else if (mapAction.type === \"fogs\") {\n        mapState.fogs = mapAction.action.undo(mapState.fogs);\n      } else if (mapAction.type === \"walls\") {\n        mapState.walls = mapAction.action.undo(mapState.walls);\n      } else if (mapAction.type === \"templates\") {\n        mapState.templates = mapAction.action.undo(mapState.templates);\n      } else if (mapAction.type === \"tokens\") {\n        mapState.tokens = mapAction.action.undo(mapState.tokens);\n      } else if (mapAction.type === \"notes\") {\n        mapState.notes = mapAction.action.undo(mapState.notes);\n      } else if (mapAction.type === \"tokenNotes\") {\n        mapState.tokenNotes = mapAction.action.undo(mapState.tokenNotes);\n      }\n    }\n    return mapState;\n  }\n\n  function addActions(\n    actions: MapAction[],\n    sync = true,\n    updateLastSynced = false\n  ) {\n    setMapActions((prevActions) => {\n      const newActions = [\n        ...prevActions.actions.slice(0, prevActions.actionIndex + 1),\n        actions,\n      ];\n      const newIndex = newActions.length - 1;\n      return {\n        actions: newActions,\n        actionIndex: newIndex,\n      };\n    });\n\n    // Update map state by performing the actions on it\n    setCurrentMapState((prevMapState) => {\n      if (!prevMapState) {\n        return prevMapState;\n      }\n      let state = { ...prevMapState };\n      state = applyMapActionsToState(state, actions);\n      return state;\n    }, sync, false, updateLastSynced);\n  }\n\n  function updateActionIndex(change: number) {\n    const prevIndex = mapActions.actionIndex;\n    const newIndex = Math.min(\n      Math.max(mapActions.actionIndex + change, -1),\n      mapActions.actions.length - 1\n    );\n\n    setMapActions((prevMapActions) => ({\n      ...prevMapActions,\n      actionIndex: newIndex,\n    }));\n\n    // Update map state by either performing the actions or undoing them\n    setCurrentMapState((prevMapState) => {\n      if (!prevMapState) {\n        return prevMapState;\n      }\n      let state = { ...prevMapState };\n      if (prevIndex < newIndex) {\n        // Redo\n        for (let i = prevIndex + 1; i < newIndex + 1; i++) {\n          const actions = mapActions.actions[i];\n          state = applyMapActionsToState(state, actions);\n        }\n      } else {\n        // Undo\n        for (let i = prevIndex; i > newIndex; i--) {\n          const actions = mapActions.actions[i];\n          state = undoMapActionsToState(state, actions);\n        }\n      }\n      return state;\n    });\n  }\n\n  const resetActions = useCallback(() => {\n    setMapActions(defaultMapActions);\n  }, []);\n\n  return [mapActions, addActions, updateActionIndex, resetActions];\n}\n\nexport default useMapActions;\n","import { useCallback, useEffect, useRef } from \"react\";\nimport shortid from \"shortid\";\n\nimport Session from \"../network/Session\";\nimport { MapState } from \"../types/MapState\";\nimport { TokenAttributeState } from \"../types/TokenState\";\nimport { SetNetworkedState } from \"./useNetworkedState\";\n\ntype TokenAttributePatch = {\n  attributes?: TokenAttributeState | null;\n};\n\ntype TokenAttributeUpdatePayload = {\n  mapId: string;\n  tokenStateId: string;\n  version: number;\n  updatedAt: number;\n  updatedBy: string;\n  patch: TokenAttributePatch;\n  changeId: string;\n};\n\ntype TokenAttributeBulkPayload = {\n  mapId: string;\n  updates: TokenAttributeUpdatePayload[];\n  changeId: string;\n};\n\ntype TokenAttributeUpdateInput = Omit<TokenAttributeUpdatePayload, \"changeId\" | \"mapId\">;\n\ntype TokenAttributeBulkInput = {\n  updates: TokenAttributeUpdateInput[];\n};\n\nconst TOKEN_ATTR_TOPICS = {\n  update: \"ext.token_attrs.update\",\n  bulk: \"ext.token_attrs.bulk\",\n};\n\nconst LOG_TOKEN_ATTR_STREAM_WARNINGS = false;\n\nconst CHANGE_ID_TTL_MS = 2 * 60 * 1000;\nconst MAX_SEEN_CHANGE_IDS = 500;\nconst MAX_ATTRIBUTE_ITEMS = 12;\nconst MAX_LABEL_LENGTH = 32;\nconst MAX_ID_LENGTH = 64;\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === \"object\" && !Array.isArray(value);\n}\n\nfunction isFiniteNumber(value: unknown): value is number {\n  return typeof value === \"number\" && Number.isFinite(value);\n}\n\nfunction isValidVisibility(value: unknown): value is \"public\" | \"private\" {\n  return value === \"public\" || value === \"private\";\n}\n\nfunction isValidString(value: unknown, maxLength: number) {\n  return typeof value === \"string\" && value.length > 0 && value.length <= maxLength;\n}\n\nfunction isValidLabel(value: unknown, maxLength: number) {\n  return typeof value === \"string\" && value.length <= maxLength;\n}\n\nfunction isValidBar(value: unknown): boolean {\n  if (!isRecord(value)) {\n    return false;\n  }\n  const { id, label, current, min, max, color, showMinMax, visibility } = value;\n  if (!isValidString(id, MAX_ID_LENGTH)) {\n    return false;\n  }\n  if (!isValidLabel(label, MAX_LABEL_LENGTH)) {\n    return false;\n  }\n  if (!isFiniteNumber(current)) {\n    return false;\n  }\n  if (min !== undefined && !isFiniteNumber(min)) {\n    return false;\n  }\n  if (max !== undefined && !isFiniteNumber(max)) {\n    return false;\n  }\n  if (typeof color !== \"string\" || color.length === 0) {\n    return false;\n  }\n  if (showMinMax !== undefined && typeof showMinMax !== \"boolean\") {\n    return false;\n  }\n  if (visibility !== undefined && !isValidVisibility(visibility)) {\n    return false;\n  }\n  return true;\n}\n\nfunction isValidValue(value: unknown): boolean {\n  if (!isRecord(value)) {\n    return false;\n  }\n  const { id, label, value: rawValue, visibility, color } = value;\n  if (!isValidString(id, MAX_ID_LENGTH)) {\n    return false;\n  }\n  if (!isValidLabel(label, MAX_LABEL_LENGTH)) {\n    return false;\n  }\n  if (typeof rawValue !== \"number\" && typeof rawValue !== \"string\") {\n    return false;\n  }\n  if (color !== undefined && color !== null && typeof color !== \"string\") {\n    return false;\n  }\n  if (visibility !== undefined && !isValidVisibility(visibility)) {\n    return false;\n  }\n  return true;\n}\n\nfunction isValidAttributeState(value: unknown): value is TokenAttributeState {\n  if (!isRecord(value)) {\n    return false;\n  }\n  const { bars, values, version, updatedAt, updatedBy } = value;\n  if (!Array.isArray(bars) || !Array.isArray(values)) {\n    return false;\n  }\n  if (bars.length > MAX_ATTRIBUTE_ITEMS || values.length > MAX_ATTRIBUTE_ITEMS) {\n    return false;\n  }\n  if (!bars.every(isValidBar) || !values.every(isValidValue)) {\n    return false;\n  }\n  if (!isFiniteNumber(version) || !isFiniteNumber(updatedAt)) {\n    return false;\n  }\n  if (!isValidString(updatedBy, MAX_ID_LENGTH)) {\n    return false;\n  }\n  return true;\n}\n\nfunction isValidPatch(value: unknown): value is TokenAttributePatch {\n  if (!isRecord(value)) {\n    return false;\n  }\n  if (!(\"attributes\" in value)) {\n    return false;\n  }\n  const { attributes } = value as { attributes?: unknown };\n  if (attributes === null || attributes === undefined) {\n    return true;\n  }\n  return isValidAttributeState(attributes);\n}\n\nfunction shouldAcceptUpdate(\n  incoming: TokenAttributeUpdatePayload,\n  current?: TokenAttributeState\n) {\n  if (!current) {\n    return true;\n  }\n  if (incoming.version > current.version) {\n    return true;\n  }\n  if (incoming.version === current.version && incoming.updatedAt > current.updatedAt) {\n    return true;\n  }\n  return false;\n}\n\nfunction pruneSeenChangeIds(seen: Map<string, number>) {\n  const now = Date.now();\n  for (const [key, timestamp] of seen) {\n    if (now - timestamp > CHANGE_ID_TTL_MS) {\n      seen.delete(key);\n    }\n  }\n  if (seen.size <= MAX_SEEN_CHANGE_IDS) {\n    return;\n  }\n  const entries = [...seen.entries()].sort((a, b) => a[1] - b[1]);\n  const excess = entries.length - MAX_SEEN_CHANGE_IDS;\n  for (let i = 0; i < excess; i++) {\n    seen.delete(entries[i][0]);\n  }\n}\n\nfunction normalizeIncomingUpdate(payload: unknown): TokenAttributeUpdatePayload | null {\n  if (!isRecord(payload)) {\n    return null;\n  }\n  const record = payload as Record<string, unknown>;\n  const mapId = record.mapId;\n  const tokenStateId = record.tokenStateId;\n  const version = record.version;\n  const updatedAt = record.updatedAt;\n  const updatedBy = record.updatedBy;\n  const patch = record.patch;\n  const changeId = record.changeId;\n  if (!isValidString(mapId, MAX_ID_LENGTH) || !isValidString(tokenStateId, MAX_ID_LENGTH)) {\n    return null;\n  }\n  if (!isFiniteNumber(version) || !isFiniteNumber(updatedAt)) {\n    return null;\n  }\n  if (!isValidString(updatedBy, MAX_ID_LENGTH)) {\n    return null;\n  }\n  if (!isValidString(changeId, MAX_ID_LENGTH)) {\n    return null;\n  }\n  if (!isValidPatch(patch)) {\n    return null;\n  }\n  return {\n    mapId: mapId as string,\n    tokenStateId: tokenStateId as string,\n    version: version as number,\n    updatedAt: updatedAt as number,\n    updatedBy: updatedBy as string,\n    patch: patch as TokenAttributePatch,\n    changeId: changeId as string,\n  };\n}\n\nfunction normalizeIncomingBulk(payload: unknown): TokenAttributeBulkPayload | null {\n  if (!isRecord(payload)) {\n    return null;\n  }\n  const record = payload as Record<string, unknown>;\n  const mapId = record.mapId;\n  const updates = record.updates;\n  const changeId = record.changeId;\n  if (!isValidString(mapId, MAX_ID_LENGTH) || !isValidString(changeId, MAX_ID_LENGTH)) {\n    return null;\n  }\n  if (!Array.isArray(updates) || updates.length === 0) {\n    return null;\n  }\n  const normalizedUpdates: TokenAttributeUpdatePayload[] = [];\n  for (const update of updates) {\n    const normalized = normalizeIncomingUpdate(update);\n    if (!normalized || normalized.mapId !== mapId) {\n      return null;\n    }\n    normalizedUpdates.push(normalized);\n  }\n  return {\n    mapId: mapId as string,\n    updates: normalizedUpdates,\n    changeId: changeId as string,\n  };\n}\n\nfunction applyUpdateToState(\n  state: MapState | null,\n  update: TokenAttributeUpdatePayload\n): MapState | null {\n  if (!state || state.mapId !== update.mapId) {\n    return state;\n  }\n  const token = state.tokens[update.tokenStateId];\n  if (!token) {\n    return state;\n  }\n  if (!shouldAcceptUpdate(update, token.attributes)) {\n    return state;\n  }\n  if (!update.patch || !(\"attributes\" in update.patch)) {\n    return state;\n  }\n  const incomingAttributes = update.patch.attributes;\n  const nextAttributes = incomingAttributes ?? undefined;\n  return {\n    ...state,\n    tokens: {\n      ...state.tokens,\n      [update.tokenStateId]: {\n        ...token,\n        attributes: nextAttributes,\n      },\n    },\n  };\n}\n\nfunction useTokenAttributesSync(\n  session: Session,\n  mapState: MapState | null,\n  setCurrentMapState: SetNetworkedState<MapState | null>\n) {\n  const mapStateRef = useRef<MapState | null>(mapState);\n  useEffect(() => {\n    mapStateRef.current = mapState;\n  }, [mapState]);\n\n  const seenChangeIdsRef = useRef<Map<string, number>>(new Map());\n\n  const registerChangeId = useCallback((changeId: string) => {\n    if (!changeId) {\n      return;\n    }\n    seenChangeIdsRef.current.set(changeId, Date.now());\n    pruneSeenChangeIds(seenChangeIdsRef.current);\n  }, []);\n\n  const isChangeIdSeen = useCallback((changeId: string) => {\n    if (!changeId) {\n      return false;\n    }\n    return seenChangeIdsRef.current.has(changeId);\n  }, []);\n\n  const sendTokenAttributesUpdate = useCallback(\n    (input: TokenAttributeUpdateInput, changeId?: string) => {\n      const mapId = mapStateRef.current?.mapId;\n      if (!mapId) {\n        return;\n      }\n      const id = changeId || shortid.generate();\n      registerChangeId(id);\n      session.sendStream(\n        TOKEN_ATTR_TOPICS.update,\n        {\n          mapId,\n          ...input,\n          changeId: id,\n        },\n        { includeSelf: true }\n      );\n    },\n    [registerChangeId, session]\n  );\n\n  const sendTokenAttributesBulk = useCallback(\n    (input: TokenAttributeBulkInput, changeId?: string) => {\n      const mapId = mapStateRef.current?.mapId;\n      if (!mapId || input.updates.length === 0) {\n        return;\n      }\n      const id = changeId || shortid.generate();\n      registerChangeId(id);\n      session.sendStream(\n        TOKEN_ATTR_TOPICS.bulk,\n        {\n          mapId,\n          updates: input.updates.map((update) => ({\n            ...update,\n            mapId,\n            changeId: id,\n          })),\n          changeId: id,\n        },\n        { includeSelf: true }\n      );\n    },\n    [registerChangeId, session]\n  );\n\n  useEffect(() => {\n    function handleUpdate(payload: unknown) {\n      const normalized = normalizeIncomingUpdate(payload);\n      if (!normalized) {\n        if (LOG_TOKEN_ATTR_STREAM_WARNINGS) {\n          console.warn(\"TOKEN_ATTR_STREAM_INVALID\", payload);\n        }\n        return;\n      }\n      if (isChangeIdSeen(normalized.changeId)) {\n        return;\n      }\n      registerChangeId(normalized.changeId);\n      setCurrentMapState(\n        (prev) => applyUpdateToState(prev, normalized),\n        false\n      );\n      console.info(\"TOKEN_ATTR_STREAM_APPLY\", {\n        tokenStateId: normalized.tokenStateId,\n        mapId: normalized.mapId,\n        changeId: normalized.changeId,\n      });\n    }\n\n    function handleBulk(payload: unknown) {\n      const normalized = normalizeIncomingBulk(payload);\n      if (!normalized) {\n        if (LOG_TOKEN_ATTR_STREAM_WARNINGS) {\n          console.warn(\"TOKEN_ATTR_STREAM_BULK_INVALID\", payload);\n        }\n        return;\n      }\n      if (isChangeIdSeen(normalized.changeId)) {\n        return;\n      }\n      registerChangeId(normalized.changeId);\n      setCurrentMapState(\n        (prev) => {\n          let nextState = prev;\n          for (const update of normalized.updates) {\n            nextState = applyUpdateToState(nextState, update);\n          }\n          return nextState;\n        },\n        false\n      );\n      console.info(\"TOKEN_ATTR_STREAM_BULK_APPLY\", {\n        count: normalized.updates.length,\n        mapId: normalized.mapId,\n        changeId: normalized.changeId,\n      });\n    }\n\n    session.onStream(TOKEN_ATTR_TOPICS.update, handleUpdate);\n    session.onStream(TOKEN_ATTR_TOPICS.bulk, handleBulk);\n    return () => {\n      session.off(`stream:${TOKEN_ATTR_TOPICS.update}`, handleUpdate);\n      session.off(`stream:${TOKEN_ATTR_TOPICS.bulk}`, handleBulk);\n    };\n  }, [isChangeIdSeen, registerChangeId, session, setCurrentMapState]);\n\n  return {\n    sendTokenAttributesUpdate,\n    sendTokenAttributesBulk,\n  };\n}\n\nexport type { TokenAttributeUpdateInput, TokenAttributeBulkInput, TokenAttributePatch };\nexport default useTokenAttributesSync;\n","function toUint8Array(\n  data: Uint8Array | ArrayBuffer | ArrayBufferView | number[] | null | undefined\n): Uint8Array {\n  if (!data) {\n    return new Uint8Array();\n  }\n  if (data instanceof Uint8Array) {\n    return data;\n  }\n  if (ArrayBuffer.isView(data)) {\n    const view = data as ArrayBufferView;\n    return new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n  }\n  if (data instanceof ArrayBuffer) {\n    return new Uint8Array(data);\n  }\n  if (Array.isArray(data)) {\n    return Uint8Array.from(data);\n  }\n  throw new Error(\"unsupported_array_buffer_type\");\n}\n\nexport function uint8ToBase64(\n  data: Uint8Array | ArrayBuffer | ArrayBufferView | number[] | null | undefined\n): string {\n  const buffer = toUint8Array(data);\n  if (buffer.length === 0) {\n    return \"\";\n  }\n\n  let binary = \"\";\n  const chunkSize = 0x8000;\n\n  for (let index = 0; index < buffer.length; index += chunkSize) {\n    const chunk = buffer.subarray(index, index + chunkSize);\n    binary += String.fromCharCode(...chunk);\n  }\n\n  return window.btoa(binary);\n}\nexport function base64ToUint8(source: string): Uint8Array {\n  if (!source) {\n    return new Uint8Array();\n  }\n\n  const binary = window.atob(source);\n  const length = binary.length;\n  const buffer = new Uint8Array(length);\n\n  for (let index = 0; index < length; index += 1) {\n    buffer[index] = binary.charCodeAt(index);\n  }\n\n  return buffer;\n}\n","import { useCallback, useMemo } from \"react\";\nimport { uint8ToBase64 } from \"../helpers/base64\";\nimport { Asset } from \"../types/Asset\";\n\nexport type UploadAssetResponse = {\n  id: string;\n  url?: string;\n  path?: string;\n  mime: string;\n  width: number;\n  height: number;\n  size?: number;\n  originalName?: string;\n};\n\nfunction normalizeAssetBase(brokerUrl: string | undefined) {\n  if (!brokerUrl) {\n    return null;\n  }\n  const trimmed = brokerUrl.replace(/\\/$/, \"\");\n  const root = trimmed.replace(/\\/assets$/, \"\");\n  return `${root}/assets`;\n}\n\nfunction dedupeAssetsPath(url: string) {\n  return url.replace(/\\/assets\\/assets\\//g, \"/assets/\");\n}\n\nexport function getAssetApiBase() {\n  return normalizeAssetBase(process.env.REACT_APP_BROKER_URL);\n}\n\nexport default function useAssetTransfer(gameId: string) {\n  const assetApiBase = useMemo(() => getAssetApiBase(), []);\n\n  const resolveRemoteUrl = useCallback(\n    (response: UploadAssetResponse): string => {\n      const base = assetApiBase?.replace(/\\/$/, \"\");\n      const baseRoot = base?.replace(/\\/assets$/, \"\");\n      const raw = response.url || response.path;\n      if (!raw) {\n        throw new Error(\"asset_response_missing_url\");\n      }\n      if (/^https?:\\/\\//i.test(raw)) {\n        return dedupeAssetsPath(raw);\n      }\n      if (raw.startsWith(\"/assets/\")) {\n        return baseRoot ? `${baseRoot}${raw}` : raw;\n      }\n      if (raw.startsWith(\"assets/\")) {\n        return baseRoot ? `${baseRoot}/${raw}` : `/${raw}`;\n      }\n      if (raw.startsWith(\"/\")) {\n        if (baseRoot) {\n          return `${baseRoot}${raw}`;\n        }\n        return base ? `${base}${raw}` : raw;\n      }\n      if (baseRoot) {\n        return `${baseRoot}/${raw}`;\n      }\n      return base ? `${base}/${raw}` : raw;\n    },\n    [assetApiBase]\n  );\n\n  const uploadAsset = useCallback(\n    async (asset: Asset): Promise<UploadAssetResponse> => {\n      if (!assetApiBase) {\n        throw new Error(\"asset_api_missing\");\n      }\n      if (!asset.file || asset.file.length === 0) {\n        throw new Error(\"asset_file_missing\");\n      }\n\n      const payload = {\n        id: asset.id,\n        owner: asset.owner,\n        mime: asset.mime,\n        width: asset.width,\n        height: asset.height,\n        gameId,\n        size: asset.size ?? asset.file.length,\n        name: asset.originalName,\n        file: uint8ToBase64(asset.file),\n      };\n\n      const response = await fetch(`${assetApiBase}/upload`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"omit\",\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        throw new Error(`asset_upload_failed_${response.status}`);\n      }\n\n      const result = (await response.json()) as UploadAssetResponse;\n      return {\n        ...result,\n        url: resolveRemoteUrl(result),\n      };\n    },\n    [assetApiBase, gameId, resolveRemoteUrl]\n  );\n\n  const downloadAsset = useCallback(\n    async (url: string) => {\n      const finalUrl = /^https?:\\/\\//i.test(url)\n        ? dedupeAssetsPath(url)\n        : assetApiBase\n        ? dedupeAssetsPath(\n            `${assetApiBase.replace(/\\/$/, \"\")}${url.startsWith(\"/\") ? url : `/${url}`}`\n          )\n        : url;\n\n    const response = await fetch(finalUrl, { credentials: \"omit\" });\n    if (!response.ok) {\n      const error = new Error(`asset_download_failed_${response.status}`);\n      (error as Error & { status?: number }).status = response.status;\n      throw error;\n    }\n    const buffer = await response.arrayBuffer();\n    return new Uint8Array(buffer);\n  }, [assetApiBase]);\n\n  return {\n    assetApiBase,\n    uploadAsset,\n    downloadAsset,\n  };\n}\n","import { IconButton, IconButtonProps } from \"theme-ui\";\n\ntype RadioButttonProps = {\n  isSelected: boolean;\n} & IconButtonProps;\n\nfunction RadioIconButton({\n  title,\n  onClick,\n  isSelected,\n  disabled,\n  children,\n  sx,\n  ...props\n}: RadioButttonProps) {\n  return (\n    <IconButton\n      aria-label={title}\n      title={title}\n      onClick={onClick}\n      sx={{ color: isSelected ? \"primary\" : \"text\", ...(sx || {}) }}\n      disabled={disabled}\n      {...props}\n    >\n      {children}\n    </IconButton>\n  );\n}\n\nRadioIconButton.defaultProps = {\n  disabled: false,\n};\n\nexport default RadioIconButton;\n","import ReactSelect, { Props } from \"react-select\";\nimport Creatable from \"react-select/creatable\";\nimport { useThemeUI } from \"theme-ui\";\n\ntype SelectProps = {\n  creatable?: boolean;\n} & Props;\n\nfunction Select({ creatable, ...props }: SelectProps) {\n  const { theme } = useThemeUI();\n\n  const Component: any = creatable ? Creatable : ReactSelect;\n\n  return (\n    <Component\n      styles={{\n        menu: (provided: any, state: any) => ({\n          ...provided,\n          backgroundColor: theme.colors?.background,\n          color: theme.colors?.text,\n          borderRadius: \"4px\",\n          borderColor: theme.colors?.gray,\n          borderStyle: \"solid\",\n          borderWidth: \"1px\",\n          fontFamily: (theme.fonts as any)?.body2,\n          opacity: state.isDisabled ? 0.5 : 1,\n        }),\n        control: (provided: any, state: any) => ({\n          ...provided,\n          backgroundColor: \"transparent\",\n          color: theme.colors?.text,\n          borderColor: theme.colors?.text,\n          opacity: state.isDisabled ? 0.5 : 1,\n        }),\n        singleValue: (provided: any) => ({\n          ...provided,\n          color: theme.colors?.text,\n          fontFamily: (theme.fonts as any).body2,\n        }),\n        option: (provided: any, state: any) => ({\n          ...provided,\n          color: theme.colors?.text,\n          opacity: state.isDisabled ? 0.5 : 1,\n        }),\n        dropdownIndicator: (provided: any, state: any) => ({\n          ...provided,\n          color: theme.colors?.text,\n          \":hover\": {\n            color: state.isDisabled\n              ? theme.colors?.disabled\n              : theme.colors?.primary,\n          },\n        }),\n        input: (provided: any, state: any) => ({\n          ...provided,\n          color: theme.colors?.text,\n          opacity: state.isDisabled ? 0.5 : 1,\n        }),\n        container: (provided: any) => ({\n          ...provided,\n          margin: \"4px 0\",\n        }),\n      }}\n      theme={(t: any) => ({\n        ...t,\n        colors: {\n          ...t.colors,\n          primary: theme.colors?.primary,\n          primary50: theme.colors?.secondary,\n          primary25: theme.colors?.highlight,\n        },\n      })}\n      captureMenuScroll={false}\n      {...props}\n    />\n  );\n}\n\nSelect.defaultProps = {\n  creatable: false,\n};\n\nexport default Select;\n","import React, { useEffect, useState } from \"react\";\nimport { Flex, Box, Label, Input, Checkbox } from \"theme-ui\";\n\nimport { isEmpty } from \"../../helpers/shared\";\nimport { getGridUpdatedInset } from \"../../helpers/grid\";\n\nimport { useDataURL } from \"../../contexts/AssetsContext\";\nimport { mapSources as defaultMapSources } from \"../../maps\";\n\nimport Divider from \"../Divider\";\nimport Select from \"../Select\";\nimport { Map, MapQuality } from \"../../types/Map\";\nimport { EditFlag, MapState } from \"../../types/MapState\";\nimport {\n  MapSettingsChangeEventHandler,\n  MapStateSettingsChangeEventHandler,\n} from \"../../types/Events\";\nimport { Grid, GridMeasurementType, GridType } from \"../../types/Grid\";\n\ntype QualityTypeSetting = { value: MapQuality; label: string };\nconst qualitySettings: QualityTypeSetting[] = [\n  { value: \"low\", label: \"Low\" },\n  { value: \"medium\", label: \"Medium\" },\n  { value: \"high\", label: \"High\" },\n  { value: \"ultra\", label: \"Ultra High\" },\n  { value: \"original\", label: \"Original\" },\n];\n\ntype GridTypeSetting = { value: GridType; label: string };\nconst gridTypeSettings: GridTypeSetting[] = [\n  { value: \"square\", label: \"Square\" },\n  { value: \"hexVertical\", label: \"Hex Vertical\" },\n  { value: \"hexHorizontal\", label: \"Hex Horizontal\" },\n];\n\ntype GridMeasurementTypeSetting = { value: GridMeasurementType; label: string };\nconst gridSquareMeasurementTypeSettings: GridMeasurementTypeSetting[] = [\n  { value: \"chebyshev\", label: \"Chessboard (D&D 5e)\" },\n  { value: \"alternating\", label: \"Alternating Diagonal (D&D 3.5e)\" },\n  { value: \"euclidean\", label: \"Euclidean\" },\n  { value: \"manhattan\", label: \"Manhattan\" },\n];\n\nconst gridHexMeasurementTypeSettings: GridMeasurementTypeSetting[] = [\n  { value: \"manhattan\", label: \"Manhattan\" },\n  { value: \"euclidean\", label: \"Euclidean\" },\n];\n\ntype MapSettingsProps = {\n  map: Map;\n  mapState: MapState;\n  onSettingsChange: MapSettingsChangeEventHandler;\n  onStateSettingsChange: MapStateSettingsChangeEventHandler;\n};\n\nfunction MapSettings({\n  map,\n  mapState,\n  onSettingsChange,\n  onStateSettingsChange,\n}: MapSettingsProps) {\n  function handleFlagChange(\n    event: React.ChangeEvent<HTMLInputElement>,\n    flag: EditFlag\n  ) {\n    if (event.target.checked) {\n      onStateSettingsChange({ editFlags: [...mapState.editFlags, flag] });\n    } else {\n      onStateSettingsChange({\n        editFlags: mapState.editFlags.filter((f) => f !== flag),\n      });\n    }\n  }\n\n  function handleGridSizeXChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const value = parseInt(event.target.value) || 0;\n    let grid = {\n      ...map.grid,\n      size: {\n        ...map.grid.size,\n        x: value,\n      },\n    };\n    grid.inset = getGridUpdatedInset(grid, map.width, map.height);\n    onSettingsChange({ grid });\n  }\n\n  function handleGridSizeYChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const value = parseInt(event.target.value) || 0;\n    let grid = {\n      ...map.grid,\n      size: {\n        ...map.grid.size,\n        y: value,\n      },\n    };\n    grid.inset = getGridUpdatedInset(grid, map.width, map.height);\n    onSettingsChange({ grid });\n  }\n\n  function handleGridTypeChange(option: GridTypeSetting | null) {\n    if (!option) {\n      return;\n    }\n    const type = option.value;\n    let grid: Grid = {\n      ...map.grid,\n      type,\n      measurement: {\n        ...map.grid.measurement,\n        type: type === \"square\" ? \"chebyshev\" : \"manhattan\",\n      },\n    };\n    grid.inset = getGridUpdatedInset(grid, map.width, map.height);\n    onSettingsChange({ grid });\n  }\n\n  function handleGridMeasurementTypeChange(\n    option: GridMeasurementTypeSetting | null\n  ) {\n    if (!option) {\n      return;\n    }\n    const grid = {\n      ...map.grid,\n      measurement: {\n        ...map.grid.measurement,\n        type: option.value,\n      },\n    };\n    onSettingsChange({ grid });\n  }\n\n  function handleQualityChange(option: QualityTypeSetting | null) {\n    if (!option) {\n      return;\n    }\n    onSettingsChange({ quality: option.value });\n  }\n\n  function handleGridMeasurementScaleChange(\n    event: React.ChangeEvent<HTMLInputElement>\n  ) {\n    const grid = {\n      ...map.grid,\n      measurement: {\n        ...map.grid.measurement,\n        scale: event.target.value,\n      },\n    };\n    onSettingsChange({ grid });\n  }\n\n  const mapURL = useDataURL(map, defaultMapSources);\n  const [mapSize, setMapSize] = useState(0);\n  useEffect(() => {\n    async function updateMapSize() {\n      if (mapURL) {\n        const response = await fetch(mapURL);\n        const blob = await response.blob();\n        let size = blob.size;\n        size /= 1000000; // Bytes to Megabytes\n        setMapSize(parseFloat(size.toFixed(2)));\n      } else {\n        setMapSize(0);\n      }\n    }\n    updateMapSize();\n  }, [mapURL]);\n\n  const mapEmpty = !map || isEmpty(map);\n  const mapStateEmpty = !mapState || isEmpty(mapState);\n\n  return (\n    <Flex sx={{ flexDirection: \"column\" }}>\n      <Flex>\n        <Box mt={2} mr={1} sx={{ flexGrow: 1 }}>\n          <Label htmlFor=\"gridX\">Columns</Label>\n          <Input\n            type=\"number\"\n            name=\"gridX\"\n            value={`${(map && map.grid.size.x) || 0}`}\n            onChange={handleGridSizeXChange}\n            disabled={mapEmpty}\n            min={1}\n            my={1}\n          />\n        </Box>\n        <Box mt={2} ml={1} sx={{ flexGrow: 1 }}>\n          <Label htmlFor=\"gridY\">Rows</Label>\n          <Input\n            type=\"number\"\n            name=\"gridY\"\n            value={`${(map && map.grid.size.y) || 0}`}\n            onChange={handleGridSizeYChange}\n            disabled={mapEmpty}\n            min={1}\n            my={1}\n          />\n        </Box>\n      </Flex>\n      <Box mt={2} sx={{ flexGrow: 1 }}>\n        <Label htmlFor=\"name\">Name</Label>\n        <Input\n          name=\"name\"\n          value={(map && map.name) || \"\"}\n          onChange={(e) => onSettingsChange({ name: e.target.value })}\n          disabled={mapEmpty}\n          my={1}\n        />\n      </Box>\n      <Flex\n        mt={2}\n        mb={mapEmpty || map.type === \"default\" ? 2 : 0}\n        sx={{ flexDirection: \"column\" }}\n      >\n        <Flex sx={{ alignItems: \"flex-end\" }}>\n          <Box sx={{ width: \"50%\" }}>\n            <Label>Grid Type</Label>\n            <Select\n              isDisabled={mapEmpty}\n              options={gridTypeSettings}\n              value={\n                mapEmpty\n                  ? undefined\n                  : gridTypeSettings.find((s) => s.value === map.grid.type)\n              }\n              onChange={handleGridTypeChange as any}\n              isSearchable={false}\n            />\n          </Box>\n          <Flex sx={{ flexGrow: 1, flexDirection: \"column\" }} ml={2}>\n            <Label>\n              <Checkbox\n                checked={!mapEmpty && map.showGrid}\n                disabled={mapEmpty}\n                onChange={(e) =>\n                  onSettingsChange({ showGrid: e.target.checked })\n                }\n              />\n              Draw Grid\n            </Label>\n            <Label>\n              <Checkbox\n                checked={!mapEmpty && map.snapToGrid}\n                disabled={mapEmpty}\n                onChange={(e) =>\n                  onSettingsChange({ snapToGrid: e.target.checked })\n                }\n              />\n              Snap to Grid\n            </Label>\n          </Flex>\n        </Flex>\n        <Flex sx={{ alignItems: \"flex-end\" }}>\n          <Box my={2} sx={{ width: \"50%\" }}>\n            <Label>Grid Measurement</Label>\n            <Select\n              isDisabled={mapEmpty}\n              options={\n                map && map.grid.type === \"square\"\n                  ? gridSquareMeasurementTypeSettings\n                  : gridHexMeasurementTypeSettings\n              }\n              value={\n                mapEmpty\n                  ? undefined\n                  : gridSquareMeasurementTypeSettings.find(\n                      (s) => s.value === map.grid.measurement.type\n                    )\n              }\n              onChange={handleGridMeasurementTypeChange as any}\n              isSearchable={false}\n            />\n          </Box>\n          <Box m={2} mr={0} sx={{ flexGrow: 1 }}>\n            <Label htmlFor=\"gridMeasurementScale\">Grid Scale</Label>\n            <Input\n              name=\"gridMeasurementScale\"\n              value={`${map && map.grid.measurement.scale}`}\n              onChange={handleGridMeasurementScaleChange}\n              disabled={mapEmpty}\n              min={1}\n              my={1}\n              autoComplete=\"off\"\n            />\n          </Box>\n        </Flex>\n      </Flex>\n      {!mapEmpty && map.type !== \"default\" && (\n        <Flex my={2} sx={{ alignItems: \"center\" }}>\n          <Box mb={1} sx={{ width: \"50%\" }}>\n            <Label>Quality</Label>\n            <Select\n              options={qualitySettings}\n              value={\n                mapEmpty\n                  ? undefined\n                  : qualitySettings.find((s) => s.value === map.quality)\n              }\n              isDisabled={mapEmpty}\n              onChange={handleQualityChange as any}\n              isOptionDisabled={\n                ((option: QualityTypeSetting) =>\n                  mapEmpty ||\n                  (option.value !== \"original\" &&\n                    !map.resolutions[option.value])) as any\n              }\n              isSearchable={false}\n            />\n          </Box>\n          <Label sx={{ width: \"50%\" }} ml={2}>\n            Size: {mapSize > 0 && `${mapSize}MB`}\n          </Label>\n        </Flex>\n      )}\n      <Divider fill />\n      <Box my={2} sx={{ flexGrow: 1 }}>\n        <Label>Allow Others to Edit</Label>\n        <Flex my={1}>\n          <Label>\n            <Checkbox\n              checked={!mapStateEmpty && mapState.editFlags.includes(\"fog\")}\n              disabled={mapStateEmpty}\n              onChange={(e) => handleFlagChange(e, \"fog\")}\n            />\n            Fog\n          </Label>\n          <Label>\n            <Checkbox\n              checked={!mapStateEmpty && mapState.editFlags.includes(\"drawing\")}\n              disabled={mapStateEmpty}\n              onChange={(e) => handleFlagChange(e, \"drawing\")}\n            />\n            Drawings\n          </Label>\n          <Label>\n            <Checkbox\n              checked={!mapStateEmpty && mapState.editFlags.includes(\"tokens\")}\n              disabled={mapStateEmpty}\n              onChange={(e) => handleFlagChange(e, \"tokens\")}\n            />\n            Tokens\n          </Label>\n          <Label>\n            <Checkbox\n              checked={!mapStateEmpty && mapState.editFlags.includes(\"notes\")}\n              disabled={mapStateEmpty}\n              onChange={(e) => handleFlagChange(e, \"notes\")}\n            />\n            Notes\n          </Label>\n        </Flex>\n      </Box>\n    </Flex>\n  );\n}\n\nexport default MapSettings;\n","import { useEffect, useState } from \"react\";\nimport useImage from \"use-image\";\n\nimport { useDataURL } from \"../contexts/AssetsContext\";\n\nimport { mapSources as defaultMapSources } from \"../maps\";\n\nimport { Map } from \"../types/Map\";\n\nfunction useMapImage(\n  map: Map | null\n): [HTMLImageElement | undefined, \"loaded\" | \"loading\" | \"failed\"] {\n  const mapURL = useDataURL(map, defaultMapSources);\n  const [mapImage, mapImageStatus] = useImage(mapURL || \"\");\n\n  // Create a map source that only updates when the image is fully loaded\n  const [loadedMapImage, setLoadedMapImage] = useState<HTMLImageElement>();\n  useEffect(() => {\n    if (mapImageStatus === \"loaded\" && mapImage) {\n      setLoadedMapImage(mapImage);\n    }\n  }, [mapImage, mapImageStatus]);\n\n  return [loadedMapImage, mapImageStatus];\n}\n\nexport default useMapImage;\n","import React, { useEffect } from \"react\";\n\nfunction usePreventOverscroll(elementRef: React.RefObject<HTMLElement>) {\n  useEffect(() => {\n    // Stop overscroll on chrome and safari\n    // also stop pinch to zoom on chrome\n    function preventOverscroll(event: WheelEvent) {\n      const path = event.composedPath ? event.composedPath() : [];\n      for (const node of path) {\n        if (\n          node instanceof HTMLElement &&\n          node.dataset &&\n          node.dataset.noteScroll === \"true\"\n        ) {\n          return;\n        }\n      }\n      event.preventDefault();\n    }\n    const element = elementRef.current;\n    if (element) {\n      element.addEventListener(\"wheel\", preventOverscroll, {\n        passive: false,\n      });\n    }\n\n    return () => {\n      if (element) {\n        element.removeEventListener(\"wheel\", preventOverscroll);\n      }\n    };\n  }, [elementRef]);\n}\n\nexport default usePreventOverscroll;\n","import React, { useEffect, useState, useContext } from \"react\";\nimport { EventEmitter } from \"events\";\n\nconst keyboardEmitter = new EventEmitter();\nkeyboardEmitter.setMaxListeners(100);\n\nconst KeyboardContext = React.createContext({ keyEmitter: keyboardEmitter });\n\nexport function KeyboardProvider({ children }: { children: React.ReactNode }) {\n  const [keyEmitter] = useState(keyboardEmitter);\n  useEffect(() => {\n    function handleKeyDown(event: Event) {\n      // Ignore text input\n      if (\n        event.target instanceof HTMLInputElement ||\n        event.target instanceof HTMLTextAreaElement\n      ) {\n        return;\n      }\n      keyEmitter.emit(\"keyDown\", event);\n    }\n\n    function handleKeyUp(event: Event) {\n      // Ignore text input\n      if (\n        event.target instanceof HTMLInputElement ||\n        event.target instanceof HTMLTextAreaElement\n      ) {\n        return;\n      }\n      keyEmitter.emit(\"keyUp\", event);\n    }\n\n    document.body.addEventListener(\"keydown\", handleKeyDown);\n    document.body.addEventListener(\"keyup\", handleKeyUp);\n    document.body.tabIndex = 1;\n    return () => {\n      document.body.removeEventListener(\"keydown\", handleKeyDown);\n      document.body.removeEventListener(\"keyup\", handleKeyUp);\n      document.body.tabIndex = 0;\n    };\n  }, [keyEmitter]);\n\n  return (\n    <KeyboardContext.Provider value={{ keyEmitter }}>\n      {children}\n    </KeyboardContext.Provider>\n  );\n}\n\nexport function useKeyboard(\n  onKeyDown?: (event: KeyboardEvent) => void,\n  onKeyUp?: (event: KeyboardEvent) => void\n) {\n  const context = useContext(KeyboardContext);\n  if (context === undefined) {\n    throw new Error(\"useKeyboard must be used within a KeyboardProvider\");\n  }\n  const { keyEmitter } = context;\n  useEffect(() => {\n    if (onKeyDown) {\n      keyEmitter.on(\"keyDown\", onKeyDown);\n    }\n    if (onKeyUp) {\n      keyEmitter.on(\"keyUp\", onKeyUp);\n    }\n\n    return () => {\n      if (onKeyDown) {\n        keyEmitter.off(\"keyDown\", onKeyDown);\n      }\n      if (onKeyUp) {\n        keyEmitter.off(\"keyUp\", onKeyUp);\n      }\n    };\n  });\n}\n\n/**\n * Handler to handle a blur event. Useful when using a shortcut that uses the Alt or Cmd\n * @param {FocusEvent} onBlur\n */\nexport function useBlur(onBlur: EventListenerOrEventListenerObject) {\n  useEffect(() => {\n    if (onBlur) {\n      window.addEventListener(\"blur\", onBlur);\n    }\n    return () => {\n      if (onBlur) {\n        window.removeEventListener(\"blur\", onBlur);\n      }\n    };\n  });\n}\n\nexport default KeyboardContext;\n","/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nfunction hasModifier(event: KeyboardEvent): boolean {\n  return event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;\n}\n\n/**\n * Key press without any modifiers and ignoring capitals\n * @param {KeyboardEvent} event\n * @param {string} key\n * @returns {boolean}\n */\nfunction singleKey(event: KeyboardEvent, key: string): boolean {\n  return (\n    !hasModifier(event) &&\n    (event.key === key || event.key === key.toUpperCase())\n  );\n}\n\nfunction undo(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey, shiftKey } = event;\n  return (key === \"z\" || key === \"Z\") && (ctrlKey || metaKey) && !shiftKey;\n}\n\nfunction redo(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey, shiftKey } = event;\n  return (key === \"z\" || key === \"Z\") && (ctrlKey || metaKey) && shiftKey;\n}\n\nfunction copy(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey, shiftKey } = event;\n  return (key === \"c\" || key === \"C\") && (ctrlKey || metaKey) && !shiftKey;\n}\n\nfunction paste(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey, shiftKey } = event;\n  return (key === \"v\" || key === \"V\") && (ctrlKey || metaKey) && !shiftKey;\n}\n\nfunction zoomIn(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey } = event;\n  return (key === \"=\" || key === \"+\") && !ctrlKey && !metaKey;\n}\n\nfunction zoomOut(event: KeyboardEvent): boolean {\n  const { key, ctrlKey, metaKey } = event;\n  return (key === \"-\" || key === \"_\") && !ctrlKey && !metaKey;\n}\n\ntype Shortcut = (event: KeyboardEvent) => boolean;\n\nconst shortcuts: Record<string, Shortcut> = {\n  // Tools\n  move: (event) => singleKey(event, \" \"),\n  moveTool: (event) => singleKey(event, \"w\"),\n  drawingTool: (event) => singleKey(event, \"d\"),\n  fogTool: (event) => singleKey(event, \"f\"),\n  spellTemplateTool: (event) => singleKey(event, \"a\"),\n  measureTool: (event) => singleKey(event, \"m\"),\n  pointerTool: (event) => singleKey(event, \"q\"),\n  textTool: (event) => singleKey(event, \"x\"),\n  noteTool: (event) => singleKey(event, \"n\"),\n  // Map editor\n  gridNudgeUp: ({ key }) => key === \"ArrowUp\",\n  gridNudgeLeft: ({ key }) => key === \"ArrowLeft\",\n  gridNudgeRight: ({ key }) => key === \"ArrowRight\",\n  gridNudgeDown: ({ key }) => key === \"ArrowDown\",\n  // Drawing tool\n  drawBrush: (event) => singleKey(event, \"b\"),\n  drawPaint: (event) => singleKey(event, \"p\"),\n  drawLine: (event) => singleKey(event, \"l\"),\n  drawRect: (event) => singleKey(event, \"r\"),\n  drawCircle: (event) => singleKey(event, \"c\"),\n  drawTriangle: (event) => singleKey(event, \"t\"),\n  drawPen: (event) => singleKey(event, \"y\"),\n  drawErase: (event) => singleKey(event, \"e\"),\n  drawBlend: (event) => singleKey(event, \"o\"),\n  drawFill: (event) => singleKey(event, \"g\"),\n  // Fog tool\n  fogPolygon: (event) => singleKey(event, \"p\"),\n  fogRectangle: (event) => singleKey(event, \"r\"),\n  fogBrush: (event) => singleKey(event, \"b\"),\n  fogToggle: (event) => singleKey(event, \"t\"),\n  fogErase: (event) => singleKey(event, \"e\"),\n  fogLayer: (event) => singleKey(event, \"l\"),\n  fogPreview: (event) => singleKey(event, \"f\"),\n  fogCut: (event) => singleKey(event, \"c\"),\n  fogFinishPolygon: ({ key }) => key === \"Enter\",\n  fogCancelPolygon: ({ key }) => key === \"Escape\",\n  // Select tool\n  selectTool: (event) => singleKey(event, \"s\"),\n  selectPath: (event) => singleKey(event, \"l\"),\n  selectRect: (event) => singleKey(event, \"r\"),\n  // Stage interaction\n  stageZoomIn: zoomIn,\n  stageZoomOut: zoomOut,\n  stagePrecisionZoom: ({ key }) => key === \"Shift\",\n  // Select\n  selectRange: ({ key }) => key === \"Shift\",\n  selectMultiple: ({ key }) => key === \"Control\" || key === \"Meta\",\n  // Common\n  undo,\n  redo,\n  copy,\n  paste,\n  delete: ({ key }) => key === \"Backspace\" || key === \"Delete\",\n  disableSnapping: ({ key }) => key === \"Control\" || key === \"Meta\",\n  duplicate: ({ key }) => key === \"Alt\",\n};\n\nexport default shortcuts;\n","import { useRef, useEffect, useState } from \"react\";\nimport { useGesture } from \"react-use-gesture\";\nimport { Handlers } from \"react-use-gesture/dist/types\";\nimport normalizeWheel from \"normalize-wheel\";\nimport Konva from \"konva\";\n\nimport { useKeyboard, useBlur } from \"../contexts/KeyboardContext\";\nimport { MapStage } from \"../contexts/MapStageContext\";\n\nimport shortcuts from \"../shortcuts\";\n\nimport Vector2 from \"../helpers/Vector2\";\n\nconst wheelZoomSpeed = -1;\nconst touchZoomSpeed = 0.005;\nconst minZoom = 0.1;\n\ntype StageScaleChangeEventHandler = (newScale: number) => void;\n\nfunction useStageInteraction(\n  stageRef: MapStage,\n  stageScale: number,\n  onStageScaleChange: StageScaleChangeEventHandler,\n  stageTranslateRef: React.MutableRefObject<Vector2>,\n  layerRef: React.RefObject<Konva.Layer>,\n  maxZoom = 10,\n  tool = \"move\",\n  preventInteraction = false,\n  gesture: Handlers = {}\n) {\n  const isInteractingWithCanvas = useRef(false);\n  const pinchPreviousDistanceRef = useRef<number>(0);\n  const pinchPreviousOriginRef = useRef<Vector2>({ x: 0, y: 0 });\n\n  const [zoomSpeed, setZoomSpeed] = useState(1);\n\n  // Prevent accessibility pinch to zoom on Mac\n  useEffect(() => {\n    function handleGesture(e: Event) {\n      e.preventDefault();\n    }\n    window.addEventListener(\"gesturestart\", handleGesture);\n    window.addEventListener(\"gesturechange\", handleGesture);\n    return () => {\n      window.removeEventListener(\"gesturestart\", handleGesture);\n      window.removeEventListener(\"gesturechange\", handleGesture);\n    };\n  });\n\n  useGesture(\n    {\n      ...gesture,\n      onWheelStart: (props) => {\n        const { event } = props;\n        const layer = layerRef.current;\n        isInteractingWithCanvas.current =\n          layer !== null && event.target === layer.getCanvas()._canvas;\n        gesture.onWheelStart && gesture.onWheelStart(props);\n      },\n      onWheel: (props) => {\n        const stage = stageRef.current;\n        if (\n          preventInteraction ||\n          !isInteractingWithCanvas.current ||\n          stage === null\n        ) {\n          return;\n        }\n        const { event, last } = props;\n        // Prevent double zoom on wheel end\n        if (!last) {\n          const { pixelY } = normalizeWheel(event);\n\n          const newScale = Math.min(\n            Math.max(\n              stageScale +\n                (pixelY * wheelZoomSpeed * stageScale * zoomSpeed) /\n                  window.innerHeight,\n              minZoom\n            ),\n            maxZoom\n          );\n\n          // Center on pointer\n          const pointer = stage.getPointerPosition();\n          if (pointer) {\n            const newTranslate = {\n              x: pointer.x - ((pointer.x - stage.x()) / stageScale) * newScale,\n              y: pointer.y - ((pointer.y - stage.y()) / stageScale) * newScale,\n            };\n\n            stage.position(newTranslate);\n\n            stageTranslateRef.current = newTranslate;\n\n            onStageScaleChange(newScale);\n          }\n        }\n\n        gesture.onWheel && gesture.onWheel(props);\n      },\n      onPinchStart: (props) => {\n        const { event } = props;\n        const layer = layerRef.current;\n        isInteractingWithCanvas.current =\n          layer !== null && event.target === layer.getCanvas()._canvas;\n        const { da, origin } = props;\n        const [distance] = da;\n        const [originX, originY] = origin;\n        pinchPreviousDistanceRef.current = distance;\n        pinchPreviousOriginRef.current = { x: originX, y: originY };\n        gesture.onPinchStart && gesture.onPinchStart(props);\n      },\n      onPinch: (props) => {\n        const layer = layerRef.current;\n        const stage = stageRef.current;\n        if (\n          preventInteraction ||\n          !isInteractingWithCanvas.current ||\n          layer === null ||\n          stage === null\n        ) {\n          return;\n        }\n\n        const { da, origin } = props;\n        const [distance] = da;\n        const [originX, originY] = origin;\n\n        // Apply scale\n        const distanceDelta = distance - pinchPreviousDistanceRef.current;\n        const originXDelta = originX - pinchPreviousOriginRef.current.x;\n        const originYDelta = originY - pinchPreviousOriginRef.current.y;\n        const newScale = Math.min(\n          Math.max(\n            stageScale +\n              distanceDelta * touchZoomSpeed * stageScale * zoomSpeed,\n            minZoom\n          ),\n          maxZoom\n        );\n\n        const canvasRect = layer.getCanvas()._canvas.getBoundingClientRect();\n        const relativeOrigin = {\n          x: originX - canvasRect.left,\n          y: originY - canvasRect.top,\n        };\n\n        // Center on pinch origin\n        const centeredTranslate = {\n          x:\n            relativeOrigin.x -\n            ((relativeOrigin.x - stage.x()) / stageScale) * newScale,\n          y:\n            relativeOrigin.y -\n            ((relativeOrigin.y - stage.y()) / stageScale) * newScale,\n        };\n\n        // Add pinch movement\n        const newTranslate = {\n          x: centeredTranslate.x + originXDelta,\n          y: centeredTranslate.y + originYDelta,\n        };\n\n        stage.position(newTranslate);\n        stageTranslateRef.current = newTranslate;\n\n        onStageScaleChange(newScale);\n\n        pinchPreviousDistanceRef.current = distance;\n        pinchPreviousOriginRef.current = { x: originX, y: originY };\n        gesture.onPinch && gesture.onPinch(props);\n      },\n      onDragStart: (props) => {\n        const { event } = props;\n        const layer = layerRef.current;\n        isInteractingWithCanvas.current =\n          layer !== null && event.target === layer.getCanvas()._canvas;\n        gesture.onDragStart && gesture.onDragStart(props);\n      },\n      onDrag: (props) => {\n        const { delta, pinching, buttons } = props;\n        const stage = stageRef.current;\n        if (\n          preventInteraction ||\n          pinching ||\n          !isInteractingWithCanvas.current ||\n          stage === null\n        ) {\n          return;\n        }\n\n        const [dx, dy] = delta;\n        const stageTranslate = stageTranslateRef.current;\n        // Move with move tool and left click or any mouse button but right click\n        if ((tool === \"move\" && buttons < 2) || buttons > 2) {\n          const newTranslate = {\n            x: stageTranslate.x + dx,\n            y: stageTranslate.y + dy,\n          };\n          stage.position(newTranslate);\n          stage.draw();\n          stageTranslateRef.current = newTranslate;\n        }\n        gesture.onDrag && gesture.onDrag(props);\n      },\n    },\n    {\n      // Fix drawing using old pointer end position on touch devices when drawing new shapes\n      drag: { delay: 300 },\n      domTarget: window,\n      eventOptions: {\n        passive: false,\n      },\n    }\n  );\n\n  function handleKeyDown(event: KeyboardEvent) {\n    // TODO: Find better way to detect whether keyboard event should fire.\n    // This one fires on all open stages\n    const stage = stageRef.current;\n    if (preventInteraction || stage === null) {\n      return;\n    }\n    if (shortcuts.stageZoomIn(event) || shortcuts.stageZoomOut(event)) {\n      const pixelY = shortcuts.stageZoomIn(event) ? -100 : 100;\n      const newScale = Math.min(\n        Math.max(\n          stageScale +\n            (pixelY * wheelZoomSpeed * stageScale * zoomSpeed) /\n              window.innerHeight,\n          minZoom\n        ),\n        maxZoom\n      );\n\n      // Center on pointer\n      const pointer = { x: window.innerWidth / 2, y: window.innerHeight / 2 };\n      const newTranslate = {\n        x: pointer.x - ((pointer.x - stage.x()) / stageScale) * newScale,\n        y: pointer.y - ((pointer.y - stage.y()) / stageScale) * newScale,\n      };\n\n      stage.position(newTranslate);\n      stageTranslateRef.current = newTranslate;\n\n      onStageScaleChange(newScale);\n    }\n\n    if (shortcuts.stagePrecisionZoom(event)) {\n      setZoomSpeed(0.25);\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.stagePrecisionZoom(event)) {\n      setZoomSpeed(1);\n    }\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n\n  function handleBlur() {\n    setZoomSpeed(1);\n  }\n\n  useBlur(handleBlur);\n}\n\nexport default useStageInteraction;\n","import Konva from \"konva\";\nimport { useEffect, useRef } from \"react\";\n\nimport { MapStage } from \"../contexts/MapStageContext\";\nimport Vector2 from \"../helpers/Vector2\";\n\ntype ImageData = {\n  id: string;\n  width: number;\n  height: number;\n};\n\nfunction useImageCenter(\n  data: ImageData | null,\n  stageRef: MapStage,\n  stageWidth: number,\n  stageHeight: number,\n  stageTranslateRef: React.MutableRefObject<Vector2>,\n  setStageScale: React.Dispatch<React.SetStateAction<number>>,\n  imageLayerRef: React.RefObject<Konva.Layer>,\n  containerRef: React.RefObject<HTMLDivElement>,\n  responsive = false\n) {\n  const stageRatio = stageWidth / stageHeight;\n  const imageRatio = data ? data.width / data.height : 1;\n\n  let imageWidth: number;\n  let imageHeight: number;\n  if (stageRatio > imageRatio) {\n    imageWidth = data ? stageHeight / (data.height / data.width) : stageWidth;\n    imageHeight = stageHeight;\n  } else {\n    imageWidth = stageWidth;\n    imageHeight = data ? stageWidth * (data.height / data.width) : stageHeight;\n  }\n\n  // Reset image translate and stage scale\n  const previousDataIdRef = useRef<string>();\n  const previousStageRatioRef = useRef(stageRatio);\n  useEffect(() => {\n    if (!data) {\n      return;\n    }\n\n    const layer = imageLayerRef.current;\n    const container = containerRef.current;\n    const stage = stageRef.current;\n    if (!container || !stage) {\n      return;\n    }\n    const containerRect = container.getBoundingClientRect();\n    const previousDataId = previousDataIdRef.current;\n    const previousStageRatio = previousStageRatioRef.current;\n\n    // Update when the id has changed and if responsive update when the stage changes\n    const shouldUpdate = responsive\n      ? previousDataId !== data.id || previousStageRatio !== stageRatio\n      : previousDataId !== data.id;\n\n    if (layer && shouldUpdate) {\n      let newTranslate;\n      if (stageRatio > imageRatio) {\n        newTranslate = {\n          x: -(imageWidth - containerRect.width) / 2,\n          y: 0,\n        };\n      } else {\n        newTranslate = {\n          x: 0,\n          y: -(imageHeight - containerRect.height) / 2,\n        };\n      }\n      layer.position(newTranslate);\n      stage.position({ x: 0, y: 0 });\n      stageTranslateRef.current = { x: 0, y: 0 };\n\n      setStageScale(1);\n    }\n    previousDataIdRef.current = data.id;\n    previousStageRatioRef.current = stageRatio;\n  });\n\n  return [imageWidth, imageHeight];\n}\n\nexport default useImageCenter;\n","import React, { useContext } from \"react\";\nimport { FullGestureState } from \"react-use-gesture/dist/types\";\nimport useDebounce from \"../hooks/useDebounce\";\nimport { TypedEmitter } from \"tiny-typed-emitter\";\nimport Konva from \"konva\";\n\nexport type MapDragEvent = Omit<FullGestureState<\"drag\">, \"event\"> & {\n  event: React.PointerEvent<Element> | PointerEvent;\n};\n\nexport type MapDragEventHandler = (props: MapDragEvent) => void;\n\nexport interface MapInteractionEvents {\n  dragStart: MapDragEventHandler;\n  drag: MapDragEventHandler;\n  dragEnd: MapDragEventHandler;\n}\n\nexport class MapInteractionEmitter extends TypedEmitter<MapInteractionEvents> {}\n\ntype MapInteraction = {\n  stageScale: number;\n  stageWidth: number;\n  stageHeight: number;\n  setPreventMapInteraction: React.Dispatch<React.SetStateAction<boolean>>;\n  mapWidth: number;\n  mapHeight: number;\n  interactionEmitter: MapInteractionEmitter | null;\n};\n\nexport const StageScaleContext = React.createContext<\n  MapInteraction[\"stageScale\"] | undefined\n>(undefined);\nexport const DebouncedStageScaleContext = React.createContext<\n  MapInteraction[\"stageScale\"] | undefined\n>(undefined);\nexport const StageWidthContext = React.createContext<\n  MapInteraction[\"stageWidth\"] | undefined\n>(undefined);\nexport const StageHeightContext = React.createContext<\n  MapInteraction[\"stageHeight\"] | undefined\n>(undefined);\nexport const SetPreventMapInteractionContext = React.createContext<\n  MapInteraction[\"setPreventMapInteraction\"] | undefined\n>(undefined);\nexport const MapWidthContext = React.createContext<\n  MapInteraction[\"mapWidth\"] | undefined\n>(undefined);\nexport const MapHeightContext = React.createContext<\n  MapInteraction[\"mapHeight\"] | undefined\n>(undefined);\nexport const InteractionEmitterContext = React.createContext<\n  MapInteraction[\"interactionEmitter\"] | undefined\n>(undefined);\n\nexport function MapInteractionProvider({\n  value,\n  children,\n}: {\n  value: MapInteraction;\n  children: React.ReactNode;\n}) {\n  const {\n    stageScale,\n    stageWidth,\n    stageHeight,\n    setPreventMapInteraction,\n    mapWidth,\n    mapHeight,\n    interactionEmitter,\n  } = value;\n  const debouncedStageScale = useDebounce(stageScale, 200);\n  return (\n    <InteractionEmitterContext.Provider value={interactionEmitter}>\n      <SetPreventMapInteractionContext.Provider\n        value={setPreventMapInteraction}\n      >\n        <StageWidthContext.Provider value={stageWidth}>\n          <StageHeightContext.Provider value={stageHeight}>\n            <MapWidthContext.Provider value={mapWidth}>\n              <MapHeightContext.Provider value={mapHeight}>\n                <StageScaleContext.Provider value={stageScale}>\n                  <DebouncedStageScaleContext.Provider\n                    value={debouncedStageScale || 1}\n                  >\n                    {children}\n                  </DebouncedStageScaleContext.Provider>\n                </StageScaleContext.Provider>\n              </MapHeightContext.Provider>\n            </MapWidthContext.Provider>\n          </StageHeightContext.Provider>\n        </StageWidthContext.Provider>\n      </SetPreventMapInteractionContext.Provider>\n    </InteractionEmitterContext.Provider>\n  );\n}\n\nexport function useInteractionEmitter() {\n  const context = useContext(InteractionEmitterContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useInteractionEmitter must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useSetPreventMapInteraction() {\n  const context = useContext(SetPreventMapInteractionContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useSetPreventMapInteraction must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useStageWidth() {\n  const context = useContext(StageWidthContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useStageWidth must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useStageHeight() {\n  const context = useContext(StageHeightContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useStageHeight must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useMapWidth() {\n  const context = useContext(MapWidthContext);\n  if (context === undefined) {\n    throw new Error(\"useMapWidth must be used within a MapInteractionProvider\");\n  }\n  return context;\n}\n\nexport function useMapHeight() {\n  const context = useContext(MapHeightContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useMapHeight must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useStageScale() {\n  const context = useContext(StageScaleContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useStageScale must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useDebouncedStageScale() {\n  const context = useContext(DebouncedStageScaleContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useDebouncedStageScale must be used within a MapInteractionProvider\"\n    );\n  }\n  return context;\n}\n\nexport function leftMouseButton(event: MapDragEvent): boolean;\nexport function leftMouseButton(\n  event: Konva.KonvaEventObject<PointerEvent>\n): boolean;\nexport function leftMouseButton(\n  event: Konva.KonvaEventObject<MouseEvent>\n): boolean;\n\nexport function leftMouseButton(event: any) {\n  if (event.evt) {\n    // Konva events\n    // Check for undefined (touch) and mouse left click (0)\n    return event.evt.button === undefined || event.evt.button === 0;\n  } else {\n    // Drag event\n    return event.buttons <= 1;\n  }\n}\n\nexport function middleMouseButton(event: MapDragEvent) {\n  return event.buttons === 4;\n}\n\nexport function rightMouseButton(event: MapDragEvent) {\n  return event.buttons === 2;\n}\n","import React, { useContext, useState, useEffect } from \"react\";\n\nimport Vector2 from \"../helpers/Vector2\";\nimport Size from \"../helpers/Size\";\nimport { getGridPixelSize, getCellPixelSize } from \"../helpers/grid\";\n\nimport { Grid } from \"../types/Grid\";\n\nimport useSetting from \"../hooks/useSetting\";\n\nimport shortcuts from \"../shortcuts\";\n\nimport { useBlur, useKeyboard } from \"./KeyboardContext\";\n\n/**\n * @typedef GridContextValue\n * @property {Grid} grid Base grid value\n * @property {Size} gridPixelSize Size of the grid in pixels\n * @property {Size} gridCellPixelSize Size of each cell in pixels\n * @property {Size} gridCellNormalizedSize Size of each cell normalized to the grid\n * @property {Vector2} gridOffset Offset of the grid from the top left in pixels\n * @property {number} gridStrokeWidth Stroke width of the grid in pixels\n * @property {Vector2} gridCellPixelOffset Offset of the grid cells to convert the center position of hex cells to the top left\n */\ntype GridContextValue = {\n  grid: Grid;\n  gridPixelSize: Size;\n  gridCellPixelSize: Size;\n  gridCellNormalizedSize: Size;\n  gridOffset: Vector2;\n  gridStrokeWidth: number;\n  gridCellPixelOffset: Vector2;\n  gridSnappingSensitivity: number;\n};\n\n/**\n * @type {GridContextValue}\n */\nconst defaultValue: GridContextValue = {\n  grid: {\n    size: new Vector2(0, 0),\n    inset: { topLeft: new Vector2(0, 0), bottomRight: new Vector2(1, 1) },\n    type: \"square\",\n    measurement: {\n      scale: \"\",\n      type: \"euclidean\",\n    },\n  },\n  gridPixelSize: new Size(0, 0),\n  gridCellPixelSize: new Size(0, 0, 0),\n  gridCellNormalizedSize: new Size(0, 0, 0),\n  gridOffset: new Vector2(0, 0),\n  gridStrokeWidth: 0,\n  gridCellPixelOffset: new Vector2(0, 0),\n  gridSnappingSensitivity: 0,\n};\n\nexport const GridContext = React.createContext(defaultValue.grid);\nexport const GridPixelSizeContext = React.createContext(\n  defaultValue.gridPixelSize\n);\nexport const GridCellPixelSizeContext = React.createContext(\n  defaultValue.gridCellPixelSize\n);\nexport const GridCellNormalizedSizeContext = React.createContext(\n  defaultValue.gridCellNormalizedSize\n);\nexport const GridOffsetContext = React.createContext(defaultValue.gridOffset);\nexport const GridStrokeWidthContext = React.createContext(\n  defaultValue.gridStrokeWidth\n);\nexport const GridCellPixelOffsetContext = React.createContext(\n  defaultValue.gridCellPixelOffset\n);\nexport const GridSnappingSensitivityContext = React.createContext(\n  defaultValue.gridSnappingSensitivity\n);\n\nconst defaultStrokeWidth = 1 / 10;\n\ntype GridProviderProps = {\n  grid: Grid | null;\n  width: number;\n  height: number;\n  children: React.ReactNode;\n};\n\nexport function GridProvider({\n  grid: inputGrid,\n  width,\n  height,\n  children,\n}: GridProviderProps) {\n  let grid: Grid;\n\n  if (!inputGrid || !inputGrid.size.x || !inputGrid.size.y) {\n    grid = defaultValue.grid;\n  } else {\n    grid = inputGrid;\n  }\n\n  const [gridPixelSize, setGridPixelSize] = useState(\n    defaultValue.gridCellPixelSize\n  );\n  const [gridCellPixelSize, setGridCellPixelSize] = useState(\n    defaultValue.gridCellPixelSize\n  );\n  const [gridCellNormalizedSize, setGridCellNormalizedSize] = useState(\n    defaultValue.gridCellNormalizedSize\n  );\n  const [gridOffset, setGridOffset] = useState(defaultValue.gridOffset);\n  const [gridStrokeWidth, setGridStrokeWidth] = useState(\n    defaultValue.gridStrokeWidth\n  );\n  const [gridCellPixelOffset, setGridCellPixelOffset] = useState(\n    defaultValue.gridCellPixelOffset\n  );\n\n  useEffect(() => {\n    const _gridPixelSize = getGridPixelSize(grid, width, height);\n    const _gridCellPixelSize = getCellPixelSize(\n      grid,\n      _gridPixelSize.width,\n      _gridPixelSize.height\n    );\n    const _gridCellNormalizedSize = new Size(\n      _gridCellPixelSize.width / width,\n      _gridCellPixelSize.height / height\n    );\n    const _gridOffset = Vector2.multiply(grid.inset.topLeft, {\n      x: width,\n      y: height,\n    });\n    const _gridStrokeWidth =\n      (_gridCellPixelSize.width < _gridCellPixelSize.height\n        ? _gridCellPixelSize.width\n        : _gridCellPixelSize.height) * defaultStrokeWidth;\n\n    let _gridCellPixelOffset = { x: 0, y: 0 };\n    // Move hex tiles to top left\n    if (grid.type === \"hexVertical\" || grid.type === \"hexHorizontal\") {\n      _gridCellPixelOffset = Vector2.multiply(_gridCellPixelSize, 0.5);\n    }\n\n    setGridPixelSize(_gridPixelSize);\n    setGridCellPixelSize(_gridCellPixelSize);\n    setGridCellNormalizedSize(_gridCellNormalizedSize);\n    setGridOffset(_gridOffset);\n    setGridStrokeWidth(_gridStrokeWidth);\n    setGridCellPixelOffset(_gridCellPixelOffset);\n  }, [grid, width, height]);\n\n  const [gridSnappingSensitivity, setGridSnappingSensitivity] = useState(\n    defaultValue.gridSnappingSensitivity\n  );\n  const [defaultSnappingSensitivity] = useSetting<number>(\n    \"map.gridSnappingSensitivity\"\n  );\n  useEffect(() => {\n    if (\n      gridSnappingSensitivity !== defaultSnappingSensitivity &&\n      gridSnappingSensitivity !== -1 // Snapping not disabled\n    ) {\n      setGridSnappingSensitivity(defaultSnappingSensitivity);\n    }\n  }, [defaultSnappingSensitivity, gridSnappingSensitivity]);\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.disableSnapping(event)) {\n      setGridSnappingSensitivity(-1);\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.disableSnapping(event)) {\n      setGridSnappingSensitivity(defaultSnappingSensitivity);\n    }\n  }\n\n  function handleBlur() {\n    setGridSnappingSensitivity(defaultSnappingSensitivity);\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n  useBlur(handleBlur);\n\n  return (\n    <GridContext.Provider value={grid}>\n      <GridPixelSizeContext.Provider value={gridPixelSize}>\n        <GridCellPixelSizeContext.Provider value={gridCellPixelSize}>\n          <GridCellNormalizedSizeContext.Provider\n            value={gridCellNormalizedSize}\n          >\n            <GridOffsetContext.Provider value={gridOffset}>\n              <GridStrokeWidthContext.Provider value={gridStrokeWidth}>\n                <GridCellPixelOffsetContext.Provider\n                  value={gridCellPixelOffset}\n                >\n                  <GridSnappingSensitivityContext.Provider\n                    value={gridSnappingSensitivity}\n                  >\n                    {children}\n                  </GridSnappingSensitivityContext.Provider>\n                </GridCellPixelOffsetContext.Provider>\n              </GridStrokeWidthContext.Provider>\n            </GridOffsetContext.Provider>\n          </GridCellNormalizedSizeContext.Provider>\n        </GridCellPixelSizeContext.Provider>\n      </GridPixelSizeContext.Provider>\n    </GridContext.Provider>\n  );\n}\n\nexport function useGrid() {\n  const context = useContext(GridContext);\n  if (context === undefined) {\n    throw new Error(\"useGrid must be used within a GridProvider\");\n  }\n  return context;\n}\n\nexport function useGridPixelSize() {\n  const context = useContext(GridPixelSizeContext);\n  if (context === undefined) {\n    throw new Error(\"useGridPixelSize must be used within a GridProvider\");\n  }\n  return context;\n}\n\nexport function useGridCellPixelSize() {\n  const context = useContext(GridCellPixelSizeContext);\n  if (context === undefined) {\n    throw new Error(\"useGridCellPixelSize must be used within a GridProvider\");\n  }\n  return context;\n}\n\nexport function useGridCellNormalizedSize() {\n  const context = useContext(GridCellNormalizedSizeContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useGridCellNormalizedSize must be used within a GridProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useGridOffset() {\n  const context = useContext(GridOffsetContext);\n  if (context === undefined) {\n    throw new Error(\"useGridOffset must be used within a GridProvider\");\n  }\n  return context;\n}\n\nexport function useGridStrokeWidth() {\n  const context = useContext(GridStrokeWidthContext);\n  if (context === undefined) {\n    throw new Error(\"useGridStrokeWidth must be used within a GridProvider\");\n  }\n  return context;\n}\n\nexport function useGridCellPixelOffset() {\n  const context = useContext(GridCellPixelOffsetContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useGridCellPixelOffset must be used within a GridProvider\"\n    );\n  }\n  return context;\n}\n\nexport function useGridSnappingSensitivity() {\n  const context = useContext(GridSnappingSensitivityContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useGridSnappingSensitivity must be used within a GridProvider\"\n    );\n  }\n  return context;\n}\n","import React, { useContext } from \"react\";\n\nimport {\n  InteractionEmitterContext,\n  SetPreventMapInteractionContext,\n  StageWidthContext,\n  StageHeightContext,\n  MapWidthContext,\n  MapHeightContext,\n  StageScaleContext,\n  DebouncedStageScaleContext,\n  useInteractionEmitter,\n  useSetPreventMapInteraction,\n  useStageWidth,\n  useStageHeight,\n  useMapWidth,\n  useMapHeight,\n  useStageScale,\n  useDebouncedStageScale,\n} from \"../contexts/MapInteractionContext\";\nimport { MapStageProvider, useMapStage } from \"../contexts/MapStageContext\";\nimport UserIdContext, { useUserId } from \"../contexts/UserIdContext\";\nimport SettingsContext, { useSettings } from \"../contexts/SettingsContext\";\nimport KeyboardContext from \"../contexts/KeyboardContext\";\nimport AssetsContext, {\n  AssetURLsStateContext,\n  AssetURLsUpdaterContext,\n  useAssets,\n} from \"../contexts/AssetsContext\";\nimport {\n  useGrid,\n  useGridCellPixelSize,\n  useGridCellNormalizedSize,\n  useGridStrokeWidth,\n  useGridCellPixelOffset,\n  useGridOffset,\n  useGridPixelSize,\n  useGridSnappingSensitivity,\n  GridContext,\n  GridPixelSizeContext,\n  GridCellPixelSizeContext,\n  GridCellNormalizedSizeContext,\n  GridOffsetContext,\n  GridStrokeWidthContext,\n  GridCellPixelOffsetContext,\n  GridSnappingSensitivityContext,\n} from \"../contexts/GridContext\";\nimport DatabaseContext, { useDatabase } from \"../contexts/DatabaseContext\";\n\ntype StageRender = (wrapped: React.ReactNode) => React.ReactElement;\n\ntype KonvaBridgeProps = {\n  stageRender: StageRender;\n  children: React.ReactNode;\n};\n\n/**\n * Provide a bridge for konva that forwards our contexts\n */\nfunction KonvaBridge({\n  stageRender,\n  children,\n}: KonvaBridgeProps): React.ReactElement {\n  const mapStageRef = useMapStage();\n  const userId = useUserId();\n  const settings = useSettings();\n  const assets = useAssets();\n  const assetURLs = useContext(AssetURLsStateContext);\n  const setAssetURLs = useContext(AssetURLsUpdaterContext);\n  const keyboardValue = useContext(KeyboardContext);\n\n  const stageScale = useStageScale();\n  const stageWidth = useStageWidth();\n  const stageHeight = useStageHeight();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const interactionEmitter = useInteractionEmitter();\n  const debouncedStageScale = useDebouncedStageScale();\n\n  const grid = useGrid();\n  const gridPixelSize = useGridPixelSize();\n  const gridCellNormalizedSize = useGridCellNormalizedSize();\n  const gridCellPixelSize = useGridCellPixelSize();\n  const gridStrokeWidth = useGridStrokeWidth();\n  const gridCellPixelOffset = useGridCellPixelOffset();\n  const gridOffset = useGridOffset();\n  const gridSnappingSensitivity = useGridSnappingSensitivity();\n\n  const database = useDatabase();\n\n  return stageRender(\n    <DatabaseContext.Provider value={database}>\n      <UserIdContext.Provider value={userId}>\n        <SettingsContext.Provider value={settings}>\n          <KeyboardContext.Provider value={keyboardValue}>\n            <MapStageProvider value={mapStageRef}>\n              <AssetsContext.Provider value={assets}>\n                <AssetURLsStateContext.Provider value={assetURLs}>\n                  <AssetURLsUpdaterContext.Provider value={setAssetURLs}>\n                    <InteractionEmitterContext.Provider\n                      value={interactionEmitter}\n                    >\n                      <SetPreventMapInteractionContext.Provider\n                        value={setPreventMapInteraction}\n                      >\n                        <StageWidthContext.Provider value={stageWidth}>\n                          <StageHeightContext.Provider value={stageHeight}>\n                            <MapWidthContext.Provider value={mapWidth}>\n                              <MapHeightContext.Provider value={mapHeight}>\n                                <StageScaleContext.Provider value={stageScale}>\n                                  <DebouncedStageScaleContext.Provider\n                                    value={debouncedStageScale}\n                                  >\n                                    <GridContext.Provider value={grid}>\n                                      <GridPixelSizeContext.Provider\n                                        value={gridPixelSize}\n                                      >\n                                        <GridCellPixelSizeContext.Provider\n                                          value={gridCellPixelSize}\n                                        >\n                                          <GridCellNormalizedSizeContext.Provider\n                                            value={gridCellNormalizedSize}\n                                          >\n                                            <GridOffsetContext.Provider\n                                              value={gridOffset}\n                                            >\n                                              <GridStrokeWidthContext.Provider\n                                                value={gridStrokeWidth}\n                                              >\n                                                <GridCellPixelOffsetContext.Provider\n                                                  value={gridCellPixelOffset}\n                                                >\n                                                  <GridSnappingSensitivityContext.Provider\n                                                    value={\n                                                      gridSnappingSensitivity\n                                                    }\n                                                  >\n                                                    {children}\n                                                  </GridSnappingSensitivityContext.Provider>\n                                                </GridCellPixelOffsetContext.Provider>\n                                              </GridStrokeWidthContext.Provider>\n                                            </GridOffsetContext.Provider>\n                                          </GridCellNormalizedSizeContext.Provider>\n                                        </GridCellPixelSizeContext.Provider>\n                                      </GridPixelSizeContext.Provider>\n                                    </GridContext.Provider>\n                                  </DebouncedStageScaleContext.Provider>\n                                </StageScaleContext.Provider>\n                              </MapHeightContext.Provider>\n                            </MapWidthContext.Provider>\n                          </StageHeightContext.Provider>\n                        </StageWidthContext.Provider>\n                      </SetPreventMapInteractionContext.Provider>\n                    </InteractionEmitterContext.Provider>\n                  </AssetURLsUpdaterContext.Provider>\n                </AssetURLsStateContext.Provider>\n              </AssetsContext.Provider>\n            </MapStageProvider>\n          </KeyboardContext.Provider>\n        </SettingsContext.Provider>\n      </UserIdContext.Provider>\n    </DatabaseContext.Provider>\n  );\n}\n\nexport default KonvaBridge;\n","function ResetMapIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M17.65 6.35c-1.63-1.63-3.94-2.57-6.48-2.31-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20c3.19 0 5.93-1.87 7.21-4.56.32-.67-.16-1.44-.9-1.44-.37 0-.72.2-.88.53-1.13 2.43-3.84 3.97-6.8 3.31-2.22-.49-4.01-2.3-4.48-4.52C5.31 9.44 8.26 6 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71l-.64.65z\" />\n    </svg>\n  );\n}\n\nexport default ResetMapIcon;\n","function GridOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H5c-.55 0-1-.45-1-1v-3h4v4zm0-6H4v-4h4v4zm0-6H4V5c0-.55.45-1 1-1h3v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm5 12h-3v-4h4v3c0 .55-.45 1-1 1zm1-6h-4v-4h4v4zm0-6h-4V4h3c.55 0 1 .45 1 1v3z\" />\n    </svg>\n  );\n}\n\nexport default GridOnIcon;\n","function GridOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M8 4v.89l2 2V4h4v4h-2.89l2 2H14v.89l2 2V10h4v4h-2.89l2 2H20v.89l2 2V4c0-1.1-.9-2-2-2H5.11l2 2H8zm8 0h3c.55 0 1 .45 1 1v3h-4V4zm6.16 17.88L2.12 1.84c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L2 4.55V20c0 1.1.9 2 2 2h15.45l1.3 1.3c.39.39 1.02.39 1.41 0 .39-.39.39-1.03 0-1.42zM10 12.55L11.45 14H10v-1.45zm-6-6L5.45 8H4V6.55zM8 20H5c-.55 0-1-.45-1-1v-3h4v4zm0-6H4v-4h3.45l.55.55V14zm6 6h-4v-4h3.45l.55.55V20zm2 0v-1.45L17.45 20H16z\" />\n    </svg>\n  );\n}\n\nexport default GridOffIcon;\n","import { Group, Rect } from \"react-konva\";\nimport useImage from \"use-image\";\n\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport {\n  useGrid,\n  useGridPixelSize,\n  useGridOffset,\n  useGridCellPixelSize,\n} from \"../../contexts/GridContext\";\n\nimport squarePatternDark from \"../../images/SquarePatternDark.png\";\nimport squarePatternLight from \"../../images/SquarePatternLight.png\";\nimport hexPatternDark from \"../../images/HexPatternDark.png\";\nimport hexPatternLight from \"../../images/HexPatternLight.png\";\n\nfunction Grid({ stroke }: { stroke: \"black\" | \"white\" }) {\n  const grid = useGrid();\n  const gridPixelSize = useGridPixelSize();\n  const gridOffset = useGridOffset();\n  const gridCellPixelSize = useGridCellPixelSize();\n\n  let imageSource;\n  if (grid.type === \"square\") {\n    if (stroke === \"black\") {\n      imageSource = squarePatternDark;\n    } else {\n      imageSource = squarePatternLight;\n    }\n  } else {\n    if (stroke === \"black\") {\n      imageSource = hexPatternDark;\n    } else {\n      imageSource = hexPatternLight;\n    }\n  }\n\n  const [patternImage] = useImage(imageSource);\n\n  if (!grid?.size.x || !grid?.size.y) {\n    return null;\n  }\n\n  const negativeGridOffset = Vector2.multiply(gridOffset, -1);\n\n  let patternProps: Record<any, any> = {};\n  if (grid.type === \"square\") {\n    // Square grid pattern is 150 DPI\n    const scale = gridCellPixelSize.width / 300;\n    if (scale > 0) {\n      patternProps.fillPatternScaleX = scale;\n      patternProps.fillPatternScaleY = scale;\n      patternProps.fillPatternOffsetX = gridCellPixelSize.width / scale / 2;\n      patternProps.fillPatternOffsetY = gridCellPixelSize.height / scale / 2;\n    }\n  } else if (grid.type === \"hexVertical\") {\n    // Hex tile pattern is 153 DPI to better fit hex tiles\n    const scale = gridCellPixelSize.width / 153;\n    if (scale > 0) {\n      patternProps.fillPatternScaleX = scale;\n      patternProps.fillPatternScaleY = scale;\n      patternProps.fillPatternOffsetY = gridCellPixelSize.radius / scale / 2;\n    }\n  } else if (grid.type === \"hexHorizontal\") {\n    const scale = gridCellPixelSize.height / 153;\n    if (scale > 0) {\n      patternProps.fillPatternScaleX = scale;\n      patternProps.fillPatternScaleY = scale;\n      patternProps.fillPatternOffsetY = -gridCellPixelSize.radius / scale / 2;\n      patternProps.fillPatternRotation = 90;\n    }\n  }\n\n  return (\n    <Group>\n      <Rect\n        width={gridPixelSize.width}\n        height={gridPixelSize.height}\n        offset={negativeGridOffset}\n        fillPatternImage={patternImage}\n        fillPatternRepeat=\"repeat\"\n        opacity={stroke === \"black\" ? 0.8 : 0.4}\n        {...patternProps}\n      />\n    </Group>\n  );\n}\n\nGrid.defaultProps = {\n  strokeWidth: 0.1,\n  stroke: \"white\",\n};\n\nexport default Grid;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAAY1BMVEVHcEwAAAAAAAAAAAAAAAAwMDAzMzMAAAAAAAAvLy8AAAAAAAAvLy8AAAAAAAAAAAAvLy8AAAAAAAAuLi4AAAAAAAAtLS0wMDAtLS0tLS0sLCwpKSkuLi4yMjIxMTEvLy8wMDAb2rkAAAAAHXRSTlMAAQMHDor/CA+LBBCMBgoSjQsXkBMek4iMjY+Ty9Nxt1kAAAIHSURBVHgB7dg1esNAFIDBNTOzhfe/ZGCrcKLuOd/8lerRcgpWrz8YjsavjYaDfi/pR6zJdJaxZtMJrF+w5pPFMmMtF5M5LFiwYMGC9cDBggULFizBggULFixYggULFixYsAQLFixYsGAJFixYsGDBEixYsGDBgiVYsGDBggVLsGDBggULlmDBggULFizBggULFixYggULFixYsAQLFixYsGAJFixYsGDBEixYsGDBgiVYsGDBggVLsGDBggULlmDBggULFizBggULFixYggULFixYsAQLFixYsGAJFixYsGDBEixYsGDBgiVYsGD1gvUeK1apH6zVerPNWNvNetWPVVoNJqHaTfeHjHXYT3eTWKXdcLqI1HF/Omes82l/XMQqXUaz2TJO19u9KDNWWdxv12Wo0jhWVVU3bf5qm7qqxqGCBQsWrEfCsht2yDmrQ07wHXI37JBXhw55z/L4B0uwYMGCBQuWYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYP3TYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYMESLFiwYMGCJViwYMGCBUuwYMGCBQuWYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYMESLFiwYMGCJViwYMGCBUuwYMGCBQuWYMGCBQsWLMGCBesZNkX1AafTbREAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAAclBMVEVHcEz////////////////y8vLx8fH////////////y8vL////y8vL////////////////////////////////////z8/P////////z8/P////////z8/P09PT09PT09PT09PT09PT09PT19fXz8/Py8vKNxtxmAAAAJXRSTlMAAQULFZD/AgwXkhiTDQMGDhkECREclQojmBQtnYyPkZKUl5zQ8NmpTQAAAhtJREFUeAHs2EWS5DAUQEEVMzOTff8jznQXrop2vyPymfZpkpSCVSiWypXqb5VyqVhIelGtWG80z1jNRr1YA/IGq9U+Y7Vbb7Fgde5YnXBYsGDBEixYsGDBgiVYsGDBggVLsGDBggULlmDBggULFizBggULFixYggULFixYsAQLFixYsGAJFixYsGDBEixYsGDBgiVYsGDBggVLsGDBggULlmDBggULFizBggULFixYggULFixYsAQLFixYsGAJFixYsGDBEixYsGDBgiVYsGDBggVLsGDBggULlmDBggULFizBggULFixYggULFixYsAQLFqzCT7U4dXv9wRVr0O91a6FKw2ExUr3ReDI9Y00n41GvGKo0mtXrnTj1x4P54oy1mA/G/U6o0njZaAVqMJmv1mes9Wo+GbRClTbb3T5Sh+MpO2Nlp+NhH6tUDVeePy6x+lNYsGDBguVv+HnGWV9kBP9F5oZfZNXhi6xnWfyDJViwYMGCBUuwYMGCBQuWYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYMESLFiwYMGCJViwYMGCBUuwYMGCBQuWYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYMESLFiwYMGCJViwYMGCBUuwYMGCBQuWYMGCBQsWLMGCBQsWLFiCBQsWLFiwBAsWLFiwYAkWLFiwYMESrPR/wzOwAOSnRca66R6qAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATIAAAEJCAMAAAAgpVuZAAAC+lBMVEVHcEz////////////////z8/Px8fHz8/P////////////////////////////////z8/Px8fH////////29vb////////////////////////////29vb////////09PTz8/P////////39/f09PTx8fHx8fH19fX////////09PTy8vLz8/P39/f////////////x8fHx8fH19fX09PTz8/P09PT19fX39/fz8/Pz8/P4+Pj19fXy8vL09PT39/fz8/Pz8/Px8fHy8vL29vb////9/f3////4+Pjy8vLw8PDz8/P////x8fH29vb+/v78/Pz29vbz8/Py8vL09PT39/fy8vL19fX////////////////29vbx8fH29vb39/fy8vLy8vL////////7+/v09PTz8/P4+Pj09PT09PT6+vr////////////////////////////////z8/Py8vLy8vL29vbx8fHy8vL////////////////////5+fny8vLx8fH09PTz8/P////////////////////z8/P09PT////19fX////////////////09PT39/fy8vL19fX////////4+Pj7+/v////////9/f3z8/P////39/fx8fH29vbz8/Pz8/P6+vr09PT29vbz8/P////z8/Py8vL4+Pjz8/P09PT29vb09PT8/Pz09PTz8/P19fX5+fny8vL5+fn09PTz8/Py8vL39/f6+vr19fX39/fy8vL4+Pj19fX19fX09PT4+Pj09PTz8/P7+/vy8vLy8vLz8/P7+/vy8vL39/fy8vL09PTz8/Pz8/P4+Pj09PTz8/P6+vr39/fz8/P6+vrz8/P19fXz8/P29vby8vL19fX09PT39/f6+vr29vb09PTz8/P09PT19fXx8fH4+Pjx8fH39/fz8/P39/f09PT19fX29vb09PT19fXy8vL29vbz8/P29vb09PT39/fy8vL19fX4+Pj////09PT29vb39/fy8vL6+vrdq/snAAAA/nRSTlMAAw0ZKvP/hiASBwECChUl1eUXGoYTFiYEDhwtiQkM1eYpCzez/vuNBhHD/7s8EAUI+OtTlpJc7Y7Oyypk77CU8GjE+KRRTUpn5P6iFNfNVUmr+81E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noqBfGOmBybQQslcCy3lWuhBQhotgtjubGDXRp+nUkLxyCCN91C/UiU0okMLscUVz6Vc8cx3csUjAQuZHiqghc5uYjvoTce8Iwd4aKm04jFJC13/IENa797sJG89qtG/l1c8UgWHPaKReqhbSAuNZF9jM4anHT5Iime+hOIxsYea1g5oS5uieg1Lta8xSfHIa6FW0kJFXAud9rUldqwVyNlEEGuWUDzyWqilQwuNO7sKmLzOksn/xqF27TjjB3CJJa+F/iLgYzApnn7SisdULfQNaaHXAWiP79AVj2x3JI+0WK6FHqFiCLm36YrHLq145JEWF9BCwJZNDnnFI7uMn9Y94zZasXxPkYcUj0VC8ZjdQzlu/yUbWcXVTknFY34PNbV6TglGFzgWSike87VQYrnv1+9QWuBZKKd4zO+hEpor8llk1SmR0VIFj/k9VHN5IYusekpkQldDTPApMM0/11GCRZWzos0uLCQW76FiE52PIccVk5Amp3jMf9DsjWU98UWPiHC6k91qY01TTkPflOQkuUfM/L31D2+t64l+zXm9utmfg58S5Z/bBzkr/OmndK+dhZ0SHteDRRZp6WaRhfWOSojpg76JsVG9w7pbZBEsslO7Y2TRFFmMiky0VGQqMhWZikxFpiJTkanIVGQqMhWZikxFpiJTkanIVGQqMhWZikxFpiJTkanIVGQqMhWZikxFpiJTkanIVGQqMhWZikxFpiJTkanIVGQqsv8FE0HNxadZOb8AAAAASUVORK5CYII=\"","import { useEffect, useState } from \"react\";\nimport useImage from \"use-image\";\n\nimport { useDataURL } from \"../../contexts/AssetsContext\";\n\nimport { mapSources as defaultMapSources } from \"../../maps\";\n\nimport { getImageLightness } from \"../../helpers/image\";\n\nimport Grid from \"../konva/Grid\";\nimport { Map } from \"../../types/Map\";\n\nfunction MapGrid({ map }: { map: Map }) {\n  let mapSourceMap = map;\n  const mapURL = useDataURL(\n    mapSourceMap,\n    defaultMapSources,\n    undefined,\n    map.type === \"file\"\n  );\n\n  const [mapImage, mapLoadingStatus] = useImage(mapURL || \"\");\n\n  const [isImageLight, setIsImageLight] = useState(true);\n\n  // When the map changes find the average lightness of its pixels\n  useEffect(() => {\n    if (mapLoadingStatus === \"loaded\" && mapImage) {\n      setIsImageLight(getImageLightness(mapImage));\n    }\n  }, [mapImage, mapLoadingStatus]);\n\n  return <Grid stroke={isImageLight ? \"black\" : \"white\"} />;\n}\n\nexport default MapGrid;\n","import { useRef } from \"react\";\nimport { Group, Circle, Rect } from \"react-konva\";\nimport Konva from \"konva\";\n\nimport {\n  useDebouncedStageScale,\n  useMapWidth,\n  useMapHeight,\n  useSetPreventMapInteraction,\n} from \"../../contexts/MapInteractionContext\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport shortcuts from \"../../shortcuts\";\nimport { Map } from \"../../types/Map\";\nimport { GridInset } from \"../../types/Grid\";\n\ntype MapGridEditorProps = {\n  map: Map;\n  onGridChange: (inset: GridInset) => void;\n};\n\nfunction MapGridEditor({ map, onGridChange }: MapGridEditorProps) {\n  const stageScale = useDebouncedStageScale();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n\n  const mapSize = { x: mapWidth, y: mapHeight };\n\n  function getHandlePositions() {\n    const topLeft = Vector2.multiply(map.grid.inset.topLeft, mapSize);\n    const bottomRight = Vector2.multiply(map.grid.inset.bottomRight, mapSize);\n\n    const size = Vector2.subtract(bottomRight, topLeft);\n    const offset = Vector2.multiply(topLeft, -1);\n\n    return {\n      topLeft,\n      topRight: { x: bottomRight.x, y: topLeft.y },\n      bottomRight,\n      bottomLeft: { x: topLeft.x, y: bottomRight.y },\n      size,\n      offset,\n    };\n  }\n  const handlePositions = getHandlePositions();\n\n  const handlePreviousPositionRef = useRef<Vector2>();\n\n  function handleScaleCircleDragStart(\n    event: Konva.KonvaEventObject<MouseEvent>\n  ) {\n    const handle = event.target;\n    const position = getHandleNormalizedPosition(handle);\n    handlePreviousPositionRef.current = position;\n  }\n\n  function handleScaleCircleDragMove(\n    event: Konva.KonvaEventObject<MouseEvent>\n  ) {\n    const handle = event.target;\n    onGridChange(getHandleInset(handle));\n    handlePreviousPositionRef.current = getHandleNormalizedPosition(handle);\n  }\n\n  function handleScaleCircleDragEnd(event: Konva.KonvaEventObject<MouseEvent>) {\n    onGridChange(getHandleInset(event.target));\n    setPreventMapInteraction(false);\n  }\n\n  function handleInteractivePointerDown() {\n    setPreventMapInteraction(true);\n  }\n\n  function handleInteractivePointerUp() {\n    setPreventMapInteraction(false);\n  }\n\n  function getHandleInset(handle: Konva.Node): GridInset {\n    const name = handle.name();\n\n    // Find distance and direction of dragging\n    const previousPosition = handlePreviousPositionRef.current;\n    if (!previousPosition) {\n      return map.grid.inset;\n    }\n    const position = getHandleNormalizedPosition(handle);\n    const distance = Vector2.distance(previousPosition, position);\n    const direction = Vector2.normalize(\n      Vector2.subtract(position, previousPosition)\n    );\n\n    const inset = {\n      topLeft: { ...map.grid.inset.topLeft },\n      bottomRight: { ...map.grid.inset.bottomRight },\n    };\n\n    if (direction.x === 0 && direction.y === 0) {\n      return inset;\n    }\n\n    // Scale the grid direction by the distance dragged and the\n    // dot product between the drag direction and the grid direction\n    // This drags the handle while keeping the aspect ratio\n    if (name === \"topLeft\") {\n      // Top left to bottom right\n      const gridDirection = Vector2.normalize(\n        Vector2.subtract(inset.topLeft, inset.bottomRight)\n      );\n      const dot = Vector2.dot(direction, gridDirection);\n      const offset = Vector2.multiply(gridDirection, distance * dot);\n      const newPosition = Vector2.add(previousPosition, offset);\n      return {\n        topLeft: newPosition,\n        bottomRight: inset.bottomRight,\n      };\n    } else if (name === \"topRight\") {\n      // Top right to bottom left\n      const gridDirection = Vector2.normalize(\n        Vector2.subtract(\n          { x: inset.bottomRight.x, y: inset.topLeft.y },\n          { x: inset.topLeft.x, y: inset.bottomRight.y }\n        )\n      );\n      const dot = Vector2.dot(direction, gridDirection);\n      const offset = Vector2.multiply(gridDirection, distance * dot);\n      const newPosition = Vector2.add(previousPosition, offset);\n      return {\n        topLeft: { x: inset.topLeft.x, y: newPosition.y },\n        bottomRight: { x: newPosition.x, y: inset.bottomRight.y },\n      };\n    } else if (name === \"bottomRight\") {\n      // Bottom right to top left\n      const gridDirection = Vector2.normalize(\n        Vector2.subtract(inset.bottomRight, inset.topLeft)\n      );\n      const dot = Vector2.dot(direction, gridDirection);\n      const offset = Vector2.multiply(gridDirection, distance * dot);\n      const newPosition = Vector2.add(previousPosition, offset);\n      return {\n        topLeft: inset.topLeft,\n        bottomRight: newPosition,\n      };\n    } else if (name === \"bottomLeft\") {\n      // Bottom left to top right\n      const gridDirection = Vector2.normalize(\n        Vector2.subtract(\n          { x: inset.topLeft.x, y: inset.bottomRight.y },\n          { x: inset.bottomRight.x, y: inset.topLeft.y }\n        )\n      );\n      const dot = Vector2.dot(direction, gridDirection);\n      const offset = Vector2.multiply(gridDirection, distance * dot);\n      const newPosition = Vector2.add(previousPosition, offset);\n      return {\n        topLeft: { x: newPosition.x, y: inset.topLeft.y },\n        bottomRight: { x: inset.bottomRight.x, y: newPosition.y },\n      };\n    } else if (name === \"center\") {\n      const offset = Vector2.subtract(position, previousPosition);\n      return {\n        topLeft: Vector2.add(inset.topLeft, offset),\n        bottomRight: Vector2.add(inset.bottomRight, offset),\n      };\n    } else {\n      return inset;\n    }\n  }\n\n  function nudgeGrid(direction: Vector2, scale: number) {\n    const inset = map.grid.inset;\n    const gridSizeNormalized = Vector2.divide(\n      Vector2.subtract(inset.bottomRight, inset.topLeft),\n      map.grid.size\n    );\n    const offset = Vector2.multiply(\n      Vector2.multiply(direction, gridSizeNormalized),\n      Math.min(scale / (stageScale * stageScale), 1)\n    );\n    onGridChange({\n      topLeft: Vector2.add(inset.topLeft, offset),\n      bottomRight: Vector2.add(inset.bottomRight, offset),\n    });\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const nudgeAmount = event.shiftKey ? 2 : 0.5;\n    if (shortcuts.gridNudgeUp(event)) {\n      // Stop arrow up/down scrolling if overflowing\n      event.preventDefault();\n      nudgeGrid({ x: 0, y: -1 }, nudgeAmount);\n    }\n    if (shortcuts.gridNudgeLeft(event)) {\n      nudgeGrid({ x: -1, y: 0 }, nudgeAmount);\n    }\n    if (shortcuts.gridNudgeRight(event)) {\n      nudgeGrid({ x: 1, y: 0 }, nudgeAmount);\n    }\n    if (shortcuts.gridNudgeDown(event)) {\n      event.preventDefault();\n      nudgeGrid({ x: 0, y: 1 }, nudgeAmount);\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  function getHandleNormalizedPosition(handle: Konva.Node) {\n    return Vector2.divide({ x: handle.x(), y: handle.y() }, mapSize);\n  }\n\n  const editCircleRadius = Math.max(\n    (Math.min(mapWidth, mapHeight) / 30) * Math.max(1 / stageScale, 1),\n    1\n  );\n\n  const editCircleProps = {\n    radius: editCircleRadius,\n    fill: \"rgba(0, 0, 0, 0.5)\",\n    stroke: \"white\",\n    strokeWidth: editCircleRadius / 5,\n    draggable: true,\n    onDragStart: handleScaleCircleDragStart,\n    onDragMove: handleScaleCircleDragMove,\n    onDragEnd: handleScaleCircleDragEnd,\n    onMouseDown: handleInteractivePointerDown,\n    onMouseUp: handleInteractivePointerUp,\n    onTouchStart: handleInteractivePointerDown,\n    onTouchEnd: handleInteractivePointerUp,\n  };\n\n  const editRectProps = {\n    fill: \"transparent\",\n    stroke: \"rgba(255, 255, 255, 0.75)\",\n    strokeWidth: editCircleRadius / 10,\n  };\n\n  return (\n    <Group>\n      <Rect\n        width={handlePositions.size.x}\n        height={handlePositions.size.y}\n        offset={handlePositions.offset}\n        {...editRectProps}\n      />\n      <Circle\n        x={handlePositions.topLeft.x}\n        y={handlePositions.topLeft.y}\n        name=\"topLeft\"\n        {...editCircleProps}\n      />\n      <Circle\n        x={handlePositions.topRight.x}\n        y={handlePositions.topRight.y}\n        name=\"topRight\"\n        {...editCircleProps}\n      />\n      <Circle\n        x={handlePositions.bottomRight.x}\n        y={handlePositions.bottomRight.y}\n        name=\"bottomRight\"\n        {...editCircleProps}\n      />\n      <Circle\n        x={handlePositions.bottomLeft.x}\n        y={handlePositions.bottomLeft.y}\n        name=\"bottomLeft\"\n        {...editCircleProps}\n      />\n      <Circle\n        x={(handlePositions.topLeft.x + handlePositions.bottomRight.x) / 2}\n        y={(handlePositions.topLeft.y + handlePositions.bottomRight.y) / 2}\n        name=\"center\"\n        {...editCircleProps}\n        radius={editCircleRadius / 1.5}\n      />\n    </Group>\n  );\n}\n\nexport default MapGridEditor;\n","import React, { useState, useRef } from \"react\";\nimport { Box, IconButton } from \"theme-ui\";\nimport { Stage, Layer, Image } from \"react-konva\";\nimport Konva from \"konva\";\nimport ReactResizeDetector from \"react-resize-detector\";\n\nimport useMapImage from \"../../hooks/useMapImage\";\nimport usePreventOverscroll from \"../../hooks/usePreventOverscroll\";\nimport useStageInteraction from \"../../hooks/useStageInteraction\";\nimport useImageCenter from \"../../hooks/useImageCenter\";\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\n\nimport { getGridDefaultInset, getGridMaxZoom } from \"../../helpers/grid\";\nimport KonvaBridge from \"../../helpers/KonvaBridge\";\n\nimport { MapInteractionProvider } from \"../../contexts/MapInteractionContext\";\nimport { GridProvider } from \"../../contexts/GridContext\";\n\nimport ResetMapIcon from \"../../icons/ResetMapIcon\";\nimport GridOnIcon from \"../../icons/GridOnIcon\";\nimport GridOffIcon from \"../../icons/GridOffIcon\";\n\nimport MapGrid from \"./MapGrid\";\nimport MapGridEditor from \"./MapGridEditor\";\nimport { Map } from \"../../types/Map\";\nimport { GridInset } from \"../../types/Grid\";\nimport { MapSettingsChangeEventHandler } from \"../../types/Events\";\n\ntype MapEditorProps = {\n  map: Map;\n  onSettingsChange: MapSettingsChangeEventHandler;\n};\n\nfunction MapEditor({ map, onSettingsChange }: MapEditorProps) {\n  const [mapImage] = useMapImage(map);\n\n  const [stageWidth, setStageWidth] = useState(1);\n  const [stageHeight, setStageHeight] = useState(1);\n  const [stageScale, setStageScale] = useState(1);\n\n  const defaultInset = getGridDefaultInset(map.grid, map.width, map.height);\n\n  const stageTranslateRef = useRef({ x: 0, y: 0 });\n  const mapStageRef = useRef<Konva.Stage>(null);\n  const mapLayerRef = useRef<Konva.Layer>(null);\n  const [preventMapInteraction, setPreventMapInteraction] = useState(false);\n\n  function handleResize(width?: number, height?: number): void {\n    if (width) {\n      setStageWidth(width);\n    }\n\n    if (height) {\n      setStageHeight(height);\n    }\n  }\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  usePreventOverscroll(containerRef);\n\n  const [mapWidth, mapHeight] = useImageCenter(\n    map,\n    mapStageRef,\n    stageWidth,\n    stageHeight,\n    stageTranslateRef,\n    setStageScale,\n    mapLayerRef,\n    containerRef,\n    true\n  );\n\n  useStageInteraction(\n    mapStageRef,\n    stageScale,\n    setStageScale,\n    stageTranslateRef,\n    mapLayerRef,\n    getGridMaxZoom(map.grid),\n    \"move\",\n    preventMapInteraction\n  );\n\n  function handleGridChange(inset: GridInset) {\n    onSettingsChange({\n      grid: {\n        ...map.grid,\n        inset,\n      },\n    });\n  }\n\n  function handleMapReset() {\n    onSettingsChange({\n      grid: {\n        ...map.grid,\n        inset: defaultInset,\n      },\n    });\n  }\n\n  const [showGridControls, setShowGridControls] = useState(true);\n\n  const mapInteraction = {\n    stageScale,\n    stageWidth,\n    stageHeight,\n    setPreventMapInteraction,\n    mapWidth,\n    mapHeight,\n    interactionEmitter: null,\n  };\n\n  const gridChanged =\n    map.grid.inset.topLeft.x !== defaultInset.topLeft.x ||\n    map.grid.inset.topLeft.y !== defaultInset.topLeft.y ||\n    map.grid.inset.bottomRight.x !== defaultInset.bottomRight.x ||\n    map.grid.inset.bottomRight.y !== defaultInset.bottomRight.y;\n\n  const gridValid = map.grid.size.x !== 0 && map.grid.size.y !== 0;\n\n  const layout = useResponsiveLayout();\n\n  return (\n    <MapInteractionProvider value={mapInteraction}>\n      <GridProvider grid={map?.grid} width={mapWidth} height={mapHeight}>\n        <Box\n          sx={{\n            width: \"100%\",\n            height: layout.screenSize === \"large\" ? \"500px\" : \"300px\",\n            cursor: \"move\",\n            touchAction: \"none\",\n            outline: \"none\",\n            position: \"relative\",\n          }}\n          bg=\"muted\"\n          ref={containerRef}\n        >\n          <ReactResizeDetector\n            handleWidth\n            handleHeight\n            onResize={handleResize}\n            targetRef={containerRef}\n          >\n            <KonvaBridge\n              stageRender={(children: React.ReactNode) => (\n                <Stage\n                  // @ts-ignore https://github.com/konvajs/react-konva/issues/342\n                  width={stageWidth}\n                  height={stageHeight}\n                  scale={{ x: stageScale, y: stageScale }}\n                  ref={mapStageRef}\n                >\n                  {children}\n                </Stage>\n              )}\n            >\n              <Layer ref={mapLayerRef}>\n                <Image image={mapImage} width={mapWidth} height={mapHeight} />\n                {showGridControls && gridValid && (\n                  <>\n                    <MapGrid map={map} />\n                    <MapGridEditor map={map} onGridChange={handleGridChange} />\n                  </>\n                )}\n              </Layer>\n            </KonvaBridge>\n          </ReactResizeDetector>\n          {gridChanged && gridValid && (\n            <IconButton\n              title=\"Reset Grid\"\n              aria-label=\"Reset Grid\"\n              onClick={handleMapReset}\n              bg=\"overlay\"\n              sx={{\n                borderRadius: \"50%\",\n                position: \"absolute\",\n                bottom: 0,\n                left: 0,\n              }}\n              m={2}\n            >\n              <ResetMapIcon />\n            </IconButton>\n          )}\n          <IconButton\n            title={\n              showGridControls ? \"Hide Grid Controls\" : \"Show Grid Controls\"\n            }\n            aria-label={\n              showGridControls ? \"Hide Grid Controls\" : \"Show Grid Controls\"\n            }\n            onClick={() => setShowGridControls(!showGridControls)}\n            bg=\"overlay\"\n            sx={{\n              borderRadius: \"50%\",\n              position: \"absolute\",\n              bottom: 0,\n              right: 0,\n            }}\n            m={2}\n            p=\"6px\"\n          >\n            {showGridControls ? <GridOnIcon /> : <GridOffIcon />}\n          </IconButton>\n        </Box>\n      </GridProvider>\n    </MapInteractionProvider>\n  );\n}\n\nexport default MapEditor;\n","import { useState } from \"react\";\nimport { Button, Flex, Label, useThemeUI } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport Modal from \"../components/Modal\";\nimport MapSettings from \"../components/map/MapSettings\";\nimport MapEditor from \"../components/map/MapEditor\";\n\nimport { isEmpty } from \"../helpers/shared\";\nimport { getGridDefaultInset } from \"../helpers/grid\";\n\nimport useResponsiveLayout from \"../hooks/useResponsiveLayout\";\nimport { Map } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport {\n  UpdateMapEventHanlder,\n  UpdateMapStateEventHandler,\n} from \"../contexts/MapDataContext\";\n\ntype EditMapProps = {\n  isOpen: boolean;\n  onDone: () => void;\n  map: Map;\n  mapState: MapState;\n  onUpdateMap: UpdateMapEventHanlder;\n  onUpdateMapState: UpdateMapStateEventHandler;\n};\n\nfunction EditMapModal({\n  isOpen,\n  onDone,\n  map,\n  mapState,\n  onUpdateMap,\n  onUpdateMapState,\n}: EditMapProps) {\n  const { theme } = useThemeUI();\n\n  function handleClose() {\n    setMapSettingChanges({});\n    setMapStateSettingChanges({});\n    onDone();\n  }\n\n  async function handleSave() {\n    await applyMapChanges();\n    onDone();\n  }\n\n  /**\n   * Map settings\n   */\n  // Local cache of map setting changes\n  // Applied when done is clicked or map selection is changed\n  const [mapSettingChanges, setMapSettingChanges] = useState<Partial<Map>>({});\n  const [mapStateSettingChanges, setMapStateSettingChanges] = useState<\n    Partial<MapState>\n  >({});\n\n  function handleMapSettingsChange(change: Partial<Map>) {\n    setMapSettingChanges((prevChanges) => ({\n      ...prevChanges,\n      ...change,\n    }));\n  }\n\n  function handleMapStateSettingsChange(change: Partial<MapState>) {\n    setMapStateSettingChanges((prevChanges) => ({\n      ...prevChanges,\n      ...change,\n    }));\n  }\n\n  async function applyMapChanges() {\n    if (!isEmpty(mapSettingChanges) || !isEmpty(mapStateSettingChanges)) {\n      // Ensure grid values are positive\n      let verifiedChanges: Partial<Map> = { ...mapSettingChanges };\n      if (verifiedChanges.grid) {\n        verifiedChanges.grid.size.x = verifiedChanges.grid.size.x || 1;\n        verifiedChanges.grid.size.y = verifiedChanges.grid.size.y || 1;\n      }\n      // Ensure inset isn't flipped\n      if (verifiedChanges.grid) {\n        const inset = verifiedChanges.grid.inset;\n        if (\n          inset.topLeft.x > inset.bottomRight.x ||\n          inset.topLeft.y > inset.bottomRight.y\n        ) {\n          verifiedChanges.grid.inset = getGridDefaultInset(\n            { size: verifiedChanges.grid.size, type: map.grid.type },\n            map.width,\n            map.height\n          );\n        }\n      }\n      await onUpdateMap(map.id, mapSettingChanges);\n      await onUpdateMapState(map.id, mapStateSettingChanges);\n\n      setMapSettingChanges({});\n      setMapStateSettingChanges({});\n    }\n  }\n\n  const selectedMapWithChanges =\n    map &&\n    ({\n      ...map,\n      ...mapSettingChanges,\n    } as Map);\n  const selectedMapStateWithChanges: MapState = mapState && {\n    ...mapState,\n    ...mapStateSettingChanges,\n  };\n\n  const layout = useResponsiveLayout();\n\n  if (!map) {\n    return null;\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={handleClose}\n      style={{\n        content: {\n          maxWidth: layout.modalSize,\n          width: \"calc(100% - 16px)\",\n          padding: 0,\n          display: \"flex\",\n          overflow: \"hidden\",\n        },\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          width: \"100%\",\n        }}\n      >\n        <Label pt={2} pb={1} px={3}>\n          Edit map\n        </Label>\n        <SimpleBar\n          style={{\n            minHeight: 0,\n            padding: \"16px\",\n            backgroundColor: theme.colors?.muted as string,\n            margin: \"0 8px\",\n            height: \"100%\",\n          }}\n        >\n          <MapEditor\n            map={selectedMapWithChanges}\n            onSettingsChange={handleMapSettingsChange}\n          />\n          <MapSettings\n            map={selectedMapWithChanges}\n            mapState={selectedMapStateWithChanges}\n            onSettingsChange={handleMapSettingsChange}\n            onStateSettingsChange={handleMapStateSettingsChange}\n          />\n        </SimpleBar>\n        <Button m={3} onClick={handleSave}>\n          Save\n        </Button>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default EditMapModal;\n","import { Box, Label, Flex, Button, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\ntype ConfirmModalProps = {\n  isOpen: boolean;\n  onRequestClose: () => void;\n  onConfirm: () => void;\n  confirmText: string;\n  label: string;\n  description: string;\n};\n\nfunction ConfirmModal({\n  isOpen,\n  onRequestClose,\n  onConfirm,\n  confirmText,\n  label,\n  description,\n}: ConfirmModalProps) {\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{ content: { maxWidth: \"300px\" } }}\n    >\n      <Box>\n        <Label py={2}>{label}</Label>\n        {description && (\n          <Text as=\"p\" mb={2} variant=\"caption\">\n            {description}\n          </Text>\n        )}\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }} m={1} ml={0} onClick={onRequestClose}>\n            Cancel\n          </Button>\n          <Button sx={{ flexGrow: 1 }} m={1} mr={0} onClick={onConfirm}>\n            {confirmText}\n          </Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nConfirmModal.defaultProps = {\n  label: \"Are you sure?\",\n  description: \"\",\n  confirmText: \"Yes\",\n};\n\nexport default ConfirmModal;\n","import { Box, Text } from \"theme-ui\";\n\nimport Link from \"./Link\";\n\nfunction DatabaseDisabledMessage({ type }: { type: string }) {\n  return (\n    <Box\n      sx={{\n        textAlign: \"center\",\n        borderRadius: \"2px\",\n        gridArea: \"1 / 1 / span 1 / span 4\",\n      }}\n      bg=\"highlight\"\n      p={1}\n    >\n      <Text as=\"p\" variant=\"body2\">\n        {type} saving is unavailable. See <Link to=\"/faq#database\">FAQ</Link>{\" \"}\n        for more information.\n      </Text>\n    </Box>\n  );\n}\n\nexport default DatabaseDisabledMessage;\n","import { useState } from \"react\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport Vector2 from \"../helpers/Vector2\";\n\nexport type ImageDropEvent = {\n  files: File[];\n  dropPosition: Vector2;\n};\n\nfunction useImageDrop(\n  onImageDrop: (event: ImageDropEvent) => void,\n  supportFileTypes = [\"image/jpeg\", \"image/gif\", \"image/png\", \"image/webp\"]\n) {\n  const { addToast } = useToasts();\n\n  const [dragging, setDragging] = useState(false);\n  function onDragEnter(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    setDragging(true);\n  }\n\n  function onDragLeave(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    setDragging(false);\n  }\n\n  function onDragOver(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.dataTransfer) {\n      event.dataTransfer.dropEffect = \"copy\";\n    }\n  }\n\n  async function onDrop(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    let imageFiles = [];\n\n    // Check if the dropped image is from a URL\n    const html = event.dataTransfer?.getData(\"text/html\");\n    if (html) {\n      try {\n        const urlMatch = html.match(/src=\"?([^\"\\s]+)\"?\\s*/);\n        if (!urlMatch) {\n          throw new Error(\"Unable to find image source\");\n        }\n        const url = urlMatch[1].replace(\"&amp;\", \"&\"); // Reverse html encoding of url parameters\n        let name = \"\";\n        const altMatch = html.match(/alt=\"?([^\"]+)\"?\\s*/);\n        if (altMatch && altMatch.length > 1) {\n          name = altMatch[1];\n        }\n        const response = await fetch(url);\n        if (response.ok) {\n          const blob = await response.blob();\n          const file = new File([blob], name, {\n            type: blob.type,\n          });\n          if (supportFileTypes.includes(file.type)) {\n            imageFiles.push(file);\n          } else {\n            addToast(`Unsupported file type for ${file.name}`);\n          }\n        }\n      } catch (e) {\n        if (e instanceof Error) {\n          if (e.message === \"Failed to fetch\") {\n            addToast(\"Unable to import image: failed to fetch\");\n          } else {\n            addToast(\"Unable to import image\");\n          }\n        }\n      }\n    }\n\n    const files = event.dataTransfer?.files || [];\n    for (let file of files) {\n      if (supportFileTypes.includes(file.type)) {\n        imageFiles.push(file);\n      } else {\n        addToast(`Unsupported file type for ${file.name}`);\n      }\n    }\n    const dropPosition = new Vector2(event.clientX, event.clientY);\n    onImageDrop({ files: imageFiles, dropPosition });\n    setDragging(false);\n  }\n\n  const containerListeners = { onDragEnter };\n  const overlayListeners = { onDragLeave, onDragOver, onDrop };\n\n  return { dragging, containerListeners, overlayListeners };\n}\n\nexport default useImageDrop;\n","import React from \"react\";\nimport { Box, Flex, Text } from \"theme-ui\";\n\nimport useImageDrop, { ImageDropEvent } from \"../../hooks/useImageDrop\";\n\ntype ImageDropProps = {\n  onDrop: (event: ImageDropEvent) => void;\n  dropText: string;\n  children?: React.ReactNode;\n};\n\nfunction ImageDrop({ onDrop, dropText, children }: ImageDropProps) {\n  const { dragging, containerListeners, overlayListeners } =\n    useImageDrop(onDrop);\n  return (\n    <Box {...containerListeners}>\n      {children}\n      {dragging && (\n        <Flex\n          bg=\"overlay\"\n          sx={{\n            position: \"absolute\",\n            top: 0,\n            right: 0,\n            left: 0,\n            bottom: 0,\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            cursor: \"copy\",\n          }}\n          {...overlayListeners}\n        >\n          <Text sx={{ pointerEvents: \"none\", color: \"primary\" }}>\n            {dropText || \"Drop image to import\"}\n          </Text>\n        </Flex>\n      )}\n    </Box>\n  );\n}\n\nexport default ImageDrop;\n","import { Image, ImageProps } from \"theme-ui\";\n\nimport { useDataURL } from \"../../contexts/AssetsContext\";\nimport { mapSources as defaultMapSources } from \"../../maps\";\nimport { Map } from \"../../types/Map\";\n\ntype MapTileImageProps = {\n  map: Map;\n} & ImageProps;\n\nfunction MapTileImage({ map, ...props }: MapTileImageProps) {\n  const mapURL = useDataURL(\n    map,\n    defaultMapSources,\n    undefined,\n    map.type === \"file\"\n  );\n\n  return <Image src={mapURL} {...props} />;\n}\n\nexport default MapTileImage;\n","import React from \"react\";\nimport { Map } from \"../../types/Map\";\n\nimport Tile from \"../tile/Tile\";\nimport MapImage from \"./MapTileImage\";\n\ntype MapTileProps = {\n  map: Map;\n  isSelected: boolean;\n  onSelect: (mapId: string) => void;\n  onEdit: (mapId: string) => void;\n  onDoubleClick: () => void;\n  canEdit: boolean;\n  badges: React.ReactChild[];\n};\n\nfunction MapTile({\n  map,\n  isSelected,\n  onSelect,\n  onEdit,\n  onDoubleClick,\n  canEdit,\n  badges,\n}: MapTileProps) {\n  return (\n    <Tile\n      title={map.name}\n      isSelected={isSelected}\n      onSelect={() => onSelect(map.id)}\n      onEdit={() => onEdit(map.id)}\n      onDoubleClick={() => canEdit && onDoubleClick()}\n      canEdit={canEdit}\n      badges={badges}\n      editTitle=\"Edit Map\"\n    >\n      <MapImage map={map} />\n    </Tile>\n  );\n}\n\nexport default MapTile;\n","import { Grid } from \"theme-ui\";\n\nimport Tile from \"../tile/Tile\";\nimport MapImage from \"./MapTileImage\";\n\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\n\nimport { Map } from \"../../types/Map\";\nimport { GroupContainer } from \"../../types/Group\";\n\ntype MapTileGroupProps = {\n  group: GroupContainer;\n  maps: Map[];\n  isSelected: boolean;\n  onSelect: (groupId: string) => void;\n  onDoubleClick: () => void;\n};\n\nfunction MapTileGroup({\n  group,\n  maps,\n  isSelected,\n  onSelect,\n  onDoubleClick,\n}: MapTileGroupProps) {\n  const layout = useResponsiveLayout();\n\n  return (\n    <Tile\n      title={group.name}\n      isSelected={isSelected}\n      onSelect={() => onSelect(group.id)}\n      onDoubleClick={onDoubleClick}\n    >\n      <Grid\n        columns={`repeat(${layout.groupGridColumns}, 1fr)`}\n        p={2}\n        sx={{\n          gridGap: 2,\n          gridTemplateRows: `repeat(${layout.groupGridColumns}, 1fr)`,\n        }}\n      >\n        {maps\n          .slice(0, layout.groupGridColumns * layout.groupGridColumns)\n          .map((map) => (\n            <MapImage\n              sx={{ borderRadius: \"8px\" }}\n              map={map}\n              key={`${map.id}-group-tile`}\n            />\n          ))}\n      </Grid>\n    </Tile>\n  );\n}\n\nexport default MapTileGroup;\n","import { useRef } from \"react\";\nimport {\n  DndContext,\n  useDndContext,\n  useDndMonitor,\n  DragEndEvent,\n} from \"@dnd-kit/core\";\n\nimport { Props } from \"@dnd-kit/core/dist/components/DndContext/DndContext\";\n\n/**\n * Wrap a dnd-kit DndContext with a position monitor to get the\n * active drag element on drag end\n * TODO: use look into fixing this upstream\n * Related: https://github.com/clauderic/dnd-kit/issues/238\n */\n\ntype DragEndWithOverlayEvent = {\n  overlayNodeClientRect?: DOMRect;\n};\n\nexport type CustomDragEndEvent = DragEndWithOverlayEvent & DragEndEvent;\n\ntype CustomDragProps = {\n  onDragEnd?: (event: CustomDragEndEvent) => void;\n};\n\nfunction DragPositionMonitor({ onDragEnd }: CustomDragProps) {\n  const { overlayNode } = useDndContext();\n\n  const overlayNodeClientRectRef = useRef<DOMRect>();\n  function handleDragMove() {\n    if (overlayNode?.nodeRef?.current) {\n      overlayNodeClientRectRef.current =\n        overlayNode.nodeRef.current.getBoundingClientRect();\n    }\n  }\n\n  function handleDragEnd(props: DragEndEvent) {\n    onDragEnd &&\n      onDragEnd({\n        ...props,\n        overlayNodeClientRect: overlayNodeClientRectRef.current,\n      });\n  }\n  useDndMonitor({ onDragEnd: handleDragEnd, onDragMove: handleDragMove });\n\n  return null;\n}\n\n/**\n * @param {CustomDragProps} props\n */\nfunction DragContext({\n  children,\n  onDragEnd,\n  ...props\n}: CustomDragProps & Props) {\n  return (\n    <DndContext {...props}>\n      <DragPositionMonitor onDragEnd={onDragEnd} />\n      {children}\n    </DndContext>\n  );\n}\n\nexport default DragContext;\n","import React, { useState, useContext, useEffect } from \"react\";\nimport cloneDeep from \"lodash.clonedeep\";\nimport Fuse from \"fuse.js\";\n\nimport { useKeyboard, useBlur } from \"./KeyboardContext\";\n\nimport { getGroupItems, groupsFromIds } from \"../helpers/group\";\n\nimport shortcuts from \"../shortcuts\";\nimport { Group, GroupItem } from \"../types/Group\";\n\nexport type GroupSelectMode = \"single\" | \"multiple\" | \"range\";\nexport type GroupSelectModeChangeEventHandler = (\n  selectMode: GroupSelectMode\n) => void;\nexport type GroupOpenEventHandler = (groupId: string) => void;\nexport type GroupCloseEventHandler = () => void;\nexport type GroupsChangeEventHandler = (newGroups: Group[]) => void;\nexport type SubgroupsChangeEventHandler = (\n  items: GroupItem[],\n  groupId: string\n) => void;\nexport type GroupSelectEventHandler = (groupId: string) => void;\nexport type GroupsSelectEventHandler = (groupIds: string[]) => void;\nexport type GroupClearSelectionEventHandler = () => void;\nexport type GroupFilterChangeEventHandler = (filter: string) => void;\nexport type GroupClearFilterEventHandler = () => void;\n\ntype GroupContextValue = {\n  groups: Group[];\n  activeGroups: Group[] | GroupItem[];\n  openGroupId: string | undefined;\n  openGroupItems: GroupItem[];\n  filter: string | undefined;\n  filteredGroupItems: GroupItem[];\n  selectedGroupIds: string[];\n  selectMode: GroupSelectMode;\n  onSelectModeChange: GroupSelectModeChangeEventHandler;\n  onGroupOpen: GroupOpenEventHandler;\n  onGroupClose: GroupCloseEventHandler;\n  onGroupsChange: GroupsChangeEventHandler;\n  onSubgroupChange: SubgroupsChangeEventHandler;\n  onGroupSelect: GroupSelectEventHandler;\n  onClearSelection: GroupClearSelectionEventHandler;\n  onFilterChange: GroupFilterChangeEventHandler;\n  onFilterClear: GroupClearFilterEventHandler;\n};\n\nconst GroupContext =\n  React.createContext<GroupContextValue | undefined>(undefined);\n\ntype GroupProviderProps = {\n  groups: Group[];\n  itemNames: Record<string, string>;\n  onGroupsChange: GroupsChangeEventHandler;\n  onGroupsSelect: GroupsSelectEventHandler;\n  disabled: boolean;\n  children: React.ReactNode;\n};\n\nexport function GroupProvider({\n  groups,\n  itemNames,\n  onGroupsChange,\n  onGroupsSelect,\n  disabled,\n  children,\n}: GroupProviderProps) {\n  const [selectedGroupIds, setSelectedGroupIds] = useState<string[]>([]);\n  const [selectMode, setSelectMode] = useState<GroupSelectMode>(\"single\");\n\n  /**\n   * Group Open\n   */\n  const [openGroupId, setOpenGroupId] = useState<string>();\n  const [openGroupItems, setOpenGroupItems] = useState<GroupItem[]>([]);\n  useEffect(() => {\n    if (openGroupId) {\n      const openGroups = groupsFromIds([openGroupId], groups);\n      if (openGroups.length === 1) {\n        const openGroup = openGroups[0];\n        setOpenGroupItems(getGroupItems(openGroup));\n      } else {\n        // Close group if we can't find it\n        // This can happen if it was deleted or all it's items were deleted\n        setOpenGroupItems([]);\n        setOpenGroupId(undefined);\n      }\n    } else {\n      setOpenGroupItems([]);\n    }\n  }, [openGroupId, groups]);\n\n  function handleGroupOpen(groupId: string) {\n    setSelectedGroupIds([]);\n    setOpenGroupId(groupId);\n  }\n\n  function handleGroupClose() {\n    setSelectedGroupIds([]);\n    setOpenGroupId(undefined);\n  }\n\n  /**\n   * Search\n   */\n  const [filter, setFilter] = useState<string>();\n  const [filteredGroupItems, setFilteredGroupItems] = useState<GroupItem[]>([]);\n  const [fuse, setFuse] = useState<Fuse<GroupItem & { name: string }>>();\n  // Update search index when items change\n  useEffect(() => {\n    let items = [];\n    for (let group of groups) {\n      const itemsToAdd = getGroupItems(group);\n      const namedItems = itemsToAdd.map((item) => ({\n        ...item,\n        name: itemNames[item.id],\n      }));\n      items.push(...namedItems);\n    }\n    setFuse(new Fuse(items, { keys: [\"name\"] }));\n  }, [groups, itemNames]);\n\n  // Perform search when search changes\n  useEffect(() => {\n    if (filter && fuse) {\n      const query = fuse.search(filter);\n      setFilteredGroupItems(query.map((result) => result.item));\n      setOpenGroupId(undefined);\n    } else {\n      setFilteredGroupItems([]);\n    }\n  }, [filter, fuse]);\n\n  /**\n   * Handlers\n   */\n\n  const activeGroups = openGroupId\n    ? openGroupItems\n    : filter\n    ? filteredGroupItems\n    : groups;\n\n  function handleGroupsChange(newGroups: Group[]) {\n    onGroupsChange(newGroups);\n  }\n\n  function handleSubgroupChange(items: GroupItem[], groupId: string) {\n    const groupIndex = groups.findIndex((group) => group.id === groupId);\n    let updatedGroups = cloneDeep(groups);\n    const group = updatedGroups[groupIndex];\n    if (group.type === \"group\") {\n      updatedGroups[groupIndex] = {\n        ...group,\n        items,\n      };\n      onGroupsChange(updatedGroups);\n    } else {\n      throw new Error(`Group ${group} not a subgroup`);\n    }\n  }\n\n  function handleGroupSelect(groupId: string) {\n    let groupIds: string[] = [];\n    switch (selectMode) {\n      case \"single\":\n        groupIds = [groupId];\n        break;\n      case \"multiple\":\n        if (selectedGroupIds.includes(groupId)) {\n          groupIds = selectedGroupIds.filter((id) => id !== groupId);\n        } else {\n          groupIds = [...selectedGroupIds, groupId];\n        }\n        break;\n      case \"range\":\n        if (selectedGroupIds.length > 0) {\n          const currentIndex = activeGroups.findIndex((g) => g.id === groupId);\n          const lastIndex = activeGroups.findIndex(\n            (g) => g.id === selectedGroupIds[selectedGroupIds.length - 1]\n          );\n          let idsToAdd: string[] = [];\n          let idsToRemove: string[] = [];\n          const direction = currentIndex > lastIndex ? 1 : -1;\n          for (\n            let i = lastIndex + direction;\n            direction < 0 ? i >= currentIndex : i <= currentIndex;\n            i += direction\n          ) {\n            const id = activeGroups[i].id;\n            if (selectedGroupIds.includes(id)) {\n              idsToRemove.push(id);\n            } else {\n              idsToAdd.push(id);\n            }\n          }\n          groupIds = [...selectedGroupIds, ...idsToAdd].filter(\n            (id) => !idsToRemove.includes(id)\n          );\n        } else {\n          groupIds = [groupId];\n        }\n        break;\n      default:\n        groupIds = [];\n    }\n    setSelectedGroupIds(groupIds);\n    onGroupsSelect(groupIds);\n  }\n\n  function handleClearSelection() {\n    setSelectedGroupIds([]);\n    onGroupsSelect([]);\n  }\n\n  /**\n   * Shortcuts\n   */\n  function handleKeyDown(event: KeyboardEvent) {\n    if (disabled) {\n      return;\n    }\n    if (shortcuts.selectRange(event)) {\n      setSelectMode(\"range\");\n    }\n    if (shortcuts.selectMultiple(event)) {\n      setSelectMode(\"multiple\");\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (disabled) {\n      return;\n    }\n    if (shortcuts.selectRange(event) && selectMode === \"range\") {\n      setSelectMode(\"single\");\n    }\n    if (shortcuts.selectMultiple(event) && selectMode === \"multiple\") {\n      setSelectMode(\"single\");\n    }\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n\n  // Set select mode to single when cmd+tabing\n  function handleBlur() {\n    setSelectMode(\"single\");\n  }\n\n  useBlur(handleBlur);\n\n  const value = {\n    groups,\n    activeGroups,\n    openGroupId,\n    openGroupItems,\n    filter,\n    filteredGroupItems,\n    selectedGroupIds,\n    selectMode,\n    onSelectModeChange: setSelectMode,\n    onGroupOpen: handleGroupOpen,\n    onGroupClose: handleGroupClose,\n    onGroupsChange: handleGroupsChange,\n    onSubgroupChange: handleSubgroupChange,\n    onGroupSelect: handleGroupSelect,\n    onClearSelection: handleClearSelection,\n    onFilterChange: setFilter,\n    onFilterClear: () => setFilter(undefined),\n  };\n\n  return (\n    <GroupContext.Provider value={value}>{children}</GroupContext.Provider>\n  );\n}\n\nGroupProvider.defaultProps = {\n  groups: [],\n  itemNames: {},\n  onGroupsChange: () => {},\n  onGroupsSelect: () => {},\n  disabled: false,\n};\n\nexport function useGroup() {\n  const context = useContext(GroupContext);\n  if (context === undefined) {\n    throw new Error(\"useGroup must be used within a GroupProvider\");\n  }\n  return context;\n}\n\nexport default GroupContext;\n","function usePreventSelect() {\n  function clearSelection() {\n    window?.getSelection()?.removeAllRanges();\n    // @ts-ignore\n    document?.selection?.empty();\n  }\n  function preventSelect() {\n    clearSelection();\n    document.body.classList.add(\"no-select\");\n  }\n\n  function resumeSelect() {\n    document.body.classList.remove(\"no-select\");\n  }\n\n  return [preventSelect, resumeSelect];\n}\n\nexport default usePreventSelect;\n","import React, { useState, useContext, useEffect } from \"react\";\nimport {\n  MouseSensor,\n  TouchSensor,\n  KeyboardSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  RectEntry,\n} from \"@dnd-kit/core\";\n\nimport DragContext, { CustomDragEndEvent } from \"./DragContext\";\nimport { DragStartEvent, DragOverEvent, ViewRect } from \"@dnd-kit/core\";\nimport { DragCancelEvent } from \"@dnd-kit/core/dist/types\";\n\nimport { useGroup } from \"./GroupContext\";\n\nimport { moveGroupsInto, moveGroups, ungroup } from \"../helpers/group\";\nimport Vector2 from \"../helpers/Vector2\";\n\nimport usePreventSelect from \"../hooks/usePreventSelect\";\nimport { GroupItem } from \"../types/Group\";\n\nconst TileDragIdContext =\n  React.createContext<string | undefined | null>(undefined);\nconst TileOverGroupIdContext =\n  React.createContext<string | undefined | null>(undefined);\nconst TileDragCursorContext =\n  React.createContext<string | undefined | null>(undefined);\n\nexport const BASE_SORTABLE_ID = \"__base__\";\nexport const GROUP_SORTABLE_ID = \"__group__\";\nexport const GROUP_ID_PREFIX = \"__group__\";\nexport const UNGROUP_ID = \"__ungroup__\";\nexport const ADD_TO_MAP_ID = \"__add__\";\n\n// Custom rectIntersect that takes a point\nfunction rectIntersection(rects: RectEntry[], point: Vector2) {\n  for (let rect of rects) {\n    const [id, bounds] = rect;\n    if (\n      id &&\n      bounds &&\n      point.x > bounds.offsetLeft &&\n      point.x < bounds.offsetLeft + bounds.width &&\n      point.y > bounds.offsetTop &&\n      point.y < bounds.offsetTop + bounds.height\n    ) {\n      return id;\n    }\n  }\n  return null;\n}\n\ntype TileDragProviderProps = {\n  onDragAdd?: (selectedGroupIds: string[], rect: DOMRect) => void;\n  onDragStart?: (event: DragStartEvent) => void;\n  onDragEnd?: (event: CustomDragEndEvent) => void;\n  onDragCancel?: (event: DragCancelEvent) => void;\n  children?: React.ReactNode;\n};\n\nexport function TileDragProvider({\n  onDragAdd,\n  onDragStart,\n  onDragEnd,\n  onDragCancel,\n  children,\n}: TileDragProviderProps) {\n  const {\n    groups,\n    activeGroups,\n    openGroupId,\n    selectedGroupIds,\n    onGroupsChange,\n    onSubgroupChange,\n    onGroupSelect,\n    onClearSelection,\n    filter,\n  } = useGroup();\n\n  const mouseSensor = useSensor(MouseSensor, {\n    activationConstraint: { distance: 3 },\n  });\n  const touchSensor = useSensor(TouchSensor, {\n    activationConstraint: { delay: 250, tolerance: 5 },\n  });\n  const keyboardSensor = useSensor(KeyboardSensor);\n\n  const sensors = useSensors(mouseSensor, touchSensor, keyboardSensor);\n\n  const [dragId, setDragId] = useState<string | null>(null);\n  const [overId, setOverId] = useState<string | null>(null);\n  const [dragCursor, setDragCursor] = useState(\"pointer\");\n\n  const [preventSelect, resumeSelect] = usePreventSelect();\n\n  const [overGroupId, setOverGroupId] = useState<string | null>(null);\n  useEffect(() => {\n    setOverGroupId(\n      (overId && overId.startsWith(GROUP_ID_PREFIX) && overId.slice(9)) || null\n    );\n  }, [overId]);\n\n  function handleDragStart(event: DragStartEvent) {\n    const { active } = event;\n    setDragId(active.id);\n    setOverId(null);\n    if (!selectedGroupIds.includes(active.id)) {\n      onGroupSelect(active.id);\n    }\n    setDragCursor(\"grabbing\");\n\n    onDragStart && onDragStart(event);\n\n    preventSelect();\n  }\n\n  function handleDragOver(event: DragOverEvent) {\n    const { over } = event;\n\n    setOverId(over?.id || null);\n    if (over) {\n      if (\n        over.id.startsWith(UNGROUP_ID) ||\n        over.id.startsWith(GROUP_ID_PREFIX)\n      ) {\n        setDragCursor(\"alias\");\n      } else if (over.id.startsWith(ADD_TO_MAP_ID)) {\n        setDragCursor(onDragAdd ? \"copy\" : \"no-drop\");\n      } else {\n        setDragCursor(\"grabbing\");\n      }\n    }\n  }\n\n  function handleDragEnd(event: CustomDragEndEvent) {\n    const { active, over, overlayNodeClientRect } = event;\n\n    setDragId(null);\n    setOverId(null);\n    setDragCursor(\"pointer\");\n    if (active && over && active.id !== over.id) {\n      let selectedIndices = selectedGroupIds.map((groupId) =>\n        activeGroups.findIndex((group) => group.id === groupId)\n      );\n      // Maintain current group sorting\n      selectedIndices = selectedIndices.sort((a, b) => a - b);\n\n      if (over.id.startsWith(GROUP_ID_PREFIX)) {\n        onClearSelection();\n        // Handle tile group\n        const overId = over.id.slice(9);\n        if (overId !== active.id) {\n          const overGroupIndex = activeGroups.findIndex(\n            (group) => group.id === overId\n          );\n          const newGroups = moveGroupsInto(\n            activeGroups,\n            overGroupIndex,\n            selectedIndices\n          );\n          if (!openGroupId) {\n            onGroupsChange(newGroups);\n          }\n        }\n      } else if (over.id === UNGROUP_ID) {\n        if (openGroupId) {\n          onClearSelection();\n          // Handle tile ungroup\n          const newGroups = ungroup(groups, openGroupId, selectedIndices);\n          onGroupsChange(newGroups);\n        }\n      } else if (over.id === ADD_TO_MAP_ID) {\n        onDragAdd &&\n          overlayNodeClientRect &&\n          onDragAdd(selectedGroupIds, overlayNodeClientRect);\n      } else if (!filter) {\n        // Hanlde tile move only if we have no filter\n        const overGroupIndex = activeGroups.findIndex(\n          (group) => group.id === over.id\n        );\n        const newGroups = moveGroups(\n          activeGroups,\n          overGroupIndex,\n          selectedIndices\n        );\n        if (openGroupId) {\n          onSubgroupChange(newGroups as GroupItem[], openGroupId);\n        } else {\n          onGroupsChange(newGroups);\n        }\n      }\n    }\n\n    resumeSelect();\n\n    onDragEnd && onDragEnd(event);\n  }\n\n  function handleDragCancel(event: DragCancelEvent) {\n    setDragId(null);\n    setOverId(null);\n    setDragCursor(\"pointer\");\n\n    resumeSelect();\n\n    onDragCancel && onDragCancel(event);\n  }\n\n  function customCollisionDetection(rects: RectEntry[], rect: ViewRect) {\n    const rectCenter = {\n      x: rect.left + rect.width / 2,\n      y: rect.top + rect.height / 2,\n    };\n\n    // Find whether out rect center is outside our add to map rect\n    const addRect = rects.find(([id]) => id === ADD_TO_MAP_ID);\n    if (addRect) {\n      const intersectingAddRect = rectIntersection([addRect], rectCenter);\n      if (!intersectingAddRect) {\n        return ADD_TO_MAP_ID;\n      }\n    }\n\n    // Find whether out rect center is outside our ungroup rect\n    if (openGroupId) {\n      const ungroupRect = rects.find(([id]) => id === UNGROUP_ID);\n      if (ungroupRect) {\n        const intersectingGroupRect = rectIntersection(\n          [ungroupRect],\n          rectCenter\n        );\n        if (!intersectingGroupRect) {\n          return UNGROUP_ID;\n        }\n      }\n    }\n\n    const otherRects = rects.filter(\n      ([id]) => id !== ADD_TO_MAP_ID && id !== UNGROUP_ID\n    );\n\n    return closestCenter(otherRects, rect);\n  }\n\n  return (\n    <DragContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragOver={handleDragOver}\n      onDragCancel={handleDragCancel}\n      sensors={sensors}\n      collisionDetection={customCollisionDetection}\n    >\n      <TileDragIdContext.Provider value={dragId}>\n        <TileOverGroupIdContext.Provider value={overGroupId}>\n          <TileDragCursorContext.Provider value={dragCursor}>\n            {children}\n          </TileDragCursorContext.Provider>\n        </TileOverGroupIdContext.Provider>\n      </TileDragIdContext.Provider>\n    </DragContext>\n  );\n}\n\nexport function useTileDragId() {\n  const context = useContext(TileDragIdContext);\n  if (context === undefined) {\n    throw new Error(\"useTileDrag must be used within a TileDragProvider\");\n  }\n  return context;\n}\n\nexport function useTileOverGroupId() {\n  const context = useContext(TileOverGroupIdContext);\n  if (context === undefined) {\n    throw new Error(\"useTileDrag must be used within a TileDragProvider\");\n  }\n  return context;\n}\n\nexport function useTileDragCursor() {\n  const context = useContext(TileDragCursorContext);\n  if (context === undefined) {\n    throw new Error(\"useTileDrag must be used within a TileDragProvider\");\n  }\n  return context;\n}\n","import React from \"react\";\nimport { Box } from \"theme-ui\";\nimport { useDroppable } from \"@dnd-kit/core\";\nimport { useSortable } from \"@dnd-kit/sortable\";\nimport { animated, useSpring } from \"react-spring\";\n\nimport { GROUP_ID_PREFIX } from \"../../contexts/TileDragContext\";\n\ntype SortableTileProps = {\n  id: string;\n  disableGrouping: boolean;\n  disableSorting: boolean;\n  hidden: boolean;\n  children: React.ReactNode;\n  isDragging: boolean;\n  cursor: string;\n};\n\nfunction SortableTile({\n  id,\n  disableGrouping,\n  disableSorting,\n  hidden,\n  children,\n  isDragging,\n  cursor,\n}: SortableTileProps) {\n  const {\n    attributes,\n    listeners,\n    setDroppableNodeRef,\n    setDraggableNodeRef,\n    over,\n    active,\n  } = useSortable({ id });\n\n  const { setNodeRef: setGroupNodeRef } = useDroppable({\n    id: `${GROUP_ID_PREFIX}${id}`,\n    disabled: disableGrouping,\n  });\n\n  const dragStyle = {\n    cursor,\n    opacity: isDragging ? 0.25 : undefined,\n  };\n\n  // Sort div left aligned\n  const sortDropStyle: React.CSSProperties = {\n    position: \"absolute\",\n    left: \"-5px\",\n    top: 0,\n    width: \"2px\",\n    height: \"100%\",\n    borderRadius: \"2px\",\n    visibility: over?.id === id && !disableSorting ? \"visible\" : \"hidden\",\n  };\n\n  // Group div center aligned\n  const groupDropStyle: React.CSSProperties = {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    width: \"100%\",\n    height: \"100%\",\n    borderWidth: \"4px\",\n    borderRadius: \"4px\",\n    borderStyle:\n      over?.id === `${GROUP_ID_PREFIX}${id}` && active?.id !== id\n        ? \"solid\"\n        : \"none\",\n  };\n\n  const { opacity } = useSpring({ opacity: hidden ? 0 : 1 });\n\n  return (\n    <animated.div style={{ opacity, position: \"relative\" }}>\n      <Box\n        ref={setDraggableNodeRef}\n        style={dragStyle}\n        {...listeners}\n        {...attributes}\n      >\n        {children}\n      </Box>\n      <Box\n        sx={{\n          width: \"100%\",\n          height: 0,\n          paddingTop: \"100%\",\n          pointerEvents: \"none\",\n          position: \"absolute\",\n          top: 0,\n        }}\n      >\n        <Box ref={setDroppableNodeRef} style={sortDropStyle} bg=\"primary\" />\n        <Box\n          ref={setGroupNodeRef}\n          style={groupDropStyle}\n          sx={{ borderColor: \"primary\" }}\n        />\n      </Box>\n    </animated.div>\n  );\n}\n\nSortableTile.defaultProps = {\n  cursor: \"pointer\",\n};\n\nexport default SortableTile;\n","import React from \"react\";\nimport { Box, ThemeUIStyleObject } from \"theme-ui\";\nimport { useInView } from \"react-intersection-observer\";\n\nfunction LazyTile({ children }: { children: React.ReactNode }) {\n  const [ref, inView] = useInView({ triggerOnce: false });\n\n  const sx: ThemeUIStyleObject = inView\n    ? {}\n    : { width: \"100%\", height: \"0\", paddingTop: \"100%\", position: \"relative\" };\n\n  return (\n    <Box sx={sx} ref={ref}>\n      {inView ? (\n        children\n      ) : (\n        <Box\n          sx={{\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            borderRadius: \"4px\",\n          }}\n          bg=\"background\"\n        />\n      )}\n    </Box>\n  );\n}\n\nexport default LazyTile;\n","import React from \"react\";\nimport { SortableContext } from \"@dnd-kit/sortable\";\n\nimport { moveGroupsInto } from \"../../helpers/group\";\nimport { keyBy } from \"../../helpers/shared\";\n\nimport SortableTile from \"./SortableTile\";\nimport LazyTile from \"./LazyTile\";\n\nimport {\n  useTileDragId,\n  useTileDragCursor,\n  useTileOverGroupId,\n  BASE_SORTABLE_ID,\n  GROUP_SORTABLE_ID,\n} from \"../../contexts/TileDragContext\";\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { Group } from \"../../types/Group\";\n\ntype SortableTilesProps = {\n  renderTile: (group: Group) => React.ReactNode;\n  subgroup: boolean;\n};\n\nfunction SortableTiles({ renderTile, subgroup }: SortableTilesProps) {\n  const dragId = useTileDragId();\n  const dragCursor = useTileDragCursor();\n  const overGroupId = useTileOverGroupId();\n  const {\n    groups,\n    selectedGroupIds: allSelectedIds,\n    filter,\n    openGroupId,\n    openGroupItems,\n    filteredGroupItems,\n  } = useGroup();\n\n  const activeGroups = subgroup\n    ? openGroupItems\n    : filter\n    ? filteredGroupItems\n    : groups;\n\n  const sortableId = subgroup ? GROUP_SORTABLE_ID : BASE_SORTABLE_ID;\n\n  // Only populate selected groups if needed\n  let selectedGroupIds: string[] = [];\n  if ((subgroup && openGroupId) || (!subgroup && !openGroupId)) {\n    selectedGroupIds = allSelectedIds;\n  }\n  const disableSorting = !!((openGroupId && !subgroup) || filter);\n  const disableGrouping = !!(subgroup || disableSorting || filter);\n\n  function renderSortableGroup(group: Group, selectedGroups: Group[]) {\n    if (overGroupId === group.id && dragId && group.id !== dragId) {\n      // If dragging over a group render a preview of that group\n      const previewGroup = moveGroupsInto(\n        [group, ...selectedGroups],\n        0,\n        selectedGroups.map((_, i) => i + 1)\n      )[0];\n      return renderTile(previewGroup);\n    }\n    return renderTile(group);\n  }\n\n  function renderTiles() {\n    const groupsByIds = keyBy(activeGroups, \"id\");\n    const selectedGroupIdsSet = new Set(selectedGroupIds);\n    let selectedGroups: Group[] = [];\n    let hasSelectedContainerGroup = false;\n    for (let groupId of selectedGroupIds) {\n      const group = groupsByIds[groupId];\n      if (group) {\n        selectedGroups.push(group);\n        if (group.type === \"group\") {\n          hasSelectedContainerGroup = true;\n        }\n      }\n    }\n    return activeGroups.map((group: Group) => {\n      const isDragging = dragId !== null && selectedGroupIdsSet.has(group.id);\n      const disableTileGrouping =\n        disableGrouping || isDragging || hasSelectedContainerGroup;\n      return (\n        <LazyTile key={group.id}>\n          <SortableTile\n            id={group.id}\n            disableGrouping={disableTileGrouping}\n            disableSorting={disableSorting}\n            hidden={group.id === openGroupId}\n            isDragging={isDragging}\n            cursor={dragCursor || \"\"}\n          >\n            {renderSortableGroup(group, selectedGroups)}\n          </SortableTile>\n        </LazyTile>\n      );\n    });\n  }\n\n  return (\n    <SortableContext items={activeGroups} id={sortableId}>\n      {renderTiles()}\n    </SortableContext>\n  );\n}\n\nexport default SortableTiles;\n","import React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { DragOverlay } from \"@dnd-kit/core\";\nimport { animated, useSpring, config } from \"react-spring\";\nimport { Badge } from \"theme-ui\";\n\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { useTileDragId } from \"../../contexts/TileDragContext\";\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { Group } from \"../../types/Group\";\n\ntype SortableTilesDragOverlayProps = {\n  renderTile: (group: Group) => React.ReactNode;\n  subgroup: boolean;\n};\n\nfunction SortableTilesDragOverlay({\n  renderTile,\n  subgroup,\n}: SortableTilesDragOverlayProps) {\n  const dragId = useTileDragId();\n  const {\n    groups,\n    selectedGroupIds: allSelectedIds,\n    filter,\n    openGroupId,\n    openGroupItems,\n    filteredGroupItems,\n  } = useGroup();\n\n  const activeGroups = subgroup\n    ? openGroupItems\n    : filter\n    ? filteredGroupItems\n    : groups;\n\n  // Only populate selected groups if needed\n  let selectedGroupIds: string[] = [];\n  if ((subgroup && openGroupId) || (!subgroup && !openGroupId)) {\n    selectedGroupIds = allSelectedIds;\n  }\n  const dragBounce = useSpring({\n    transform: !!dragId ? \"scale(0.9)\" : \"scale(1)\",\n    config: config.wobbly,\n  });\n\n  function renderDragOverlays() {\n    let selectedIndices = selectedGroupIds.map((groupId) =>\n      activeGroups.findIndex((group) => group.id === groupId)\n    );\n    const activeIndex = activeGroups.findIndex((group) => group.id === dragId);\n    // Sort so the draging tile is the first element\n    selectedIndices = selectedIndices.sort((a, b) =>\n      a === activeIndex ? -1 : b === activeIndex ? 1 : 0\n    );\n\n    selectedIndices = selectedIndices.slice(0, 5);\n\n    let coords = selectedIndices.map(\n      (_, index) => new Vector2(5 * index, 5 * index)\n    );\n\n    // Reverse so the first element is rendered on top\n    selectedIndices = selectedIndices.reverse();\n    coords = coords.reverse();\n\n    const selectedGroups = selectedIndices.map((index) => activeGroups[index]);\n\n    return selectedGroups.map((group, index) => (\n      <DragOverlay dropAnimation={null} key={group.id}>\n        <div\n          style={{\n            transform: `translate(${coords[index].x}%, ${coords[index].y}%)`,\n          }}\n        >\n          <animated.div style={{ ...dragBounce, position: \"relative\" }}>\n            {renderTile(group)}\n            {index === selectedIndices.length - 1 &&\n              selectedGroupIds.length > 1 && (\n                <Badge\n                  sx={{\n                    position: \"absolute\",\n                    top: 0,\n                    right: 0,\n                    transform: \"translate(25%, -25%)\",\n                  }}\n                >\n                  {selectedGroupIds.length}\n                </Badge>\n              )}\n          </animated.div>\n        </div>\n      </DragOverlay>\n    ));\n  }\n\n  return createPortal(dragId && renderDragOverlays(), document.body);\n}\n\nexport default SortableTilesDragOverlay;\n","import MapTile from \"./MapTile\";\nimport MapTileGroup from \"./MapTileGroup\";\n\nimport SortableTiles from \"../tile/SortableTiles\";\nimport SortableTilesDragOverlay from \"../tile/SortableTilesDragOverlay\";\n\nimport { getGroupItems } from \"../../helpers/group\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\n\nimport { Map } from \"../../types/Map\";\nimport { Group } from \"../../types/Group\";\n\ntype MapTileProps = {\n  mapsById: Record<string, Map>;\n  onMapEdit: (mapId: string) => void;\n  onMapSelect: (groupId: string) => void;\n  subgroup: boolean;\n};\n\nfunction MapTiles({\n  mapsById,\n  onMapEdit,\n  onMapSelect,\n  subgroup,\n}: MapTileProps) {\n  const { selectedGroupIds, selectMode, onGroupOpen, onGroupSelect } =\n    useGroup();\n\n  function renderTile(group: Group) {\n    if (group.type === \"item\") {\n      const map = mapsById[group.id];\n      if (map) {\n        const isSelected = selectedGroupIds.includes(group.id);\n        const canEdit =\n          isSelected &&\n          selectMode === \"single\" &&\n          selectedGroupIds.length === 1;\n        return (\n          <MapTile\n            key={map.id}\n            map={map}\n            isSelected={isSelected}\n            onSelect={onGroupSelect}\n            onEdit={onMapEdit}\n            onDoubleClick={() => canEdit && onMapSelect(group.id)}\n            canEdit={canEdit}\n            badges={[`${map.grid.size.x}x${map.grid.size.y}`]}\n          />\n        );\n      }\n    } else {\n      const isSelected = selectedGroupIds.includes(group.id);\n      const items = getGroupItems(group);\n      const canOpen =\n        isSelected && selectMode === \"single\" && selectedGroupIds.length === 1;\n      return (\n        <MapTileGroup\n          key={group.id}\n          group={group}\n          maps={items.map((item) => mapsById[item.id])}\n          isSelected={isSelected}\n          onSelect={onGroupSelect}\n          onDoubleClick={() => canOpen && onGroupOpen(group.id)}\n        />\n      );\n    }\n  }\n\n  return (\n    <>\n      <SortableTiles renderTile={renderTile} subgroup={subgroup} />\n      <SortableTilesDragOverlay renderTile={renderTile} subgroup={subgroup} />\n    </>\n  );\n}\n\nMapTiles.defaultProps = {\n  subgroup: false,\n};\n\nexport default MapTiles;\n","function RemoveMapIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z\" />\n    </svg>\n  );\n}\n\nexport default RemoveMapIcon;\n","import { useState, useEffect } from \"react\";\nimport { Flex, Close, IconButton } from \"theme-ui\";\n\nimport { groupsFromIds, itemsFromGroups } from \"../../helpers/group\";\n\nimport ConfirmModal from \"../../modals/ConfirmModal\";\n\nimport ResetMapIcon from \"../../icons/ResetMapIcon\";\nimport RemoveMapIcon from \"../../icons/RemoveMapIcon\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { useMapData } from \"../../contexts/MapDataContext\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport shortcuts from \"../../shortcuts\";\nimport { Map } from \"../../types/Map\";\nimport {\n  MapChangeEventHandler,\n  MapResetEventHandler,\n} from \"../../types/Events\";\n\ntype MapEditBarProps = {\n  currentMap: Map | null;\n  disabled: boolean;\n  onMapChange: MapChangeEventHandler;\n  onMapReset: MapResetEventHandler;\n  onLoad: (loading: boolean) => void;\n};\n\nfunction MapEditBar({\n  currentMap,\n  disabled,\n  onMapChange,\n  onMapReset,\n  onLoad,\n}: MapEditBarProps) {\n  const [hasMapState, setHasMapState] = useState(false);\n\n  const { maps, mapStates, removeMaps, resetMap } = useMapData();\n\n  const { activeGroups, selectedGroupIds, onClearSelection } = useGroup();\n\n  useEffect(() => {\n    const selectedGroups = groupsFromIds(selectedGroupIds, activeGroups);\n    const selectedMapStates = itemsFromGroups(\n      selectedGroups,\n      mapStates,\n      \"mapId\"\n    );\n\n    let _hasMapState = false;\n    for (let state of selectedMapStates) {\n      if (\n        Object.values(state.tokens).length > 0 ||\n        Object.values(state.drawings).length > 0 ||\n        Object.values(state.fogs).length > 0 ||\n        Object.values(state.notes).length > 0\n      ) {\n        _hasMapState = true;\n        break;\n      }\n    }\n\n    setHasMapState(_hasMapState);\n  }, [selectedGroupIds, mapStates, activeGroups]);\n\n  function getSelectedMaps() {\n    const selectedGroups = groupsFromIds(selectedGroupIds, activeGroups);\n    return itemsFromGroups(selectedGroups, maps);\n  }\n\n  const [isMapsRemoveModalOpen, setIsMapsRemoveModalOpen] = useState(false);\n  async function handleMapsRemove() {\n    onLoad(true);\n    setIsMapsRemoveModalOpen(false);\n    const selectedMaps = getSelectedMaps();\n    const selectedMapIds = selectedMaps.map((map) => map.id);\n    onClearSelection();\n    await removeMaps(selectedMapIds);\n    // Removed the map from the map screen if needed\n    if (currentMap && selectedMapIds.includes(currentMap.id)) {\n      onMapChange(null, null);\n    }\n    onLoad(false);\n  }\n\n  const [isMapsResetModalOpen, setIsMapsResetModalOpen] = useState(false);\n  async function handleMapsReset() {\n    onLoad(true);\n    setIsMapsResetModalOpen(false);\n    const selectedMaps = getSelectedMaps();\n    const selectedMapIds = selectedMaps.map((map) => map.id);\n    for (let id of selectedMapIds) {\n      const newState = await resetMap(id);\n      // Reset the state of the current map if needed\n      if (currentMap && currentMap.id === id) {\n        onMapReset(newState);\n      }\n    }\n    onLoad(false);\n  }\n\n  /**\n   * Shortcuts\n   */\n  function handleKeyDown(event: KeyboardEvent) {\n    if (disabled) {\n      return;\n    }\n    if (shortcuts.delete(event)) {\n      const selectedMaps = getSelectedMaps();\n      if (selectedMaps.length > 0) {\n        setIsMapsResetModalOpen(false);\n        setIsMapsRemoveModalOpen(true);\n      }\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  if (selectedGroupIds.length === 0) {\n    return null;\n  }\n\n  return (\n    <Flex\n      sx={{\n        position: \"absolute\",\n        bottom: 0,\n        left: 0,\n        right: 0,\n        justifyContent: \"space-between\",\n      }}\n      bg=\"overlay\"\n    >\n      <Close\n        title=\"Clear Selection\"\n        aria-label=\"Clear Selection\"\n        onClick={() => onClearSelection()}\n      />\n      <Flex>\n        <IconButton\n          aria-label=\"Reset Selected Map(s)\"\n          title=\"Reset Selected Map(s)\"\n          onClick={() => setIsMapsResetModalOpen(true)}\n          disabled={!hasMapState}\n        >\n          <ResetMapIcon />\n        </IconButton>\n        <IconButton\n          aria-label=\"Remove Selected Map(s)\"\n          title=\"Remove Selected Map(s)\"\n          onClick={() => setIsMapsRemoveModalOpen(true)}\n        >\n          <RemoveMapIcon />\n        </IconButton>\n      </Flex>\n      <ConfirmModal\n        isOpen={isMapsResetModalOpen}\n        onRequestClose={() => setIsMapsResetModalOpen(false)}\n        onConfirm={handleMapsReset}\n        confirmText=\"Reset\"\n        label=\"Reset Selected Map(s)\"\n        description=\"This will remove all fog, drawings and tokens from the selected maps.\"\n      />\n      <ConfirmModal\n        isOpen={isMapsRemoveModalOpen}\n        onRequestClose={() => setIsMapsRemoveModalOpen(false)}\n        onConfirm={handleMapsRemove}\n        confirmText=\"Remove\"\n        label=\"Remove Selected Map(s)\"\n        description=\"This operation cannot be undone.\"\n      />\n    </Flex>\n  );\n}\n\nexport default MapEditBar;\n","import { Button } from \"theme-ui\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\n\nimport { findGroup } from \"../../helpers/group\";\n\ntype SelectMapSelectButtonProps = {\n  onMapSelect: (mapId: string) => void;\n  disabled: boolean;\n};\n\nfunction SelectMapSelectButton({\n  onMapSelect,\n  disabled,\n}: SelectMapSelectButtonProps) {\n  const { activeGroups, selectedGroupIds } = useGroup();\n\n  function handleSelectClick() {\n    if (selectedGroupIds.length === 1) {\n      const group = findGroup(activeGroups, selectedGroupIds[0]);\n      if (group && group.type === \"item\") {\n        onMapSelect(group.id);\n      }\n    }\n  }\n\n  return (\n    <Button\n      variant=\"primary\"\n      disabled={disabled || selectedGroupIds.length > 1}\n      onClick={handleSelectClick}\n      mt={2}\n    >\n      Select\n    </Button>\n  );\n}\n\nexport default SelectMapSelectButton;\n","function ChangeNicknameIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\" />\n    </svg>\n  );\n}\n\nexport default ChangeNicknameIcon;\n","import React, { useState, useRef, useEffect } from \"react\";\nimport { Box, Input, Button, Label, Flex } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\nexport type GroupNameEventHandler = (name: string) => void;\n\ntype GroupNameModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  name: string;\n  onSubmit: GroupNameEventHandler;\n};\n\nfunction GroupNameModal({\n  isOpen,\n  name,\n  onSubmit,\n  onRequestClose,\n}: GroupNameModalProps) {\n  const [tmpName, setTempName] = useState(name);\n\n  useEffect(() => {\n    setTempName(name);\n  }, [name]);\n\n  function handleChange(event: React.ChangeEvent<HTMLInputElement>) {\n    setTempName(event.target.value);\n  }\n\n  function handleSubmit(event: React.FormEvent<HTMLDivElement>) {\n    event.preventDefault();\n    onSubmit(tmpName);\n  }\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput() {\n    inputRef.current?.focus();\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      onAfterOpen={focusInput}\n    >\n      <Box as=\"form\" onSubmit={handleSubmit}>\n        <Label py={2} htmlFor=\"name\">\n          Group Name\n        </Label>\n        <Input\n          id=\"name\"\n          value={tmpName}\n          onChange={handleChange}\n          ref={inputRef}\n        />\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }}>Save</Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default GroupNameModal;\n","import React from \"react\";\nimport { useDroppable } from \"@dnd-kit/core\";\n\ntype DroppableProps = React.HTMLAttributes<HTMLDivElement> & {\n  id: string;\n  disabled: boolean;\n};\n\nfunction Droppable({ id, children, disabled, ...props }: DroppableProps) {\n  const { setNodeRef } = useDroppable({ id, disabled });\n\n  return (\n    <div ref={setNodeRef} {...props}>\n      {children}\n    </div>\n  );\n}\n\nDroppable.defaultProps = {\n  disabled: false,\n};\n\nexport default Droppable;\n","import React, { useState, useRef } from \"react\";\nimport { Box, Close, Grid, useThemeUI, IconButton, Text, Flex } from \"theme-ui\";\nimport { useSpring, animated, config } from \"react-spring\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport SimpleBar from \"simplebar-react\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { UNGROUP_ID, ADD_TO_MAP_ID } from \"../../contexts/TileDragContext\";\n\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\n\nimport ChangeNicknameIcon from \"../../icons/ChangeNicknameIcon\";\n\nimport GroupNameModal from \"../../modals/GroupNameModal\";\n\nimport { renameGroup } from \"../../helpers/group\";\n\nimport Droppable from \"../drag/Droppable\";\nimport { Group } from \"../../types/Group\";\n\ntype TilesOverlayProps = {\n  modalSize: { width: number; height: number };\n  children: React.ReactNode;\n};\n\nfunction TilesOverlay({ modalSize, children }: TilesOverlayProps) {\n  const {\n    groups,\n    openGroupId,\n    onGroupClose,\n    onClearSelection,\n    onGroupsChange,\n  } = useGroup();\n\n  const { theme } = useThemeUI();\n\n  const layout = useResponsiveLayout();\n\n  const openAnimation = useSpring({\n    opacity: openGroupId ? 1 : 0,\n    transform: openGroupId ? \"scale(1)\" : \"scale(0.99)\",\n    config: config.gentle,\n  });\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [containerSize, setContinerSize] = useState({ width: 0, height: 0 });\n  function handleContainerResize(width?: number, height?: number) {\n    if (width && height) {\n      const size = Math.min(width, height) - 16;\n      setContinerSize({ width: size, height: size });\n    }\n  }\n\n  const [isGroupNameModalOpen, setIsGroupNameModalOpen] = useState(false);\n  function handleGroupNameChange(name: string) {\n    if (openGroupId) {\n      onGroupsChange(renameGroup(groups, openGroupId, name));\n      setIsGroupNameModalOpen(false);\n    }\n  }\n\n  const group = groups.find((group: Group) => group.id === openGroupId);\n\n  if (!openGroupId) {\n    return null;\n  }\n\n  const groupName = group && group.type === \"group\" && group.name;\n\n  return (\n    <>\n      <Box\n        sx={{\n          position: \"absolute\",\n          width: \"100%\",\n          height: \"100%\",\n          top: 0,\n        }}\n        bg=\"overlay\"\n        ref={containerRef}\n      />\n      <ReactResizeDetector\n        handleWidth\n        handleHeight\n        onResize={handleContainerResize}\n        targetRef={containerRef}\n      >\n        <animated.div\n          style={{\n            ...openAnimation,\n            position: \"absolute\",\n            width: \"100%\",\n            height: \"100%\",\n            top: 0,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            cursor: \"pointer\",\n            pointerEvents: openGroupId ? undefined : \"none\",\n          }}\n          onClick={() => openGroupId && onGroupClose()}\n        >\n          <Box\n            sx={{\n              width: containerSize.width,\n              height: containerSize.height,\n              borderRadius: \"8px\",\n              border: \"1px solid\",\n              borderColor: \"border\",\n              cursor: \"default\",\n              display: \"flex\",\n              justifyContent: \"flex-start\",\n              alignItems: \"center\",\n              position: \"relative\",\n              flexDirection: \"column\",\n            }}\n            bg=\"background\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <Flex my={1} sx={{ position: \"relative\" }}>\n              <Text as=\"p\" my=\"2px\">\n                {groupName}\n              </Text>\n              <IconButton\n                sx={{\n                  width: \"24px\",\n                  height: \"24px\",\n                  position: groupName ? \"absolute\" : \"relative\",\n                  left: groupName ? \"100%\" : 0,\n                }}\n                title=\"Edit Group\"\n                aria-label=\"Edit Group\"\n                onClick={() => setIsGroupNameModalOpen(true)}\n              >\n                <ChangeNicknameIcon />\n              </IconButton>\n            </Flex>\n            <SimpleBar\n              style={{\n                width: containerSize.width - 16,\n                height: containerSize.height - 48,\n                marginBottom: \"8px\",\n                backgroundColor: theme.colors?.muted as string,\n              }}\n              onClick={() => onClearSelection()}\n            >\n              <Grid\n                sx={{\n                  borderRadius: \"4px\",\n                  overflow: \"hidden\",\n                  position: \"relative\",\n                }}\n                gap={2}\n                columns={`repeat(${layout.groupGridColumns}, 1fr)`}\n                p={3}\n              >\n                <Droppable\n                  id={ADD_TO_MAP_ID}\n                  style={{\n                    position: \"absolute\",\n                    width: modalSize.width,\n                    height: `calc(100% + ${\n                      modalSize.height - containerSize.height + 48\n                    }px)`,\n                    left: `-${\n                      (modalSize.width - containerSize.width) / 2 + 8\n                    }px`,\n                    top: `-${\n                      (modalSize.height - containerSize.height) / 2 + 48\n                    }px`,\n                    zIndex: -1,\n                  }}\n                />\n                <Droppable\n                  id={UNGROUP_ID}\n                  style={{\n                    position: \"absolute\",\n                    top: 0,\n                    bottom: 0,\n                    left: 0,\n                    right: 0,\n                    zIndex: -1,\n                  }}\n                />\n                {children}\n              </Grid>\n            </SimpleBar>\n            <Close\n              onClick={() => onGroupClose()}\n              sx={{ position: \"absolute\", top: 0, right: 0 }}\n            />\n          </Box>\n        </animated.div>\n      </ReactResizeDetector>\n      <GroupNameModal\n        isOpen={isGroupNameModalOpen}\n        name={groupName || \"\"}\n        onSubmit={handleGroupNameChange}\n        onRequestClose={() => setIsGroupNameModalOpen(false)}\n      />\n    </>\n  );\n}\n\nexport default TilesOverlay;\n","import React from \"react\";\nimport { Grid, useThemeUI } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { ADD_TO_MAP_ID } from \"../../contexts/TileDragContext\";\n\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\n\nimport Droppable from \"../drag/Droppable\";\n\nfunction TilesContainer({ children }: { children: React.ReactNode }) {\n  const { onClearSelection } = useGroup();\n\n  const { theme } = useThemeUI();\n\n  const layout = useResponsiveLayout();\n\n  return (\n    <>\n      <SimpleBar\n        style={{\n          height: layout.tileContainerHeight,\n          backgroundColor: theme.colors?.muted as string,\n        }}\n        onClick={() => onClearSelection()}\n      >\n        <Grid\n          p={3}\n          pb={4}\n          sx={{\n            borderRadius: \"4px\",\n            overflow: \"hidden\",\n            position: \"relative\",\n          }}\n          gap={2}\n          columns={`repeat(${layout.tileGridColumns}, 1fr)`}\n        >\n          <Droppable\n            id={ADD_TO_MAP_ID}\n            style={{\n              position: \"absolute\",\n              top: 0,\n              bottom: 0,\n              left: 0,\n              right: 0,\n              zIndex: -1,\n            }}\n          />\n          {children}\n        </Grid>\n      </SimpleBar>\n    </>\n  );\n}\n\nexport default TilesContainer;\n","function AddIcon({ large }: { large: boolean }) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height={large ? \"32\" : \"24\"}\n      viewBox=\"0 0 24 24\"\n      width={large ? \"32\" : \"24\"}\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1z\" />\n    </svg>\n  );\n}\n\nAddIcon.defaultProps = { large: false };\n\nexport default AddIcon;\n","function SelectMultipleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM8 17h8c.55 0 1-.45 1-1V8c0-.55-.45-1-1-1H8c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zm1-8h6v6H9V9z\" />\n    </svg>\n  );\n}\n\nexport default SelectMultipleIcon;\n","function SelectSingleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-1 14H7c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h10c.55 0 1 .45 1 1v10c0 .55-.45 1-1 1z\" />\n    </svg>\n  );\n}\n\nexport default SelectSingleIcon;\n","function SearchIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\" />\n    </svg>\n  );\n}\n\nexport default SearchIcon;\n","import { Box, Input, InputProps } from \"theme-ui\";\n\nimport SearchIcon from \"../icons/SearchIcon\";\n\nfunction Search(props: InputProps) {\n  return (\n    <Box sx={{ position: \"relative\", flexGrow: 1 }}>\n      <Input\n        sx={{\n          borderRadius: \"0\",\n          border: \"none\",\n          borderRight: \"1px solid\",\n          \":focus\": {\n            outline: \"none\",\n          },\n          paddingRight: \"36px\",\n        }}\n        placeholder=\"Search\"\n        {...props}\n      />\n      <Box\n        sx={{\n          position: \"absolute\",\n          right: \"8px\",\n          top: \"50%\",\n          transform: \"translateY(-50%)\",\n          height: \"24px\",\n          width: \"24px\",\n          pointerEvents: \"none\",\n        }}\n      >\n        <SearchIcon />\n      </Box>\n    </Box>\n  );\n}\n\nexport default Search;\n","import { Flex, IconButton } from \"theme-ui\";\n\nimport AddIcon from \"../../icons/AddIcon\";\nimport SelectMultipleIcon from \"../../icons/SelectMultipleIcon\";\nimport SelectSingleIcon from \"../../icons/SelectSingleIcon\";\n\nimport Search from \"../Search\";\nimport RadioIconButton from \"../RadioIconButton\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\n\ntype TileActionBarProps = {\n  onAdd: () => void;\n  addTitle: string;\n};\n\nfunction TileActionBar({ onAdd, addTitle }: TileActionBarProps) {\n  const {\n    selectMode,\n    onSelectModeChange,\n    onClearSelection,\n    filter,\n    onFilterChange,\n  } = useGroup();\n\n  return (\n    <Flex\n      bg=\"muted\"\n      sx={{\n        border: \"1px solid\",\n        borderColor: \"text\",\n        borderRadius: \"4px\",\n        alignItems: \"center\",\n        \":focus-within\": {\n          outline: \"1px auto\",\n          outlineColor: \"primary\",\n          outlineOffset: \"0px\",\n        },\n      }}\n      onFocus={() => onClearSelection()}\n    >\n      <Search value={filter} onChange={(e) => onFilterChange(e.target.value)} />\n      <Flex\n        mr={1}\n        px={1}\n        sx={{\n          borderRight: \"1px solid\",\n          borderColor: \"text\",\n          height: \"36px\",\n          alignItems: \"center\",\n        }}\n      >\n        <RadioIconButton\n          title=\"Select Single\"\n          onClick={() => onSelectModeChange(\"single\")}\n          isSelected={selectMode === \"single\"}\n        >\n          <SelectSingleIcon />\n        </RadioIconButton>\n        <RadioIconButton\n          title=\"Select Multiple\"\n          onClick={() => onSelectModeChange(\"multiple\")}\n          isSelected={selectMode === \"multiple\" || selectMode === \"range\"}\n        >\n          <SelectMultipleIcon />\n        </RadioIconButton>\n      </Flex>\n      <IconButton onClick={onAdd} aria-label={addTitle} title={addTitle} mr={1}>\n        <AddIcon />\n      </IconButton>\n    </Flex>\n  );\n}\n\nexport default TileActionBar;\n","const imageMimeByExt: Record<string, string> = {\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  png: \"image/png\",\n  webp: \"image/webp\",\n  gif: \"image/gif\",\n  bmp: \"image/bmp\",\n  svg: \"image/svg+xml\",\n};\n\nexport function getFileNameFromUrl(url: string, fallback: string) {\n  try {\n    const { pathname } = new URL(url);\n    const segments = pathname.split(\"/\").filter(Boolean);\n    if (segments.length > 0) {\n      return decodeURIComponent(segments[segments.length - 1]);\n    }\n  } catch (error) {\n    // Fallback below\n  }\n  return fallback;\n}\n\nexport function guessImageMimeFromUrl(\n  url: string,\n  fallback = \"image/png\"\n): string {\n  try {\n    const { pathname } = new URL(url);\n    const match = pathname.toLowerCase().match(/\\.([a-z0-9]+)$/);\n    if (match) {\n      const ext = match[1];\n      return imageMimeByExt[ext] || fallback;\n    }\n  } catch (error) {\n    // Fallback below\n  }\n  return fallback;\n}\n","import { v4 as uuid } from \"uuid\";\nimport Case from \"case\";\n\nimport blobToBuffer from \"./blobToBuffer\";\nimport { resizeImage, createThumbnail, imageToWebp } from \"./image\";\nimport { getFileNameFromUrl, guessImageMimeFromUrl } from \"./url\";\nimport {\n  getGridDefaultInset,\n  getGridSizeFromImage,\n  gridSizeVaild,\n} from \"./grid\";\nimport Vector2 from \"./Vector2\";\n\nimport { Map, FileMapResolutions, FileMap } from \"../types/Map\";\nimport { Asset } from \"../types/Asset\";\n\ntype Resolution = {\n  size: number;\n  quality: number;\n  id: \"low\" | \"medium\" | \"high\" | \"ultra\";\n};\n\nconst webpMime = \"image/webp\";\n\nconst mapResolutions: Resolution[] = [\n  {\n    size: 30, // Pixels per grid\n    quality: 0.5, // JPEG compression quality\n    id: \"low\",\n  },\n  { size: 70, quality: 0.6, id: \"medium\" },\n  { size: 140, quality: 0.7, id: \"high\" },\n  { size: 300, quality: 0.8, id: \"ultra\" },\n];\n\nfunction clampQuality(value: number) {\n  if (Number.isNaN(value)) {\n    return 0.8;\n  }\n  return Math.min(1, Math.max(0.1, value));\n}\n\nfunction scaleResolutionQuality(baseQuality: number, resolutionQuality: number) {\n  const scale = baseQuality / 0.8;\n  return clampQuality(resolutionQuality * scale);\n}\n\n/**\n * Get the asset id of the preview file to send for a map\n */\nexport function getMapPreviewAsset(map: Map): string | undefined {\n  if (map.type === \"file\") {\n    const res = map.resolutions;\n    switch (map.quality) {\n      case \"low\":\n        return;\n      case \"medium\":\n        return res.low;\n      case \"high\":\n        return res.medium;\n      case \"ultra\":\n        return res.medium;\n      case \"original\":\n        if (res.medium) {\n          return res.medium;\n        } else if (res.low) {\n          return res.low;\n        }\n        return;\n      default:\n        return;\n    }\n  }\n}\n\nexport async function createMapFromFile(\n  file: File,\n  userId: string,\n  compressionQuality = 0.8\n): Promise<{ map: Map; assets: Asset[] }> {\n  let image = new Image();\n\n  const buffer = await blobToBuffer(file);\n  // Copy file to avoid permissions issues\n  const blob = new Blob([buffer]);\n  // Create and load the image temporarily to get its dimensions\n  const url = URL.createObjectURL(blob);\n\n  return new Promise((resolve, reject) => {\n    image.onload = async function () {\n      const normalizedQuality = clampQuality(compressionQuality);\n      // Find name and grid size\n      let gridSize;\n      let name = \"Unknown Map\";\n      if (file.name) {\n        if (file.name.matchAll) {\n          // Match against a regex to find the grid size in the file name\n          // e.g. Cave 22x23 will return [[\"22x22\", \"22\", \"x\", \"23\"]]\n          const gridMatches = [...file.name.matchAll(/(\\d+) ?(x|X) ?(\\d+)/g)];\n          for (let match of gridMatches) {\n            const matchX = parseInt(match[1]);\n            const matchY = parseInt(match[3]);\n            if (\n              !isNaN(matchX) &&\n              !isNaN(matchY) &&\n              gridSizeVaild(matchX, matchY)\n            ) {\n              gridSize = { x: matchX, y: matchY };\n            }\n          }\n        }\n\n        if (!gridSize) {\n          gridSize = await getGridSizeFromImage(image);\n        }\n\n        // Remove file extension\n        name = file.name.replace(/\\.[^/.]+$/, \"\");\n        // Removed grid size expression\n        name = name.replace(/(\\[ ?|\\( ?)?\\d+ ?(x|X) ?\\d+( ?\\]| ?\\))?/, \"\");\n        // Clean string\n        name = name.replace(/ +/g, \" \");\n        name = name.trim();\n        // Capitalize and remove underscores\n        name = Case.capital(name);\n      }\n\n      if (!gridSize) {\n        gridSize = { x: 22, y: 22 };\n      }\n\n      let assets: Asset[] = [];\n\n      // Create resolutions\n      const resolutions: FileMapResolutions = {};\n      for (let resolution of mapResolutions) {\n        const resolutionPixelSize = Vector2.multiply(gridSize, resolution.size);\n        if (\n          image.width >= resolutionPixelSize.x &&\n          image.height >= resolutionPixelSize.y\n        ) {\n          const targetQuality = scaleResolutionQuality(\n            normalizedQuality,\n            resolution.quality\n          );\n          const resized = await resizeImage(\n            image,\n            Vector2.componentMax(resolutionPixelSize),\n            webpMime,\n            targetQuality\n          );\n          const resolvedImage =\n            resized ??\n            (await resizeImage(\n              image,\n              Vector2.componentMax(resolutionPixelSize),\n              file.type,\n              resolution.quality\n            ));\n          if (resolvedImage) {\n            const assetId = uuid();\n            resolutions[resolution.id] = assetId;\n            const asset = {\n              ...resolvedImage,\n              id: assetId,\n              owner: userId,\n              source: \"local\" as const,\n              size: resolvedImage.file.length,\n              originalName: file.name,\n            };\n            assets.push(asset);\n          }\n        }\n      }\n      // Create thumbnail\n      const thumbnailImage =\n        (await createThumbnail(\n          image,\n          webpMime,\n          300,\n          normalizedQuality\n        )) ?? (await createThumbnail(image, file.type));\n      const thumbnailId = uuid();\n      if (thumbnailImage) {\n        const thumbnail = {\n          ...thumbnailImage,\n          id: thumbnailId,\n          owner: userId,\n          source: \"local\" as const,\n          size: thumbnailImage.file.length,\n          originalName: file.name,\n        };\n        assets.push(thumbnail);\n      }\n\n      const compressedImage = await imageToWebp(image, normalizedQuality);\n      const fileAsset = {\n        id: uuid(),\n        file: compressedImage?.file ?? buffer,\n        width: compressedImage?.width ?? image.width,\n        height: compressedImage?.height ?? image.height,\n        mime: compressedImage?.mime ?? file.type,\n        owner: userId,\n        size: compressedImage?.file.length ?? buffer.byteLength,\n        originalName: file.name,\n        source: \"local\" as const,\n      };\n      assets.push(fileAsset);\n\n      const map: FileMap = {\n        name,\n        resolutions,\n        file: fileAsset.id,\n        thumbnail: thumbnailId,\n        type: \"file\",\n        grid: {\n          size: gridSize,\n          inset: getGridDefaultInset(\n            { size: gridSize, type: \"square\" },\n            image.width,\n            image.height\n          ),\n          type: \"square\",\n          measurement: {\n            type: \"chebyshev\",\n            scale: \"5ft\",\n          },\n        },\n        width: image.width,\n        height: image.height,\n        id: uuid(),\n        created: Date.now(),\n        lastModified: Date.now(),\n        owner: userId,\n        showGrid: false,\n        snapToGrid: true,\n        quality: \"original\",\n      };\n\n      URL.revokeObjectURL(url);\n      resolve({ map, assets });\n    };\n    image.onerror = reject;\n    image.src = url;\n  });\n}\n\nexport async function createMapFromUrl(\n  url: string,\n  userId: string\n): Promise<{ map: Map; assets: Asset[] }> {\n  if (!url) {\n    return Promise.reject();\n  }\n  function loadImage(source: string, useCors: boolean) {\n    return new Promise<HTMLImageElement>((resolve, reject) => {\n      const img = new Image();\n      if (useCors) {\n        img.crossOrigin = \"anonymous\";\n      }\n      img.onload = () => resolve(img);\n      img.onerror = reject;\n      img.src = source;\n    });\n  }\n\n  const image =\n    (await loadImage(url, true).catch(() => loadImage(url, false))) as\n      | HTMLImageElement\n      | undefined;\n  if (!image) {\n    return Promise.reject();\n  }\n  const fileName = getFileNameFromUrl(url, `remote-${Date.now()}`);\n\n  let gridSize;\n  let name = \"Unknown Map\";\n  if (fileName) {\n    if (fileName.matchAll) {\n      const gridMatches = [...fileName.matchAll(/(\\d+) ?(x|X) ?(\\d+)/g)];\n      for (let match of gridMatches) {\n        const matchX = parseInt(match[1]);\n        const matchY = parseInt(match[3]);\n        if (!isNaN(matchX) && !isNaN(matchY) && gridSizeVaild(matchX, matchY)) {\n          gridSize = { x: matchX, y: matchY };\n        }\n      }\n    }\n\n    if (!gridSize) {\n      try {\n        gridSize = await getGridSizeFromImage(image);\n      } catch (error) {\n        // Fallback below\n      }\n    }\n\n    name = fileName.replace(/\\.[^/.]+$/, \"\");\n    name = name.replace(/(\\[ ?|\\( ?)?\\d+ ?(x|X) ?\\d+( ?\\]| ?\\))?/, \"\");\n    name = name.replace(/ +/g, \" \");\n    name = name.trim();\n    name = Case.capital(name);\n  }\n\n  if (!gridSize) {\n    gridSize = { x: 22, y: 22 };\n  }\n\n  const mime = guessImageMimeFromUrl(url);\n  const fileAsset = {\n    id: uuid(),\n    file: new Uint8Array(),\n    width: image.width,\n    height: image.height,\n    mime,\n    owner: userId,\n    remoteUrl: url,\n    originalName: fileName,\n    source: \"external\" as const,\n  };\n\n  const map: FileMap = {\n    name,\n    resolutions: {},\n    file: fileAsset.id,\n    thumbnail: fileAsset.id,\n    type: \"file\",\n    grid: {\n      size: gridSize,\n      inset: getGridDefaultInset(\n        { size: gridSize, type: \"square\" },\n        image.width,\n        image.height\n      ),\n      type: \"square\",\n      measurement: {\n        type: \"chebyshev\",\n        scale: \"5ft\",\n      },\n    },\n    width: image.width,\n    height: image.height,\n    id: uuid(),\n    created: Date.now(),\n    lastModified: Date.now(),\n    owner: userId,\n    showGrid: false,\n    snapToGrid: true,\n    quality: \"original\",\n  };\n\n  return { map, assets: [fileAsset] };\n}\n","import { useRef, useState, useEffect } from \"react\";\nimport { Flex, Label, Box } from \"theme-ui\";\nimport { useToasts } from \"react-toast-notifications\";\nimport ReactResizeDetector from \"react-resize-detector\";\n\nimport EditMapModal from \"./EditMapModal\";\nimport ConfirmModal from \"./ConfirmModal\";\n\nimport Modal from \"../components/Modal\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\nimport DatabaseDisabledMessage from \"../components/DatabaseDisabledMessage\";\n\nimport ImageDrop from \"../components/image/ImageDrop\";\n\nimport MapTiles from \"../components/map/MapTiles\";\nimport MapEditBar from \"../components/map/MapEditBar\";\nimport SelectMapSelectButton from \"../components/map/SelectMapSelectButton\";\n\nimport TilesOverlay from \"../components/tile/TilesOverlay\";\nimport TilesContainer from \"../components/tile/TilesContainer\";\nimport TileActionBar from \"../components/tile/TileActionBar\";\n\nimport { findGroup, getItemNames } from \"../helpers/group\";\nimport { createMapFromFile } from \"../helpers/map\";\n\nimport useResponsiveLayout from \"../hooks/useResponsiveLayout\";\nimport useSetting from \"../hooks/useSetting\";\n\nimport { useMapData } from \"../contexts/MapDataContext\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useAssets } from \"../contexts/AssetsContext\";\nimport { GroupProvider } from \"../contexts/GroupContext\";\nimport { TileDragProvider } from \"../contexts/TileDragContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\n\nimport { Map } from \"../types/Map\";\nimport {\n  MapChangeEventHandler,\n  MapResetEventHandler,\n  RequestCloseEventHandler,\n} from \"../types/Events\";\n\ntype SelectMapProps = {\n  isOpen: boolean;\n  onDone: RequestCloseEventHandler;\n  onMapChange: MapChangeEventHandler;\n  onMapReset: MapResetEventHandler;\n  currentMap: Map | null;\n};\n\nfunction SelectMapModal({\n  isOpen,\n  onDone,\n  onMapChange,\n  onMapReset,\n  // The map currently being view in the map screen\n  currentMap,\n}: SelectMapProps) {\n  const { addToast } = useToasts();\n\n  const { databaseStatus } = useDatabase();\n\n  const userId = useUserId();\n  const {\n    maps,\n    mapStates,\n    mapGroups,\n    addMap,\n    mapsLoading,\n    getMapState,\n    getMap,\n    updateMapGroups,\n    updateMap,\n    updateMapState,\n    mapsById,\n  } = useMapData();\n  const { addAssets } = useAssets();\n  const [imageCompressionQuality] = useSetting<number>(\n    \"asset.compressionQuality\"\n  );\n\n  // Get map names for group filtering\n  const [mapNames, setMapNames] = useState(getItemNames(maps));\n  useEffect(() => {\n    setMapNames(getItemNames(maps));\n  }, [maps]);\n\n  /**\n   * Image Upload\n   */\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [isLargeImageWarningModalOpen, setShowLargeImageWarning] =\n    useState(false);\n  const largeImageWarningFiles = useRef<File[]>();\n\n  async function handleImagesUpload(files: File[]) {\n    if (navigator.storage) {\n      // Attempt to enable persistant storage\n      await navigator.storage.persist();\n    }\n\n    let mapFiles = [];\n    for (let file of files) {\n      if (file.size > 5e7) {\n        addToast(`Unable to import map ${file.name} as it is over 50MB`);\n      } else {\n        mapFiles.push(file);\n      }\n    }\n\n    // Any file greater than 20MB\n    if (mapFiles.some((file) => file.size > 2e7)) {\n      largeImageWarningFiles.current = mapFiles;\n      setShowLargeImageWarning(true);\n      return;\n    }\n\n    for (let file of mapFiles) {\n      await handleImageUpload(file);\n    }\n\n    clearFileInput();\n  }\n\n  function clearFileInput() {\n    // Set file input to null to allow adding the same image 2 times in a row\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  }\n\n  function openImageDialog() {\n    if (fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  }\n\n  function handleLargeImageWarningCancel() {\n    largeImageWarningFiles.current = undefined;\n    setShowLargeImageWarning(false);\n    clearFileInput();\n  }\n\n  async function handleLargeImageWarningConfirm() {\n    setShowLargeImageWarning(false);\n    const files = largeImageWarningFiles.current;\n    if (files) {\n      for (let file of files) {\n        await handleImageUpload(file);\n      }\n    }\n    largeImageWarningFiles.current = undefined;\n    clearFileInput();\n  }\n\n  async function handleImageUpload(file: File) {\n    if (!userId) {\n      return;\n    }\n    setIsLoading(true);\n    try {\n      const compressionQuality = imageCompressionQuality ?? 0.8;\n      const { map, assets } = await createMapFromFile(\n        file,\n        userId,\n        compressionQuality\n      );\n      await addMap(map);\n      await addAssets(assets);\n    } catch (error) {\n      console.error(\"MAP_IMPORT_FAILED\", error);\n      addToast(\"\");\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  /**\n   * Modal Controls\n   */\n\n  async function handleClose() {\n    onDone();\n  }\n\n  /**\n   * Map Controls\n   */\n  async function handleMapSelect(mapId: string) {\n    if (isLoading) {\n      return;\n    }\n    if (mapId) {\n      setIsLoading(true);\n      const map = (await getMap(mapId)) || null;\n      const mapState = (await getMapState(mapId)) || null;\n      onMapChange(map, mapState);\n      setIsLoading(false);\n    } else {\n      onMapChange(null, null);\n    }\n    onDone();\n  }\n\n  const [editingMapId, setEditingMapId] = useState<string>();\n\n  const [isDraggingMap, setIsDraggingMap] = useState(false);\n\n  const [canAddDraggedMap, setCanAddDraggedMap] = useState(false);\n  function handleGroupsSelect(groupIds: string[]) {\n    if (groupIds.length === 1) {\n      // Only allow adding a map from dragging if there is a single group item selected\n      const group = findGroup(mapGroups, groupIds[0]);\n      setCanAddDraggedMap(group !== undefined && group.type === \"item\");\n    } else {\n      setCanAddDraggedMap(false);\n    }\n  }\n\n  function handleDragAdd(groupIds: string[]) {\n    if (groupIds.length === 1) {\n      handleMapSelect(groupIds[0]);\n    }\n  }\n\n  const layout = useResponsiveLayout();\n\n  const [modalSize, setModalSize] = useState({ width: 0, height: 0 });\n  function handleModalResize(width?: number, height?: number) {\n    if (width && height) {\n      setModalSize({ width, height });\n    }\n  }\n\n  const editingMap =\n    editingMapId && maps.find((map) => map.id === editingMapId);\n  const editingMapState =\n    editingMapId && mapStates.find((state) => state.mapId === editingMapId);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={handleClose}\n      style={{\n        content: { maxWidth: layout.modalSize, width: \"calc(100% - 16px)\" },\n      }}\n      shouldCloseOnEsc={!isDraggingMap}\n    >\n      <ImageDrop\n        onDrop={({ files }) => handleImagesUpload(files)}\n        dropText=\"Drop map to import\"\n      >\n        <input\n          onChange={(event) =>\n            event.target.files &&\n            handleImagesUpload(Array.from(event.target.files))\n          }\n          type=\"file\"\n          accept=\"image/jpeg, image/gif, image/png, image/webp\"\n          style={{ display: \"none\" }}\n          multiple\n          ref={fileInputRef}\n        />\n        <ReactResizeDetector\n          handleWidth\n          handleHeight\n          onResize={handleModalResize}\n          refreshMode=\"debounce\"\n        >\n          <GroupProvider\n            groups={mapGroups}\n            itemNames={mapNames}\n            onGroupsChange={updateMapGroups}\n            onGroupsSelect={handleGroupsSelect}\n            disabled={!isOpen}\n          >\n            <Flex\n              sx={{\n                flexDirection: \"column\",\n              }}\n            >\n              <Label pt={2} pb={1}>\n                Select or import a map\n              </Label>\n              <TileActionBar onAdd={openImageDialog} addTitle=\"Import Map(s)\" />\n              <Box sx={{ position: \"relative\" }}>\n                <TileDragProvider\n                  onDragAdd={(canAddDraggedMap && handleDragAdd) || undefined}\n                  onDragStart={() => setIsDraggingMap(true)}\n                  onDragEnd={() => setIsDraggingMap(false)}\n                  onDragCancel={() => setIsDraggingMap(false)}\n                >\n                  <TilesContainer>\n                    {databaseStatus === \"disabled\" && (\n                      <DatabaseDisabledMessage type=\"Map\" />\n                    )}\n                    <MapTiles\n                      mapsById={mapsById}\n                      onMapEdit={setEditingMapId}\n                      onMapSelect={handleMapSelect}\n                    />\n                  </TilesContainer>\n                </TileDragProvider>\n                <TileDragProvider\n                  onDragAdd={(canAddDraggedMap && handleDragAdd) || undefined}\n                  onDragStart={() => setIsDraggingMap(true)}\n                  onDragEnd={() => setIsDraggingMap(false)}\n                  onDragCancel={() => setIsDraggingMap(false)}\n                >\n                  <TilesOverlay modalSize={modalSize}>\n                    <MapTiles\n                      mapsById={mapsById}\n                      onMapEdit={setEditingMapId}\n                      onMapSelect={handleMapSelect}\n                      subgroup\n                    />\n                  </TilesOverlay>\n                </TileDragProvider>\n                <MapEditBar\n                  currentMap={currentMap}\n                  disabled={isLoading || !!editingMapId}\n                  onMapChange={onMapChange}\n                  onMapReset={onMapReset}\n                  onLoad={setIsLoading}\n                />\n              </Box>\n              <SelectMapSelectButton\n                onMapSelect={handleMapSelect}\n                disabled={isLoading}\n              />\n            </Flex>\n          </GroupProvider>\n        </ReactResizeDetector>\n      </ImageDrop>\n      <>{(isLoading || mapsLoading) && <LoadingOverlay bg=\"overlay\" />}</>\n      <>\n        {editingMap && editingMapState && (\n          <EditMapModal\n            isOpen={!!editingMapId}\n            onDone={() => setEditingMapId(undefined)}\n            map={editingMap}\n            mapState={editingMapState}\n            onUpdateMap={updateMap}\n            onUpdateMapState={updateMapState}\n          />\n        )}\n      </>\n      <ConfirmModal\n        isOpen={isLargeImageWarningModalOpen}\n        onRequestClose={handleLargeImageWarningCancel}\n        onConfirm={handleLargeImageWarningConfirm}\n        confirmText=\"Continue\"\n        label=\"Warning\"\n        description=\"An imported image is larger than 20MB, this may cause slowness. Continue?\"\n      />\n    </Modal>\n  );\n}\n\nexport default SelectMapModal;\n","function SelectMapIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-10.6-3.47l1.63 2.18 2.58-3.22c.2-.25.58-.25.78 0l2.96 3.7c.26.33.03.81-.39.81H9c-.41 0-.65-.47-.4-.8l2-2.67c.2-.26.6-.26.8 0zM2 7v13c0 1.1.9 2 2 2h13c.55 0 1-.45 1-1s-.45-1-1-1H5c-.55 0-1-.45-1-1V7c0-.55-.45-1-1-1s-1 .45-1 1z\" />\n    </svg>\n  );\n}\n\nexport default SelectMapIcon;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport SelectMapModal from \"../../modals/SelectMapModal\";\nimport SelectMapIcon from \"../../icons/SelectMapIcon\";\n\nimport { useMapData } from \"../../contexts/MapDataContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport {\n  MapChangeEventHandler,\n  MapResetEventHandler,\n} from \"../../types/Events\";\nimport { Map } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\n\ntype SelectMapButtonProps = {\n  onMapChange: MapChangeEventHandler;\n  onMapReset: MapResetEventHandler;\n  currentMap: Map | null;\n  currentMapState: MapState | null;\n  disabled: boolean;\n};\n\nfunction SelectMapButton({\n  onMapChange,\n  onMapReset,\n  currentMap,\n  currentMapState,\n  disabled,\n}: SelectMapButtonProps) {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  const { updateMapState } = useMapData();\n  const userId = useUserId();\n  function openModal() {\n    if (currentMapState && currentMap && currentMap.owner === userId) {\n      updateMapState(currentMapState.mapId, currentMapState);\n    }\n    setIsModalOpen(true);\n  }\n\n  function handleDone() {\n    setIsModalOpen(false);\n  }\n\n  return (\n    <>\n      <IconButton\n        aria-label=\"Select Map\"\n        title=\"Select Map\"\n        onClick={openModal}\n        disabled={disabled}\n      >\n        <SelectMapIcon />\n      </IconButton>\n      <SelectMapModal\n        isOpen={isModalOpen}\n        onDone={handleDone}\n        onMapChange={onMapChange}\n        onMapReset={onMapReset}\n        currentMap={currentMap}\n      />\n    </>\n  );\n}\n\nexport default SelectMapButton;\n","function FogBrushIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18 4V3c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V6h1v4h-9c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-9h7c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1h-2z\" />\n    </svg>\n  );\n}\n\nexport default FogBrushIcon;\n","function FogPolygonIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M15.858 20a1 1 0 110 2h-8a1 1 0 010-2h8zm-5-17.998v9.516a2 2 0 102 0V2.12l5.725 10.312a1 1 0 01.049.87l-.058.117-3.093 5.333a1 1 0 01-.865.498H8.941a1 1 0 01-.875-.516L5.125 13.41a1 1 0 01-.002-.965l5.735-10.443z\" />\n    </svg>\n  );\n}\n\nexport default FogPolygonIcon;\n","function FogRemoveIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M3.212 12.303c-1 1-1.182 2.455-.404 3.233l5.656 5.656c.778.778 2.233.596 3.233-.404l9.091-9.091c1-1 1.182-2.455.404-3.233l-5.656-5.656c-.778-.778-2.233-.596-3.233.404l-9.091 9.091zm6.667-2.424l4.242 4.242c.39.39.485.93.212 1.202l-3.96 3.96c-.272.272-.813.177-1.201-.212l-4.243-4.243c-.389-.388-.484-.93-.212-1.202l3.96-3.96c.272-.272.813-.176 1.202.213z\" />\n    </svg>\n  );\n}\n\nexport default FogRemoveIcon;\n","function FogRectangleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" />\n    </svg>\n  );\n}\n\nexport default FogRectangleIcon;\n","function FogToggleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12 4a7.49 7.49 0 017.35 6.04c2.6.18 4.65 2.32 4.65 4.96 0 2.76-2.24 5-5 5H6c-3.31 0-6-2.69-6-6 0-3.09 2.34-5.64 5.35-5.96A7.496 7.496 0 0112 4zm0 2a5.493 5.493 0 00-4.759 2.75l-.117.214-.496.951-1.067.114A3.994 3.994 0 002 14a4.005 4.005 0 003.8 3.995L6 18h6.042v-.103L12 6z\" />\n    </svg>\n  );\n}\n\nexport default FogToggleIcon;\n","function FogCutOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M2.52 11.1a4 4 0 016.08.5l12.36-5.96c.72-.35 1.6-.05 1.94.67l.02.04.02.05c.33.74.01 1.6-.72 1.96l-7.93 3.83-1.66 3.44a4 4 0 11-6.17 2.14 4 4 0 01-3.94-6.67zm6.37 6.37a2 2 0 102.82 2.83 2 2 0 00-2.82-2.83zm2.82-5.66c-.2.2-.2.51 0 .7.2.2.51.2.71 0 .2-.19.2-.5 0-.7a.5.5 0 00-.7 0zM9.3 14.6a4 4 0 01-.08.35l-.03.09a4 4 0 01.44-.1l.32-.66-.65.32zm8.54-13.3l.04.01a1.45 1.45 0 01.72 1.97l-1.54 3.18-4.25 1.9L15.88 2a1.5 1.5 0 011.96-.71zM3.94 12.52a2 2 0 102.83 2.83 2 2 0 00-2.83-2.83z\" />\n    </svg>\n  );\n}\n\nexport default FogCutOnIcon;\n","function FogCutOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M5.28 3.68l15.56 15.56a1 1 0 01-1.42 1.41l-6.21-6.21-.58 1.2a4 4 0 11-6.17 2.14A4 4 0 118.6 11.6l1.2-.58L3.87 5.1a1 1 0 111.41-1.4zm3.6 13.79a2 2 0 102.83 2.83 2 2 0 00-2.82-2.83zm-4.94-4.95a2 2 0 102.83 2.83 2 2 0 00-2.83-2.83zm6.01 1.76l-.65.32a4 4 0 01-.08.35l-.03.09a4 4 0 01.44-.1l.32-.66zM22.9 6.31l.02.04.02.05c.33.74.01 1.6-.72 1.96l-6.68 3.22-2.24-2.24 7.66-3.7c.72-.35 1.6-.05 1.94.67zM17.84 1.3l.04.01a1.45 1.45 0 01.72 1.97l-1.54 3.18-4.25 1.9L15.88 2a1.5 1.5 0 011.96-.71z\" />\n    </svg>\n  );\n}\n\nexport default FogCutOffIcon;\n","function FogPreviewOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 24H0V0h24z\" fill=\"none\" />\n      <path d=\"M12 6.5c2.76 0 5 2.24 5 5 0 .51-.1 1-.24 1.46l3.06 3.06c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l2.17 2.17c.47-.14.96-.24 1.47-.24zM2.71 3.16c-.39.39-.39 1.02 0 1.41l1.97 1.97C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.97-.3 4.31-.82l2.72 2.72c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L4.13 3.16c-.39-.39-1.03-.39-1.42 0zM12 16.5c-2.76 0-5-2.24-5-5 0-.77.18-1.5.49-2.14l1.57 1.57c-.03.18-.06.37-.06.57 0 1.66 1.34 3 3 3 .2 0 .38-.03.57-.07L14.14 16c-.65.32-1.37.5-2.14.5zm2.97-5.33c-.15-1.4-1.25-2.49-2.64-2.64l2.64 2.64z\" />\n    </svg>\n  );\n}\n\nexport default FogPreviewOffIcon;\n","function FogPreviewOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 24H0V0h24z\" fill=\"none\" />\n      <path d=\"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\" />\n    </svg>\n  );\n}\n\nexport default FogPreviewOnIcon;\n","function TokenShowIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\" />\n    </svg>\n  );\n}\n\nexport default TokenShowIcon;\n","import React, { useState, useEffect } from \"react\";\nimport { Box, Flex } from \"theme-ui\";\n\nimport RadioIconButton from \"../../RadioIconButton\";\n\nexport type Tool = {\n  id: string;\n  title: string;\n  isSelected: boolean;\n  icon: React.ReactNode;\n  disabled?: boolean;\n};\n\ntype ToolSectionProps = {\n  collapse: boolean;\n  tools: Tool[];\n  onToolClick: (tool: Tool) => void;\n};\n\n// Section of map tools with the option to collapse into a vertical list\nfunction ToolSection({ collapse, tools, onToolClick }: ToolSectionProps) {\n  const [showMore, setShowMore] = useState(false);\n  const [collapsedTool, setCollapsedTool] = useState<Tool>();\n\n  useEffect(() => {\n    const selectedTool = tools.find((tool) => tool.isSelected);\n    if (selectedTool) {\n      setCollapsedTool(selectedTool);\n    } else {\n      // No selected tool, deselect if we have a tool or get the first tool if not\n      setCollapsedTool((prevTool) =>\n        prevTool ? { ...prevTool, isSelected: false } : tools[0]\n      );\n    }\n  }, [tools]);\n\n  function handleToolClick(tool: Tool) {\n    if (collapse && tool.isSelected) {\n      setShowMore(!showMore);\n    } else if (collapse && !tool.isSelected) {\n      setShowMore(false);\n    }\n    onToolClick(tool);\n  }\n\n  function renderTool(tool: Tool) {\n    return (\n      <RadioIconButton\n        title={tool.title}\n        onClick={() => handleToolClick(tool)}\n        key={tool.id}\n        isSelected={tool.isSelected}\n        disabled={tool.disabled}\n      >\n        {tool.icon}\n      </RadioIconButton>\n    );\n  }\n\n  if (collapse) {\n    if (!collapsedTool) {\n      return null;\n    }\n    return (\n      <Box sx={{ position: \"relative\" }}>\n        {renderTool(collapsedTool)}\n        {/* Render chevron when more tools is available */}\n        <Box\n          sx={{\n            position: \"absolute\",\n            width: 0,\n            height: 0,\n            borderTop: \"4px solid\",\n            borderTopColor: \"text\",\n            borderLeft: \"4px solid transparent\",\n            borderRight: \"4px solid transparent\",\n            transform: \"translate(0, -4px) rotate(-45deg)\",\n            bottom: 0,\n            right: 0,\n            pointerEvents: \"none\",\n          }}\n        />\n        {showMore && (\n          <Flex\n            sx={{\n              position: \"absolute\",\n              top: \"40px\",\n              left: \"50%\",\n              transform: \"translateX(-50%)\",\n              flexDirection: \"column\",\n              borderRadius: \"4px\",\n            }}\n            bg=\"overlay\"\n            p={2}\n          >\n            {tools.filter((tool) => !tool.isSelected).map(renderTool)}\n          </Flex>\n        )}\n      </Box>\n    );\n  } else {\n    return (\n      <>\n        {tools.map((tool) => (\n          <RadioIconButton\n            title={tool.title}\n            onClick={() => handleToolClick(tool)}\n            key={tool.id}\n            isSelected={tool.isSelected}\n            disabled={tool.disabled}\n          >\n            {tool.icon}\n          </RadioIconButton>\n        ))}\n      </>\n    );\n  }\n}\n\nToolSection.defaultProps = {\n  collapse: false,\n};\n\nexport default ToolSection;\n","function EraseAllIcon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zm3.17-7.83c.39-.39 1.02-.39 1.41 0L12 12.59l1.42-1.42c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41L13.41 14l1.42 1.42c.39.39.39 1.02 0 1.41-.39.39-1.02.39-1.41 0L12 15.41l-1.42 1.42c-.39.39-1.02.39-1.41 0-.39-.39-.39-1.02 0-1.41L10.59 14l-1.42-1.42c-.39-.38-.39-1.02 0-1.41zM15.5 4l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z\" />\n    </svg>\n  );\n}\n\nexport default EraseAllIcon;\n","import React, { useEffect, useState } from \"react\";\nimport Modal from \"react-modal\";\nimport { useThemeUI } from \"theme-ui\";\nimport CSS from \"csstype\";\n\nimport { RequestCloseEventHandler } from \"../../types/Events\";\nimport { useInteractionEmitter } from \"../../contexts/MapInteractionContext\";\n\ntype MapMenuProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onModalContent: (instance: HTMLDivElement) => void;\n  top: number | string;\n  left: number | string;\n  bottom: number | string;\n  right: number | string;\n  children: React.ReactNode;\n  style: React.CSSProperties;\n  excludeNode: Node | null;\n};\n\nfunction MapMenu({\n  isOpen,\n  onRequestClose,\n  onModalContent,\n  top,\n  left,\n  bottom,\n  right,\n  children,\n  style,\n  // A node to exclude from the pointer event for closing\n  excludeNode,\n}: MapMenuProps) {\n  // Save modal node in state to ensure that the pointer listeners\n  // are removed if the open state changed not from the onRequestClose\n  // callback\n  const [modalContentNode, setModalContentNode] = useState<Node | null>(null);\n\n  const interactionEmitter = useInteractionEmitter();\n\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n    function handleDragMove() {\n      onRequestClose();\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleDragMove);\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleDragMove);\n    };\n  });\n\n  useEffect(() => {\n    // Close modal if interacting with any other element\n    function handleInteraction(event: Event) {\n      const path = event.composedPath();\n      if (\n        modalContentNode &&\n        !path.includes(modalContentNode) &&\n        !(excludeNode && path.includes(excludeNode)) &&\n        !(event.target instanceof HTMLTextAreaElement)\n      ) {\n        onRequestClose();\n        document.body.removeEventListener(\"pointerup\", handleInteraction);\n        document.body.removeEventListener(\"wheel\", handleInteraction);\n      }\n    }\n\n    if (modalContentNode) {\n      document.body.addEventListener(\"pointerup\", handleInteraction);\n      // Check for wheel event to close modal as well\n      document.body.addEventListener(\"wheel\", handleInteraction);\n    }\n\n    return () => {\n      if (modalContentNode) {\n        document.body.removeEventListener(\"pointerup\", handleInteraction);\n        document.body.removeEventListener(\"wheel\", handleInteraction);\n      }\n    };\n  }, [modalContentNode, excludeNode, onRequestClose]);\n\n  function handleModalContent(node: HTMLDivElement) {\n    setModalContentNode(node);\n    onModalContent(node);\n  }\n\n  const { theme } = useThemeUI();\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{\n        overlay: { top: \"0\", bottom: \"initial\" },\n        content: {\n          backgroundColor: theme.colors?.overlay as CSS.Property.Color,\n          top,\n          left,\n          right,\n          bottom,\n          padding: 0,\n          borderRadius: \"4px\",\n          border: \"none\",\n          ...style,\n        },\n      }}\n      contentRef={handleModalContent}\n    >\n      {children}\n    </Modal>\n  );\n}\n\nMapMenu.defaultProps = {\n  onModalContent: () => {},\n  top: \"initial\",\n  left: \"initial\",\n  right: \"initial\",\n  bottom: \"initial\",\n  style: {},\n  excludeNode: null,\n};\n\nexport default MapMenu;\n","import { useEffect, useRef, useState } from \"react\";\nimport { Button, IconButton } from \"theme-ui\";\n\nimport EraseAllIcon from \"../../../icons/EraseAllIcon\";\nimport MapMenu from \"../../map/MapMenu\";\n\ntype EraseAllButtonProps = {\n  onToolAction: (action: string) => void;\n  disabled: boolean;\n};\n\nfunction EraseAllButton({ onToolAction, disabled }: EraseAllButtonProps) {\n  const [isEraseAllConfirmOpen, setIsEraseAllConfirmOpen] = useState(false);\n\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const [menuLeft, setMenuLeft] = useState(0);\n  const [menuTop, setMenuTop] = useState(0);\n  useEffect(() => {\n    const button = buttonRef.current;\n    if (isEraseAllConfirmOpen && button) {\n      const rect = button.getBoundingClientRect();\n      setMenuLeft(rect.left + rect.width / 2);\n      setMenuTop(rect.bottom + 8);\n    }\n  }, [isEraseAllConfirmOpen]);\n\n  return (\n    <>\n      <IconButton\n        aria-label=\"Erase All\"\n        title=\"Erase All\"\n        onClick={() => setIsEraseAllConfirmOpen(true)}\n        disabled={disabled}\n        ref={buttonRef}\n      >\n        <EraseAllIcon />\n      </IconButton>\n      <MapMenu\n        isOpen={isEraseAllConfirmOpen}\n        onRequestClose={() => setIsEraseAllConfirmOpen(false)}\n        left={menuLeft}\n        top={menuTop}\n        style={{ transform: \"translateX(-50%)\" }}\n      >\n        <Button\n          disabled={disabled}\n          onClick={() => {\n            setIsEraseAllConfirmOpen(false);\n            onToolAction(\"eraseAll\");\n          }}\n        >\n          Erase All\n        </Button>\n      </MapMenu>\n    </>\n  );\n}\n\nexport default EraseAllButton;\n","import { useState } from \"react\";\nimport { Box, Slider as ThemeSlider, SliderProps } from \"theme-ui\";\n\ntype SliderModalProps = SliderProps & {\n  min: number;\n  max: number;\n  value: number;\n  labelFunc: (value: number) => string;\n};\n\nfunction Slider({\n  min,\n  max,\n  value,\n  ml,\n  mr,\n  labelFunc,\n  ...rest\n}: SliderModalProps) {\n  const percentValue = ((value - min) * 100) / (max - min);\n\n  const [labelVisible, setLabelVisible] = useState<boolean>(false);\n\n  return (\n    <Box sx={{ position: \"relative\" }} ml={ml} mr={mr}>\n      {labelVisible && (\n        <Box\n          sx={{\n            position: \"absolute\",\n            top: \"-42px\",\n          }}\n          style={{\n            left: `calc(${percentValue}% + ${-8 - percentValue * 0.15}px)`,\n          }}\n        >\n          <Box\n            sx={{\n              width: \"32px\",\n              height: \"32px\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              borderRadius: \"50% 50% 50% 0%\",\n              transform: \"rotate(-45deg)\",\n            }}\n            bg=\"primary\"\n          >\n            <Box\n              sx={{\n                fontFamily: \"body2\",\n                fontWeight: \"caption\",\n                fontSize: 0,\n                transform: \"rotate(45deg)\",\n              }}\n            >\n              {labelFunc(value)}\n            </Box>\n          </Box>\n        </Box>\n      )}\n      <ThemeSlider\n        min={min}\n        max={max}\n        value={value}\n        onMouseDown={() => setLabelVisible(true)}\n        onMouseUp={() => setLabelVisible(false)}\n        onTouchStart={() => setLabelVisible(true)}\n        onTouchEnd={() => setLabelVisible(false)}\n        {...rest}\n      />\n    </Box>\n  );\n}\n\nSlider.defaultProps = {\n  min: 0,\n  max: 1,\n  value: 0,\n  ml: 0,\n  mr: 0,\n  labelFunc: (value: number) => value,\n};\n\nexport default Slider;\n","import { Flex, IconButton, Text } from \"theme-ui\";\nimport { useMedia } from \"react-media\";\n\nimport RadioIconButton from \"../RadioIconButton\";\n\nimport FogBrushIcon from \"../../icons/FogBrushIcon\";\nimport FogPolygonIcon from \"../../icons/FogPolygonIcon\";\nimport FogRemoveIcon from \"../../icons/FogRemoveIcon\";\nimport FogRectangleIcon from \"../../icons/FogRectangleIcon\";\nimport FogToggleIcon from \"../../icons/FogToggleIcon\";\nimport FogCutOnIcon from \"../../icons/FogCutOnIcon\";\nimport FogCutOffIcon from \"../../icons/FogCutOffIcon\";\nimport FogPreviewOffIcon from \"../../icons/FogPreviewOffIcon\";\nimport FogPreviewOnIcon from \"../../icons/FogPreviewOnIcon\";\nimport ResetMapIcon from \"../../icons/ResetMapIcon\";\nimport TokenShowIcon from \"../../icons/TokenShowIcon\";\n\nimport ToolSection from \"./shared/ToolSection\";\n\nimport Divider from \"../Divider\";\nimport EraseAllButton from \"./shared/EraseAllButton\";\nimport Slider from \"../Slider\";\n\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport shortcuts from \"../../shortcuts\";\n\nimport {\n  FogToolSettings as FogToolSettingsType,\n  FogToolType,\n} from \"../../types/Fog\";\n\ntype FogToolSettingsProps = {\n  settings: FogToolSettingsType;\n  onSettingChange: (change: Partial<FogToolSettingsType>) => void;\n  onToolAction?: (action: string) => void;\n  disabledActions?: string[];\n  fogEnabled?: boolean;\n  showGmOpacity?: boolean;\n  gmOpacity?: number;\n  showExplored?: boolean;\n};\n\nfunction FogToolSettings({\n  settings,\n  onSettingChange,\n  onToolAction,\n  disabledActions = [],\n  fogEnabled = true,\n  showGmOpacity = false,\n  gmOpacity = 0.35,\n  showExplored = false,\n}: FogToolSettingsProps) {\n  const exploredVisible = !!showExplored;\n  const previewOnDrag = !!settings.previewOnDrag;\n  const autoVisionOnDrop = !!settings.autoVisionOnDrop;\n  // Keyboard shortcuts\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.fogPolygon(event)) {\n      onSettingChange({ type: \"polygon\" });\n    } else if (shortcuts.fogBrush(event)) {\n      onSettingChange({ type: \"brush\" });\n    } else if (shortcuts.fogErase(event)) {\n      onSettingChange({ type: \"remove\" });\n    } else if (shortcuts.fogRectangle(event)) {\n      onSettingChange({ type: \"rectangle\" });\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  const isSmallScreen = useMedia({ query: \"(max-width: 799px)\" });\n  const drawTools = [\n    {\n      id: \"polygon\",\n      title: \"Wall Pen (P)\",\n      isSelected: settings.type === \"polygon\",\n      icon: <FogPolygonIcon />,\n    },\n    {\n      id: \"rectangle\",\n      title: \"Wall Line (R)\",\n      isSelected: settings.type === \"rectangle\",\n      icon: <FogRectangleIcon />,\n    },\n    {\n      id: \"brush\",\n      title: \"Wall Brush (B)\",\n      isSelected: settings.type === \"brush\",\n      icon: <FogBrushIcon />,\n    },\n  ];\n\n  return (\n    <Flex sx={{ alignItems: \"center\" }}>\n      <RadioIconButton\n        title={fogEnabled ? \"Disable Fog\" : \"Enable Fog\"}\n        onClick={() => onToolAction?.(\"toggleFogEnabled\")}\n        isSelected={fogEnabled}\n      >\n        <FogToggleIcon />\n      </RadioIconButton>\n      <Divider vertical />\n      <RadioIconButton\n        title={exploredVisible ? \"Hide Explored\" : \"Show Explored\"}\n        onClick={() => onToolAction?.(\"toggleExplored\")}\n        isSelected={exploredVisible}\n      >\n        {exploredVisible ? <FogCutOnIcon /> : <FogCutOffIcon />}\n      </RadioIconButton>\n      <IconButton\n        aria-label=\"Reset Explored Fog\"\n        title=\"Reset Explored Fog\"\n        onClick={() => onToolAction?.(\"resetExplored\")}\n      >\n        <ResetMapIcon />\n      </IconButton>\n      <Divider vertical />\n      <IconButton\n        aria-label={\n          previewOnDrag\n            ? \"Disable Real-time Lighting Preview\"\n            : \"Enable Real-time Lighting Preview\"\n        }\n        title={\n          previewOnDrag\n            ? \"Disable Real-time Lighting Preview\"\n            : \"Enable Real-time Lighting Preview\"\n        }\n        onClick={() => onSettingChange({ previewOnDrag: !previewOnDrag })}\n        sx={{ color: previewOnDrag ? \"primary\" : \"text\" }}\n      >\n        {previewOnDrag ? <FogPreviewOnIcon /> : <FogPreviewOffIcon />}\n      </IconButton>\n      <IconButton\n        aria-label={\n          autoVisionOnDrop\n            ? \"Disable Auto Vision on Drop\"\n            : \"Enable Auto Vision on Drop\"\n        }\n        title={\n          autoVisionOnDrop\n            ? \"Disable Auto Vision on Drop\"\n            : \"Enable Auto Vision on Drop\"\n        }\n        onClick={() => onSettingChange({ autoVisionOnDrop: !autoVisionOnDrop })}\n        sx={{ color: autoVisionOnDrop ? \"primary\" : \"text\" }}\n      >\n        <TokenShowIcon />\n      </IconButton>\n      {showGmOpacity && (\n        <>\n          <Divider vertical />\n          <Flex sx={{ alignItems: \"center\" }}>\n            <Text variant=\"body2\" sx={{ mr: 2 }}>\n              GM Fog\n            </Text>\n            <Slider\n              min={0}\n              max={1}\n              step={0.05}\n              value={gmOpacity}\n              onChange={(e) =>\n                onToolAction?.(\n                  `setGmOpacity:${parseFloat(e.target.value) || 0}`\n                )\n              }\n              labelFunc={(value) => `${Math.round(value * 100)}%`}\n              ml={2}\n              mr={3}\n            />\n          </Flex>\n        </>\n      )}\n      <Divider vertical />\n      <ToolSection\n        tools={drawTools}\n        onToolClick={(tool) =>\n          onSettingChange({ type: tool.id as FogToolType })\n        }\n        collapse={isSmallScreen}\n      />\n      <Divider vertical />\n      <RadioIconButton\n        title=\"Erase Wall (E)\"\n        onClick={() => onSettingChange({ type: \"remove\" })}\n        isSelected={settings.type === \"remove\"}\n      >\n        <FogRemoveIcon />\n      </RadioIconButton>\n      <Divider vertical />\n      <EraseAllButton\n        onToolAction={onToolAction || (() => {})}\n        disabled={disabledActions.includes(\"eraseAll\")}\n      />\n    </Flex>\n  );\n}\n\nexport default FogToolSettings;\n","// Colors used for the game for theme general UI colors look at theme.js\nconst colors = {\n  blue: \"rgb(26, 106, 255)\",\n  orange: \"rgb(255, 116, 51)\",\n  red: \"rgb(255, 77, 77)\",\n  yellow: \"rgb(255, 212, 51)\",\n  purple: \"rgb(136, 77, 255)\",\n  green: \"rgb(133, 255, 102)\",\n  pink: \"rgb(235, 138, 255)\",\n  teal: \"rgb(68, 224, 241)\",\n  black: \"rgb(34, 34, 34)\",\n  darkGray: \"rgb(90, 90, 90)\",\n  lightGray: \"rgb(179, 179, 179)\",\n  white: \"rgb(255, 255, 255)\",\n  primary: \"hsl(260, 100%, 80%)\",\n};\n\nexport type Colors = typeof colors;\n\nexport type Color = keyof Colors;\n\nexport const colorOptions = Object.keys(colors) as Color[];\n\nexport default colors;\n","import React, { useState } from \"react\";\nimport { Box, SxProp, Input, Label } from \"theme-ui\";\n\nimport colors, { colorOptions, Color } from \"../../../helpers/colors\";\nimport MapMenu from \"../../map/MapMenu\";\n\ntype ColorCircleProps = {\n  color: string;\n  selected: boolean;\n  onClick?: React.MouseEventHandler<HTMLDivElement>;\n} & SxProp;\n\nfunction ColorCircle({ color, selected, onClick, sx }: ColorCircleProps) {\n  return (\n    <Box\n      key={color}\n      sx={{\n        borderRadius: \"50%\",\n        transform: \"scale(0.75)\",\n        backgroundColor: colors[color as Color] || color,\n        cursor: \"pointer\",\n        ...sx,\n      }}\n      onClick={onClick}\n      aria-label={`Brush Color ${color}`}\n    >\n      {selected && (\n        <Box\n          sx={{\n            width: \"100%\",\n            height: \"100%\",\n            border: \"2px solid white\",\n            position: \"absolute\",\n            top: 0,\n            borderRadius: \"50%\",\n          }}\n        />\n      )}\n    </Box>\n  );\n}\n\ntype ColorControlProps = {\n  color: string;\n  onColorChange: (newColor: string) => void;\n  exclude: Color[];\n  allowCustom?: boolean;\n};\n\nfunction ColorControl({\n  color,\n  onColorChange,\n  exclude,\n  allowCustom,\n}: ColorControlProps) {\n  const [showColorMenu, setShowColorMenu] = useState(false);\n  const [colorMenuOptions, setColorMenuOptions] = useState({});\n\n  function handleControlClick(event: React.MouseEvent<HTMLDivElement>) {\n    if (showColorMenu) {\n      setShowColorMenu(false);\n      setColorMenuOptions({});\n    } else {\n      setShowColorMenu(true);\n      const rect = event.currentTarget.getBoundingClientRect();\n      setColorMenuOptions({\n        // Align the right of the submenu to the left of the tool and center vertically\n        left: `${rect.left + rect.width / 2}px`,\n        top: `${rect.bottom + 16}px`,\n        style: { transform: \"translateX(-50%)\" },\n        // Exclude this node from the sub menus auto close\n        excludeNode: event.currentTarget,\n      });\n    }\n  }\n\n  const palette = colorOptions.filter((c) => !exclude.includes(c));\n  const displayColor = colors[color as Color] || color;\n\n  const colorMenu = (\n    <MapMenu\n      isOpen={showColorMenu}\n      onRequestClose={() => {\n        setShowColorMenu(false);\n        setColorMenuOptions({});\n      }}\n      {...colorMenuOptions}\n    >\n      <Box\n        sx={{\n          width: \"104px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"space-between\",\n        }}\n        p={1}\n      >\n        {palette.map((c) => (\n          <ColorCircle\n            key={c}\n            color={colors[c]}\n            selected={c === color}\n            onClick={() => {\n              onColorChange(c);\n              setShowColorMenu(false);\n              setColorMenuOptions({});\n            }}\n            sx={{ width: \"25%\", paddingTop: \"25%\" }}\n          />\n        ))}\n      </Box>\n      {allowCustom && (\n        <Box px={2} pb={2}>\n          <Label htmlFor=\"drawing-custom-color\">Custom</Label>\n          <Input\n            id=\"drawing-custom-color\"\n            type=\"color\"\n            value={displayColor.startsWith(\"#\") ? displayColor : \"#ff4d4d\"}\n            onChange={(event) => {\n              onColorChange(event.target.value);\n              setShowColorMenu(false);\n              setColorMenuOptions({});\n            }}\n          />\n        </Box>\n      )}\n    </MapMenu>\n  );\n\n  return (\n    <>\n      <ColorCircle\n        color={displayColor}\n        selected\n        onClick={handleControlClick}\n        sx={{ width: \"24px\", height: \"24px\" }}\n      />\n      {colorMenu}\n    </>\n  );\n}\n\nColorControl.defaultProps = {\n  exclude: [],\n  allowCustom: false,\n};\n\nexport default ColorControl;\n","function BlendOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 0H0v24h24V0z\" fill=\"none\" />\n      <path d=\"M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z\" />\n    </svg>\n  );\n}\n\nexport default BlendOnIcon;\n","function BlendOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 5.1v4.05l7.4 7.4c1.15-2.88.59-6.28-1.75-8.61l-4.94-4.95c-.39-.39-1.02-.39-1.41 0L8.56 5.71l1.41 1.41L12 5.1zm-8.31-.02c-.39.39-.39 1.02 0 1.41l2.08 2.08c-2.54 3.14-2.35 7.75.57 10.68C7.9 20.8 9.95 21.58 12 21.58c1.78 0 3.56-.59 5.02-1.77l2 2c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L5.11 5.08c-.39-.39-1.03-.39-1.42 0zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59c0-1.32.43-2.56 1.21-3.59L12 14.79v4.8z\" />\n    </svg>\n  );\n}\n\nexport default BlendOffIcon;\n","import { IconButton } from \"theme-ui\";\n\nimport BlendOnIcon from \"../../../icons/BlendOnIcon\";\nimport BlendOffIcon from \"../../../icons/BlendOffIcon\";\n\ntype AlphaBlendToggleProps = {\n  useBlending: boolean;\n  onBlendingChange: (useBlending: boolean) => void;\n};\n\nfunction AlphaBlendToggle({\n  useBlending,\n  onBlendingChange,\n}: AlphaBlendToggleProps) {\n  return (\n    <IconButton\n      aria-label={useBlending ? \"Disable Blending (O)\" : \"Enable Blending (O)\"}\n      title={useBlending ? \"Disable Blending (O)\" : \"Enable Blending (O)\"}\n      onClick={() => onBlendingChange(!useBlending)}\n    >\n      {useBlending ? <BlendOnIcon /> : <BlendOffIcon />}\n    </IconButton>\n  );\n}\n\nexport default AlphaBlendToggle;\n","function ShapeFillOnIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M8.639 20.508c.324.324.76.492 1.185.492.424 0 .86-.168 1.184-.492l6.147-6.147c.66-.648.66-1.71 0-2.37l-9.21-9.209a1.113 1.113 0 00-1.575 0 1.113 1.113 0 000 1.576l1.878 1.878-5.756 5.756c-.66.66-.66 1.72 0 2.37l6.147 6.146zM9.824 7.823l5.353 5.353H4.47l5.354-5.353zM19.882 21a2.242 2.242 0 002.236-2.235c0-1.487-2.236-3.912-2.236-3.912s-2.235 2.425-2.235 3.912A2.242 2.242 0 0019.882 21z\" />\n    </svg>\n  );\n}\n\nexport default ShapeFillOnIcon;\n","function ShapeFillOffIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M3.414 6.52L16.85 19.953a1 1 0 01-1.414 1.415l-2.644-2.644-1.783 1.783a1.688 1.688 0 01-1.025.484l-.16.008c-.371 0-.751-.128-1.058-.378l-.126-.114-6.147-6.147a1.664 1.664 0 01-.11-2.249l.11-.12 1.782-1.784L2 7.934a1 1 0 111.414-1.415zM7.85 2.695l.097.086 9.21 9.21c.62.62.656 1.597.109 2.25l-.11.12-1.769 1.768-2.954-2.954h2.745L9.824 7.823 8.45 9.195 6.87 7.613l1.379-1.377L6.37 4.358a1.113 1.113 0 010-1.576 1.113 1.113 0 011.479-.086zm-.607 10.48L5.856 11.79 4.47 13.176h2.772zM19.882 21a2.242 2.242 0 002.236-2.235c0-1.487-2.236-3.912-2.236-3.912s-2.235 2.425-2.235 3.912A2.242 2.242 0 0019.882 21z\" />\n    </svg>\n  );\n}\n\nexport default ShapeFillOffIcon;\n","import { IconButton } from \"theme-ui\";\n\nimport ShapeFillOnIcon from \"../../../icons/ShapeFillOnIcon\";\nimport ShapeFillOffIcon from \"../../../icons/ShapeFillOffIcon\";\n\ntype ShapeFillToggleProps = {\n  useShapeFill: boolean;\n  onShapeFillChange: (useShapeFill: boolean) => void;\n};\n\nfunction ShapeFillToggle({\n  useShapeFill,\n  onShapeFillChange,\n}: ShapeFillToggleProps) {\n  return (\n    <IconButton\n      aria-label={\n        useShapeFill ? \"Disable Shape Fill (G)\" : \"Enable Shape Fill (G)\"\n      }\n      title={useShapeFill ? \"Disable Shape Fill (G)\" : \"Enable Shape Fill (G)\"}\n      onClick={() => onShapeFillChange(!useShapeFill)}\n    >\n      {useShapeFill ? <ShapeFillOnIcon /> : <ShapeFillOffIcon />}\n    </IconButton>\n  );\n}\n\nexport default ShapeFillToggle;\n","function BrushToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z\" />\n    </svg>\n  );\n}\n\nexport default BrushToolIcon;\n","function BrushPaintIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18 4V3c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V6h1v4h-9c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-9h7c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1h-2z\" />\n    </svg>\n  );\n}\n\nexport default BrushPaintIcon;\n","function BrushLineIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M4.222 16.95L16.95 4.222a2 2 0 112.828 2.828L7.05 19.778a2 2 0 11-2.828-2.828z\" />\n    </svg>\n  );\n}\n\nexport default BrushLineIcon;\n","function BrushRectangleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" />\n    </svg>\n  );\n}\n\nexport default BrushRectangleIcon;\n","function BrushCircleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z\" />\n    </svg>\n  );\n}\n\nexport default BrushCircleIcon;\n","function BrushTriangleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M2.73 21h18.53c.77 0 1.25-.83.87-1.5l-9.27-16a.996.996 0 00-1.73 0l-9.27 16c-.38.67.1 1.5.87 1.5z\" />\n    </svg>\n  );\n}\n\nexport default BrushTriangleIcon;\n","function EraseToolIcon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M3.212 12.303c-1 1-1.182 2.455-.404 3.233l5.656 5.656c.778.778 2.233.596 3.233-.404l9.091-9.091c1-1 1.182-2.455.404-3.233l-5.656-5.656c-.778-.778-2.233-.596-3.233.404l-9.091 9.091zm6.667-2.424l4.242 4.242c.39.39.485.93.212 1.202l-3.96 3.96c-.272.272-.813.177-1.201-.212l-4.243-4.243c-.389-.388-.484-.93-.212-1.202l3.96-3.96c.272-.272.813-.176 1.202.213z\" />\n    </svg>\n  );\n}\n\nexport default EraseToolIcon;\n","function SettingsIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z\" />\n    </svg>\n  );\n}\n\nexport default SettingsIcon;\n","function PenToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"none\"\n      stroke=\"currentcolor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <polyline points=\"4,18 9,12 13,15 20,8\" />\n      <circle cx=\"4\" cy=\"18\" r=\"1\" fill=\"currentcolor\" />\n      <circle cx=\"9\" cy=\"12\" r=\"1\" fill=\"currentcolor\" />\n      <circle cx=\"13\" cy=\"15\" r=\"1\" fill=\"currentcolor\" />\n      <circle cx=\"20\" cy=\"8\" r=\"1\" fill=\"currentcolor\" />\n    </svg>\n  );\n}\n\nexport default PenToolIcon;\n","function MoveToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M21.5 4c-.83 0-1.5.67-1.5 1.5v5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-8c0-.83-.67-1.5-1.5-1.5S16 1.67 16 2.5v8c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-9c0-.83-.67-1.5-1.5-1.5S12 .67 12 1.5v8.99c0 .28-.22.5-.5.5s-.5-.22-.5-.5V4.5c0-.83-.67-1.5-1.5-1.5S8 3.67 8 4.5v11.41l-4.12-2.35c-.58-.33-1.3-.24-1.78.22-.6.58-.62 1.54-.03 2.13l6.78 6.89c.75.77 1.77 1.2 2.85 1.2H19c2.21 0 4-1.79 4-4V5.5c0-.83-.67-1.5-1.5-1.5z\" />\n    </svg>\n  );\n}\n\nexport default MoveToolIcon;\n","import { useEffect, useState } from \"react\";\nimport type { MouseEvent } from \"react\";\nimport { Box, Flex, IconButton, Label } from \"theme-ui\";\nimport { useMedia } from \"react-media\";\n\nimport RadioIconButton from \"../RadioIconButton\";\nimport Slider from \"../Slider\";\n\nimport ColorControl from \"./shared/ColorControl\";\nimport AlphaBlendToggle from \"./shared/AlphaBlendToggle\";\nimport ToolSection from \"./shared/ToolSection\";\nimport ShapeFillToggle from \"./shared/ShapeFillToggle\";\nimport MapMenu from \"../map/MapMenu\";\n\nimport BrushIcon from \"../../icons/BrushToolIcon\";\nimport BrushPaintIcon from \"../../icons/BrushPaintIcon\";\nimport BrushLineIcon from \"../../icons/BrushLineIcon\";\nimport BrushRectangleIcon from \"../../icons/BrushRectangleIcon\";\nimport BrushCircleIcon from \"../../icons/BrushCircleIcon\";\nimport BrushTriangleIcon from \"../../icons/BrushTriangleIcon\";\nimport EraseIcon from \"../../icons/EraseToolIcon\";\nimport SettingsIcon from \"../../icons/SettingsIcon\";\nimport PenToolIcon from \"../../icons/PenToolIcon\";\nimport MoveToolIcon from \"../../icons/MoveToolIcon\";\n\nimport Divider from \"../Divider\";\n\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport shortcuts from \"../../shortcuts\";\n\nimport {\n  DrawingToolSettings as DrawingToolSettingsType,\n  DrawingToolType,\n  DashStyle,\n} from \"../../types/Drawing\";\nimport EraseAllButton from \"./shared/EraseAllButton\";\n\ntype DrawingToolSettingsProps = {\n  settings: DrawingToolSettingsType;\n  onSettingChange: (change: Partial<DrawingToolSettingsType>) => void;\n  onToolAction: (action: string) => void;\n  disabledActions: string[];\n};\n\nfunction DrawingToolSettings({\n  settings,\n  onSettingChange,\n  onToolAction,\n  disabledActions,\n}: DrawingToolSettingsProps) {\n  // Keyboard shotcuts\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.drawBrush(event)) {\n      onSettingChange({ type: \"brush\" });\n    } else if (shortcuts.drawPaint(event)) {\n      onSettingChange({ type: \"paint\" });\n    } else if (shortcuts.drawLine(event)) {\n      onSettingChange({ type: \"line\" });\n    } else if (shortcuts.drawRect(event)) {\n      onSettingChange({ type: \"rectangle\" });\n    } else if (shortcuts.drawCircle(event)) {\n      onSettingChange({ type: \"circle\" });\n    } else if (shortcuts.drawTriangle(event)) {\n      onSettingChange({ type: \"triangle\" });\n    } else if (shortcuts.drawPen(event)) {\n      onSettingChange({ type: \"pen\" });\n    } else if (shortcuts.drawErase(event)) {\n      onSettingChange({ type: \"erase\" });\n    } else if (shortcuts.drawBlend(event)) {\n      const nextBlending = !settings.useBlending;\n      onSettingChange({\n        useBlending: nextBlending,\n        opacity: nextBlending ? 0.5 : 1,\n      });\n    } else if (shortcuts.drawFill(event)) {\n      onSettingChange({ useShapeFill: !settings.useShapeFill });\n    }\n  }\n  useKeyboard(handleKeyDown);\n\n  // Change to brush if on erase and it gets disabled\n  useEffect(() => {\n    if (settings.type === \"erase\" && disabledActions.includes(\"erase\")) {\n      onSettingChange({ type: \"brush\" });\n    }\n  }, [disabledActions, settings, onSettingChange]);\n\n  const isSmallScreen = useMedia({ query: \"(max-width: 799px)\" });\n\n  const opacity =\n    typeof settings.opacity === \"number\"\n      ? settings.opacity\n      : settings.useBlending\n      ? 0.5\n      : 1;\n  const strokeWidth =\n    typeof settings.strokeWidth === \"number\" ? settings.strokeWidth : 1;\n  const dashStyle = settings.dashStyle || \"solid\";\n  const supportsDash =\n    settings.type === \"line\" ||\n    settings.type === \"rectangle\" ||\n    settings.type === \"circle\" ||\n    settings.type === \"triangle\" ||\n    settings.type === \"pen\";\n  const dashInactive =\n    !supportsDash ||\n    (settings.useShapeFill &&\n      settings.type !== \"line\" &&\n      settings.type !== \"pen\");\n\n  const tools = [\n    {\n      id: \"brush\",\n      title: \"Brush (B)\",\n      isSelected: settings.type === \"brush\",\n      icon: <BrushIcon />,\n    },\n    {\n      id: \"paint\",\n      title: \"Paint (P)\",\n      isSelected: settings.type === \"paint\",\n      icon: <BrushPaintIcon />,\n    },\n    {\n      id: \"line\",\n      title: \"Line (L)\",\n      isSelected: settings.type === \"line\",\n      icon: <BrushLineIcon />,\n    },\n    {\n      id: \"rectangle\",\n      title: \"Rectangle (R)\",\n      isSelected: settings.type === \"rectangle\",\n      icon: <BrushRectangleIcon />,\n    },\n    {\n      id: \"circle\",\n      title: \"Circle (C)\",\n      isSelected: settings.type === \"circle\",\n      icon: <BrushCircleIcon />,\n    },\n    {\n      id: \"triangle\",\n      title: \"Triangle (T)\",\n      isSelected: settings.type === \"triangle\",\n      icon: <BrushTriangleIcon />,\n    },\n    {\n      id: \"pen\",\n      title: \"Pen (Y)\",\n      isSelected: settings.type === \"pen\",\n      icon: <PenToolIcon />,\n    },\n    {\n      id: \"drag\",\n      title: \"Drag\",\n      isSelected: settings.type === \"drag\",\n      icon: <MoveToolIcon />,\n    },\n  ];\n\n  function handleAdvancedClick(event: MouseEvent<HTMLButtonElement>) {\n    if (showAdvancedMenu) {\n      setShowAdvancedMenu(false);\n      setAdvancedMenuOptions({});\n      return;\n    }\n    const rect = event.currentTarget.getBoundingClientRect();\n    setShowAdvancedMenu(true);\n    setAdvancedMenuOptions({\n      left: `${rect.left + rect.width / 2}px`,\n      top: `${rect.bottom + 16}px`,\n      style: { transform: \"translateX(-50%)\" },\n      excludeNode: event.currentTarget,\n    });\n  }\n\n  const [showAdvancedMenu, setShowAdvancedMenu] = useState(false);\n  const [advancedMenuOptions, setAdvancedMenuOptions] = useState({});\n\n  const dashOptions: { id: DashStyle; title: string; dash: number[] }[] = [\n    { id: \"solid\", title: \"Solid\", dash: [] },\n    { id: \"dashed\", title: \"Dashed\", dash: [6, 4] },\n    { id: \"dotted\", title: \"Dotted\", dash: [2, 3] },\n  ];\n\n  const advancedMenu = (\n    <MapMenu\n      isOpen={showAdvancedMenu}\n      onRequestClose={() => {\n        setShowAdvancedMenu(false);\n        setAdvancedMenuOptions({});\n      }}\n      {...advancedMenuOptions}\n    >\n      <Box\n        sx={{\n          width: \"320px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: 2,\n        }}\n        p={2}\n      >\n        <Box>\n          <Label>Opacity</Label>\n          <Slider\n            min={0}\n            max={1}\n            step={0.05}\n            value={opacity}\n            labelFunc={(value) => `${Math.round(value * 100)}%`}\n            onChange={(event) => {\n              const next = Number(event.target.value);\n              onSettingChange({\n                opacity: next,\n                useBlending: next < 1,\n              });\n            }}\n          />\n        </Box>\n        <Divider />\n        <Box>\n          <Label>Stroke</Label>\n          <Slider\n            min={0.25}\n            max={4}\n            step={0.25}\n            value={strokeWidth}\n            labelFunc={(value) => `${value}x`}\n            onChange={(event) =>\n              onSettingChange({ strokeWidth: Number(event.target.value) })\n            }\n          />\n        </Box>\n        <Divider />\n        <Box>\n          <Label>\n            Dash {dashStyle ? `(${dashStyle})` : \"\"}\n            {dashInactive ? \" (line/shape only)\" : \"\"}\n          </Label>\n          <Flex sx={{ gap: 1, flexWrap: \"wrap\" }}>\n            {dashOptions.map((option) => (\n              <RadioIconButton\n                key={option.id}\n                title={option.title}\n                isSelected={dashStyle === option.id}\n                onClick={() => onSettingChange({ dashStyle: option.id })}\n                sx={{\n                  backgroundColor:\n                    dashStyle === option.id ? \"highlight\" : \"transparent\",\n                  borderRadius: \"4px\",\n                }}\n              >\n                <Box\n                  sx={{\n                    width: \"24px\",\n                    height: \"24px\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                  }}\n                >\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"24\"\n                    height=\"24\"\n                    viewBox=\"0 0 24 24\"\n                    fill=\"none\"\n                    stroke=\"currentcolor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  >\n                    <line\n                      x1=\"4\"\n                      y1=\"12\"\n                      x2=\"20\"\n                      y2=\"12\"\n                      strokeDasharray={option.dash.join(\" \")}\n                    />\n                  </svg>\n                </Box>\n              </RadioIconButton>\n            ))}\n          </Flex>\n        </Box>\n      </Box>\n    </MapMenu>\n  );\n\n  return (\n    <Flex sx={{ alignItems: \"center\" }}>\n      <ColorControl\n        color={settings.color}\n        onColorChange={(color) => onSettingChange({ color })}\n        exclude={[\"primary\"]}\n        allowCustom\n      />\n      <Divider vertical />\n      <ToolSection\n        tools={tools}\n        onToolClick={(tool) =>\n          onSettingChange({ type: tool.id as DrawingToolType })\n        }\n        collapse={isSmallScreen}\n      />\n      <Divider vertical />\n      <RadioIconButton\n        title=\"Erase (E)\"\n        onClick={() => onSettingChange({ type: \"erase\" })}\n        isSelected={settings.type === \"erase\"}\n        disabled={disabledActions.includes(\"erase\")}\n      >\n        <EraseIcon />\n      </RadioIconButton>\n      <EraseAllButton\n        onToolAction={onToolAction}\n        disabled={disabledActions.includes(\"erase\")}\n      />\n      <Divider vertical />\n      <AlphaBlendToggle\n        useBlending={settings.useBlending}\n        onBlendingChange={(useBlending) =>\n          onSettingChange({ useBlending, opacity: useBlending ? 0.5 : 1 })\n        }\n      />\n      <ShapeFillToggle\n        useShapeFill={settings.useShapeFill}\n        onShapeFillChange={(useShapeFill) => onSettingChange({ useShapeFill })}\n      />\n      <IconButton\n        aria-label=\"Drawing Advanced Settings\"\n        title=\"Drawing Advanced Settings\"\n        onClick={handleAdvancedClick}\n        sx={{ color: showAdvancedMenu ? \"primary\" : \"text\" }}\n      >\n        <SettingsIcon />\n      </IconButton>\n      {advancedMenu}\n    </Flex>\n  );\n}\n\nexport default DrawingToolSettings;\n","function SpellTemplateDragToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <circle\n        cx=\"12\"\n        cy=\"12\"\n        r=\"4.5\"\n        fill=\"none\"\n        stroke=\"currentcolor\"\n        strokeWidth=\"2\"\n      />\n      <path d=\"M12 4 L9.5 6.5 L14.5 6.5 Z\" />\n      <path d=\"M12 20 L9.5 17.5 L14.5 17.5 Z\" />\n      <path d=\"M4 12 L6.5 9.5 L6.5 14.5 Z\" />\n      <path d=\"M20 12 L17.5 9.5 L17.5 14.5 Z\" />\n    </svg>\n  );\n}\n\nexport default SpellTemplateDragToolIcon;\n","function RemoveTokenIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z\" />\n    </svg>\n  );\n}\n\nexport default RemoveTokenIcon;\n","import { MouseEventHandler, useEffect, useRef, useState } from \"react\";\nimport type { MouseEvent } from \"react\";\nimport { Box, Flex, Input, Label, SxProp, IconButton, Button } from \"theme-ui\";\nimport { useMedia } from \"react-media\";\n\nimport ToolSection from \"./shared/ToolSection\";\nimport Divider from \"../Divider\";\nimport Select from \"../Select\";\nimport MapMenu from \"../map/MapMenu\";\n\nimport BrushRectangleIcon from \"../../icons/BrushRectangleIcon\";\nimport BrushCircleIcon from \"../../icons/BrushCircleIcon\";\nimport BrushLineIcon from \"../../icons/BrushLineIcon\";\nimport BrushTriangleIcon from \"../../icons/BrushTriangleIcon\";\nimport FogPreviewOffIcon from \"../../icons/FogPreviewOffIcon\";\nimport FogPreviewOnIcon from \"../../icons/FogPreviewOnIcon\";\nimport SpellTemplateDragToolIcon from \"../../icons/SpellTemplateDragToolIcon\";\nimport EraseAllIcon from \"../../icons/EraseAllIcon\";\nimport RemoveTokenIcon from \"../../icons/RemoveTokenIcon\";\nimport SettingsIcon from \"../../icons/SettingsIcon\";\n\nimport colors, { colorOptions, Color } from \"../../helpers/colors\";\n\nimport {\n  SpellTemplateRule,\n  SpellTemplateToolSettings as SpellTemplateToolSettingsType,\n  SpellTemplateToolType,\n} from \"../../types/SpellTemplate\";\n\ntype SpellTemplateToolSettingsProps = {\n  settings: SpellTemplateToolSettingsType;\n  onSettingChange: (change: Partial<SpellTemplateToolSettingsType>) => void;\n  selectedTemplateId?: string | null;\n  onRemoveSelectedTemplate?: (() => void) | null;\n  hasTemplates?: boolean;\n  onRemoveAllTemplates?: (() => void) | null;\n};\n\ntype RuleOption = { value: SpellTemplateRule; label: string };\n\nconst ruleOptions: RuleOption[] = [\n  { value: \"center\", label: \"Center Point\" },\n  { value: \"area_50\", label: \"Area >= 50%\" },\n  { value: \"touch\", label: \"Touch\" },\n  { value: \"ruleset_dnd5e\", label: \"D&D 5e\" },\n  { value: \"ruleset_pf\", label: \"Pathfinder\" },\n];\n\ntype ColorCircleProps = {\n  color: string;\n  selected: boolean;\n  onClick?: MouseEventHandler<HTMLDivElement>;\n} & SxProp;\nfunction ColorCircle({ color, selected, onClick, sx }: ColorCircleProps) {\n  return (\n    <Box\n      sx={{\n        borderRadius: \"50%\",\n        transform: \"scale(0.75)\",\n        backgroundColor: color,\n        cursor: \"pointer\",\n        position: \"relative\",\n        ...sx,\n      }}\n      onClick={onClick}\n      aria-label={`Template Color ${color}`}\n    >\n      {selected && (\n        <Box\n          sx={{\n            width: \"100%\",\n            height: \"100%\",\n            border: \"2px solid white\",\n            position: \"absolute\",\n            top: 0,\n            borderRadius: \"50%\",\n          }}\n        />\n      )}\n    </Box>\n  );\n}\n\ntype ColorControlProps = {\n  color: string;\n  onColorChange: (newColor: string) => void;\n};\n\nfunction SpellTemplateColorControl({\n  color,\n  onColorChange,\n}: ColorControlProps) {\n  const [showColorMenu, setShowColorMenu] = useState(false);\n  const [colorMenuOptions, setColorMenuOptions] = useState({});\n\n  const palette = colorOptions.filter((c) => c !== \"primary\");\n  const paletteColor = colors[color as Color];\n  const displayColor = paletteColor || color;\n\n  function handleControlClick(event: MouseEvent<HTMLDivElement>) {\n    if (showColorMenu) {\n      setShowColorMenu(false);\n      setColorMenuOptions({});\n    } else {\n      setShowColorMenu(true);\n      const rect = event.currentTarget.getBoundingClientRect();\n      setColorMenuOptions({\n        left: `${rect.left + rect.width / 2}px`,\n        top: `${rect.bottom + 16}px`,\n        style: { transform: \"translateX(-50%)\" },\n        excludeNode: event.currentTarget,\n      });\n    }\n  }\n\n  const colorMenu = (\n    <MapMenu\n      isOpen={showColorMenu}\n      onRequestClose={() => {\n        setShowColorMenu(false);\n        setColorMenuOptions({});\n      }}\n      {...colorMenuOptions}\n    >\n      <Box\n        sx={{\n          width: \"120px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"space-between\",\n        }}\n        p={1}\n      >\n        {palette.map((c) => (\n          <ColorCircle\n            key={c}\n            color={colors[c]}\n            selected={c === color}\n            onClick={() => {\n              onColorChange(c);\n              setShowColorMenu(false);\n              setColorMenuOptions({});\n            }}\n            sx={{ width: \"25%\", paddingTop: \"25%\" }}\n          />\n        ))}\n      </Box>\n      <Box px={2} pb={2}>\n        <Label htmlFor=\"spell-template-color\">Custom</Label>\n        <Input\n          id=\"spell-template-color\"\n          type=\"color\"\n          value={displayColor.startsWith(\"#\") ? displayColor : \"#ff4d4d\"}\n          onChange={(event) => onColorChange(event.target.value)}\n        />\n      </Box>\n    </MapMenu>\n  );\n\n  return (\n    <>\n      <ColorCircle\n        color={displayColor}\n        selected\n        onClick={handleControlClick}\n        sx={{ width: \"32px\", height: \"32px\", transform: \"scale(1)\" }}\n      />\n      {colorMenu}\n    </>\n  );\n}\nfunction SpellTemplateToolSettings({\n  settings,\n  onSettingChange,\n  selectedTemplateId,\n  onRemoveSelectedTemplate,\n  hasTemplates,\n  onRemoveAllTemplates,\n}: SpellTemplateToolSettingsProps) {\n  const isSmallScreen = useMedia({ query: \"(max-width: 799px)\" });\n  const [showSettingsMenu, setShowSettingsMenu] = useState(false);\n  const [settingsMenuOptions, setSettingsMenuOptions] = useState({});\n  const [isClearAllConfirmOpen, setIsClearAllConfirmOpen] = useState(false);\n  const clearAllButtonRef = useRef<HTMLButtonElement | null>(null);\n  const [clearAllMenuPosition, setClearAllMenuPosition] = useState({\n    left: 0,\n    top: 0,\n  });\n\n  const toolIconSx = {\n    width: \"28px\",\n    height: \"28px\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    \"& svg\": {\n      width: \"28px\",\n      height: \"28px\",\n    },\n  };\n\n  const tools = [\n    {\n      id: \"drag\",\n      title: \"Move\",\n      isSelected: settings.type === \"drag\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <SpellTemplateDragToolIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"circle\",\n      title: \"Circle\",\n      isSelected: settings.type === \"circle\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushCircleIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"rectangle\",\n      title: \"Rectangle\",\n      isSelected: settings.type === \"rectangle\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushRectangleIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"cone\",\n      title: \"Cone\",\n      isSelected: settings.type === \"cone\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushTriangleIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"line\",\n      title: \"Line\",\n      isSelected: settings.type === \"line\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushLineIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"ring\",\n      title: \"Ring\",\n      isSelected: settings.type === \"ring\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushCircleIcon />\n        </Box>\n      ),\n    },\n    {\n      id: \"path\",\n      title: \"Wall\",\n      isSelected: settings.type === \"path\",\n      icon: (\n        <Box sx={toolIconSx}>\n          <BrushLineIcon />\n        </Box>\n      ),\n    },\n  ];\n\n  const selectedRule = ruleOptions.find((rule) => rule.value === settings.rule);\n\n  useEffect(() => {\n    if (!isClearAllConfirmOpen) {\n      return;\n    }\n    const button = clearAllButtonRef.current;\n    if (!button) {\n      return;\n    }\n    const rect = button.getBoundingClientRect();\n    setClearAllMenuPosition({\n      left: rect.left + rect.width / 2,\n      top: rect.bottom + 8,\n    });\n  }, [isClearAllConfirmOpen]);\n\n  function handleSettingsClick(event: MouseEvent<HTMLButtonElement>) {\n    if (showSettingsMenu) {\n      setShowSettingsMenu(false);\n      setSettingsMenuOptions({});\n      return;\n    }\n    const rect = event.currentTarget.getBoundingClientRect();\n    setShowSettingsMenu(true);\n    setSettingsMenuOptions({\n      left: `${rect.left + rect.width / 2}px`,\n      top: `${rect.bottom + 16}px`,\n      style: { transform: \"translateX(-50%)\" },\n      excludeNode: event.currentTarget,\n    });\n  }\n\n  const settingsMenu = (\n    <MapMenu\n      isOpen={showSettingsMenu}\n      onRequestClose={() => {\n        setShowSettingsMenu(false);\n        setSettingsMenuOptions({});\n      }}\n      {...settingsMenuOptions}\n    >\n      <Box\n        sx={{\n          width: \"320px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: 2,\n        }}\n        p={2}\n      >\n        <Box>\n          <Label>Rule</Label>\n          <Select\n            value={selectedRule || null}\n            options={ruleOptions}\n            onChange={(option: any) =>\n              onSettingChange({ rule: option?.value || \"center\" })\n            }\n          />\n        </Box>\n        <Divider />\n        <Flex sx={{ gap: 2, flexWrap: \"wrap\" }}>\n          <Box sx={{ minWidth: \"140px\", flex: \"1 1 140px\" }}>\n            <Label htmlFor=\"spell-template-line-width\">Width (cells)</Label>\n            <Input\n              id=\"spell-template-line-width\"\n              type=\"number\"\n              min={0.25}\n              step={0.25}\n              value={settings.lineWidth}\n              onChange={(event) =>\n                onSettingChange({\n                  lineWidth: Math.max(0, Number(event.target.value) || 0),\n                })\n              }\n            />\n          </Box>\n          <Box sx={{ minWidth: \"140px\", flex: \"1 1 140px\" }}>\n            <Label htmlFor=\"spell-template-cone-angle\">Angle (deg)</Label>\n            <Input\n              id=\"spell-template-cone-angle\"\n              type=\"number\"\n              min={10}\n              max={180}\n              step={5}\n              value={settings.coneAngle}\n              onChange={(event) =>\n                onSettingChange({\n                  coneAngle: Math.max(1, Number(event.target.value) || 0),\n                })\n              }\n            />\n          </Box>\n          <Box sx={{ minWidth: \"140px\", flex: \"1 1 140px\" }}>\n            <Label htmlFor=\"spell-template-ring-inner\">Inner Ratio</Label>\n            <Input\n              id=\"spell-template-ring-inner\"\n              type=\"number\"\n              min={0}\n              max={0.9}\n              step={0.05}\n              value={settings.ringInnerRatio}\n              onChange={(event) =>\n                onSettingChange({\n                  ringInnerRatio: Math.min(\n                    0.95,\n                    Math.max(0, Number(event.target.value) || 0)\n                  ),\n                })\n              }\n            />\n          </Box>\n        </Flex>\n        <Divider />\n        <Flex sx={{ gap: 2, flexWrap: \"wrap\" }}>\n          <Box sx={{ minWidth: \"140px\", flex: \"1 1 140px\" }}>\n            <Label htmlFor=\"spell-template-opacity\">Opacity</Label>\n            <Input\n              id=\"spell-template-opacity\"\n              type=\"number\"\n              min={0}\n              max={1}\n              step={0.05}\n              value={settings.opacity}\n              onChange={(event) =>\n                onSettingChange({\n                  opacity: Math.min(1, Math.max(0, Number(event.target.value))),\n                })\n              }\n            />\n          </Box>\n          <Box sx={{ minWidth: \"140px\", flex: \"1 1 140px\" }}>\n            <Label htmlFor=\"spell-template-stroke\">Stroke</Label>\n            <Input\n              id=\"spell-template-stroke\"\n              type=\"number\"\n              min={0.1}\n              step={0.1}\n              value={settings.strokeWidth}\n              onChange={(event) =>\n                onSettingChange({\n                  strokeWidth: Math.max(0, Number(event.target.value) || 0),\n                })\n              }\n            />\n          </Box>\n        </Flex>\n      </Box>\n    </MapMenu>\n  );\n\n  return (\n    <Flex\n      sx={{\n        alignItems: \"center\",\n        flexWrap: isSmallScreen ? \"wrap\" : \"nowrap\",\n        gap: 2,\n      }}\n    >\n      <SpellTemplateColorControl\n        color={settings.color}\n        onColorChange={(color) => onSettingChange({ color })}\n      />\n      <Divider vertical />\n      <ToolSection\n        tools={tools}\n        onToolClick={(tool) =>\n          onSettingChange({ type: tool.id as SpellTemplateToolType })\n        }\n        collapse={isSmallScreen}\n      />\n      <Divider vertical />\n      <IconButton\n        aria-label=\"Remove Selected Template\"\n        title=\"Remove Selected Template\"\n        onClick={() => onRemoveSelectedTemplate && onRemoveSelectedTemplate()}\n        disabled={!selectedTemplateId || !onRemoveSelectedTemplate}\n      >\n        <RemoveTokenIcon />\n      </IconButton>\n      <IconButton\n        aria-label=\"Erase All\"\n        title=\"Erase All\"\n        onClick={() => {\n          if (!hasTemplates || !onRemoveAllTemplates) {\n            return;\n          }\n          setIsClearAllConfirmOpen(true);\n        }}\n        disabled={!hasTemplates || !onRemoveAllTemplates}\n        ref={clearAllButtonRef}\n      >\n        <EraseAllIcon />\n      </IconButton>\n      <MapMenu\n        isOpen={isClearAllConfirmOpen}\n        onRequestClose={() => setIsClearAllConfirmOpen(false)}\n        left={clearAllMenuPosition.left}\n        top={clearAllMenuPosition.top}\n        style={{ transform: \"translateX(-50%)\" }}\n      >\n        <Button\n          disabled={!hasTemplates || !onRemoveAllTemplates}\n          onClick={() => {\n            setIsClearAllConfirmOpen(false);\n            onRemoveAllTemplates && onRemoveAllTemplates();\n          }}\n        >\n          Erase All\n        </Button>\n      </MapMenu>\n      <IconButton\n        aria-label={\n          settings.previewOnRotate\n            ? \"Disable Real-time Preview\"\n            : \"Enable Real-time Preview\"\n        }\n        title={\n          settings.previewOnRotate\n            ? \"Disable Real-time Preview\"\n            : \"Enable Real-time Preview\"\n        }\n        onClick={() =>\n          onSettingChange({ previewOnRotate: !settings.previewOnRotate })\n        }\n        sx={{ color: settings.previewOnRotate ? \"primary\" : \"text\" }}\n      >\n        {settings.previewOnRotate ? <FogPreviewOnIcon /> : <FogPreviewOffIcon />}\n      </IconButton>\n      <IconButton\n        aria-label=\"Template Settings\"\n        title=\"Template Settings\"\n        onClick={handleSettingsClick}\n        sx={{ color: showSettingsMenu ? \"primary\" : \"text\" }}\n      >\n        <SettingsIcon />\n      </IconButton>\n      {settingsMenu}\n    </Flex>\n  );\n}\n\nexport default SpellTemplateToolSettings;\n","import { Flex } from \"theme-ui\";\n\nimport ColorControl from \"./shared/ColorControl\";\n\nimport { PointerToolSettings as PointerToolSettingsType } from \"../../types/Pointer\";\n\ntype PointerToolSettingsProps = {\n  settings: PointerToolSettingsType;\n  onSettingChange: (change: Partial<PointerToolSettingsType>) => void;\n};\n\nfunction PointerToolSettings({\n  settings,\n  onSettingChange,\n}: PointerToolSettingsProps) {\n  return (\n    <Flex sx={{ alignItems: \"center\" }}>\n      <ColorControl\n        color={settings.color}\n        onColorChange={(color) =>\n          onSettingChange({ color: color as PointerToolSettingsType[\"color\"] })\n        }\n        exclude={[\"black\", \"darkGray\", \"lightGray\", \"white\", \"primary\"]}\n      />\n    </Flex>\n  );\n}\n\nexport default PointerToolSettings;\n","function SelectRectangleIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <rect fill=\"none\" height=\"24\" width=\"24\" />\n      <path d=\"M18.75 3c1.186 0 2.165.93 2.245 2.097L21 5.25V11a1 1 0 01-2 0V6.167a1.17 1.17 0 00-1.04-1.16L17.833 5H6.167a1.17 1.17 0 00-1.16 1.04L5 6.167v11.666a1.17 1.17 0 001.04 1.16l.127.007H11a1 1 0 010 2H5.25a2.257 2.257 0 01-2.245-2.097L3 18.75V5.25c0-1.186.93-2.165 2.097-2.245L5.25 3h13.5z\" />\n      <path d=\"M14.33 10h-.03a1.34 1.34 0 00-1.3 1.34v10c.02.6.39 1.092.926 1.27l.153.05h.251l.14-.007a1.35 1.35 0 00.94-.533l2.304-3.45h3.956a1.323 1.323 0 001.26-.884 1.33 1.33 0 00-.434-1.494l-7.323-5.986A1.312 1.312 0 0014.33 10z\" />\n    </svg>\n  );\n}\n\nexport default SelectRectangleIcon;\n","function SelectPathIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <rect fill=\"none\" height=\"24\" width=\"24\" />\n      <path d=\"M5 17a1 1 0 011 1 4 4 0 001.6 3.2 1 1 0 11-1.2 1.6A6 6 0 014 18a1 1 0 011-1zM6.087 16.521a1 1 0 011.322-.504c.898.402 1.815.683 2.744.836a1 1 0 01-.326 1.974 13.145 13.145 0 01-3.236-.984 1 1 0 01-.504-1.322zM12 1c6.031 0 11 3.974 11 9.022a8.19 8.19 0 01-.376 2.278 1 1 0 01-1.908-.6A6.162 6.162 0 0021 10c0-3.811-3.988-7-9-7-5.012 0-9 3.189-9 6.992a5.8 5.8 0 001.143 3.412 1 1 0 11-1.606 1.192A7.806 7.806 0 011 10c0-5.026 4.969-9 11-9z\" />\n      <path d=\"M5 13a3 3 0 100 6 3 3 0 000-6zm0 2a1 1 0 110 2 1 1 0 010-2zM14.488 10.35l-.187-.01A1.34 1.34 0 0013 11.68v10c.02.6.39 1.092.926 1.27a1 1 0 00.314.05h.09l.158-.01.153-.034c.343-.09.592-.26.769-.496l2.304-3.45h3.956a1.323 1.323 0 001.26-.884 1.33 1.33 0 00-.434-1.494l-7.323-5.986a1.313 1.313 0 00-.685-.297z\" />\n    </svg>\n  );\n}\n\nexport default SelectPathIcon;\n","import { Flex } from \"theme-ui\";\n\nimport {\n  SelectToolSettings as SelectToolSettingsType,\n  SelectToolType,\n} from \"../../types/Select\";\n\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport ToolSection from \"./shared/ToolSection\";\n\nimport shortcuts from \"../../shortcuts\";\n\nimport RectIcon from \"../../icons/SelectRectangleIcon\";\nimport PathIcon from \"../../icons/SelectPathIcon\";\n\ntype SelectToolSettingsProps = {\n  settings: SelectToolSettingsType;\n  onSettingChange: (change: Partial<SelectToolSettingsType>) => void;\n};\n\nfunction SelectToolSettings({\n  settings,\n  onSettingChange,\n}: SelectToolSettingsProps) {\n  // Keyboard shotcuts\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.selectPath(event)) {\n      onSettingChange({ type: \"path\" });\n    } else if (shortcuts.selectRect(event)) {\n      onSettingChange({ type: \"rectangle\" });\n    }\n  }\n  useKeyboard(handleKeyDown);\n\n  const tools = [\n    {\n      id: \"rectangle\",\n      title: \"Rectangle Selection (R)\",\n      isSelected: settings.type === \"rectangle\",\n      icon: <RectIcon />,\n    },\n    {\n      id: \"path\",\n      title: \"Lasso Selection (L)\",\n      isSelected: settings.type === \"path\",\n      icon: <PathIcon />,\n    },\n  ];\n\n  return (\n    <Flex sx={{ alignItems: \"center\" }}>\n      <ToolSection\n        tools={tools}\n        onToolClick={(tool) =>\n          onSettingChange({ type: tool.id as SelectToolType })\n        }\n      />\n    </Flex>\n  );\n}\n\nexport default SelectToolSettings;\n","function FogToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z\" />\n    </svg>\n  );\n}\n\nexport default FogToolIcon;\n","function MeasureToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n      transform=\"scale(-1 1)\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M17.66,17.66l-0.71,0.71c-0.2,0.2-0.51,0.2-0.71,0l0,0c-0.2-0.2-0.2-0.51,0-0.71l0.71-0.71l-1.94-1.94l-0.71,0.71 c-0.2,0.2-0.51,0.2-0.71,0l0,0c-0.2-0.2-0.2-0.51,0-0.71l0.71-0.71l-1.94-1.94l-0.71,0.71c-0.2,0.2-0.51,0.2-0.71,0l0,0 c-0.2-0.2-0.2-0.51,0-0.71l0.71-0.71L9.7,9.7l-0.71,0.71c-0.2,0.2-0.51,0.2-0.71,0l0,0c-0.2-0.2-0.2-0.51,0-0.71l0.71-0.71 L7.05,7.05L6.34,7.76c-0.2,0.2-0.51,0.2-0.71,0l0,0c-0.2-0.2-0.2-0.51,0-0.71l0.71-0.71L4.85,4.85C4.54,4.54,4,4.76,4,5.21V18 c0,1.1,0.9,2,2,2h12.79c0.45,0,0.67-0.54,0.35-0.85L17.66,17.66z M7,16v-4.76L12.76,17H8C7.45,17,7,16.55,7,16z\" />{\" \"}\n    </svg>\n  );\n}\n\nexport default MeasureToolIcon;\n","function ExpandMoreIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M24 24H0V0h24v24z\" fill=\"none\" opacity=\".87\" />\n      <path d=\"M15.88 9.29L12 13.17 8.12 9.29c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0z\" />\n    </svg>\n  );\n}\n\nexport default ExpandMoreIcon;\n","function PointerToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M6.387 17.964a4 4 0 005.657 0c1.042-1.041 3.564-5.45 7.569-13.225-7.776 4.004-12.184 6.527-13.226 7.568a4 4 0 000 5.657z\" />\n    </svg>\n  );\n}\n\nexport default PointerToolIcon;\n","function FullScreenIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M6 14c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1H7v-2c0-.55-.45-1-1-1zm0-4c.55 0 1-.45 1-1V7h2c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1zm11 7h-2c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1s-1 .45-1 1v2zM14 6c0 .55.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1V6c0-.55-.45-1-1-1h-3c-.55 0-1 .45-1 1z\" />\n    </svg>\n  );\n}\n\nexport default FullScreenIcon;\n","function FullScreenIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M6 16h2v2c0 .55.45 1 1 1s1-.45 1-1v-3c0-.55-.45-1-1-1H6c-.55 0-1 .45-1 1s.45 1 1 1zm2-8H6c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1s-1 .45-1 1v2zm7 11c.55 0 1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1h-3c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1zm1-11V6c0-.55-.45-1-1-1s-1 .45-1 1v3c0 .55.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1h-2z\" />\n    </svg>\n  );\n}\n\nexport default FullScreenIcon;\n","function NoteToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n      transform=\"scale(-1 1)\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M19,3H4.99C3.89,3,3,3.9,3,5l0.01,14c0,1.1,0.89,2,1.99,2h10l6-6V5C21,3.9,20.1,3,19,3z M8,8h8c0.55,0,1,0.45,1,1v0 c0,0.55-0.45,1-1,1H8c-0.55,0-1-0.45-1-1v0C7,8.45,7.45,8,8,8z M11,14H8c-0.55,0-1-0.45-1-1v0c0-0.55,0.45-1,1-1h3 c0.55,0,1,0.45,1,1v0C12,13.55,11.55,14,11,14z M14,19.5V15c0-0.55,0.45-1,1-1h4.5L14,19.5z\" />\n    </svg>\n  );\n}\n\nexport default NoteToolIcon;\n","function NoteTextIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M2 20h20c1.1 0 2 .9 2 2s-.9 2-2 2H2c-1.1 0-2-.9-2-2s.9-2 2-2z\" />\n      <path d=\"M10.63 3.93L6.06 15.58c-.27.68.23 1.42.97 1.42.43 0 .82-.27.98-.68L8.87 14h6.25l.87 2.32c.15.41.54.68.98.68.73 0 1.24-.74.97-1.42L13.37 3.93C13.14 3.37 12.6 3 12 3c-.6 0-1.15.37-1.37.93zM9.62 12L12 5.67 14.38 12H9.62z\" />\n    </svg>\n  );\n}\n\nexport default NoteTextIcon;\n","function SelectToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <rect fill=\"none\" height=\"24\" width=\"24\" />\n      <path d=\"M5 17a1 1 0 011 1 4 4 0 001.6 3.2 1 1 0 11-1.2 1.6A6 6 0 014 18a1 1 0 011-1zM6.087 16.521a1 1 0 011.322-.504c.898.402 1.815.683 2.744.836a1 1 0 01-.326 1.974 13.145 13.145 0 01-3.236-.984 1 1 0 01-.504-1.322zM12 1c6.031 0 11 3.974 11 9.022a8.19 8.19 0 01-.376 2.278 1 1 0 01-1.908-.6A6.162 6.162 0 0021 10c0-3.811-3.988-7-9-7-5.012 0-9 3.189-9 6.992a5.8 5.8 0 001.143 3.412 1 1 0 11-1.606 1.192A7.806 7.806 0 011 10c0-5.026 4.969-9 11-9z\" />\n      <path d=\"M5 13a3 3 0 100 6 3 3 0 000-6zm0 2a1 1 0 110 2 1 1 0 010-2zM14.488 10.35l-.187-.01A1.34 1.34 0 0013 11.68v10c.02.6.39 1.092.926 1.27a1 1 0 00.314.05h.09l.158-.01.153-.034c.343-.09.592-.26.769-.496l2.304-3.45h3.956a1.323 1.323 0 001.26-.884 1.33 1.33 0 00-.434-1.494l-7.323-5.986a1.313 1.313 0 00-.685-.297z\" />\n    </svg>\n  );\n}\n\nexport default SelectToolIcon;\n","function PasteIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M19 2h-4.18C14.4.84 13.3 0 12 0S9.6.84 9.18 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm6 18H6c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1h1v1c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V4h1c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1z\" />\n    </svg>\n  );\n}\n\nexport default PasteIcon;\n","function SpellTemplateToolIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <circle\n        cx=\"12\"\n        cy=\"12\"\n        r=\"6\"\n        fill=\"none\"\n        stroke=\"currentcolor\"\n        strokeWidth=\"2\"\n      />\n      <path d=\"M12 6 L19 12 L12 18 Z\" />\n    </svg>\n  );\n}\n\nexport default SpellTemplateToolIcon;\n","function UndoIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12.5 8c-2.65 0-5.05.99-6.9 2.6L3.71 8.71C3.08 8.08 2 8.52 2 9.41V15c0 .55.45 1 1 1h5.59c.89 0 1.34-1.08.71-1.71l-1.91-1.91c1.39-1.16 3.16-1.88 5.12-1.88 3.16 0 5.89 1.84 7.19 4.5.27.56.91.84 1.5.64.71-.23 1.07-1.04.75-1.72C20.23 10.42 16.65 8 12.5 8z\" />\n    </svg>\n  );\n}\n\nexport default UndoIcon;\n","import React from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport UndoIcon from \"../../../icons/UndoIcon\";\n\nimport { isMacLike } from \"../../../helpers/shared\";\n\ntype UndoButtonProps = {\n  onClick?: React.MouseEventHandler<HTMLButtonElement>;\n  disabled?: boolean;\n};\n\nfunction UndoButton({ onClick, disabled }: UndoButtonProps) {\n  return (\n    <IconButton\n      title={`Undo (${isMacLike ? \"Cmd\" : \"Ctrl\"} + Z)`}\n      aria-label={`Undo (${isMacLike ? \"Cmd\" : \"Ctrl\"} + Z)`}\n      onClick={onClick}\n      disabled={disabled}\n    >\n      <UndoIcon />\n    </IconButton>\n  );\n}\n\nexport default UndoButton;\n","function RedoIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.16 0-7.74 2.42-9.44 5.93-.32.67.04 1.47.75 1.71.59.2 1.23-.08 1.5-.64 1.3-2.66 4.03-4.5 7.19-4.5 1.95 0 3.73.72 5.12 1.88l-1.91 1.91c-.63.63-.19 1.71.7 1.71H21c.55 0 1-.45 1-1V9.41c0-.89-1.08-1.34-1.71-.71l-1.89 1.9z\" />\n    </svg>\n  );\n}\n\nexport default RedoIcon;\n","import React from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport RedoIcon from \"../../../icons/RedoIcon\";\n\nimport { isMacLike } from \"../../../helpers/shared\";\n\ntype RedoButtonProps = {\n  onClick?: React.MouseEventHandler<HTMLButtonElement>;\n  disabled?: boolean;\n};\n\nfunction RedoButton({ onClick, disabled }: RedoButtonProps) {\n  return (\n    <IconButton\n      title={`Redo (${isMacLike ? \"Cmd\" : \"Ctrl\"} + Shift + Z)`}\n      aria-label={`Redo (${isMacLike ? \"Cmd\" : \"Ctrl\"} + Shift + Z)`}\n      onClick={onClick}\n      disabled={disabled}\n    >\n      <RedoIcon />\n    </IconButton>\n  );\n}\n\nexport default RedoButton;\n","import React, { createContext, useContext } from \"react\";\n\ntype ImageImportContextValue = {\n  openImportFromUrl: () => void;\n};\n\nconst ImageImportContext = createContext<ImageImportContextValue | undefined>(\n  undefined\n);\n\nexport function ImageImportProvider({\n  openImportFromUrl,\n  children,\n}: {\n  openImportFromUrl: () => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <ImageImportContext.Provider value={{ openImportFromUrl }}>\n      {children}\n    </ImageImportContext.Provider>\n  );\n}\n\nexport function useImageImport() {\n  return useContext(ImageImportContext);\n}\n","import { useState, Fragment, useEffect, useMemo } from \"react\";\nimport { IconButton, Flex, Box } from \"theme-ui\";\n\nimport RadioIconButton from \"../RadioIconButton\";\nimport Divider from \"../Divider\";\n\nimport SelectMapButton from \"./SelectMapButton\";\n\nimport FogToolSettings from \"../controls/FogToolSettings\";\nimport DrawingToolSettings from \"../controls/DrawingToolSettings\";\nimport SpellTemplateToolSettings from \"../controls/SpellTemplateToolSettings\";\nimport PointerToolSettings from \"../controls/PointerToolSettings\";\nimport SelectToolSettings from \"../controls/SelectToolSettings\";\n\nimport MoveToolIcon from \"../../icons/MoveToolIcon\";\nimport FogToolIcon from \"../../icons/FogToolIcon\";\nimport BrushToolIcon from \"../../icons/BrushToolIcon\";\nimport MeasureToolIcon from \"../../icons/MeasureToolIcon\";\nimport ExpandMoreIcon from \"../../icons/ExpandMoreIcon\";\nimport PointerToolIcon from \"../../icons/PointerToolIcon\";\nimport FullScreenIcon from \"../../icons/FullScreenIcon\";\nimport FullScreenExitIcon from \"../../icons/FullScreenExitIcon\";\nimport NoteToolIcon from \"../../icons/NoteToolIcon\";\nimport TextToolIcon from \"../../icons/NoteTextIcon\";\nimport SelectToolIcon from \"../../icons/SelectToolIcon\";\nimport PasteIcon from \"../../icons/PasteIcon\";\nimport SpellTemplateToolIcon from \"../../icons/SpellTemplateToolIcon\";\n\nimport UndoButton from \"../controls/shared/UndoButton\";\nimport RedoButton from \"../controls/shared/RedoButton\";\n\nimport useSetting from \"../../hooks/useSetting\";\n\nimport { Map, MapTool, MapToolId } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\nimport {\n  MapChangeEventHandler,\n  MapResetEventHandler,\n} from \"../../types/Events\";\nimport { Settings } from \"../../types/Settings\";\nimport type { SpellTemplateToolSettings as SpellTemplateToolSettingsType } from \"../../types/SpellTemplate\";\n\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\nimport { useImageImport } from \"../../contexts/ImageImportContext\";\n\nimport shortcuts from \"../../shortcuts\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport { isEmpty } from \"../../helpers/shared\";\nimport { MapActions } from \"../../hooks/useMapActions\";\n\ntype MapControlsProps = {\n  onMapChange: MapChangeEventHandler;\n  onMapReset: MapResetEventHandler;\n  map: Map | null;\n  mapState: MapState | null;\n  mapActions: MapActions;\n  allowMapChange: boolean;\n  selectedToolId: MapToolId;\n  onSelectedToolChange: (toolId: MapToolId) => void;\n  toolSettings: Settings;\n  onToolSettingChange: (change: Partial<Settings>) => void;\n  onToolAction: (actionId: string) => void;\n  selectedTemplateId: string | null;\n  onRemoveSelectedTemplate: () => void;\n  hasTemplates: boolean;\n  onRemoveAllTemplates: () => void;\n  onUndo: () => void;\n  onRedo: () => void;\n};\n\nfunction MapContols({\n  onMapChange,\n  onMapReset,\n  map,\n  mapState,\n  mapActions,\n  allowMapChange,\n  selectedToolId,\n  onSelectedToolChange,\n  toolSettings,\n  onToolSettingChange,\n  onToolAction,\n  selectedTemplateId,\n  onRemoveSelectedTemplate,\n  hasTemplates,\n  onRemoveAllTemplates,\n  onUndo,\n  onRedo,\n}: MapControlsProps) {\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [fullScreen, setFullScreen] = useSetting(\"map.fullScreen\");\n\n  const userId = useUserId();\n  const imageImport = useImageImport();\n  const tokenNoteSettings = toolSettings.tokenNote || {\n    enabled: false,\n    trigger: \"longPress\",\n    longPressMs: 500,\n    blur: \"high\",\n    fontSize: \"md\",\n    defaultFont: \"default\",\n    defaultPermission: \"write\",\n  };\n  const tokenNoteEnabled = tokenNoteSettings.enabled;\n\n  const disabledControls = useMemo(() => {\n    const isOwner = map && map.owner === userId;\n    const allowMapDrawing = isOwner || mapState?.editFlags.includes(\"drawing\");\n    const allowFogDrawing = isOwner || mapState?.editFlags.includes(\"fog\");\n    const allowNoteEditing = isOwner || mapState?.editFlags.includes(\"notes\");\n\n    const disabled: MapToolId[] = [];\n    if (!allowMapChange) {\n      disabled.push(\"map\");\n    }\n    if (!map) {\n      disabled.push(\"move\");\n      disabled.push(\"measure\");\n      disabled.push(\"pointer\");\n      disabled.push(\"select\");\n      disabled.push(\"effect\");\n    }\n    if (!map || !allowMapDrawing) {\n      disabled.push(\"drawing\");\n      disabled.push(\"spellTemplates\");\n    }\n    if (!map || !allowFogDrawing) {\n      disabled.push(\"fog\");\n    }\n    if (!map || !allowNoteEditing) {\n      disabled.push(\"note\");\n      disabled.push(\"text\");\n    }\n    if (!map || mapActions.actionIndex < 0) {\n      disabled.push(\"undo\");\n    }\n    if (!map || mapActions.actionIndex === mapActions.actions.length - 1) {\n      disabled.push(\"redo\");\n    }\n    return disabled;\n  }, [map, mapState, mapActions, allowMapChange, userId]);\n\n  // Change back to move tool if selected tool becomes disabled\n  useEffect(() => {\n    if (disabledControls.includes(selectedToolId)) {\n      onSelectedToolChange(\"move\");\n    }\n  }, [selectedToolId, disabledControls, onSelectedToolChange]);\n\n  const disabledSettings = useMemo(() => {\n    const disabled: Partial<Record<keyof Settings, string[]>> = {\n      drawing: [],\n      fog: [],\n    };\n    if (mapState && isEmpty(mapState.drawings)) {\n      disabled.drawing?.push(\"erase\");\n    }\n    if (!mapState || isEmpty(mapState.walls || {})) {\n      disabled.fog?.push(\"eraseAll\");\n    }\n    return disabled;\n  }, [mapState]);\n\n  const defaultSpellTemplateSettings: SpellTemplateToolSettingsType = {\n    type: \"circle\",\n    rule: \"center\",\n    color: \"red\",\n    opacity: 0.5,\n    strokeWidth: 1,\n    lineWidth: 1,\n    coneAngle: 90,\n    ringInnerRatio: 0.5,\n    previewOnRotate: true,\n  };\n\n  const toolsById: Record<string, MapTool> = {\n    move: {\n      id: \"move\",\n      icon: <MoveToolIcon />,\n      title: \"Move Tool (W)\",\n    },\n    select: {\n      id: \"select\",\n      icon: <SelectToolIcon />,\n      title: \"Select Tool (S)\",\n      SettingsComponent: SelectToolSettings,\n    },\n    effect: {\n      id: \"effect\",\n      icon: <SelectToolIcon />,\n      title: \"Effect Tool\",\n      SettingsComponent: SelectToolSettings,\n    },\n    fog: {\n      id: \"fog\",\n      icon: <FogToolIcon />,\n      title: \"Fog Tool (F)\",\n      SettingsComponent: FogToolSettings,\n    },\n    drawing: {\n      id: \"drawing\",\n      icon: <BrushToolIcon />,\n      title: \"Drawing Tool (D)\",\n      SettingsComponent: DrawingToolSettings,\n    },\n    spellTemplates: {\n      id: \"spellTemplates\",\n      icon: <SpellTemplateToolIcon />,\n      title: \"Spell Templates (A)\",\n      SettingsComponent: SpellTemplateToolSettings,\n    },\n    measure: {\n      id: \"measure\",\n      icon: <MeasureToolIcon />,\n      title: \"Measure Tool (M)\",\n    },\n    pointer: {\n      id: \"pointer\",\n      icon: <PointerToolIcon />,\n      title: \"Pointer Tool (Q)\",\n      SettingsComponent: PointerToolSettings,\n    },\n    text: {\n      id: \"text\",\n      icon: <TextToolIcon />,\n      title: \"Text Tool (X)\",\n    },\n    note: {\n      id: \"note\",\n      icon: <NoteToolIcon />,\n      title: \"Note Tool (N)\",\n    },\n  };\n  const tools: MapToolId[] = [\n    \"move\",\n    \"select\",\n    \"effect\",\n    \"fog\",\n    \"drawing\",\n    \"spellTemplates\",\n    \"measure\",\n    \"pointer\",\n    \"text\",\n    \"note\",\n  ];\n\n  const sections = [\n    {\n      id: \"map\",\n      component: (\n        <SelectMapButton\n          onMapChange={onMapChange}\n          onMapReset={onMapReset}\n          currentMap={map}\n          currentMapState={mapState}\n          disabled={disabledControls.includes(\"map\")}\n        />\n      ),\n    },\n    ...(imageImport?.openImportFromUrl\n      ? [\n          {\n            id: \"import\",\n            component: (\n              <IconButton\n                aria-label=\" URL \"\n                title=\" URL \"\n                onClick={imageImport.openImportFromUrl}\n              >\n                <PasteIcon />\n              </IconButton>\n            ),\n          },\n        ]\n      : []),\n    {\n      id: \"tools\",\n      component: tools.map((tool) => (\n        <RadioIconButton\n          key={tool}\n          title={toolsById[tool].title}\n          onClick={() => onSelectedToolChange(tool)}\n          isSelected={selectedToolId === tool}\n          disabled={disabledControls.includes(tool)}\n        >\n          {toolsById[tool].icon}\n        </RadioIconButton>\n      )),\n    },\n    {\n      id: \"tokenNotes\",\n      component: (\n        <IconButton\n          aria-label=\"Token Note Mode\"\n          title=\"Token Note Mode\"\n          onClick={() =>\n            onToolSettingChange({\n              tokenNote: {\n                ...tokenNoteSettings,\n                enabled: !tokenNoteEnabled,\n              },\n            })\n          }\n          disabled={!map}\n          sx={{\n            backgroundColor: tokenNoteEnabled ? \"highlight\" : \"transparent\",\n          }}\n        >\n          <NoteToolIcon />\n        </IconButton>\n      ),\n    },\n    {\n      id: \"history\",\n      component: (\n        <>\n          <UndoButton\n            onClick={onUndo}\n            disabled={disabledControls.includes(\"undo\")}\n          />\n          <RedoButton\n            onClick={onRedo}\n            disabled={disabledControls.includes(\"redo\")}\n          />\n        </>\n      ),\n    },\n  ];\n\n  let controls = null;\n  if (sections.length === 1 && sections[0].id === \"map\") {\n    controls = (\n      <Box\n        sx={{\n          display: \"block\",\n          backgroundColor: \"overlay\",\n          borderRadius: \"4px\",\n        }}\n        m={2}\n      >\n        {sections[0].component}\n      </Box>\n    );\n  } else if (sections.length > 0) {\n    controls = (\n      <>\n        <IconButton\n          aria-label={isExpanded ? \"Hide Map Controls\" : \"Show Map Controls\"}\n          title={isExpanded ? \"Hide Map Controls\" : \"Show Map Controls\"}\n          onClick={() => setIsExpanded(!isExpanded)}\n          sx={{\n            transform: `rotate(${isExpanded ? \"0\" : \"180deg\"})`,\n            display: \"block\",\n            backgroundColor: \"overlay\",\n            borderRadius: \"50%\",\n          }}\n          m={2}\n        >\n          <ExpandMoreIcon />\n        </IconButton>\n        <Box\n          sx={{\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            display: isExpanded ? \"flex\" : \"none\",\n            backgroundColor: \"overlay\",\n            borderRadius: \"4px\",\n          }}\n          p={2}\n        >\n          {sections.map((section, index) => (\n            <Fragment key={section.id}>\n              {section.component}\n              {index !== sections.length - 1 && <Divider />}\n            </Fragment>\n          ))}\n        </Box>\n      </>\n    );\n  }\n\n  function getToolSettings() {\n    const Settings = toolsById[selectedToolId].SettingsComponent;\n    if (\n      !Settings ||\n      (selectedToolId !== \"fog\" &&\n        selectedToolId !== \"drawing\" &&\n        selectedToolId !== \"spellTemplates\" &&\n        selectedToolId !== \"pointer\" &&\n        selectedToolId !== \"select\" &&\n        selectedToolId !== \"effect\")\n    ) {\n      return null;\n    }\n    const selectedSettings =\n      selectedToolId === \"spellTemplates\" && !toolSettings.spellTemplates\n        ? defaultSpellTemplateSettings\n        : selectedToolId === \"effect\"\n        ? toolSettings.select\n        : toolSettings[selectedToolId];\n    const showGmOpacity =\n      selectedToolId === \"fog\" && !!(map && map.owner === userId);\n    const disabledActions =\n      selectedToolId === \"effect\"\n        ? disabledSettings.select\n        : disabledSettings[selectedToolId];\n    return (\n      <Box\n        sx={{\n          position: \"absolute\",\n          top: \"4px\",\n          left: \"50%\",\n          transform: \"translateX(-50%)\",\n          backgroundColor: \"overlay\",\n          borderRadius: \"4px\",\n          maxWidth: \"calc(100% - 16px)\",\n          overflowX: \"auto\",\n        }}\n        p={1}\n      >\n        <Settings\n          settings={selectedSettings}\n          fogEnabled={selectedToolId === \"fog\" ? mapState?.fogEnabled : undefined}\n          showGmOpacity={showGmOpacity}\n          showExplored={\n            selectedToolId === \"fog\" ? mapState?.showExplored ?? false : false\n          }\n          gmOpacity={\n            selectedToolId === \"fog\" &&\n            typeof toolSettings.fog?.gmOpacity === \"number\"\n              ? toolSettings.fog.gmOpacity\n              : 0.35\n          }\n          onSettingChange={(\n            change: Partial<\n              Settings[\"fog\" | \"drawing\" | \"spellTemplates\" | \"pointer\" | \"select\"]\n            >\n          ) =>\n            onToolSettingChange({\n              [selectedToolId]: {\n                ...selectedSettings,\n                ...change,\n              },\n            })\n          }\n          onToolAction={onToolAction}\n          disabledActions={disabledActions}\n          selectedTemplateId={\n            selectedToolId === \"spellTemplates\" ? selectedTemplateId : null\n          }\n          onRemoveSelectedTemplate={\n            selectedToolId === \"spellTemplates\" ? onRemoveSelectedTemplate : null\n          }\n          hasTemplates={selectedToolId === \"spellTemplates\" ? hasTemplates : false}\n          onRemoveAllTemplates={\n            selectedToolId === \"spellTemplates\" ? onRemoveAllTemplates : null\n          }\n        />\n      </Box>\n    );\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.moveTool(event) && !disabledControls.includes(\"move\")) {\n      onSelectedToolChange(\"move\");\n    }\n    if (shortcuts.selectTool(event) && !disabledControls.includes(\"select\")) {\n      onSelectedToolChange(\"select\");\n    }\n    if (shortcuts.drawingTool(event) && !disabledControls.includes(\"drawing\")) {\n      onSelectedToolChange(\"drawing\");\n    }\n    if (\n      shortcuts.spellTemplateTool(event) &&\n      !disabledControls.includes(\"spellTemplates\")\n    ) {\n      onSelectedToolChange(\"spellTemplates\");\n    }\n    if (shortcuts.fogTool(event) && !disabledControls.includes(\"fog\")) {\n      onSelectedToolChange(\"fog\");\n    }\n    if (shortcuts.measureTool(event) && !disabledControls.includes(\"measure\")) {\n      onSelectedToolChange(\"measure\");\n    }\n    if (shortcuts.pointerTool(event) && !disabledControls.includes(\"pointer\")) {\n      onSelectedToolChange(\"pointer\");\n    }\n    if (shortcuts.textTool(event) && !disabledControls.includes(\"text\")) {\n      onSelectedToolChange(\"text\");\n    }\n    if (shortcuts.noteTool(event) && !disabledControls.includes(\"note\")) {\n      onSelectedToolChange(\"note\");\n    }\n    if (shortcuts.redo(event) && !disabledControls.includes(\"redo\")) {\n      onRedo();\n    }\n    if (shortcuts.undo(event) && !disabledControls.includes(\"undo\")) {\n      onUndo();\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  return (\n    <>\n      <Flex\n        sx={{\n          position: \"absolute\",\n          top: 0,\n          right: 0,\n          flexDirection: \"column\",\n          alignItems: \"center\",\n        }}\n        mx={1}\n      >\n        {controls}\n      </Flex>\n      {getToolSettings()}\n      <Box\n        sx={{\n          position: \"absolute\",\n          right: \"4px\",\n          bottom: 0,\n          backgroundColor: \"overlay\",\n          borderRadius: \"50%\",\n        }}\n        m={2}\n      >\n        <IconButton\n          onClick={() => setFullScreen(!fullScreen)}\n          aria-label={fullScreen ? \"Exit Full Screen\" : \"Enter Full Screen\"}\n          title={fullScreen ? \"Exit Full Screen\" : \"Enter Full Screen\"}\n        >\n          {fullScreen ? <FullScreenExitIcon /> : <FullScreenIcon />}\n        </IconButton>\n      </Box>\n    </>\n  );\n}\n\nexport default MapContols;\n","import React, { useEffect } from \"react\";\n\nfunction usePreventContextMenu(elementRef: React.RefObject<HTMLElement>) {\n  useEffect(() => {\n    // Stop conext menu i.e. right click dialog\n    function preventContextMenu(event: MouseEvent) {\n      event.preventDefault();\n      return false;\n    }\n    const element = elementRef.current;\n    if (element) {\n      element.addEventListener(\"contextmenu\", preventContextMenu, {\n        passive: false,\n      });\n    }\n\n    return () => {\n      if (element) {\n        element.removeEventListener(\"contextmenu\", preventContextMenu);\n      }\n    };\n  }, [elementRef]);\n}\n\nexport default usePreventContextMenu;\n","import React, { useRef, useEffect, useState } from \"react\";\nimport { Box } from \"theme-ui\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport { Stage, Layer, Image, Group } from \"react-konva\";\nimport Konva from \"konva\";\n\nimport useMapImage from \"../../hooks/useMapImage\";\nimport usePreventOverscroll from \"../../hooks/usePreventOverscroll\";\nimport useStageInteraction from \"../../hooks/useStageInteraction\";\nimport useImageCenter from \"../../hooks/useImageCenter\";\nimport usePreventContextMenu from \"../../hooks/usePreventContextMenu\";\n\nimport { getGridMaxZoom } from \"../../helpers/grid\";\nimport KonvaBridge from \"../../helpers/KonvaBridge\";\n\nimport {\n  MapInteractionEmitter,\n  MapInteractionProvider,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { GridProvider } from \"../../contexts/GridContext\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport shortcuts from \"../../shortcuts\";\nimport { Map, MapToolId } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\n\ntype SelectedToolChangeEventHanlder = (tool: MapToolId) => void;\n\ntype MapInteractionProps = {\n  map: Map | null;\n  mapState: MapState | null;\n  children?: React.ReactNode;\n  overlay?: React.ReactNode;\n  controls: React.ReactNode;\n  selectedToolId: MapToolId;\n  onSelectedToolChange: SelectedToolChangeEventHanlder;\n};\n\nfunction MapInteraction({\n  map,\n  mapState,\n  children,\n  overlay,\n  controls,\n  selectedToolId,\n  onSelectedToolChange,\n}: MapInteractionProps) {\n  const [mapImage, mapImageStatus] = useMapImage(map);\n\n  const [mapLoaded, setMapLoaded] = useState(false);\n  useEffect(() => {\n    if (!map || !mapState || mapState.mapId !== map.id) {\n      setMapLoaded(false);\n    } else if (mapImageStatus === \"loaded\") {\n      setMapLoaded(true);\n    }\n  }, [mapImageStatus, map, mapState]);\n\n  const [stageWidth, setStageWidth] = useState(1);\n  const [stageHeight, setStageHeight] = useState(1);\n  const [stageScale, setStageScale] = useState(1);\n  const [preventMapInteraction, setPreventMapInteraction] = useState(false);\n\n  // Avoid state udpates when panning the map by using a ref and updating the konva element directly\n  const stageTranslateRef = useRef({ x: 0, y: 0 });\n  const mapStageRef = useMapStage();\n  const mapLayerRef = useRef<Konva.Layer>(null);\n  const mapImageRef = useRef<Konva.Image>(null);\n  const overlayLayerRef = useRef<Konva.Layer>(null);\n\n  function handleResize(width?: number, height?: number) {\n    if (width && height && width > 0 && height > 0) {\n      setStageWidth(width);\n      setStageHeight(height);\n    }\n  }\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  usePreventOverscroll(containerRef);\n  usePreventContextMenu(containerRef);\n\n  const [mapWidth, mapHeight] = useImageCenter(\n    map,\n    mapStageRef,\n    stageWidth,\n    stageHeight,\n    stageTranslateRef,\n    setStageScale,\n    mapLayerRef,\n    containerRef\n  );\n\n  const previousSelectedToolRef = useRef(selectedToolId);\n  const [currentMouseButtons, setCurentMouseButtons] = useState(0);\n\n  const [interactionEmitter] = useState(new MapInteractionEmitter());\n\n  useStageInteraction(\n    mapStageRef,\n    stageScale,\n    setStageScale,\n    stageTranslateRef,\n    mapLayerRef,\n    getGridMaxZoom(map?.grid),\n    selectedToolId,\n    preventMapInteraction,\n    {\n      onPinchStart: () => {\n        // Change to move tool when pinching and zooming\n        previousSelectedToolRef.current = selectedToolId;\n        onSelectedToolChange(\"move\");\n      },\n      onPinchEnd: () => {\n        onSelectedToolChange(previousSelectedToolRef.current);\n      },\n      onDrag: (props) => {\n        const { first, last, buttons } = props;\n        if (buttons !== currentMouseButtons) {\n          setCurentMouseButtons(buttons);\n        }\n        if (first) {\n          interactionEmitter.emit(\"dragStart\", props);\n        } else if (last) {\n          interactionEmitter.emit(\"dragEnd\", props);\n        } else {\n          interactionEmitter.emit(\"drag\", props);\n        }\n      },\n    }\n  );\n\n  function handleKeyDown(event: KeyboardEvent) {\n    // Change to move tool when pressing space\n    if (shortcuts.move(event) && selectedToolId === \"move\") {\n      // Stop active state on move icon from being selected\n      event.preventDefault();\n    }\n    if (map && shortcuts.move(event) && selectedToolId !== \"move\") {\n      event.preventDefault();\n      previousSelectedToolRef.current = selectedToolId;\n      onSelectedToolChange(\"move\");\n    }\n    if (!event.repeat && shortcuts.move(event) && selectedToolId === \"move\") {\n      previousSelectedToolRef.current = \"move\";\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.move(event) && selectedToolId === \"move\") {\n      onSelectedToolChange(previousSelectedToolRef.current);\n    }\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n\n  useEffect(() => {\n    const overlayLayer = overlayLayerRef.current;\n    const mapLayer = mapLayerRef.current;\n    if (!overlayLayer || !mapLayer) {\n      return;\n    }\n    overlayLayer.position(mapLayer.position());\n    overlayLayer.batchDraw();\n    const canvas = overlayLayer.getCanvas()._canvas;\n    if (canvas) {\n      canvas.style.pointerEvents = \"none\";\n    }\n  }, [mapWidth, mapHeight, map, mapState, stageWidth, stageHeight]);\n\n  function getCursorForTool(tool: MapToolId) {\n    if (currentMouseButtons === 2) {\n      return \"crosshair\";\n    } else if (currentMouseButtons > 2) {\n      return \"move\";\n    }\n    switch (tool) {\n      case \"move\":\n        return \"move\";\n      case \"fog\":\n      case \"drawing\":\n      case \"spellTemplates\":\n        return \"crosshair\";\n      case \"measure\":\n      case \"pointer\":\n      case \"text\":\n      case \"note\":\n      case \"select\":\n      case \"effect\":\n        return \"crosshair\";\n      default:\n        return \"default\";\n    }\n  }\n\n  const mapInteraction = {\n    stageScale,\n    stageWidth,\n    stageHeight,\n    setPreventMapInteraction,\n    mapWidth,\n    mapHeight,\n    interactionEmitter,\n  };\n\n  return (\n    <MapInteractionProvider value={mapInteraction}>\n      <GridProvider\n        grid={map?.grid || null}\n        width={mapWidth}\n        height={mapHeight}\n      >\n        <Box\n          sx={{\n            position: \"relative\",\n            cursor: getCursorForTool(selectedToolId),\n            touchAction: \"none\",\n            outline: \"none\",\n            width: \"100%\",\n            height: \"100%\",\n          }}\n          ref={containerRef}\n          className=\"map\"\n        >\n          <ReactResizeDetector\n            handleWidth\n            handleHeight\n            onResize={handleResize}\n            targetRef={containerRef}\n          >\n            <KonvaBridge\n              stageRender={(children) => (\n                <Stage\n                  // @ts-ignore\n                  width={stageWidth}\n                  height={stageHeight}\n                  scale={{ x: stageScale, y: stageScale }}\n                  ref={mapStageRef}\n                >\n                  {children}\n                </Stage>\n              )}\n            >\n              <Layer ref={mapLayerRef}>\n                <Image\n                  image={(mapLoaded && mapImage) || undefined}\n                  width={mapWidth}\n                  height={mapHeight}\n                  id=\"mapImage\"\n                  ref={mapImageRef}\n                />\n                {mapLoaded && children}\n                <Group id=\"portal\" />\n              </Layer>\n              {overlay ? (\n                <Layer\n                  ref={overlayLayerRef}\n                  listening={false}\n                  hitGraphEnabled={false}\n                >\n                  {overlay}\n                </Layer>\n              ) : null}\n            </KonvaBridge>\n          </ReactResizeDetector>\n          {controls}\n        </Box>\n      </GridProvider>\n    </MapInteractionProvider>\n  );\n}\n\nexport default MapInteraction;\n","export type Point = [number, number];\nexport type Segment = [Point, Point];\nexport type Polygon = Point[];\n\ntype SortedPoint = [number, number, number];\n\nexport function compute(position: Point, segments: Segment[]): Polygon {\n  const bounded: Segment[] = [];\n  let minX = position[0];\n  let minY = position[1];\n  let maxX = position[0];\n  let maxY = position[1];\n  for (let i = 0; i < segments.length; ++i) {\n    for (let j = 0; j < 2; ++j) {\n      minX = Math.min(minX, segments[i][j][0]);\n      minY = Math.min(minY, segments[i][j][1]);\n      maxX = Math.max(maxX, segments[i][j][0]);\n      maxY = Math.max(maxY, segments[i][j][1]);\n    }\n    bounded.push([\n      [segments[i][0][0], segments[i][0][1]],\n      [segments[i][1][0], segments[i][1][1]],\n    ]);\n  }\n  --minX;\n  --minY;\n  ++maxX;\n  ++maxY;\n  bounded.push([\n    [minX, minY],\n    [maxX, minY],\n  ]);\n  bounded.push([\n    [maxX, minY],\n    [maxX, maxY],\n  ]);\n  bounded.push([\n    [maxX, maxY],\n    [minX, maxY],\n  ]);\n  bounded.push([\n    [minX, maxY],\n    [minX, minY],\n  ]);\n  const polygon: Polygon = [];\n  const sorted = sortPoints(position, bounded);\n  const map = new Array(bounded.length).fill(-1);\n  const heap: number[] = [];\n  const start: Point = [position[0] + 1, position[1]];\n  for (let i = 0; i < bounded.length; ++i) {\n    const a1 = angle(bounded[i][0], position);\n    const a2 = angle(bounded[i][1], position);\n    let active = false;\n    if (a1 > -180 && a1 <= 0 && a2 <= 180 && a2 >= 0 && a2 - a1 > 180) {\n      active = true;\n    }\n    if (a2 > -180 && a2 <= 0 && a1 <= 180 && a1 >= 0 && a1 - a2 > 180) {\n      active = true;\n    }\n    if (active) {\n      insert(i, heap, position, bounded, start, map);\n    }\n  }\n  for (let i = 0; i < sorted.length; ) {\n    let extend = false;\n    let shorten = false;\n    const orig = i;\n    let vertex = bounded[sorted[i][0]][sorted[i][1]];\n    const oldSegment = heap[0];\n    do {\n      if (map[sorted[i][0]] !== -1) {\n        if (sorted[i][0] === oldSegment) {\n          extend = true;\n          vertex = bounded[sorted[i][0]][sorted[i][1]];\n        }\n        remove(map[sorted[i][0]], heap, position, bounded, vertex, map);\n      } else {\n        insert(sorted[i][0], heap, position, bounded, vertex, map);\n        if (heap[0] !== oldSegment) {\n          shorten = true;\n        }\n      }\n      ++i;\n      if (i === sorted.length) {\n        break;\n      }\n    } while (sorted[i][2] < sorted[orig][2] + epsilon());\n\n    if (extend) {\n      polygon.push(vertex);\n      const cur = intersectLines(\n        bounded[heap[0]][0],\n        bounded[heap[0]][1],\n        position,\n        vertex\n      );\n      if (cur.length === 2 && !equal(cur, vertex)) {\n        polygon.push(cur as Point);\n      }\n    } else if (shorten) {\n      const a = intersectLines(\n        bounded[oldSegment][0],\n        bounded[oldSegment][1],\n        position,\n        vertex\n      );\n      const b = intersectLines(\n        bounded[heap[0]][0],\n        bounded[heap[0]][1],\n        position,\n        vertex\n      );\n      if (a.length === 2) {\n        polygon.push(a as Point);\n      }\n      if (b.length === 2) {\n        polygon.push(b as Point);\n      }\n    }\n  }\n  return polygon;\n}\n\nexport function computeViewport(\n  position: Point,\n  segments: Segment[],\n  viewportMinCorner: Point,\n  viewportMaxCorner: Point\n): Polygon {\n  const brokenSegments: Segment[] = [];\n  const viewport: Point[] = [\n    [viewportMinCorner[0], viewportMinCorner[1]],\n    [viewportMaxCorner[0], viewportMinCorner[1]],\n    [viewportMaxCorner[0], viewportMaxCorner[1]],\n    [viewportMinCorner[0], viewportMaxCorner[1]],\n  ];\n  for (let i = 0; i < segments.length; ++i) {\n    if (\n      segments[i][0][0] < viewportMinCorner[0] &&\n      segments[i][1][0] < viewportMinCorner[0]\n    ) {\n      continue;\n    }\n    if (\n      segments[i][0][1] < viewportMinCorner[1] &&\n      segments[i][1][1] < viewportMinCorner[1]\n    ) {\n      continue;\n    }\n    if (\n      segments[i][0][0] > viewportMaxCorner[0] &&\n      segments[i][1][0] > viewportMaxCorner[0]\n    ) {\n      continue;\n    }\n    if (\n      segments[i][0][1] > viewportMaxCorner[1] &&\n      segments[i][1][1] > viewportMaxCorner[1]\n    ) {\n      continue;\n    }\n    const intersections: Point[] = [];\n    for (let j = 0; j < viewport.length; ++j) {\n      let k = j + 1;\n      if (k === viewport.length) {\n        k = 0;\n      }\n      if (\n        doLineSegmentsIntersect(\n          segments[i][0][0],\n          segments[i][0][1],\n          segments[i][1][0],\n          segments[i][1][1],\n          viewport[j][0],\n          viewport[j][1],\n          viewport[k][0],\n          viewport[k][1]\n        )\n      ) {\n        const intersect = intersectLines(\n          segments[i][0],\n          segments[i][1],\n          viewport[j],\n          viewport[k]\n        );\n        if (intersect.length !== 2) {\n          continue;\n        }\n        if (equal(intersect as Point, segments[i][0])) {\n          continue;\n        }\n        if (equal(intersect as Point, segments[i][1])) {\n          continue;\n        }\n        intersections.push(intersect as Point);\n      }\n    }\n    const start: Point = [segments[i][0][0], segments[i][0][1]];\n    while (intersections.length > 0) {\n      let endIndex = 0;\n      let endDis = distance(start, intersections[0]);\n      for (let j = 1; j < intersections.length; ++j) {\n        const dis = distance(start, intersections[j]);\n        if (dis < endDis) {\n          endDis = dis;\n          endIndex = j;\n        }\n      }\n      brokenSegments.push([\n        [start[0], start[1]],\n        [intersections[endIndex][0], intersections[endIndex][1]],\n      ]);\n      start[0] = intersections[endIndex][0];\n      start[1] = intersections[endIndex][1];\n      intersections.splice(endIndex, 1);\n    }\n    brokenSegments.push([\n      [start[0], start[1]],\n      [segments[i][1][0], segments[i][1][1]],\n    ]);\n  }\n\n  const viewportSegments: Segment[] = [];\n  for (let i = 0; i < brokenSegments.length; ++i) {\n    if (\n      inViewport(brokenSegments[i][0], viewportMinCorner, viewportMaxCorner) &&\n      inViewport(brokenSegments[i][1], viewportMinCorner, viewportMaxCorner)\n    ) {\n      viewportSegments.push([\n        [brokenSegments[i][0][0], brokenSegments[i][0][1]],\n        [brokenSegments[i][1][0], brokenSegments[i][1][1]],\n      ]);\n    }\n  }\n  const eps = epsilon() * 10;\n  viewportSegments.push([\n    [viewportMinCorner[0] - eps, viewportMinCorner[1] - eps],\n    [viewportMaxCorner[0] + eps, viewportMinCorner[1] - eps],\n  ]);\n  viewportSegments.push([\n    [viewportMaxCorner[0] + eps, viewportMinCorner[1] - eps],\n    [viewportMaxCorner[0] + eps, viewportMaxCorner[1] + eps],\n  ]);\n  viewportSegments.push([\n    [viewportMaxCorner[0] + eps, viewportMaxCorner[1] + eps],\n    [viewportMinCorner[0] - eps, viewportMaxCorner[1] + eps],\n  ]);\n  viewportSegments.push([\n    [viewportMinCorner[0] - eps, viewportMaxCorner[1] + eps],\n    [viewportMinCorner[0] - eps, viewportMinCorner[1] - eps],\n  ]);\n  return compute(position, viewportSegments);\n}\n\nexport function inPolygon(position: Point, polygon: Polygon): boolean {\n  let val = polygon[0][0];\n  for (let i = 0; i < polygon.length; ++i) {\n    val = Math.min(polygon[i][0], val);\n    val = Math.min(polygon[i][1], val);\n  }\n  const edge: Point = [val - 1, val - 1];\n  let parity = 0;\n  for (let i = 0; i < polygon.length; ++i) {\n    let j = i + 1;\n    if (j === polygon.length) {\n      j = 0;\n    }\n    if (\n      doLineSegmentsIntersect(\n        edge[0],\n        edge[1],\n        position[0],\n        position[1],\n        polygon[i][0],\n        polygon[i][1],\n        polygon[j][0],\n        polygon[j][1]\n      )\n    ) {\n      const intersect = intersectLines(edge, position, polygon[i], polygon[j]);\n      if (intersect.length !== 2) {\n        continue;\n      }\n      if (equal(position, intersect as Point)) {\n        return true;\n      }\n      if (equal(intersect as Point, polygon[i])) {\n        if (angle2(position, edge, polygon[j]) < 180) {\n          ++parity;\n        }\n      } else if (equal(intersect as Point, polygon[j])) {\n        if (angle2(position, edge, polygon[i]) < 180) {\n          ++parity;\n        }\n      } else {\n        ++parity;\n      }\n    }\n  }\n  return parity % 2 !== 0;\n}\n\nexport function convertToSegments(polygons: Polygon[]): Segment[] {\n  const segments: Segment[] = [];\n  for (let i = 0; i < polygons.length; ++i) {\n    for (let j = 0; j < polygons[i].length; ++j) {\n      let k = j + 1;\n      if (k === polygons[i].length) {\n        k = 0;\n      }\n      segments.push([\n        [polygons[i][j][0], polygons[i][j][1]],\n        [polygons[i][k][0], polygons[i][k][1]],\n      ]);\n    }\n  }\n  return segments;\n}\n\nexport function breakIntersections(segments: Segment[]): Segment[] {\n  const output: Segment[] = [];\n  for (let i = 0; i < segments.length; ++i) {\n    const intersections: Point[] = [];\n    for (let j = 0; j < segments.length; ++j) {\n      if (i === j) {\n        continue;\n      }\n      if (\n        doLineSegmentsIntersect(\n          segments[i][0][0],\n          segments[i][0][1],\n          segments[i][1][0],\n          segments[i][1][1],\n          segments[j][0][0],\n          segments[j][0][1],\n          segments[j][1][0],\n          segments[j][1][1]\n        )\n      ) {\n        const intersect = intersectLines(\n          segments[i][0],\n          segments[i][1],\n          segments[j][0],\n          segments[j][1]\n        );\n        if (intersect.length !== 2) {\n          continue;\n        }\n        if (equal(intersect as Point, segments[i][0])) {\n          continue;\n        }\n        if (equal(intersect as Point, segments[i][1])) {\n          continue;\n        }\n        intersections.push(intersect as Point);\n      }\n    }\n    const start: Point = [segments[i][0][0], segments[i][0][1]];\n    while (intersections.length > 0) {\n      let endIndex = 0;\n      let endDis = distance(start, intersections[0]);\n      for (let j = 1; j < intersections.length; ++j) {\n        const dis = distance(start, intersections[j]);\n        if (dis < endDis) {\n          endDis = dis;\n          endIndex = j;\n        }\n      }\n      output.push([\n        [start[0], start[1]],\n        [intersections[endIndex][0], intersections[endIndex][1]],\n      ]);\n      start[0] = intersections[endIndex][0];\n      start[1] = intersections[endIndex][1];\n      intersections.splice(endIndex, 1);\n    }\n    output.push([\n      [start[0], start[1]],\n      [segments[i][1][0], segments[i][1][1]],\n    ]);\n  }\n  return output;\n}\n\nfunction epsilon() {\n  return 0.0000001;\n}\n\nfunction equal(a: Point, b: Point) {\n  return (\n    Math.abs(a[0] - b[0]) < epsilon() &&\n    Math.abs(a[1] - b[1]) < epsilon()\n  );\n}\n\nfunction remove(\n  index: number,\n  heap: number[],\n  position: Point,\n  segments: Segment[],\n  destination: Point,\n  map: number[]\n) {\n  map[heap[index]] = -1;\n  if (index === heap.length - 1) {\n    heap.pop();\n    return;\n  }\n  heap[index] = heap.pop() as number;\n  map[heap[index]] = index;\n  let cur = index;\n  const parentIndex = parent(cur);\n  if (cur !== 0 && lessThan(heap[cur], heap[parentIndex], position, segments, destination)) {\n    while (cur > 0) {\n      const parentNode = parent(cur);\n      if (!lessThan(heap[cur], heap[parentNode], position, segments, destination)) {\n        break;\n      }\n      map[heap[parentNode]] = cur;\n      map[heap[cur]] = parentNode;\n      const temp = heap[cur];\n      heap[cur] = heap[parentNode];\n      heap[parentNode] = temp;\n      cur = parentNode;\n    }\n  } else {\n    while (true) {\n      const left = child(cur);\n      const right = left + 1;\n      if (\n        left < heap.length &&\n        lessThan(heap[left], heap[cur], position, segments, destination) &&\n        (right === heap.length ||\n          lessThan(heap[left], heap[right], position, segments, destination))\n      ) {\n        map[heap[left]] = cur;\n        map[heap[cur]] = left;\n        const temp = heap[left];\n        heap[left] = heap[cur];\n        heap[cur] = temp;\n        cur = left;\n      } else if (\n        right < heap.length &&\n        lessThan(heap[right], heap[cur], position, segments, destination)\n      ) {\n        map[heap[right]] = cur;\n        map[heap[cur]] = right;\n        const temp = heap[right];\n        heap[right] = heap[cur];\n        heap[cur] = temp;\n        cur = right;\n      } else {\n        break;\n      }\n    }\n  }\n}\n\nfunction insert(\n  index: number,\n  heap: number[],\n  position: Point,\n  segments: Segment[],\n  destination: Point,\n  map: number[]\n) {\n  const intersect = intersectLines(segments[index][0], segments[index][1], position, destination);\n  if (intersect.length === 0) {\n    return;\n  }\n  let cur = heap.length;\n  heap.push(index);\n  map[index] = cur;\n  while (cur > 0) {\n    const parentNode = parent(cur);\n    if (!lessThan(heap[cur], heap[parentNode], position, segments, destination)) {\n      break;\n    }\n    map[heap[parentNode]] = cur;\n    map[heap[cur]] = parentNode;\n    const temp = heap[cur];\n    heap[cur] = heap[parentNode];\n    heap[parentNode] = temp;\n    cur = parentNode;\n  }\n}\n\nfunction lessThan(\n  index1: number,\n  index2: number,\n  position: Point,\n  segments: Segment[],\n  destination: Point\n) {\n  const inter1 = intersectLines(segments[index1][0], segments[index1][1], position, destination);\n  const inter2 = intersectLines(segments[index2][0], segments[index2][1], position, destination);\n  if (inter1.length !== 2 || inter2.length !== 2) {\n    return false;\n  }\n  if (!equal(inter1 as Point, inter2 as Point)) {\n    const d1 = distance(inter1 as Point, position);\n    const d2 = distance(inter2 as Point, position);\n    return d1 < d2;\n  }\n  let end1 = 0;\n  if (equal(inter1 as Point, segments[index1][0])) {\n    end1 = 1;\n  }\n  let end2 = 0;\n  if (equal(inter2 as Point, segments[index2][0])) {\n    end2 = 1;\n  }\n  const a1 = angle2(segments[index1][end1], inter1 as Point, position);\n  const a2 = angle2(segments[index2][end2], inter2 as Point, position);\n  if (a1 < 180) {\n    if (a2 > 180) {\n      return true;\n    }\n    return a2 < a1;\n  }\n  return a1 < a2;\n}\n\nfunction parent(index: number) {\n  return Math.floor((index - 1) / 2);\n}\n\nfunction child(index: number) {\n  return 2 * index + 1;\n}\n\nfunction angle2(a: Point, b: Point, c: Point) {\n  const a1 = angle(a, b);\n  const a2 = angle(b, c);\n  let a3 = a1 - a2;\n  if (a3 < 0) {\n    a3 += 360;\n  }\n  if (a3 > 360) {\n    a3 -= 360;\n  }\n  return a3;\n}\n\nfunction sortPoints(position: Point, segments: Segment[]): SortedPoint[] {\n  const points: SortedPoint[] = new Array(segments.length * 2);\n  for (let i = 0; i < segments.length; ++i) {\n    for (let j = 0; j < 2; ++j) {\n      const a = angle(segments[i][j], position);\n      points[2 * i + j] = [i, j, a];\n    }\n  }\n  points.sort((a, b) => a[2] - b[2]);\n  return points;\n}\n\nfunction angle(a: Point, b: Point) {\n  return (Math.atan2(b[1] - a[1], b[0] - a[0]) * 180) / Math.PI;\n}\n\nfunction intersectLines(a1: Point, a2: Point, b1: Point, b2: Point): Point | [] {\n  const dbx = b2[0] - b1[0];\n  const dby = b2[1] - b1[1];\n  const dax = a2[0] - a1[0];\n  const day = a2[1] - a1[1];\n  const u_b = dby * dax - dbx * day;\n  if (u_b !== 0) {\n    const ua = (dbx * (a1[1] - b1[1]) - dby * (a1[0] - b1[0])) / u_b;\n    return [a1[0] - ua * -dax, a1[1] - ua * -day];\n  }\n  return [];\n}\n\nfunction distance(a: Point, b: Point) {\n  const dx = a[0] - b[0];\n  const dy = a[1] - b[1];\n  return dx * dx + dy * dy;\n}\n\nfunction isOnSegment(xi: number, yi: number, xj: number, yj: number, xk: number, yk: number) {\n  return (\n    (xi <= xk || xj <= xk) &&\n    (xk <= xi || xk <= xj) &&\n    (yi <= yk || yj <= yk) &&\n    (yk <= yi || yk <= yj)\n  );\n}\n\nfunction computeDirection(xi: number, yi: number, xj: number, yj: number, xk: number, yk: number) {\n  const a = (xk - xi) * (yj - yi);\n  const b = (xj - xi) * (yk - yi);\n  return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction doLineSegmentsIntersect(\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  x3: number,\n  y3: number,\n  x4: number,\n  y4: number\n) {\n  const d1 = computeDirection(x3, y3, x4, y4, x1, y1);\n  const d2 = computeDirection(x3, y3, x4, y4, x2, y2);\n  const d3 = computeDirection(x1, y1, x2, y2, x3, y3);\n  const d4 = computeDirection(x1, y1, x2, y2, x4, y4);\n  return (\n    (((d1 > 0 && d2 < 0) || (d1 < 0 && d2 > 0)) &&\n      ((d3 > 0 && d4 < 0) || (d3 < 0 && d4 > 0))) ||\n    (d1 === 0 && isOnSegment(x3, y3, x4, y4, x1, y1)) ||\n    (d2 === 0 && isOnSegment(x3, y3, x4, y4, x2, y2)) ||\n    (d3 === 0 && isOnSegment(x1, y1, x2, y2, x3, y3)) ||\n    (d4 === 0 && isOnSegment(x1, y1, x2, y2, x4, y4))\n  );\n}\n\nfunction inViewport(position: Point, viewportMinCorner: Point, viewportMaxCorner: Point) {\n  if (position[0] < viewportMinCorner[0] - epsilon()) {\n    return false;\n  }\n  if (position[1] < viewportMinCorner[1] - epsilon()) {\n    return false;\n  }\n  if (position[0] > viewportMaxCorner[0] + epsilon()) {\n    return false;\n  }\n  if (position[1] > viewportMaxCorner[1] + epsilon()) {\n    return false;\n  }\n  return true;\n}\n","import { useEffect, useMemo, useRef } from \"react\";\nimport { Group, Line, Rect } from \"react-konva\";\n\nimport { useMapHeight, useMapWidth } from \"../../contexts/MapInteractionContext\";\nimport { useGridCellNormalizedSize } from \"../../contexts/GridContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport { Map } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\nimport { Wall } from \"../../types/Wall\";\nimport { FogSettings } from \"../../types/Settings\";\n\nimport {\n  breakIntersections,\n  computeViewport,\n  Point,\n  Polygon,\n  Segment,\n} from \"../../helpers/visibility\";\n\ntype FogOfWarLayerProps = {\n  map: Map | null;\n  mapState: MapState | null;\n  fogSettings?: FogSettings;\n  onExploredChange?: (explored: number[][][][]) => void;\n  tokenPreview?: Record<string, { x: number; y: number }>;\n  useTokenPreview?: boolean;\n};\n\ntype LightPolygon = {\n  polygon: Polygon;\n  color: string;\n};\n\nfunction wallToSegments(wall: Wall): Segment[] {\n  const segments: Segment[] = [];\n  for (let i = 0; i < wall.points.length - 1; i++) {\n    const a = wall.points[i];\n    const b = wall.points[i + 1];\n    segments.push([\n      [a.x, a.y],\n      [b.x, b.y],\n    ]);\n  }\n  return segments;\n}\n\nfunction createEllipseSegments(\n  center: Point,\n  radiusX: number,\n  radiusY: number,\n  steps = 32\n): Segment[] {\n  const segments: Segment[] = [];\n  if (radiusX <= 0 || radiusY <= 0 || steps < 3) {\n    return segments;\n  }\n  const points: Point[] = [];\n  for (let i = 0; i < steps; i++) {\n    const angle = (Math.PI * 2 * i) / steps;\n    points.push([\n      center[0] + Math.cos(angle) * radiusX,\n      center[1] + Math.sin(angle) * radiusY,\n    ]);\n  }\n  for (let i = 0; i < points.length; i++) {\n    const next = i === points.length - 1 ? 0 : i + 1;\n    segments.push([points[i], points[next]]);\n  }\n  return segments;\n}\n\nfunction polygonToPoints(poly: Polygon, width: number, height: number) {\n  const points: number[] = [];\n  for (let i = 0; i < poly.length; i++) {\n    points.push(poly[i][0] * width, poly[i][1] * height);\n  }\n  return points;\n}\n\nfunction FogOfWarLayer({\n  map,\n  mapState,\n  fogSettings,\n  onExploredChange,\n  tokenPreview,\n  useTokenPreview,\n}: FogOfWarLayerProps) {\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const gridCellNormalizedSize = useGridCellNormalizedSize();\n  const userId = useUserId();\n  const fogEnabled = mapState?.fogEnabled ?? true;\n  const isOwner = !!(map && map.owner === userId);\n  const gmOpacity =\n    typeof fogSettings?.gmOpacity === \"number\" ? fogSettings.gmOpacity : 0.35;\n  const showExplored = !!mapState?.showExplored;\n  const baseFogOpacity = isOwner ? gmOpacity : 1;\n  const fogOpacity = Math.min(Math.max(baseFogOpacity, 0), 1);\n  const exploredCutOpacity = showExplored ? Math.min(0.2, fogOpacity) : 0;\n  const dimCutOpacity = Math.min(0.35, fogOpacity);\n\n  const walls = Object.values(mapState?.walls || {});\n  const wallsSignature =\n    walls.length === 0\n      ? \"\"\n      : walls\n          .map((wall) => {\n            const points = wall.points\n              .map((point) => `${point.x},${point.y}`)\n              .join(\";\");\n            return `${wall.id}:${points}`;\n          })\n          .join(\"|\");\n\n  const wallSegments = useMemo(() => {\n    if (!wallsSignature) {\n      return [];\n    }\n    const segments = walls.flatMap(wallToSegments);\n    return breakIntersections(segments);\n  }, [walls, wallsSignature]);\n\n  const tokens = useMemo(() => {\n    const baseTokens = Object.values(mapState?.tokens || {});\n    if (\n      !useTokenPreview ||\n      !tokenPreview ||\n      Object.keys(tokenPreview).length === 0\n    ) {\n      return baseTokens;\n    }\n    return baseTokens.map((token) => {\n      const override = tokenPreview[token.id];\n      if (!override) {\n        return token;\n      }\n      return { ...token, x: override.x, y: override.y };\n    });\n  }, [mapState, tokenPreview, useTokenPreview]);\n\n  const visionSources = useMemo(() => {\n    return tokens\n      .filter((token) => token.hasVision && token.visible)\n      .map((token) => ({\n        x: token.x,\n        y: token.y,\n        range: typeof token.visionRange === \"number\" ? token.visionRange : 0,\n      }));\n  }, [tokens]);\n\n  const lightSources = useMemo(() => {\n    return tokens\n      .filter((token) => token.visible && token.lightConfig?.enabled)\n      .map((token) => ({\n        x: token.x,\n        y: token.y,\n        bright:\n          typeof token.lightConfig?.radiusBright === \"number\"\n            ? token.lightConfig.radiusBright\n            : 0,\n        dim:\n          typeof token.lightConfig?.radiusDim === \"number\"\n            ? token.lightConfig.radiusDim\n            : 0,\n        color: token.lightConfig?.color || \"#ffffff\",\n      }));\n  }, [tokens]);\n\n  const visibilityPolygons = useMemo(() => {\n    if (!fogEnabled) {\n      return [];\n    }\n    if (gridCellNormalizedSize.x <= 0 || gridCellNormalizedSize.y <= 0) {\n      return [];\n    }\n    const viewportMin: Point = [0, 0];\n    const viewportMax: Point = [1, 1];\n    const polygons: Polygon[] = [];\n    for (let source of visionSources) {\n      const radiusX = source.range * gridCellNormalizedSize.x;\n      const radiusY = source.range * gridCellNormalizedSize.y;\n      if (radiusX <= 0 || radiusY <= 0) {\n        continue;\n      }\n      const ellipseSegments = createEllipseSegments(\n        [source.x, source.y],\n        radiusX,\n        radiusY\n      );\n      const segments = breakIntersections([...wallSegments, ...ellipseSegments]);\n      const poly = computeViewport(\n        [source.x, source.y],\n        segments,\n        viewportMin,\n        viewportMax\n      );\n      if (poly.length > 2) {\n        polygons.push(poly);\n      }\n    }\n    return polygons;\n  }, [fogEnabled, gridCellNormalizedSize, visionSources, wallSegments]);\n\n  const lightBrightPolygons = useMemo<LightPolygon[]>(() => {\n    if (!fogEnabled) {\n      return [];\n    }\n    if (gridCellNormalizedSize.x <= 0 || gridCellNormalizedSize.y <= 0) {\n      return [];\n    }\n    const viewportMin: Point = [0, 0];\n    const viewportMax: Point = [1, 1];\n    const polygons: LightPolygon[] = [];\n    for (let source of lightSources) {\n      const radiusX = source.bright * gridCellNormalizedSize.x;\n      const radiusY = source.bright * gridCellNormalizedSize.y;\n      if (radiusX <= 0 || radiusY <= 0) {\n        continue;\n      }\n      const ellipseSegments = createEllipseSegments(\n        [source.x, source.y],\n        radiusX,\n        radiusY\n      );\n      const segments = breakIntersections([...wallSegments, ...ellipseSegments]);\n      const poly = computeViewport(\n        [source.x, source.y],\n        segments,\n        viewportMin,\n        viewportMax\n      );\n      if (poly.length > 2) {\n        polygons.push({ polygon: poly, color: source.color });\n      }\n    }\n    return polygons;\n  }, [fogEnabled, gridCellNormalizedSize, lightSources, wallSegments]);\n\n  const lightDimPolygons = useMemo<LightPolygon[]>(() => {\n    if (!fogEnabled) {\n      return [];\n    }\n    if (gridCellNormalizedSize.x <= 0 || gridCellNormalizedSize.y <= 0) {\n      return [];\n    }\n    const viewportMin: Point = [0, 0];\n    const viewportMax: Point = [1, 1];\n    const polygons: LightPolygon[] = [];\n    for (let source of lightSources) {\n      const radiusX =\n        Math.max(source.dim, source.bright) * gridCellNormalizedSize.x;\n      const radiusY =\n        Math.max(source.dim, source.bright) * gridCellNormalizedSize.y;\n      if (radiusX <= 0 || radiusY <= 0 || source.dim <= source.bright) {\n        continue;\n      }\n      const ellipseSegments = createEllipseSegments(\n        [source.x, source.y],\n        radiusX,\n        radiusY\n      );\n      const segments = breakIntersections([...wallSegments, ...ellipseSegments]);\n      const poly = computeViewport(\n        [source.x, source.y],\n        segments,\n        viewportMin,\n        viewportMax\n      );\n      if (poly.length > 2) {\n        polygons.push({ polygon: poly, color: source.color });\n      }\n    }\n    return polygons;\n  }, [fogEnabled, gridCellNormalizedSize, lightSources, wallSegments]);\n\n  const exploredPolygons = useMemo<Polygon[]>(() => {\n    if (!showExplored) {\n      return [];\n    }\n    const explored = (mapState?.explored ?? []) as number[][][][];\n    const result: Polygon[] = [];\n    for (const entry of explored) {\n      if (!Array.isArray(entry)) {\n        continue;\n      }\n      for (const polygon of entry) {\n        if (Array.isArray(polygon) && polygon.length > 2) {\n          result.push(polygon as Polygon);\n        }\n      }\n    }\n    return result;\n  }, [mapState?.explored, showExplored]);\n\n  const exploredRef = useRef<number[][][][] | undefined>(undefined);\n  const visibilitySignatureRef = useRef<string>(\"\");\n  const visibilitySignature = useMemo(() => {\n    if (visibilityPolygons.length === 0) {\n      return \"\";\n    }\n    return JSON.stringify(visibilityPolygons);\n  }, [visibilityPolygons]);\n  const exploredTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  useEffect(() => {\n    if (!fogEnabled || visibilityPolygons.length === 0 || !onExploredChange) {\n      return;\n    }\n    const explored = (mapState?.explored ?? []) as number[][][][];\n    if (\n      exploredRef.current === explored &&\n      visibilitySignatureRef.current === visibilitySignature\n    ) {\n      return;\n    }\n    exploredRef.current = explored;\n    visibilitySignatureRef.current = visibilitySignature;\n    const newExplored = [\n      ...explored,\n      ...visibilityPolygons.map((polygon) => [polygon]),\n    ];\n    if (exploredTimeoutRef.current) {\n      clearTimeout(exploredTimeoutRef.current);\n    }\n    exploredTimeoutRef.current = setTimeout(() => {\n      onExploredChange(newExplored);\n    }, 300);\n    return () => {\n      if (exploredTimeoutRef.current) {\n        clearTimeout(exploredTimeoutRef.current);\n        exploredTimeoutRef.current = null;\n      }\n    };\n  }, [\n    fogEnabled,\n    visibilityPolygons,\n    visibilitySignature,\n    mapState?.explored,\n    onExploredChange,\n  ]);\n\n  if (!map || !mapState || !fogEnabled) {\n    return null;\n  }\n  if (mapWidth <= 0 || mapHeight <= 0) {\n    return null;\n  }\n\n  return (\n    <Group listening={false}>\n      <Rect\n        x={0}\n        y={0}\n        width={mapWidth}\n        height={mapHeight}\n        fill={`rgba(0,0,0,${fogOpacity})`}\n      />\n      {exploredPolygons.map((polygon, index) => (\n        <Line\n          key={`explored-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill={`rgba(0,0,0,${exploredCutOpacity})`}\n          stroke={undefined}\n          globalCompositeOperation=\"destination-out\"\n        />\n      ))}\n      {lightDimPolygons.map(({ polygon }, index) => (\n        <Line\n          key={`light-dim-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill={`rgba(0,0,0,${dimCutOpacity})`}\n          stroke={undefined}\n          globalCompositeOperation=\"destination-out\"\n        />\n      ))}\n      {lightBrightPolygons.map(({ polygon }, index) => (\n        <Line\n          key={`light-bright-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill=\"black\"\n          stroke={undefined}\n          globalCompositeOperation=\"destination-out\"\n        />\n      ))}\n      {visibilityPolygons.map((polygon, index) => (\n        <Line\n          key={`vision-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill=\"black\"\n          stroke={undefined}\n          globalCompositeOperation=\"destination-out\"\n        />\n      ))}\n      {lightDimPolygons.map(({ polygon, color }, index) => (\n        <Line\n          key={`light-dim-tint-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill={color}\n          stroke={undefined}\n          opacity={0.12}\n        />\n      ))}\n      {lightBrightPolygons.map(({ polygon, color }, index) => (\n        <Line\n          key={`light-bright-tint-${index}`}\n          points={polygonToPoints(polygon, mapWidth, mapHeight)}\n          closed\n          fill={color}\n          stroke={undefined}\n          opacity={0.22}\n        />\n      ))}\n    </Group>\n  );\n}\n\nexport default FogOfWarLayer;\n","import simplify from \"simplify-js\";\nimport polygonClipping, { Geom, Polygon, Ring } from \"polygon-clipping\";\n\nimport Vector2, { BoundingBox } from \"./Vector2\";\nimport Size from \"./Size\";\nimport { toDegrees } from \"./shared\";\nimport { getNearestCellCoordinates, getCellLocation } from \"./grid\";\n\nimport {\n  ShapeType,\n  ShapeData,\n  PointsData,\n  RectData,\n  CircleData,\n} from \"../types/Drawing\";\nimport { Fog } from \"../types/Fog\";\nimport { Grid } from \"../types/Grid\";\n\n/**\n *\n * @param {ShapeType} type\n * @param {Vector2} brushPosition\n * @returns {ShapeData}\n */\nexport function getDefaultShapeData(\n  type: ShapeType,\n  brushPosition: Vector2\n): ShapeData {\n  if (type === \"line\") {\n    return {\n      points: [\n        { x: brushPosition.x, y: brushPosition.y },\n        { x: brushPosition.x, y: brushPosition.y },\n      ],\n    };\n  } else if (type === \"circle\") {\n    return { x: brushPosition.x, y: brushPosition.y, radius: 0 };\n  } else if (type === \"rectangle\") {\n    return {\n      x: brushPosition.x,\n      y: brushPosition.y,\n      width: 0,\n      height: 0,\n    };\n  } else if (type === \"triangle\") {\n    return {\n      points: [\n        { x: brushPosition.x, y: brushPosition.y },\n        { x: brushPosition.x, y: brushPosition.y },\n        { x: brushPosition.x, y: brushPosition.y },\n      ],\n    };\n  } else {\n    throw new Error(\"Shape type not implemented\");\n  }\n}\n\n/**\n * @param {Vector2} cellSize\n * @returns {Vector2}\n */\nexport function getGridCellRatio(cellSize: Vector2): Vector2 {\n  if (cellSize.x < cellSize.y) {\n    return { x: cellSize.y / cellSize.x, y: 1 };\n  } else if (cellSize.y < cellSize.x) {\n    return { x: 1, y: cellSize.x / cellSize.y };\n  } else {\n    return { x: 1, y: 1 };\n  }\n}\n\n/**\n *\n * @param {ShapeType} type\n * @param {ShapeData} data\n * @param {Vector2} brushPosition\n * @param {Vector2} gridCellNormalizedSize\n * @returns {ShapeData}\n */\nexport function getUpdatedShapeData(\n  type: ShapeType,\n  data: ShapeData,\n  brushPosition: Vector2,\n  gridCellNormalizedSize: Vector2,\n  mapWidth: number,\n  mapHeight: number\n): ShapeData {\n  if (type === \"line\") {\n    data = data as PointsData;\n    return {\n      points: [data.points[0], { x: brushPosition.x, y: brushPosition.y }],\n    } as PointsData;\n  } else if (type === \"circle\") {\n    data = data as CircleData;\n    const gridRatio = getGridCellRatio(gridCellNormalizedSize);\n    const dif = Vector2.subtract(brushPosition, {\n      x: data.x,\n      y: data.y,\n    });\n    const scaled = Vector2.multiply(dif, gridRatio);\n    const distance = Vector2.magnitude(scaled);\n    return {\n      ...data,\n      radius: distance,\n    };\n  } else if (type === \"rectangle\") {\n    data = data as RectData;\n    const dif = Vector2.subtract(brushPosition, { x: data.x, y: data.y });\n    return {\n      ...data,\n      width: dif.x,\n      height: dif.y,\n    };\n  } else if (type === \"triangle\") {\n    data = data as PointsData;\n    // Convert to absolute coordinates\n    const mapSize = { x: mapWidth, y: mapHeight };\n    const brushPositionPixel = Vector2.multiply(brushPosition, mapSize);\n\n    const points = data.points;\n    const startPixel = Vector2.multiply(points[0], mapSize);\n    const dif = Vector2.subtract(brushPositionPixel, startPixel);\n    const length = Vector2.magnitude(dif);\n    const direction = Vector2.normalize(dif);\n    // Get the angle for a triangle who's width is the same as it's length\n    const angle = Math.atan(length / 2 / (length === 0 ? 1 : length));\n    const sideLength = length / Math.cos(angle);\n\n    const leftDir = Vector2.rotateDirection(direction, toDegrees(angle));\n    const rightDir = Vector2.rotateDirection(direction, -toDegrees(angle));\n\n    // Convert back to normalized coordinates\n    const leftDirNorm = Vector2.divide(leftDir, mapSize);\n    const rightDirNorm = Vector2.divide(rightDir, mapSize);\n\n    return {\n      points: [\n        points[0],\n        Vector2.add(Vector2.multiply(leftDirNorm, sideLength), points[0]),\n        Vector2.add(Vector2.multiply(rightDirNorm, sideLength), points[0]),\n      ],\n    };\n  } else {\n    throw new Error(\"Shape type not implemented\");\n  }\n}\n\n/**\n * Simplify points to a grid size\n * @param {Vector2[]} points\n * @param {number} tolerance\n */\nexport function simplifyPoints(\n  points: Vector2[],\n  tolerance: number\n): Vector2[] {\n  return simplify(points, tolerance);\n}\n\n/**\n * Merges overlapping fog shapes\n * @param {Fog[]} shapes\n * @param {boolean} ignoreHidden\n * @returns {Fog[]}\n */\nexport function mergeFogShapes(\n  shapes: Fog[],\n  ignoreHidden: boolean = true\n): Fog[] {\n  if (shapes.length === 0) {\n    return shapes;\n  }\n  let geometries: Geom[] = [];\n  for (let shape of shapes) {\n    if (ignoreHidden && !shape.visible) {\n      continue;\n    }\n    const shapePoints: Ring = shape.data.points.map(({ x, y }) => [x, y]);\n    const shapeHoles: Polygon = shape.data.holes.map((hole) =>\n      hole.map(({ x, y }: { x: number; y: number }) => [x, y])\n    );\n    let shapeGeom: Geom = [[shapePoints, ...shapeHoles]];\n    geometries.push(shapeGeom);\n  }\n  if (geometries.length === 0) {\n    return [];\n  }\n  try {\n    let union = polygonClipping.union(geometries[0], ...geometries.slice(1));\n    let merged: Fog[] = [];\n    for (let i = 0; i < union.length; i++) {\n      let holes: Vector2[][] = [];\n      if (union[i].length > 1) {\n        for (let j = 1; j < union[i].length; j++) {\n          holes.push(union[i][j].map(([x, y]) => ({ x, y })));\n        }\n      }\n      // find the first visible shape\n      let visibleShape = shapes.find((shape) => ignoreHidden || shape.visible);\n      if (!visibleShape) {\n        // TODO: handle if visible shape not found\n        throw Error;\n      }\n      merged.push({\n        // Use the data of the first visible shape as the merge\n        ...visibleShape,\n        id: `merged-${i}`,\n        data: {\n          points: union[i][0].map(([x, y]) => ({ x, y })),\n          holes,\n        },\n        type: \"fog\",\n      });\n    }\n    return merged;\n  } catch {\n    console.error(\"Unable to merge shapes\");\n    return shapes;\n  }\n}\n\n/**\n * @param {Fog[]} shapes\n * @param {boolean} maxPoints Max amount of points per shape to get bounds for\n * @returns {Vector2.BoundingBox[]}\n */\nexport function getFogShapesBoundingBoxes(\n  shapes: Fog[],\n  maxPoints = 0\n): BoundingBox[] {\n  let boxes = [];\n  for (let shape of shapes) {\n    if (maxPoints > 0 && shape.data.points.length > maxPoints) {\n      continue;\n    }\n    boxes.push(Vector2.getBoundingBox(shape.data.points));\n  }\n  return boxes;\n}\n\n/**\n * @typedef Guide\n * @property {Vector2} start\n * @property {Vector2} end\n * @property {(\"horizontal\"|\"vertical\")} orientation\n * @property {number} distance\n */\n\nexport type Guide = {\n  start: Vector2;\n  end: Vector2;\n  orientation: \"horizontal\" | \"vertical\";\n  distance: number;\n};\n\n/**\n * @param {Vector2} brushPosition Brush position in pixels\n * @param {Vector2} grid\n * @param {Vector2} gridCellSize Grid cell size in pixels\n * @param {Vector2} gridOffset\n * @param {Vector2} gridCellOffset\n * @param {number} snappingSensitivity\n * @param {Vector2} mapSize\n * @returns {Guide[]}\n */\nexport function getGuidesFromGridCell(\n  brushPosition: Vector2,\n  grid: Grid,\n  gridCellSize: Size,\n  gridOffset: Vector2,\n  gridCellOffset: Vector2,\n  snappingSensitivity: number,\n  mapSize: Vector2\n): Guide[] {\n  let boundingBoxes = [];\n  // Add map bounds\n  boundingBoxes.push(\n    Vector2.getBoundingBox([\n      { x: 0, y: 0 },\n      { x: 1, y: 1 },\n    ])\n  );\n  let offsetPosition = Vector2.subtract(\n    Vector2.subtract(brushPosition, gridOffset),\n    gridCellOffset\n  );\n  const cellCoords = getNearestCellCoordinates(\n    grid,\n    offsetPosition.x,\n    offsetPosition.y,\n    gridCellSize\n  );\n  let cellPosition = getCellLocation(\n    grid,\n    cellCoords.x,\n    cellCoords.y,\n    gridCellSize\n  );\n  cellPosition = Vector2.add(\n    Vector2.add(cellPosition, gridOffset),\n    gridCellOffset\n  );\n  // Normalize values so output is normalized\n  cellPosition = Vector2.divide(cellPosition, mapSize);\n  const gridCellNormalizedSize = Vector2.divide(gridCellSize, mapSize);\n  const brushPositionNorm = Vector2.divide(brushPosition, mapSize);\n  const boundingBox = Vector2.getBoundingBox([\n    {\n      x: cellPosition.x - gridCellNormalizedSize.x / 2,\n      y: cellPosition.y - gridCellNormalizedSize.y / 2,\n    },\n    {\n      x: cellPosition.x + gridCellNormalizedSize.x / 2,\n      y: cellPosition.y + gridCellNormalizedSize.y / 2,\n    },\n  ]);\n  boundingBoxes.push(boundingBox);\n  return getGuidesFromBoundingBoxes(\n    brushPositionNorm,\n    boundingBoxes,\n    gridCellNormalizedSize,\n    snappingSensitivity\n  );\n}\n\n/**\n * @param {Vector2} brushPosition\n * @param {Vector2.BoundingBox[]} boundingBoxes\n * @param {Vector2} gridCellSize\n * @param {number} snappingSensitivity\n * @returns {Guide[]}\n */\nexport function getGuidesFromBoundingBoxes(\n  brushPosition: Vector2,\n  boundingBoxes: BoundingBox[],\n  gridCellSize: Vector2, // TODO: check if this was meant to be of type Size\n  snappingSensitivity: number\n): Guide[] {\n  let horizontalEdges = [];\n  let verticalEdges = [];\n  for (let bounds of boundingBoxes) {\n    horizontalEdges.push({\n      start: { x: bounds.min.x, y: bounds.min.y },\n      end: { x: bounds.max.x, y: bounds.min.y },\n    });\n    horizontalEdges.push({\n      start: { x: bounds.min.x, y: bounds.center.y },\n      end: { x: bounds.max.x, y: bounds.center.y },\n    });\n    horizontalEdges.push({\n      start: { x: bounds.min.x, y: bounds.max.y },\n      end: { x: bounds.max.x, y: bounds.max.y },\n    });\n\n    verticalEdges.push({\n      start: { x: bounds.min.x, y: bounds.min.y },\n      end: { x: bounds.min.x, y: bounds.max.y },\n    });\n    verticalEdges.push({\n      start: { x: bounds.center.x, y: bounds.min.y },\n      end: { x: bounds.center.x, y: bounds.max.y },\n    });\n    verticalEdges.push({\n      start: { x: bounds.max.x, y: bounds.min.y },\n      end: { x: bounds.max.x, y: bounds.max.y },\n    });\n  }\n  let guides: Guide[] = [];\n  for (let edge of verticalEdges) {\n    const distance = Math.abs(brushPosition.x - edge.start.x);\n    if (distance / gridCellSize.x < snappingSensitivity) {\n      guides.push({ ...edge, distance, orientation: \"vertical\" });\n    }\n  }\n  for (let edge of horizontalEdges) {\n    const distance = Math.abs(brushPosition.y - edge.start.y);\n    if (distance / gridCellSize.y < snappingSensitivity) {\n      guides.push({ ...edge, distance, orientation: \"horizontal\" });\n    }\n  }\n  return guides;\n}\n\n/**\n * @param {Vector2} brushPosition\n * @param {Guide[]} guides\n * @returns {Guide[]}\n */\nexport function findBestGuides(\n  brushPosition: Vector2,\n  guides: Guide[]\n): Guide[] {\n  let bestGuides: Guide[] = [];\n  let verticalGuide = guides\n    .filter((guide) => guide.orientation === \"vertical\")\n    .sort((a, b) => a.distance - b.distance)[0];\n  let horizontalGuide = guides\n    .filter((guide) => guide.orientation === \"horizontal\")\n    .sort((a, b) => a.distance - b.distance)[0];\n\n  // Offset edges to match brush position\n  if (verticalGuide && !horizontalGuide) {\n    verticalGuide.start.y = Math.min(verticalGuide.start.y, brushPosition.y);\n    verticalGuide.end.y = Math.max(verticalGuide.end.y, brushPosition.y);\n    bestGuides.push(verticalGuide);\n  }\n  if (horizontalGuide && !verticalGuide) {\n    horizontalGuide.start.x = Math.min(\n      horizontalGuide.start.x,\n      brushPosition.x\n    );\n    horizontalGuide.end.x = Math.max(horizontalGuide.end.x, brushPosition.x);\n    bestGuides.push(horizontalGuide);\n  }\n  if (horizontalGuide && verticalGuide) {\n    verticalGuide.start.y = Math.min(\n      verticalGuide.start.y,\n      horizontalGuide.start.y\n    );\n    verticalGuide.end.y = Math.max(\n      verticalGuide.end.y,\n      horizontalGuide.start.y\n    );\n\n    horizontalGuide.start.x = Math.min(\n      horizontalGuide.start.x,\n      verticalGuide.start.x\n    );\n    horizontalGuide.end.x = Math.max(\n      horizontalGuide.end.x,\n      verticalGuide.start.x\n    );\n\n    bestGuides.push(horizontalGuide);\n    bestGuides.push(verticalGuide);\n  }\n  return bestGuides;\n}\n","import Konva from \"konva\";\nimport Vector2 from \"./Vector2\";\n\n/**\n * @param {Konva.Node} node\n * @returns {Vector2}\n */\nexport function getRelativePointerPosition(\n  node: Konva.Node\n): Vector2 | undefined {\n  let transform = node.getAbsoluteTransform().copy();\n  transform.invert();\n  let position = node.getStage()?.getPointerPosition();\n  if (!position) {\n    return;\n  }\n  return transform.point(position);\n}\n\nexport function getRelativePointerPositionNormalized(\n  node: Konva.Node\n): Vector2 | undefined {\n  const relativePosition = getRelativePointerPosition(node);\n  if (!relativePosition) {\n    return;\n  }\n  return {\n    x: relativePosition.x / node.width(),\n    y: relativePosition.y / node.height(),\n  };\n}\n\n/**\n * Converts points from alternating array form to vector array form\n * @param {number[]} numbers points in an x, y alternating array\n * @returns {Vector2[]} a `Vector2` array\n */\nexport function convertNumbersToPoints(numbers: number[]): Vector2[] {\n  return numbers.reduce((acc: Vector2[], _, i, arr) => {\n    if (i % 2 === 0) {\n      acc.push({ x: arr[i], y: arr[i + 1] });\n    }\n    return acc;\n  }, []);\n}\n\n/**\n * Converts points from vector array form to alternating number array form\n * @param {Vector2[]} points\n * @returns {number[]}\n */\nexport function convertPointsToNumbers(points: Vector2[]): number[] {\n  return points.reduce(\n    (acc: number[], point: Vector2) => [...acc, point.x, point.y],\n    []\n  );\n}\n\nexport function scaleAndFlattenPoints(\n  points: Vector2[],\n  scale: Vector2\n): number[] {\n  return convertPointsToNumbers(points.map((p) => Vector2.multiply(p, scale)));\n}\n","import Vector2 from \"../helpers/Vector2\";\nimport {\n  getCellLocation,\n  getNearestCellCoordinates,\n  getCellCorners,\n} from \"../helpers/grid\";\n\nimport {\n  useGrid,\n  useGridOffset,\n  useGridCellPixelSize,\n  useGridCellPixelOffset,\n  useGridSnappingSensitivity,\n} from \"../contexts/GridContext\";\n\n/**\n * Returns a function that when called will snap a node to the current grid\n * @param {number=} snappingSensitivity 1 = Always snap, 0 = never snap if undefined the default user setting will be used\n * @param {boolean=} useCorners Snap to grid cell corners\n */\nfunction useGridSnapping(\n  snappingSensitivity: number | undefined = undefined,\n  useCorners: boolean = true\n) {\n  const defaultSnappingSensitivity = useGridSnappingSensitivity();\n  let gridSnappingSensitivity: number;\n  if (defaultSnappingSensitivity === -1) {\n    // Snapping disabled via shortcut\n    gridSnappingSensitivity = 0;\n  } else if (snappingSensitivity === undefined) {\n    gridSnappingSensitivity = defaultSnappingSensitivity;\n  } else {\n    gridSnappingSensitivity = snappingSensitivity;\n  }\n\n  const grid = useGrid();\n  const gridOffset = useGridOffset();\n  const gridCellPixelSize = useGridCellPixelSize();\n  const gridCellPixelOffset = useGridCellPixelOffset();\n\n  /**\n   * @param {Vector2} node The node to snap\n   */\n  function snapPositionToGrid(position: Vector2) {\n    // Account for grid offset\n    let offsetPosition = Vector2.subtract(\n      Vector2.subtract(position, gridOffset),\n      gridCellPixelOffset\n    );\n    const nearsetCell = getNearestCellCoordinates(\n      grid,\n      offsetPosition.x,\n      offsetPosition.y,\n      gridCellPixelSize\n    );\n    const cellPosition = getCellLocation(\n      grid,\n      nearsetCell.x,\n      nearsetCell.y,\n      gridCellPixelSize\n    );\n    const cellCorners = getCellCorners(\n      grid,\n      cellPosition.x,\n      cellPosition.y,\n      gridCellPixelSize\n    );\n\n    const snapPoints = [cellPosition];\n    if (useCorners) {\n      snapPoints.push(...cellCorners);\n    }\n\n    for (let snapPoint of snapPoints) {\n      const distanceToSnapPoint = Vector2.distance(offsetPosition, snapPoint);\n      if (\n        distanceToSnapPoint <\n        Vector2.componentMin(gridCellPixelSize) * gridSnappingSensitivity\n      ) {\n        // Reverse grid offset\n        let offsetSnapPoint = Vector2.add(\n          Vector2.add(snapPoint, gridOffset),\n          gridCellPixelOffset\n        );\n        return offsetSnapPoint;\n      }\n    }\n\n    return position;\n  }\n\n  return snapPositionToGrid;\n}\n\nexport default useGridSnapping;\n","import Konva from \"konva\";\nimport { Circle, Line, Rect } from \"react-konva\";\nimport {\n  useMapHeight,\n  useMapWidth,\n} from \"../../contexts/MapInteractionContext\";\nimport colors from \"../../helpers/colors\";\nimport { scaleAndFlattenPoints } from \"../../helpers/konva\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { Drawing as DrawingType } from \"../../types/Drawing\";\n\ntype DrawingProps = {\n  drawing: DrawingType;\n} & Konva.ShapeConfig;\n\nfunction getDashArray(\n  dashStyle: DrawingType[\"dashStyle\"],\n  strokeWidth: number\n): number[] | undefined {\n  if (!dashStyle || dashStyle === \"solid\") {\n    return undefined;\n  }\n  const unit = Math.max(1, strokeWidth);\n  if (dashStyle === \"dashed\") {\n    return [unit * 4, unit * 2];\n  }\n  if (dashStyle === \"dotted\") {\n    return [unit, unit * 2];\n  }\n  return undefined;\n}\n\nfunction Drawing({ drawing, ...props }: DrawingProps) {\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const mapSize = new Vector2(mapWidth, mapHeight);\n  const strokeWidth =\n    typeof props.strokeWidth === \"number\" ? props.strokeWidth : 1;\n  const dash =\n    strokeWidth === 0 ? undefined : getDashArray(drawing.dashStyle, strokeWidth);\n\n  const resolvedColor =\n    drawing.color in colors\n      ? colors[drawing.color as keyof typeof colors]\n      : drawing.color;\n\n  const defaultProps = {\n    fill: resolvedColor,\n    stroke: resolvedColor,\n    opacity:\n      typeof drawing.opacity === \"number\"\n        ? drawing.opacity\n        : drawing.blend\n        ? 0.5\n        : 1,\n    id: drawing.id,\n  };\n\n  if (drawing.type === \"path\") {\n    return (\n      <Line\n        points={scaleAndFlattenPoints(drawing.data.points, mapSize)}\n        tension={0.5}\n        closed={drawing.pathType === \"fill\"}\n        fillEnabled={drawing.pathType === \"fill\"}\n        lineCap=\"round\"\n        lineJoin=\"round\"\n        {...defaultProps}\n        {...props}\n      />\n    );\n  } else if (drawing.type === \"shape\") {\n    if (drawing.shapeType === \"rectangle\") {\n      return (\n        <Rect\n          x={drawing.data.x * mapWidth}\n          y={drawing.data.y * mapHeight}\n          width={drawing.data.width * mapWidth}\n          height={drawing.data.height * mapHeight}\n          fillEnabled={props.strokeWidth === 0}\n          {...defaultProps}\n          {...props}\n          dash={dash}\n        />\n      );\n    } else if (drawing.shapeType === \"circle\") {\n      const minSide = mapWidth < mapHeight ? mapWidth : mapHeight;\n      return (\n        <Circle\n          x={drawing.data.x * mapWidth}\n          y={drawing.data.y * mapHeight}\n          radius={drawing.data.radius * minSide}\n          fillEnabled={props.strokeWidth === 0}\n          {...defaultProps}\n          {...props}\n          dash={dash}\n        />\n      );\n    } else if (drawing.shapeType === \"triangle\") {\n      return (\n        <Line\n          points={scaleAndFlattenPoints(drawing.data.points, mapSize)}\n          closed={true}\n          fillEnabled={props.strokeWidth === 0}\n          {...defaultProps}\n          {...props}\n          dash={dash}\n        />\n      );\n    } else if (drawing.shapeType === \"line\") {\n      return (\n        <Line\n          points={scaleAndFlattenPoints(drawing.data.points, mapSize)}\n          lineCap=\"round\"\n          {...defaultProps}\n          {...props}\n          dash={dash}\n        />\n      );\n    }\n  }\n\n  return null;\n}\n\nexport default Drawing;\n","import { useState, useEffect, useCallback } from \"react\";\nimport Konva from \"konva\";\nimport shortid from \"shortid\";\nimport { Group, Rect, Line as KonvaLine } from \"react-konva\";\n\nimport {\n  useDebouncedStageScale,\n  useMapWidth,\n  useMapHeight,\n  useInteractionEmitter,\n  leftMouseButton,\n  MapDragEvent,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport {\n  useGridCellNormalizedSize,\n  useGridStrokeWidth,\n} from \"../../contexts/GridContext\";\n\nimport Vector2 from \"../../helpers/Vector2\";\nimport {\n  getDefaultShapeData,\n  getUpdatedShapeData,\n  simplifyPoints,\n} from \"../../helpers/drawing\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\n\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport DrawingShape from \"../konva/Drawing\";\n\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\nimport shortcuts from \"../../shortcuts\";\n\nimport { Map } from \"../../types/Map\";\nimport {\n  Drawing,\n  DrawingToolSettings,\n  drawingToolIsShape,\n  Shape,\n  Line,\n} from \"../../types/Drawing\";\n\nexport type DrawingAddEventHanlder = (drawing: Drawing) => void;\nexport type DrawingsRemoveEventHandler = (drawingIds: string[]) => void;\nexport type DrawingsEditEventHandler = (drawings: Partial<Drawing>[]) => void;\n\ntype MapDrawingProps = {\n  map: Map | null;\n  drawings: Drawing[];\n  onDrawingAdd: DrawingAddEventHanlder;\n  onDrawingsRemove: DrawingsRemoveEventHandler;\n  onDrawingsEdit: DrawingsEditEventHandler;\n  active: boolean;\n  toolSettings: DrawingToolSettings;\n};\n\nfunction DrawingTool({\n  map,\n  drawings,\n  onDrawingAdd: onShapeAdd,\n  onDrawingsRemove: onShapesRemove,\n  onDrawingsEdit: onShapesEdit,\n  active,\n  toolSettings,\n}: MapDrawingProps) {\n  const stageScale = useDebouncedStageScale();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const interactionEmitter = useInteractionEmitter();\n\n  const gridCellNormalizedSize = useGridCellNormalizedSize();\n  const gridStrokeWidth = useGridStrokeWidth();\n\n  const mapStageRef = useMapStage();\n  const [drawing, setDrawing] = useState<Drawing | null>(null);\n  const [penDrawing, setPenDrawing] = useState<Line | null>(null);\n  const [isBrushDown, setIsBrushDown] = useState(false);\n  const [erasingDrawings, setErasingDrawings] = useState<Drawing[]>([]);\n\n  const shouldHover = toolSettings.type === \"erase\" && active;\n\n  const isPen = toolSettings.type === \"pen\";\n  const isDrag = toolSettings.type === \"drag\";\n  const isBrush =\n    toolSettings.type === \"brush\" || toolSettings.type === \"paint\";\n  const isShape =\n    toolSettings.type === \"line\" ||\n    toolSettings.type === \"rectangle\" ||\n    toolSettings.type === \"circle\" ||\n    toolSettings.type === \"triangle\";\n\n  const snapPositionToGrid = useGridSnapping();\n\n  const getBrushPosition = useCallback(() => {\n    const mapStage = mapStageRef.current;\n    if (!mapStage || !map) {\n      return;\n    }\n    const mapImage = mapStage.findOne(\"#mapImage\");\n    let position = getRelativePointerPosition(mapImage);\n    if (!position) {\n      return;\n    }\n    if (map.snapToGrid && (isShape || isPen)) {\n      position = snapPositionToGrid(position);\n    }\n    return Vector2.divide(position, {\n      x: mapImage.width(),\n      y: mapImage.height(),\n    });\n  }, [mapStageRef, map, isShape, isPen, snapPositionToGrid]);\n\n  useEffect(() => {\n    if (!active || isDrag) {\n      return;\n    }\n    if (isPen) {\n      return;\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      const commonShapeData = {\n        color: toolSettings.color,\n        blend: toolSettings.useBlending,\n        opacity:\n          typeof toolSettings.opacity === \"number\"\n            ? toolSettings.opacity\n            : toolSettings.useBlending\n            ? 0.5\n            : 1,\n        dashStyle: toolSettings.dashStyle,\n        id: shortid.generate(),\n      };\n      const type = toolSettings.type;\n      if (isBrush) {\n        setDrawing({\n          type: \"path\",\n          pathType: type === \"brush\" ? \"stroke\" : \"fill\",\n          data: { points: [brushPosition] },\n          strokeWidth:\n            type === \"brush\"\n              ? typeof toolSettings.strokeWidth === \"number\"\n                ? toolSettings.strokeWidth\n                : 1\n              : 0,\n          ...commonShapeData,\n        });\n      } else if (isShape && drawingToolIsShape(type)) {\n        setDrawing({\n          type: \"shape\",\n          shapeType: type,\n          data: getDefaultShapeData(type, brushPosition),\n          strokeWidth:\n            toolSettings.type === \"line\" || !toolSettings.useShapeFill\n              ? typeof toolSettings.strokeWidth === \"number\"\n                ? toolSettings.strokeWidth\n                : 1\n              : 0,\n          ...commonShapeData,\n        } as Shape);\n      }\n      setIsBrushDown(true);\n    }\n\n    function handleBrushMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      if (isBrushDown && drawing) {\n        if (isBrush) {\n          setDrawing((prevShape) => {\n            if (prevShape?.type !== \"path\") {\n              return prevShape;\n            }\n            const prevPoints = prevShape.data.points;\n            if (\n              Vector2.compare(\n                prevPoints[prevPoints.length - 1],\n                brushPosition,\n                0.001\n              )\n            ) {\n              return prevShape;\n            }\n            const simplified = simplifyPoints(\n              [...prevPoints, brushPosition],\n              1 / 1000 / stageScale\n            );\n            return {\n              ...prevShape,\n              data: { points: simplified },\n            };\n          });\n        } else if (isShape) {\n          setDrawing((prevShape) => {\n            if (prevShape?.type !== \"shape\") {\n              return prevShape;\n            }\n            return {\n              ...prevShape,\n              data: getUpdatedShapeData(\n                prevShape.shapeType,\n                prevShape.data,\n                brushPosition,\n                gridCellNormalizedSize,\n                mapWidth,\n                mapHeight\n              ),\n            } as Shape;\n          });\n        }\n      }\n    }\n\n    function handleBrushUp(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (isBrush && drawing && drawing.type === \"path\") {\n        if (drawing.data.points.length > 1) {\n          onShapeAdd(drawing);\n        }\n      } else if (isShape && drawing) {\n        onShapeAdd(drawing);\n      }\n\n      eraseHoveredShapes();\n\n      setDrawing(null);\n      setIsBrushDown(false);\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n    };\n  });\n\n  const removeLastPenPoint = useCallback(() => {\n    setPenDrawing((prevShape) => {\n      if (!prevShape) {\n        return prevShape;\n      }\n      if (prevShape.data.points.length > 2) {\n        return {\n          ...prevShape,\n          data: {\n            ...prevShape.data,\n            points: [\n              ...prevShape.data.points.slice(0, -2),\n              ...prevShape.data.points.slice(-1),\n            ],\n          },\n        };\n      }\n      return null;\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!active || !isPen || isDrag) {\n      if (penDrawing) {\n        setPenDrawing(null);\n      }\n      return;\n    }\n    const mapStage = mapStageRef.current;\n    if (!mapStage) {\n      return;\n    }\n\n    function handlePointerMove() {\n      if (!penDrawing) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      setPenDrawing((prevShape) => {\n        if (!prevShape) {\n          return prevShape;\n        }\n        return {\n          ...prevShape,\n          data: {\n            ...prevShape.data,\n            points: [\n              ...prevShape.data.points.slice(0, -1),\n              brushPosition,\n            ],\n          },\n        };\n      });\n    }\n\n    function handlePointerClick() {\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      setPenDrawing((prevShape) => {\n        if (!prevShape) {\n          return {\n            type: \"shape\",\n            shapeType: \"line\",\n            data: { points: [brushPosition, brushPosition] },\n            strokeWidth:\n              typeof toolSettings.strokeWidth === \"number\"\n                ? toolSettings.strokeWidth\n                : 1,\n            color: toolSettings.color,\n            blend: toolSettings.useBlending,\n            opacity:\n              typeof toolSettings.opacity === \"number\"\n                ? toolSettings.opacity\n                : toolSettings.useBlending\n                ? 0.5\n                : 1,\n            dashStyle: toolSettings.dashStyle,\n            id: shortid.generate(),\n          };\n        }\n        return {\n          ...prevShape,\n          data: {\n            ...prevShape.data,\n            points: [\n              ...prevShape.data.points.slice(0, -1),\n              brushPosition,\n              brushPosition,\n            ],\n          },\n        };\n      });\n    }\n\n    mapStage.on(\"mousemove touchmove\", handlePointerMove);\n    mapStage.on(\"click tap\", handlePointerClick);\n\n    return () => {\n      mapStage.off(\"mousemove touchmove\", handlePointerMove);\n      mapStage.off(\"click tap\", handlePointerClick);\n    };\n  }, [\n    active,\n    isPen,\n    isDrag,\n    mapStageRef,\n    penDrawing,\n    getBrushPosition,\n    toolSettings.strokeWidth,\n    toolSettings.color,\n    toolSettings.useBlending,\n    toolSettings.opacity,\n    toolSettings.dashStyle,\n  ]);\n\n  const finishPenDrawing = useCallback(() => {\n    if (!penDrawing) {\n      return;\n    }\n    const points = penDrawing.data.points.slice(0, -1);\n    if (points.length > 1) {\n      onShapeAdd({\n        ...penDrawing,\n        data: {\n          ...penDrawing.data,\n          points,\n        },\n      });\n    }\n    setPenDrawing(null);\n  }, [penDrawing, onShapeAdd]);\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (!active || !isPen || !penDrawing) {\n      return;\n    }\n    if (shortcuts.fogFinishPolygon(event)) {\n      finishPenDrawing();\n    } else if (shortcuts.fogCancelPolygon(event)) {\n      setPenDrawing(null);\n    } else if (shortcuts.delete(event)) {\n      removeLastPenPoint();\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  function handleShapeOver(shape: Drawing, isDown: boolean) {\n    if (shouldHover && isDown) {\n      if (erasingDrawings.findIndex((s) => s.id === shape.id) === -1) {\n        setErasingDrawings((prevShapes) => [...prevShapes, shape]);\n      }\n    }\n  }\n\n  function eraseHoveredShapes() {\n    if (erasingDrawings.length > 0) {\n      onShapesRemove(erasingDrawings.map((shape) => shape.id));\n      setErasingDrawings([]);\n    }\n  }\n\n  function renderDrawing(shape: Drawing) {\n    const isDraggingEnabled = active && isDrag;\n    function handleDragEnd(\n      event: Konva.KonvaEventObject<DragEvent>\n    ) {\n      if (!isDraggingEnabled) {\n        return;\n      }\n      const node = event.target;\n      const { x, y } = node.position();\n      if (x === 0 && y === 0) {\n        return;\n      }\n      if (mapWidth === 0 || mapHeight === 0) {\n        return;\n      }\n      const isRect = shape.type === \"shape\" && shape.shapeType === \"rectangle\";\n      const isCircle = shape.type === \"shape\" && shape.shapeType === \"circle\";\n      const baseX =\n        isRect || isCircle ? shape.data.x * mapWidth : 0;\n      const baseY =\n        isRect || isCircle ? shape.data.y * mapHeight : 0;\n      const dxPx = x - baseX;\n      const dyPx = y - baseY;\n      node.position({ x: baseX, y: baseY });\n      const dx = dxPx / mapWidth;\n      const dy = dyPx / mapHeight;\n      const shiftPoint = (point: Vector2) => ({\n        x: point.x + dx,\n        y: point.y + dy,\n      });\n      let updated: Drawing | null = null;\n      if (shape.type === \"path\") {\n        updated = {\n          ...shape,\n          data: {\n            points: shape.data.points.map(shiftPoint),\n          },\n        };\n      } else if (shape.type === \"shape\") {\n        if (shape.shapeType === \"rectangle\") {\n          updated = {\n            ...shape,\n            data: {\n              ...shape.data,\n              x: shape.data.x + dx,\n              y: shape.data.y + dy,\n            },\n          };\n        } else if (shape.shapeType === \"circle\") {\n          updated = {\n            ...shape,\n            data: {\n              ...shape.data,\n              x: shape.data.x + dx,\n              y: shape.data.y + dy,\n            },\n          };\n        } else {\n          updated = {\n            ...shape,\n            data: {\n              points: shape.data.points.map(shiftPoint),\n            },\n          };\n        }\n      }\n      if (updated) {\n        onShapesEdit([updated]);\n      }\n    }\n    return (\n      <DrawingShape\n        drawing={shape}\n        key={shape.id}\n        onMouseMove={() => handleShapeOver(shape, isBrushDown)}\n        onTouchOver={() => handleShapeOver(shape, isBrushDown)}\n        onMouseDown={() => handleShapeOver(shape, true)}\n        onTouchStart={() => handleShapeOver(shape, true)}\n        onMouseUp={eraseHoveredShapes}\n        onTouchEnd={eraseHoveredShapes}\n        strokeWidth={gridStrokeWidth * shape.strokeWidth}\n        hitStrokeWidth={Math.max(\n          12 / stageScale,\n          gridStrokeWidth * shape.strokeWidth * 2\n        )}\n        draggable={isDraggingEnabled}\n        onDragEnd={handleDragEnd}\n      />\n    );\n  }\n\n  function handlePenFinish(\n    event: Konva.KonvaEventObject<MouseEvent | TouchEvent>\n  ) {\n    event.cancelBubble = true;\n    finishPenDrawing();\n  }\n\n  function handlePenUndo(\n    event: Konva.KonvaEventObject<MouseEvent | TouchEvent>\n  ) {\n    event.cancelBubble = true;\n    removeLastPenPoint();\n  }\n\n  function renderPenControls() {\n    if (!penDrawing) {\n      return null;\n    }\n    const start = penDrawing.data.points[0];\n    if (!start) {\n      return null;\n    }\n    const position = Vector2.multiply(start, {\n      x: mapWidth,\n      y: mapHeight,\n    });\n    const controlSize = 22 / stageScale;\n    const gap = 6 / stageScale;\n    const offset = 12 / stageScale;\n    const totalWidth = controlSize * 2 + gap;\n    const stroke = Math.max(1, 1 / stageScale);\n    const x = Math.min(\n      Math.max(position.x + offset, 0),\n      mapWidth - totalWidth\n    );\n    const y = Math.min(\n      Math.max(position.y - offset - controlSize, 0),\n      mapHeight - controlSize\n    );\n\n    return (\n      <Group x={x} y={y}>\n        <Group onClick={handlePenFinish} onTap={handlePenFinish}>\n          <Rect\n            width={controlSize}\n            height={controlSize}\n            cornerRadius={controlSize / 4}\n            fill=\"rgba(0,0,0,0.7)\"\n            stroke=\"white\"\n            strokeWidth={stroke}\n          />\n          <KonvaLine\n            points={[\n              controlSize * 0.25,\n              controlSize * 0.55,\n              controlSize * 0.45,\n              controlSize * 0.75,\n              controlSize * 0.75,\n              controlSize * 0.3,\n            ]}\n            stroke=\"white\"\n            strokeWidth={stroke * 2}\n            lineCap=\"round\"\n            lineJoin=\"round\"\n          />\n        </Group>\n        <Group x={controlSize + gap} onClick={handlePenUndo} onTap={handlePenUndo}>\n          <Rect\n            width={controlSize}\n            height={controlSize}\n            cornerRadius={controlSize / 4}\n            fill=\"rgba(0,0,0,0.7)\"\n            stroke=\"white\"\n            strokeWidth={stroke}\n          />\n          <KonvaLine\n            points={[\n              controlSize * 0.7,\n              controlSize * 0.25,\n              controlSize * 0.35,\n              controlSize * 0.5,\n              controlSize * 0.7,\n              controlSize * 0.75,\n            ]}\n            stroke=\"white\"\n            strokeWidth={stroke * 2}\n            lineCap=\"round\"\n            lineJoin=\"round\"\n          />\n        </Group>\n      </Group>\n    );\n  }\n\n  function renderErasingDrawing(drawing: Drawing) {\n    const eraseShape: Drawing = {\n      ...drawing,\n      color: \"primary\",\n    };\n    return renderDrawing(eraseShape);\n  }\n\n  return (\n    <Group>\n      {drawings.map(renderDrawing)}\n      {drawing && renderDrawing(drawing)}\n      {penDrawing && renderDrawing(penDrawing)}\n      {penDrawing && renderPenControls()}\n      {erasingDrawings.length > 0 && erasingDrawings.map(renderErasingDrawing)}\n    </Group>\n  );\n}\n\nexport default DrawingTool;\n","import Vector2 from \"../helpers/Vector2\";\nimport { Color } from \"../helpers/colors\";\n\nexport type DrawingColor = Color | string;\n\nexport type DashStyle = \"solid\" | \"dashed\" | \"dotted\";\n\nexport type DrawingToolType =\n  | \"brush\"\n  | \"paint\"\n  | \"line\"\n  | \"rectangle\"\n  | \"circle\"\n  | \"triangle\"\n  | \"erase\"\n  | \"pen\"\n  | \"drag\";\n\nexport type DrawingToolSettings = {\n  type: DrawingToolType;\n  color: DrawingColor;\n  useBlending: boolean;\n  useShapeFill: boolean;\n  opacity: number;\n  strokeWidth: number;\n  dashStyle: DashStyle;\n};\n\nexport type PointsData = {\n  points: Vector2[];\n};\n\nexport type RectData = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport type CircleData = {\n  x: number;\n  y: number;\n  radius: number;\n};\n\nexport type ShapeData = PointsData | RectData | CircleData;\n\nexport type BaseDrawing = {\n  blend: boolean;\n  color: DrawingColor;\n  id: string;\n  strokeWidth: number;\n  opacity?: number;\n  dashStyle?: DashStyle;\n};\n\nexport type BaseShape = BaseDrawing & {\n  type: \"shape\";\n};\n\nexport type Line = BaseShape & {\n  shapeType: \"line\";\n  data: PointsData;\n};\n\nexport type Rectangle = BaseShape & {\n  shapeType: \"rectangle\";\n  data: RectData;\n};\n\nexport type Circle = BaseShape & {\n  shapeType: \"circle\";\n  data: CircleData;\n};\n\nexport type Triangle = BaseShape & {\n  shapeType: \"triangle\";\n  data: PointsData;\n};\n\nexport type ShapeType =\n  | Line[\"shapeType\"]\n  | Rectangle[\"shapeType\"]\n  | Circle[\"shapeType\"]\n  | Triangle[\"shapeType\"];\n\nexport type Shape = Line | Rectangle | Circle | Triangle;\n\nexport type Path = BaseDrawing & {\n  type: \"path\";\n  pathType: \"fill\" | \"stroke\";\n  data: PointsData;\n};\n\nexport type Drawing = Shape | Path;\n\nexport function drawingToolIsShape(type: DrawingToolType): type is ShapeType {\n  return (\n    type === \"line\" ||\n    type === \"rectangle\" ||\n    type === \"circle\" ||\n    type === \"triangle\"\n  );\n}\n\nexport type DrawingState = Record<string, Drawing>;\n","import Konva from \"konva\";\nimport { useState } from \"react\";\nimport { Circle, Group, Path } from \"react-konva\";\n\ntype TickProps = {\n  x: number;\n  y: number;\n  scale: number;\n  onClick: (evt: Konva.KonvaEventObject<MouseEvent>) => void;\n  cross: boolean;\n};\n\nexport function Tick({ x, y, scale, onClick, cross }: TickProps) {\n  const [fill, setFill] = useState(\"white\");\n  function handleEnter() {\n    setFill(\"hsl(260, 100%, 80%)\");\n  }\n\n  function handleLeave() {\n    setFill(\"white\");\n  }\n  return (\n    <Group\n      x={x}\n      y={y}\n      scaleX={scale}\n      scaleY={scale}\n      onMouseEnter={handleEnter}\n      onMouseLeave={handleLeave}\n      onClick={onClick}\n      onTap={onClick}\n    >\n      <Circle radius={12} fill=\"hsla(230, 25%, 18%, 0.8)\" />\n      <Path\n        offsetX={12}\n        offsetY={12}\n        fill={fill}\n        data={\n          cross\n            ? \"M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z\"\n            : \"M9 16.2l-3.5-3.5c-.39-.39-1.01-.39-1.4 0-.39.39-.39 1.01 0 1.4l4.19 4.19c.39.39 1.02.39 1.41 0L20.3 7.7c.39-.39.39-1.01 0-1.4-.39-.39-1.01-.39-1.4 0L9 16.2z\"\n        }\n      />\n    </Group>\n  );\n}\n\nexport default Tick;\n","import { useState, useEffect, useCallback } from \"react\";\nimport { Group, Line } from \"react-konva\";\nimport Konva from \"konva\";\nimport shortid from \"shortid\";\n\nimport {\n  useDebouncedStageScale,\n  useMapWidth,\n  useMapHeight,\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport Vector2 from \"../../helpers/Vector2\";\nimport { simplifyPoints } from \"../../helpers/drawing\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\nimport { scaleAndFlattenPoints } from \"../../helpers/konva\";\nimport colors from \"../../helpers/colors\";\n\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport shortcuts from \"../../shortcuts\";\n\nimport { Map } from \"../../types/Map\";\nimport { Wall } from \"../../types/Wall\";\nimport { FogToolSettings } from \"../../types/Fog\";\n\nimport Tick from \"../konva/Tick\";\n\ntype WallAddEventHandler = (walls: Wall[]) => void;\ntype WallRemoveEventHandler = (wallIds: string[]) => void;\n\ntype WallToolProps = {\n  map: Map | null;\n  walls: Wall[];\n  onWallsAdd: WallAddEventHandler;\n  onWallsRemove: WallRemoveEventHandler;\n  active: boolean;\n  toolSettings: FogToolSettings;\n  editable: boolean;\n};\n\nfunction WallTool({\n  map,\n  walls,\n  onWallsAdd,\n  onWallsRemove,\n  active,\n  toolSettings,\n  editable,\n}: WallToolProps) {\n  const stageScale = useDebouncedStageScale();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const interactionEmitter = useInteractionEmitter();\n  const mapStageRef = useMapStage();\n  const gridStrokeWidth = useGridStrokeWidth();\n\n  const snapPositionToGrid = useGridSnapping();\n\n  const [drawingWall, setDrawingWall] = useState<Wall | null>(null);\n  const [penWall, setPenWall] = useState<Wall | null>(null);\n  const [isBrushDown, setIsBrushDown] = useState(false);\n  const [erasingWalls, setErasingWalls] = useState<Wall[]>([]);\n\n  const isPen = toolSettings.type === \"polygon\";\n  const isLine = toolSettings.type === \"rectangle\";\n  const isBrush = toolSettings.type === \"brush\";\n  const isErase =\n    toolSettings.type === \"remove\" || toolSettings.type === \"toggle\";\n\n  const shouldHover = active && editable && isErase;\n\n  const mapSize = new Vector2(mapWidth, mapHeight);\n\n  const getBrushPosition = useCallback(() => {\n    const mapStage = mapStageRef.current;\n    if (!mapStage || !map) {\n      return;\n    }\n    const mapImage = mapStage.findOne(\"#mapImage\");\n    let position = getRelativePointerPosition(mapImage);\n    if (!position) {\n      return;\n    }\n    if (map.snapToGrid && (isLine || isPen)) {\n      position = snapPositionToGrid(position);\n    }\n    return Vector2.divide(position, {\n      x: mapImage.width(),\n      y: mapImage.height(),\n    });\n  }, [mapStageRef, map, isLine, isPen, snapPositionToGrid]);\n\n  useEffect(() => {\n    if (!active || !editable || isPen) {\n      return;\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      if (isBrush) {\n        setDrawingWall({\n          id: shortid.generate(),\n          type: \"wall\",\n          points: [brushPosition],\n          blocksVision: true,\n        });\n      } else if (isLine) {\n        setDrawingWall({\n          id: shortid.generate(),\n          type: \"wall\",\n          points: [brushPosition, brushPosition],\n          blocksVision: true,\n        });\n      }\n      setIsBrushDown(true);\n    }\n\n    function handleBrushMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      if (isBrushDown && drawingWall) {\n        if (isBrush) {\n          setDrawingWall((prevWall) => {\n            if (!prevWall) {\n              return prevWall;\n            }\n            const prevPoints = prevWall.points;\n            if (\n              Vector2.compare(\n                prevPoints[prevPoints.length - 1],\n                brushPosition,\n                0.001\n              )\n            ) {\n              return prevWall;\n            }\n            const points = simplifyPoints(\n              [...prevPoints, brushPosition],\n              1 / 1000 / stageScale\n            );\n            return {\n              ...prevWall,\n              points,\n            };\n          });\n        } else if (isLine) {\n          setDrawingWall((prevWall) => {\n            if (!prevWall) {\n              return prevWall;\n            }\n            return {\n              ...prevWall,\n              points: [prevWall.points[0], brushPosition],\n            };\n          });\n        }\n      }\n    }\n\n    function handleBrushUp(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (drawingWall) {\n        const points = drawingWall.points;\n        const lastPoint = points[points.length - 1];\n        const firstPoint = points[0];\n        const isTooShort =\n          points.length < 2 || Vector2.compare(firstPoint, lastPoint, 0.0001);\n        if (!isTooShort) {\n          onWallsAdd([{ ...drawingWall }]);\n        }\n      }\n      if (isErase) {\n        eraseHoveredWalls();\n      }\n      setDrawingWall(null);\n      setIsBrushDown(false);\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n    };\n  });\n\n  useEffect(() => {\n    if (!active || !editable || !isPen) {\n      if (penWall) {\n        setPenWall(null);\n      }\n      return;\n    }\n    const mapStage = mapStageRef.current;\n    if (!mapStage) {\n      return;\n    }\n\n    function handlePointerMove() {\n      if (!penWall) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      setPenWall((prevWall) => {\n        if (!prevWall) {\n          return prevWall;\n        }\n        return {\n          ...prevWall,\n          points: [...prevWall.points.slice(0, -1), brushPosition],\n        };\n      });\n    }\n\n    function handlePointerClick() {\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      setPenWall((prevWall) => {\n        if (!prevWall) {\n          return {\n            id: shortid.generate(),\n            type: \"wall\",\n            points: [brushPosition, brushPosition],\n            blocksVision: true,\n          };\n        }\n        return {\n          ...prevWall,\n          points: [\n            ...prevWall.points.slice(0, -1),\n            brushPosition,\n            brushPosition,\n          ],\n        };\n      });\n    }\n\n    mapStage.on(\"mousemove touchmove\", handlePointerMove);\n    mapStage.on(\"click tap\", handlePointerClick);\n\n    return () => {\n      mapStage.off(\"mousemove touchmove\", handlePointerMove);\n      mapStage.off(\"click tap\", handlePointerClick);\n    };\n  }, [active, editable, isPen, mapStageRef, penWall, getBrushPosition]);\n\n  const finishPenWall = useCallback(() => {\n    if (!penWall) {\n      return;\n    }\n    const points = penWall.points.slice(0, -1);\n    const simplified = simplifyPoints(points, 1 / 1000 / stageScale);\n    if (simplified.length > 1) {\n      onWallsAdd([\n        {\n          ...penWall,\n          points: simplified,\n        },\n      ]);\n    }\n    setPenWall(null);\n  }, [penWall, onWallsAdd, stageScale]);\n\n  const removeLastPenPoint = useCallback(() => {\n    setPenWall((prevWall) => {\n      if (!prevWall) {\n        return prevWall;\n      }\n      if (prevWall.points.length > 2) {\n        return {\n          ...prevWall,\n          points: [\n            ...prevWall.points.slice(0, -2),\n            ...prevWall.points.slice(-1),\n          ],\n        };\n      }\n      return null;\n    });\n  }, []);\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (!active || !isPen || !penWall) {\n      return;\n    }\n    if (shortcuts.fogFinishPolygon(event)) {\n      finishPenWall();\n    } else if (shortcuts.fogCancelPolygon(event)) {\n      setPenWall(null);\n    } else if (shortcuts.delete(event)) {\n      removeLastPenPoint();\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  function handleWallOver(wall: Wall, isDown: boolean) {\n    if (shouldHover && isDown) {\n      if (erasingWalls.findIndex((s) => s.id === wall.id) === -1) {\n        setErasingWalls((prevWalls) => [...prevWalls, wall]);\n      }\n    }\n  }\n\n  function eraseHoveredWalls() {\n    if (erasingWalls.length > 0) {\n      onWallsRemove(erasingWalls.map((wall) => wall.id));\n      setErasingWalls([]);\n    }\n  }\n\n  function renderWall(wall: Wall, color: string = colors.black) {\n    const strokeWidth = gridStrokeWidth * 1.5;\n    const hitStrokeWidth = Math.max(12 / stageScale, strokeWidth * 2);\n    return (\n      <Line\n        key={wall.id}\n        points={scaleAndFlattenPoints(wall.points, mapSize)}\n        stroke={color}\n        strokeWidth={strokeWidth}\n        lineCap=\"round\"\n        lineJoin=\"round\"\n        hitStrokeWidth={hitStrokeWidth}\n        onMouseMove={(e: Konva.KonvaEventObject<MouseEvent>) =>\n          (!isBrushDown || leftMouseButton(e)) &&\n          handleWallOver(wall, isBrushDown)\n        }\n        onTouchOver={() => handleWallOver(wall, isBrushDown)}\n        onMouseDown={(e: Konva.KonvaEventObject<MouseEvent>) =>\n          leftMouseButton(e) && handleWallOver(wall, true)\n        }\n        onTouchStart={() => handleWallOver(wall, true)}\n        onMouseUp={eraseHoveredWalls}\n        onTouchEnd={eraseHoveredWalls}\n      />\n    );\n  }\n\n  function renderErasingWall(wall: Wall) {\n    return renderWall(wall, colors.primary);\n  }\n\n  function renderDrawingWall(wall: Wall) {\n    return renderWall(wall, colors.darkGray || colors.black);\n  }\n\n  function renderPenAcceptTick(wall: Wall) {\n    if (wall.points.length === 0) {\n      return null;\n    }\n    const isCross = wall.points.length < 3;\n    return (\n      <Tick\n        x={wall.points[0].x * mapWidth}\n        y={wall.points[0].y * mapHeight}\n        scale={1 / stageScale}\n        cross={isCross}\n        onClick={(e) => {\n          e.cancelBubble = true;\n          if (isCross) {\n            setPenWall(null);\n          } else {\n            finishPenWall();\n          }\n        }}\n      />\n    );\n  }\n\n  return (\n    <Group>\n      {walls.map((wall) => renderWall(wall))}\n      {drawingWall && renderDrawingWall(drawingWall)}\n      {penWall && renderDrawingWall(penWall)}\n      {penWall && renderPenAcceptTick(penWall)}\n      {erasingWalls.length > 0 && erasingWalls.map(renderErasingWall)}\n    </Group>\n  );\n}\n\nexport default WallTool;\n","import { Group, Label, Line, Tag, Text } from \"react-konva\";\n\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\nimport {\n  useDebouncedStageScale,\n  useMapHeight,\n  useMapWidth,\n} from \"../../contexts/MapInteractionContext\";\n\nimport { scaleAndFlattenPoints } from \"../../helpers/konva\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { GridScale } from \"../../types/Grid\";\n\ntype RulerProps = {\n  points: Vector2[];\n  scale: GridScale;\n  length: number;\n};\n\nfunction Ruler({ points, scale, length }: RulerProps) {\n  const stageScale = useDebouncedStageScale();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const mapSize = new Vector2(mapWidth, mapHeight);\n\n  const gridStrokeWidth = useGridStrokeWidth();\n\n  const linePoints = scaleAndFlattenPoints(points, mapSize);\n\n  const lineCenter = Vector2.multiply(Vector2.centroid(points), mapSize);\n\n  return (\n    <Group>\n      <Line\n        points={linePoints}\n        strokeWidth={1.5 * gridStrokeWidth}\n        stroke=\"hsla(230, 25%, 18%, 0.8)\"\n        lineCap=\"round\"\n      />\n      <Line\n        points={linePoints}\n        strokeWidth={0.25 * gridStrokeWidth}\n        stroke=\"white\"\n        lineCap=\"round\"\n      />\n      <Label\n        x={lineCenter.x}\n        y={lineCenter.y}\n        offsetX={26}\n        offsetY={26}\n        scaleX={1 / stageScale}\n        scaleY={1 / stageScale}\n      >\n        <Tag fill=\"hsla(230, 25%, 18%, 0.8)\" cornerRadius={4} />\n        <Text\n          text={`${(length * scale.multiplier).toFixed(scale.digits)}${\n            scale.unit\n          }`}\n          fill=\"white\"\n          fontSize={24}\n          padding={4}\n        />\n      </Label>\n    </Group>\n  );\n}\n\nexport default Ruler;\n","import { useState, useEffect } from \"react\";\nimport { Group } from \"react-konva\";\n\nimport {\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport {\n  useGrid,\n  useGridCellPixelSize,\n  useGridCellNormalizedSize,\n  useGridOffset,\n} from \"../../contexts/GridContext\";\n\nimport {\n  getDefaultShapeData,\n  getUpdatedShapeData,\n} from \"../../helpers/drawing\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\nimport { parseGridScale, gridDistance } from \"../../helpers/grid\";\n\nimport Ruler from \"../konva/Ruler\";\n\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\nimport { Map } from \"../../types/Map\";\nimport { PointsData } from \"../../types/Drawing\";\n\ntype MapMeasureProps = {\n  map: Map | null;\n  active: boolean;\n};\n\ntype MeasureData = { length: number; points: Vector2[] };\n\nfunction MeasureTool({ map, active }: MapMeasureProps) {\n  const interactionEmitter = useInteractionEmitter();\n\n  const grid = useGrid();\n  const gridCellNormalizedSize = useGridCellNormalizedSize();\n  const gridCellPixelSize = useGridCellPixelSize();\n  const gridOffset = useGridOffset();\n\n  const mapStageRef = useMapStage();\n  const [drawingShapeData, setDrawingShapeData] = useState<MeasureData | null>(\n    null\n  );\n  const [isBrushDown, setIsBrushDown] = useState(false);\n\n  const gridScale = parseGridScale(active ? grid.measurement.scale : null);\n\n  const snapPositionToGrid = useGridSnapping(\n    grid.measurement.type === \"euclidean\" ? 0 : 1,\n    false\n  );\n\n  useEffect(() => {\n    if (!active) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n    const mapImage = mapStage?.findOne(\"#mapImage\");\n\n    function getBrushPosition() {\n      if (!mapImage) {\n        return;\n      }\n      let position = getRelativePointerPosition(mapImage);\n      if (!position) {\n        return;\n      }\n      if (map?.snapToGrid) {\n        position = snapPositionToGrid(position);\n      }\n      return Vector2.divide(position, {\n        x: mapImage.width(),\n        y: mapImage.height(),\n      });\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      const { points } = getDefaultShapeData(\n        \"line\",\n        brushPosition\n      ) as PointsData;\n      const length = 0;\n      setDrawingShapeData({ length, points });\n      setIsBrushDown(true);\n    }\n\n    function handleBrushMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (isBrushDown && drawingShapeData && brushPosition && mapImage) {\n        const { points } = getUpdatedShapeData(\n          \"line\",\n          drawingShapeData,\n          brushPosition,\n          gridCellNormalizedSize,\n          1,\n          1\n        ) as PointsData;\n        // Convert back to pixel values\n        const a = Vector2.subtract(\n          Vector2.multiply(points[0], {\n            x: mapImage.width(),\n            y: mapImage.height(),\n          }),\n          gridOffset\n        );\n        const b = Vector2.subtract(\n          Vector2.multiply(points[1], {\n            x: mapImage.width(),\n            y: mapImage.height(),\n          }),\n          gridOffset\n        );\n        const length = gridDistance(grid, a, b, gridCellPixelSize);\n        setDrawingShapeData({\n          length,\n          points,\n        });\n      }\n    }\n\n    function handleBrushUp(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      setDrawingShapeData(null);\n      setIsBrushDown(false);\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n    };\n  });\n\n  return (\n    <Group>\n      {drawingShapeData && (\n        <Ruler\n          points={drawingShapeData.points}\n          scale={gridScale}\n          length={drawingShapeData.length}\n        />\n      )}\n    </Group>\n  );\n}\n\nexport default MeasureTool;\n","import Konva from \"konva\";\nimport { Circle, Line, Rect, Group } from \"react-konva\";\n\nimport { useMapHeight, useMapWidth } from \"../../contexts/MapInteractionContext\";\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\nimport colors, { Color } from \"../../helpers/colors\";\nimport { convertPointsToNumbers } from \"../../helpers/konva\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { SpellTemplate } from \"../../types/SpellTemplate\";\n\ntype SpellTemplateProps = {\n  template: SpellTemplate;\n} & Konva.ShapeConfig;\n\nfunction SpellTemplateShape({ template, ...props }: SpellTemplateProps) {\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const gridStrokeWidth = useGridStrokeWidth();\n  const minSide = mapWidth < mapHeight ? mapWidth : mapHeight;\n\n  const origin = Vector2.multiply(template.origin, {\n    x: mapWidth,\n    y: mapHeight,\n  });\n\n  const strokeWidth = gridStrokeWidth * template.style.strokeWidth;\n  const color = colors[template.style.color as Color] || template.style.color;\n\n  if (template.type === \"circle\") {\n    const radius = (template.params.radius || 0) * minSide;\n    return (\n      <Circle\n        x={origin.x}\n        y={origin.y}\n        radius={radius}\n        fill={color}\n        stroke={color}\n        opacity={template.style.opacity}\n        strokeWidth={strokeWidth}\n        {...props}\n      />\n    );\n  }\n\n  if (template.type === \"ring\") {\n    const outerRadius = (template.params.radius || 0) * minSide;\n    const innerRadius = (template.params.innerRadius || 0) * minSide;\n    const ringWidth = Math.max(outerRadius - innerRadius, strokeWidth);\n    const ringRadius = innerRadius + ringWidth / 2;\n    const hitWidth = Math.max(10, ringWidth);\n    return (\n      <Circle\n        x={origin.x}\n        y={origin.y}\n        radius={ringRadius}\n        stroke={color}\n        opacity={template.style.opacity}\n        strokeWidth={ringWidth}\n        hitStrokeWidth={hitWidth}\n        {...props}\n      />\n    );\n  }\n\n  if (template.type === \"rectangle\") {\n    const width = (template.params.width || 0) * mapWidth;\n    const height = (template.params.height || 0) * mapHeight;\n    return (\n      <Rect\n        x={origin.x}\n        y={origin.y}\n        width={width}\n        height={height}\n        offsetX={width / 2}\n        offsetY={height / 2}\n        rotation={template.rotation}\n        fill={color}\n        stroke={color}\n        opacity={template.style.opacity}\n        strokeWidth={strokeWidth}\n        {...props}\n      />\n    );\n  }\n\n  if (template.type === \"cone\") {\n    const length = (template.params.length || 0) * minSide;\n    const angle = template.params.angle || 0;\n    const direction = {\n      x: Math.cos((template.rotation * Math.PI) / 180),\n      y: Math.sin((template.rotation * Math.PI) / 180),\n    };\n    const left = Vector2.rotateDirection(direction, angle / 2);\n    const right = Vector2.rotateDirection(direction, -angle / 2);\n    const points = [\n      origin,\n      Vector2.add(origin, Vector2.multiply(left, length)),\n      Vector2.add(origin, Vector2.multiply(right, length)),\n    ];\n    return (\n      <Line\n        points={convertPointsToNumbers(points)}\n        closed\n        fill={color}\n        stroke={color}\n        opacity={template.style.opacity}\n        strokeWidth={strokeWidth}\n        {...props}\n      />\n    );\n  }\n\n  if (template.type === \"line\" || template.type === \"path\") {\n    const points = (template.params.points || []).map((point) =>\n      Vector2.multiply(point, { x: mapWidth, y: mapHeight })\n    );\n    const width = (template.params.width || 0) * minSide;\n    const hitWidth = Math.max(12, width);\n    return (\n      <Line\n        points={convertPointsToNumbers(points)}\n        stroke={color}\n        opacity={template.style.opacity}\n        strokeWidth={width}\n        hitStrokeWidth={hitWidth}\n        lineCap=\"round\"\n        lineJoin=\"round\"\n        {...props}\n      />\n    );\n  }\n\n  return <Group />;\n}\n\nexport default SpellTemplateShape;\n","import Konva from \"konva\";\nimport { Group, Line } from \"react-konva\";\n\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\nimport colors, { Color } from \"../../helpers/colors\";\nimport { convertPointsToNumbers } from \"../../helpers/konva\";\n\nimport { AffectedCell } from \"../../helpers/spellTemplates\";\n\ntype SpellTemplateGridOverlayProps = {\n  cells: AffectedCell[];\n  color: string;\n  opacity: number;\n} & Konva.ShapeConfig;\n\nfunction SpellTemplateGridOverlay({\n  cells,\n  color,\n  opacity,\n  ...props\n}: SpellTemplateGridOverlayProps) {\n  const gridStrokeWidth = useGridStrokeWidth();\n  const strokeWidth = gridStrokeWidth * 0.75;\n  const displayColor = colors[color as Color] || color;\n\n  return (\n    <Group>\n      {cells.map((cell) => (\n        <Line\n          key={`${cell.col}-${cell.row}`}\n          points={convertPointsToNumbers(cell.polygon)}\n          closed\n          stroke={displayColor}\n          strokeWidth={strokeWidth}\n          opacity={opacity}\n          fill={displayColor}\n          fillEnabled\n          listening={false}\n          {...props}\n        />\n      ))}\n    </Group>\n  );\n}\n\nexport default SpellTemplateGridOverlay;\n","import polygonClipping, { Geom, Ring } from \"polygon-clipping\";\n\nimport Vector2, { BoundingBox } from \"./Vector2\";\nimport Size from \"./Size\";\nimport { getCellCorners, getCellLocation, getNearestCellCoordinates } from \"./grid\";\n\nimport { SpellTemplate, SpellTemplateRule } from \"../types/SpellTemplate\";\nimport { Grid } from \"../types/Grid\";\n\ntype MapSize = { x: number; y: number };\n\nexport type AffectedCell = {\n  col: number;\n  row: number;\n  polygon: Vector2[];\n  center: Vector2;\n};\n\nconst CIRCLE_SEGMENTS = 32;\n\nfunction toRing(points: Vector2[]): Ring {\n  return points.map(({ x, y }) => [x, y]);\n}\n\nfunction approximateCircle(\n  center: Vector2,\n  radius: number,\n  segments: number\n): Vector2[] {\n  let points: Vector2[] = [];\n  for (let i = 0; i < segments; i++) {\n    const angle = (Math.PI * 2 * i) / segments;\n    points.push({\n      x: center.x + Math.cos(angle) * radius,\n      y: center.y + Math.sin(angle) * radius,\n    });\n  }\n  return points;\n}\n\nfunction getMinSide(mapSize: MapSize) {\n  return mapSize.x < mapSize.y ? mapSize.x : mapSize.y;\n}\n\nfunction getTemplatePointsInPixels(\n  template: SpellTemplate,\n  mapSize: MapSize\n): Vector2[] {\n  const origin = Vector2.multiply(template.origin, mapSize);\n  const minSide = getMinSide(mapSize);\n\n  if (template.type === \"circle\" || template.type === \"ring\") {\n    const radius = (template.params.radius || 0) * minSide;\n    return approximateCircle(origin, radius, CIRCLE_SEGMENTS);\n  }\n  if (template.type === \"rectangle\") {\n    const width = (template.params.width || 0) * mapSize.x;\n    const height = (template.params.height || 0) * mapSize.y;\n    const half = { x: width / 2, y: height / 2 };\n    const corners = [\n      { x: origin.x - half.x, y: origin.y - half.y },\n      { x: origin.x + half.x, y: origin.y - half.y },\n      { x: origin.x + half.x, y: origin.y + half.y },\n      { x: origin.x - half.x, y: origin.y + half.y },\n    ];\n    return corners.map((corner) =>\n      Vector2.rotate(corner, origin, template.rotation)\n    );\n  }\n  if (template.type === \"cone\") {\n    const length = (template.params.length || 0) * minSide;\n    const angle = template.params.angle || 0;\n    const direction = {\n      x: Math.cos((template.rotation * Math.PI) / 180),\n      y: Math.sin((template.rotation * Math.PI) / 180),\n    };\n    const left = Vector2.rotateDirection(direction, angle / 2);\n    const right = Vector2.rotateDirection(direction, -angle / 2);\n    return [\n      origin,\n      Vector2.add(origin, Vector2.multiply(left, length)),\n      Vector2.add(origin, Vector2.multiply(right, length)),\n    ];\n  }\n  if (template.type === \"line\") {\n    const points = template.params.points || [];\n    return points.map((point) => Vector2.multiply(point, mapSize));\n  }\n  if (template.type === \"path\") {\n    const points = template.params.points || [];\n    return points.map((point) => Vector2.multiply(point, mapSize));\n  }\n  return [];\n}\nfunction buildStrokeGeom(points: Vector2[], width: number): Geom {\n  if (points.length < 2 || width <= 0) {\n    return [];\n  }\n\n  const half = width / 2;\n  let geoms: Geom[] = [];\n\n  for (let i = 0; i < points.length - 1; i++) {\n    const start = points[i];\n    const end = points[i + 1];\n    const direction = Vector2.normalize(Vector2.subtract(end, start));\n    const perpendicular = { x: -direction.y, y: direction.x };\n    const offset = Vector2.multiply(perpendicular, half);\n    const rect = [\n      Vector2.add(start, offset),\n      Vector2.add(end, offset),\n      Vector2.subtract(end, offset),\n      Vector2.subtract(start, offset),\n    ];\n    geoms.push([[toRing(rect)]]);\n  }\n\n  const capSegments = Math.max(12, Math.round(CIRCLE_SEGMENTS / 2));\n  for (let point of points) {\n    const cap = approximateCircle(point, half, capSegments);\n    geoms.push([[toRing(cap)]]);\n  }\n\n  if (geoms.length === 1) {\n    return geoms[0];\n  }\n  return polygonClipping.union(geoms[0], ...geoms.slice(1));\n}\n\nexport function getTemplateGeom(template: SpellTemplate, mapSize: MapSize): Geom {\n  const origin = Vector2.multiply(template.origin, mapSize);\n  const minSide = getMinSide(mapSize);\n\n  if (template.type === \"ring\") {\n    const outerRadius = (template.params.radius || 0) * minSide;\n    const innerRadius = (template.params.innerRadius || 0) * minSide;\n    const outer = approximateCircle(origin, outerRadius, CIRCLE_SEGMENTS);\n    const inner = approximateCircle(origin, innerRadius, CIRCLE_SEGMENTS);\n    return [[toRing(outer), toRing(inner)]];\n  }\n\n  if (template.type === \"line\" || template.type === \"path\") {\n    const points = getTemplatePointsInPixels(template, mapSize);\n    const width = (template.params.width || 0) * minSide;\n    return buildStrokeGeom(points, width);\n  }\n\n  const points = getTemplatePointsInPixels(template, mapSize);\n  if (points.length === 0) {\n    return [];\n  }\n  return [[toRing(points)]];\n}\n\nexport function getTemplateBoundingBox(\n  template: SpellTemplate,\n  mapSize: MapSize\n): BoundingBox {\n  const minSide = getMinSide(mapSize);\n  if (template.type === \"line\" || template.type === \"path\") {\n    const points = getTemplatePointsInPixels(template, mapSize);\n    if (points.length === 0) {\n      return Vector2.getBoundingBox([{ x: 0, y: 0 }]);\n    }\n    const bounds = Vector2.getBoundingBox(points);\n    const pad = ((template.params.width || 0) * minSide) / 2;\n    return {\n      min: { x: bounds.min.x - pad, y: bounds.min.y - pad },\n      max: { x: bounds.max.x + pad, y: bounds.max.y + pad },\n      width: bounds.width + pad * 2,\n      height: bounds.height + pad * 2,\n      center: bounds.center,\n    };\n  }\n\n  if (template.type === \"ring\") {\n    const outerRadius = (template.params.radius || 0) * minSide;\n    const origin = Vector2.multiply(template.origin, mapSize);\n    return Vector2.getBoundingBox([\n      { x: origin.x - outerRadius, y: origin.y - outerRadius },\n      { x: origin.x + outerRadius, y: origin.y + outerRadius },\n    ]);\n  }\n\n  const points = getTemplatePointsInPixels(template, mapSize);\n  if (points.length === 0) {\n    return Vector2.getBoundingBox([{ x: 0, y: 0 }]);\n  }\n  return Vector2.getBoundingBox(points);\n}\nfunction pointInRing(point: Vector2, ring: Ring): boolean {\n  let inside = false;\n  for (let i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n    const xi = ring[i][0];\n    const yi = ring[i][1];\n    const xj = ring[j][0];\n    const yj = ring[j][1];\n    const intersect =\n      (yi > point.y) !== (yj > point.y) &&\n      point.x < ((xj - xi) * (point.y - yi)) / (yj - yi + 0.000001) + xi;\n    if (intersect) {\n      inside = !inside;\n    }\n  }\n  return inside;\n}\n\nfunction normalizeGeom(geom: Geom): Ring[][] {\n  if (geom.length === 0) {\n    return [];\n  }\n  const first = geom[0] as any;\n  if (typeof first?.[0]?.[0] === \"number\") {\n    return [geom as Ring[]];\n  }\n  return geom as Ring[][];\n}\n\nfunction pointInGeom(point: Vector2, geom: Geom): boolean {\n  const polygons = normalizeGeom(geom);\n  for (let polygon of polygons) {\n    const outer = polygon[0];\n    if (!outer || !pointInRing(point, outer)) {\n      continue;\n    }\n    let insideHole = false;\n    for (let i = 1; i < polygon.length; i++) {\n      if (pointInRing(point, polygon[i])) {\n        insideHole = true;\n        break;\n      }\n    }\n    if (!insideHole) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function isPointInTemplate(\n  template: SpellTemplate,\n  mapSize: MapSize,\n  point: Vector2\n): boolean {\n  const geom = getTemplateGeom(template, mapSize);\n  if (geom.length === 0) {\n    return false;\n  }\n  return pointInGeom(point, geom);\n}\n\nfunction polygonArea(points: Ring): number {\n  let area = 0;\n  for (let i = 0, j = points.length - 1; i < points.length; j = i++) {\n    area += points[j][0] * points[i][1] - points[i][0] * points[j][1];\n  }\n  return Math.abs(area / 2);\n}\n\nfunction geomArea(geom: Geom): number {\n  const polygons = normalizeGeom(geom);\n  let area = 0;\n  for (let polygon of polygons) {\n    if (polygon.length === 0) {\n      continue;\n    }\n    area += polygonArea(polygon[0]);\n    for (let i = 1; i < polygon.length; i++) {\n      area -= polygonArea(polygon[i]);\n    }\n  }\n  return area;\n}\n\nfunction resolveRule(rule: SpellTemplateRule): SpellTemplateRule {\n  if (rule === \"ruleset_dnd5e\" || rule === \"ruleset_pf\") {\n    return \"touch\";\n  }\n  return rule;\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction buildCellPolygon(\n  grid: Grid,\n  col: number,\n  row: number,\n  cellSize: Size,\n  gridOffset: Vector2,\n  gridCellOffset: Vector2\n): { polygon: Vector2[]; center: Vector2 } {\n  const cellCenter = Vector2.add(\n    Vector2.add(getCellLocation(grid, col, row, cellSize), gridOffset),\n    gridCellOffset\n  );\n  const corners = getCellCorners(grid, cellCenter.x, cellCenter.y, cellSize);\n  return { polygon: corners, center: cellCenter };\n}\n\nexport function getAffectedCells(\n  template: SpellTemplate,\n  rule: SpellTemplateRule,\n  grid: Grid,\n  cellSize: Size,\n  gridOffset: Vector2,\n  gridCellOffset: Vector2,\n  mapSize: MapSize\n): AffectedCell[] {\n  if (grid.size.x === 0 || grid.size.y === 0) {\n    return [];\n  }\n  const resolvedRule = resolveRule(rule);\n  const geom = getTemplateGeom(template, mapSize);\n  const bounds = getTemplateBoundingBox(template, mapSize);\n  if (geom.length === 0) {\n    return [];\n  }\n\n  const min = Vector2.subtract(Vector2.subtract(bounds.min, gridOffset), gridCellOffset);\n  const max = Vector2.subtract(Vector2.subtract(bounds.max, gridOffset), gridCellOffset);\n\n  const minCoord = getNearestCellCoordinates(grid, min.x, min.y, cellSize);\n  const maxCoord = getNearestCellCoordinates(grid, max.x, max.y, cellSize);\n\n  const minCol = clamp(Math.min(minCoord.x, maxCoord.x) - 2, 0, grid.size.x - 1);\n  const maxCol = clamp(Math.max(minCoord.x, maxCoord.x) + 2, 0, grid.size.x - 1);\n  const minRow = clamp(Math.min(minCoord.y, maxCoord.y) - 2, 0, grid.size.y - 1);\n  const maxRow = clamp(Math.max(minCoord.y, maxCoord.y) + 2, 0, grid.size.y - 1);\n\n  let affected: AffectedCell[] = [];\n  for (let row = minRow; row <= maxRow; row++) {\n    for (let col = minCol; col <= maxCol; col++) {\n      const { polygon, center } = buildCellPolygon(\n        grid,\n        col,\n        row,\n        cellSize,\n        gridOffset,\n        gridCellOffset\n      );\n      const cellGeom: Geom = [[toRing(polygon)]];\n\n      if (resolvedRule === \"center\") {\n        if (pointInGeom(center, geom)) {\n          affected.push({ col, row, polygon, center });\n        }\n        continue;\n      }\n\n      const intersection = polygonClipping.intersection(geom, cellGeom);\n      const area = geomArea(intersection);\n      if (resolvedRule === \"touch\") {\n        if (area > 0) {\n          affected.push({ col, row, polygon, center });\n        }\n      } else if (resolvedRule === \"area_50\") {\n        const cellArea = geomArea(cellGeom);\n        if (cellArea > 0 && area / cellArea >= 0.5) {\n          affected.push({ col, row, polygon, center });\n        }\n      }\n    }\n  }\n\n  return affected;\n}\n","import { Group, Rect, Text } from \"react-konva\";\n\nimport { parseGridScale } from \"../../helpers/grid\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { SpellTemplate } from \"../../types/SpellTemplate\";\nimport { TokenState } from \"../../types/TokenState\";\nimport { AffectedCell } from \"../../helpers/spellTemplates\";\nimport { Grid } from \"../../types/Grid\";\nimport Size from \"../../helpers/Size\";\n\nconst HUD_WIDTH = 220;\nconst HUD_PADDING = 8;\nconst LINE_HEIGHT = 14;\n\nfunction formatScaled(value: number, scale: ReturnType<typeof parseGridScale>) {\n  const scaled = value * scale.multiplier;\n  const digits = scale.digits || 0;\n  const unit = scale.unit || \"\";\n  const formatted = scaled.toFixed(digits);\n  return unit ? `${formatted}${unit}` : `${formatted}`;\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\ntype SpellTemplateHudProps = {\n  template: SpellTemplate;\n  affectedCells: AffectedCell[];\n  tokens: TokenState[];\n  cursorPosition: Vector2 | null;\n  mapSize: { x: number; y: number };\n  grid: Grid;\n  gridCellPixelSize: Size;\n};\n\nfunction SpellTemplateHud({\n  template,\n  affectedCells,\n  tokens,\n  cursorPosition,\n  mapSize,\n  grid,\n  gridCellPixelSize,\n}: SpellTemplateHudProps) {\n  const scale = parseGridScale(grid.measurement.scale);\n  const minCell = Math.min(\n    gridCellPixelSize.width,\n    gridCellPixelSize.height\n  );\n  const minSide = Math.min(mapSize.x, mapSize.y) || 1;\n\n  let lines: string[] = [];\n  lines.push(`Type: ${template.type}`);\n\n  if (template.type === \"circle\" || template.type === \"ring\") {\n    const radiusPx = (template.params.radius || 0) * minSide;\n    const radiusCells = minCell > 0 ? radiusPx / minCell : 0;\n    lines.push(`Radius: ${formatScaled(radiusCells, scale)}`);\n  } else if (template.type === \"rectangle\") {\n    const widthPx = (template.params.width || 0) * mapSize.x;\n    const heightPx = (template.params.height || 0) * mapSize.y;\n    const widthCells = minCell > 0 ? widthPx / minCell : 0;\n    const heightCells = minCell > 0 ? heightPx / minCell : 0;\n    lines.push(\n      `Size: ${formatScaled(widthCells, scale)} x ${formatScaled(\n        heightCells,\n        scale\n      )}`\n    );\n  } else if (template.type === \"cone\") {\n    const lengthPx = (template.params.length || 0) * minSide;\n    const lengthCells = minCell > 0 ? lengthPx / minCell : 0;\n    lines.push(`Length: ${formatScaled(lengthCells, scale)}`);\n    lines.push(`Angle: ${Math.round(template.params.angle || 0)}deg`);\n  } else if (template.type === \"line\" || template.type === \"path\") {\n    const widthPx = (template.params.width || 0) * minSide;\n    const widthCells = minCell > 0 ? widthPx / minCell : 0;\n    lines.push(`Width: ${formatScaled(widthCells, scale)}`);\n  }\n\n  lines.push(`Cells: ${affectedCells.length}`);\n\n  if (tokens.length > 0) {\n    const names = tokens\n      .map((token) => token.label || token.id)\n      .filter(Boolean);\n    const preview = names.slice(0, 3);\n    const suffix = names.length > 3 ? ` +${names.length - 3}` : \"\";\n    lines.push(`Targets: ${preview.join(\", \")}${suffix}`);\n  }\n\n  const height = lines.length * LINE_HEIGHT + HUD_PADDING * 2;\n  const baseX = cursorPosition ? cursorPosition.x + 16 : 16;\n  const baseY = cursorPosition ? cursorPosition.y + 16 : 16;\n  const x = clamp(baseX, 8, mapSize.x - HUD_WIDTH - 8);\n  const y = clamp(baseY, 8, mapSize.y - height - 8);\n\n  return (\n    <Group x={x} y={y} listening={false}>\n      <Rect\n        width={HUD_WIDTH}\n        height={height}\n        fill=\"rgba(0, 0, 0, 0.6)\"\n        cornerRadius={4}\n      />\n      {lines.map((line, index) => (\n        <Text\n          key={`${line}-${index}`}\n          text={line}\n          x={HUD_PADDING}\n          y={HUD_PADDING + index * LINE_HEIGHT}\n          fontSize={12}\n          fill=\"white\"\n        />\n      ))}\n    </Group>\n  );\n}\n\nexport default SpellTemplateHud;\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport shortid from \"shortid\";\nimport { Group, Line, Circle } from \"react-konva\";\nimport Konva from \"konva\";\n\nimport {\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n  useMapWidth,\n  useMapHeight,\n  useSetPreventMapInteraction,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport {\n  useGrid,\n  useGridCellPixelSize,\n  useGridCellPixelOffset,\n  useGridOffset,\n} from \"../../contexts/GridContext\";\n\nimport Vector2 from \"../../helpers/Vector2\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport { Map } from \"../../types/Map\";\nimport {\n  SpellTemplate,\n  SpellTemplateToolSettings,\n  SpellTemplateType,\n} from \"../../types/SpellTemplate\";\n\nimport SpellTemplateShape from \"../konva/SpellTemplate\";\nimport SpellTemplateGridOverlay from \"../konva/SpellTemplateGridOverlay\";\nimport {\n  AffectedCell,\n  getAffectedCells,\n  getTemplateBoundingBox,\n  isPointInTemplate,\n} from \"../../helpers/spellTemplates\";\nimport SpellTemplateHud from \"../spellTemplates/SpellTemplateHud\";\nimport { TokenState } from \"../../types/TokenState\";\n\nconst ROTATION_HANDLE_DISTANCE = 24;\nconst DEFAULT_TEMPLATE_SETTINGS: SpellTemplateToolSettings = {\n  type: \"circle\",\n  rule: \"center\",\n  color: \"red\",\n  opacity: 0.5,\n  strokeWidth: 1,\n  lineWidth: 1,\n  coneAngle: 90,\n  ringInnerRatio: 0.5,\n  previewOnRotate: true,\n};\n\nexport type SpellTemplateAddHandler = (template: SpellTemplate) => void;\nexport type SpellTemplateEditHandler = (edits: Partial<SpellTemplate>[]) => void;\nexport type SpellTemplateRemoveHandler = (ids: string[]) => void;\n\ntype SpellTemplateToolProps = {\n  map: Map | null;\n  templates: SpellTemplate[];\n  active: boolean;\n  editable: boolean;\n  toolSettings: SpellTemplateToolSettings;\n  onTemplateAdd: SpellTemplateAddHandler;\n  onTemplateEdit: SpellTemplateEditHandler;\n  selectedTemplateId: string | null;\n  onSelectedTemplateIdChange: (templateId: string | null) => void;\n  onRemoveSelectedTemplate?: () => void;\n  onTemplateDragStateChange?: (dragging: boolean) => void;\n  isPointOverTrash?: (clientX: number, clientY: number) => boolean;\n  tokens?: TokenState[];\n};\nfunction SpellTemplateTool({\n  map,\n  templates,\n  active,\n  editable,\n  toolSettings: incomingToolSettings,\n  onTemplateAdd,\n  onTemplateEdit,\n  selectedTemplateId,\n  onSelectedTemplateIdChange,\n  onRemoveSelectedTemplate,\n  onTemplateDragStateChange,\n  isPointOverTrash,\n  tokens = [],\n}: SpellTemplateToolProps) {\n  const toolSettings: SpellTemplateToolSettings =\n    incomingToolSettings || DEFAULT_TEMPLATE_SETTINGS;\n  const mapStageRef = useMapStage();\n  const interactionEmitter = useInteractionEmitter();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const grid = useGrid();\n  const gridCellPixelSize = useGridCellPixelSize();\n  const gridCellPixelOffset = useGridCellPixelOffset();\n  const gridOffset = useGridOffset();\n\n  const snapPositionToGrid = useGridSnapping();\n\n  const [drawingTemplate, setDrawingTemplate] = useState<SpellTemplate | null>(\n    null\n  );\n  const [rotatingTemplateId, setRotatingTemplateId] = useState<string | null>(\n    null\n  );\n  const [cursorPosition, setCursorPosition] = useState<Vector2 | null>(null);\n  const ignoreNextDragRef = useRef(false);\n  const drawStartRef = useRef<Vector2 | null>(null);\n  const rotationStateRef = useRef<{\n    id: string;\n    startAngle: number;\n    pivot: Vector2;\n    points?: Vector2[];\n  } | null>(null);\n\n  const activeTemplate = drawingTemplate ||\n    templates.find((template) => template.id === selectedTemplateId) ||\n    null;\n\n  useEffect(() => {\n    if (!active) {\n      setDrawingTemplate(null);\n      onSelectedTemplateIdChange(null);\n      setRotatingTemplateId(null);\n      onTemplateDragStateChange && onTemplateDragStateChange(false);\n      setPreventMapInteraction(false);\n    }\n  }, [\n    active,\n    onSelectedTemplateIdChange,\n    onTemplateDragStateChange,\n    setPreventMapInteraction,\n  ]);\n\n  useEffect(() => {\n    if (toolSettings.type !== \"drag\") {\n      onTemplateDragStateChange && onTemplateDragStateChange(false);\n    }\n  }, [toolSettings.type, onTemplateDragStateChange]);\n\n  const templatesById = useMemo(() => {\n    const map: Record<string, SpellTemplate> = {};\n    for (let template of templates) {\n      map[template.id] = template;\n    }\n    return map;\n  }, [templates]);\n\n  useEffect(() => {\n    if (selectedTemplateId && !templatesById[selectedTemplateId]) {\n      onSelectedTemplateIdChange(null);\n    }\n  }, [selectedTemplateId, templatesById, onSelectedTemplateIdChange]);\n\n  const getBrushPosition = useCallback(\n    (snapping = true) => {\n      const mapStage = mapStageRef.current;\n      if (!mapStage || !map) {\n        return;\n      }\n      const mapImage = mapStage.findOne(\"#mapImage\");\n      let position = getRelativePointerPosition(mapImage);\n      if (!position) {\n        return;\n      }\n      if (map.snapToGrid && snapping) {\n        position = snapPositionToGrid(position);\n      }\n      return Vector2.divide(position, {\n        x: mapImage.width(),\n        y: mapImage.height(),\n      });\n    },\n    [mapStageRef, map, snapPositionToGrid]\n  );\n\n  const getWidthNormalized = useCallback(() => {\n    const minSide = Math.min(mapWidth, mapHeight);\n    const minCell = Math.min(\n      gridCellPixelSize.width,\n      gridCellPixelSize.height\n    );\n    const widthPixels = toolSettings.lineWidth * minCell;\n    return minSide > 0 ? widthPixels / minSide : 0;\n  }, [mapWidth, mapHeight, gridCellPixelSize, toolSettings.lineWidth]);\n\n  const createTemplate = useCallback(\n    (type: SpellTemplateType, origin: Vector2) => {\n    const base = {\n      id: shortid.generate(),\n      type,\n      origin,\n      rotation: 0,\n      params: {},\n      style: {\n        color: toolSettings.color,\n        opacity: toolSettings.opacity,\n        strokeWidth: toolSettings.strokeWidth,\n      },\n    } as SpellTemplate;\n\n    if (type === \"circle\") {\n      base.params.radius = 0;\n    } else if (type === \"ring\") {\n      base.params.radius = 0;\n      base.params.innerRadius = 0;\n    } else if (type === \"rectangle\") {\n      base.params.width = 0;\n      base.params.height = 0;\n    } else if (type === \"line\") {\n      base.params.points = [origin, origin];\n      base.params.width = getWidthNormalized();\n    } else if (type === \"cone\") {\n      base.params.length = 0;\n      base.params.angle = toolSettings.coneAngle;\n    } else if (type === \"path\") {\n      base.params.points = [origin, origin];\n      base.params.width = getWidthNormalized();\n    }\n\n    return base;\n    },\n    [toolSettings, getWidthNormalized]\n  );\n  useEffect(() => {\n    if (\n      !active ||\n      !editable ||\n      toolSettings.type === \"path\" ||\n      toolSettings.type === \"drag\"\n    ) {\n      return;\n    }\n\n    function handleDragStart(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (ignoreNextDragRef.current) {\n        ignoreNextDragRef.current = false;\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      const templateType = toolSettings.type;\n      if (templateType === \"drag\") {\n        return;\n      }\n      onSelectedTemplateIdChange(null);\n      drawStartRef.current = brushPosition;\n      setDrawingTemplate(createTemplate(templateType, brushPosition));\n    }\n\n    function handleDragMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      if (!drawingTemplate) {\n        return;\n      }\n      setDrawingTemplate((prevTemplate) => {\n        if (!prevTemplate) {\n          return prevTemplate;\n        }\n        const minSide = Math.min(mapWidth, mapHeight) || 1;\n        const start = drawStartRef.current || prevTemplate.origin;\n        const originPixel = Vector2.multiply(start, {\n          x: mapWidth,\n          y: mapHeight,\n        });\n        const currentPixel = Vector2.multiply(brushPosition, {\n          x: mapWidth,\n          y: mapHeight,\n        });\n        const delta = Vector2.subtract(currentPixel, originPixel);\n        const distance = Vector2.magnitude(delta) / minSide;\n\n        if (prevTemplate.type === \"circle\") {\n          return {\n            ...prevTemplate,\n            params: {\n              ...prevTemplate.params,\n              radius: distance,\n            },\n          };\n        }\n        if (prevTemplate.type === \"ring\") {\n          const outerRadius = distance;\n          const innerRadius = outerRadius * toolSettings.ringInnerRatio;\n          return {\n            ...prevTemplate,\n            params: {\n              ...prevTemplate.params,\n              radius: outerRadius,\n              innerRadius,\n            },\n          };\n        }\n        if (prevTemplate.type === \"rectangle\") {\n          const width = Math.abs(brushPosition.x - start.x);\n          const height = Math.abs(brushPosition.y - start.y);\n          const center = {\n            x: (start.x + brushPosition.x) / 2,\n            y: (start.y + brushPosition.y) / 2,\n          };\n          return {\n            ...prevTemplate,\n            origin: center,\n            params: {\n              ...prevTemplate.params,\n              width,\n              height,\n            },\n          };\n        }\n        if (prevTemplate.type === \"line\") {\n          return {\n            ...prevTemplate,\n            params: {\n              ...prevTemplate.params,\n              points: [start, brushPosition],\n              width: getWidthNormalized(),\n            },\n          };\n        }\n        if (prevTemplate.type === \"cone\") {\n          const rotation = (Math.atan2(delta.y, delta.x) * 180) / Math.PI;\n          return {\n            ...prevTemplate,\n            rotation,\n            params: {\n              ...prevTemplate.params,\n              length: distance,\n              angle: toolSettings.coneAngle,\n            },\n          };\n        }\n\n        return prevTemplate;\n      });\n    }\n\n    function handleDragEnd(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (drawingTemplate) {\n        onTemplateAdd(drawingTemplate);\n        onSelectedTemplateIdChange(drawingTemplate.id);\n      }\n      setDrawingTemplate(null);\n      drawStartRef.current = null;\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleDragStart);\n    interactionEmitter?.on(\"drag\", handleDragMove);\n    interactionEmitter?.on(\"dragEnd\", handleDragEnd);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleDragStart);\n      interactionEmitter?.off(\"drag\", handleDragMove);\n      interactionEmitter?.off(\"dragEnd\", handleDragEnd);\n    };\n  }, [\n    active,\n    editable,\n    toolSettings,\n    mapWidth,\n    mapHeight,\n    drawingTemplate,\n    interactionEmitter,\n    map,\n    onTemplateAdd,\n    onSelectedTemplateIdChange,\n    createTemplate,\n    getBrushPosition,\n    getWidthNormalized,\n  ]);\n\n  useEffect(() => {\n    if (!active || !editable || toolSettings.type !== \"path\") {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n\n    function handlePointerMove() {\n      const brushPosition = getBrushPosition();\n      if (!brushPosition || !drawingTemplate) {\n        return;\n      }\n      setDrawingTemplate((prevTemplate) => {\n        if (!prevTemplate || !prevTemplate.params.points) {\n          return prevTemplate;\n        }\n        return {\n          ...prevTemplate,\n          params: {\n            ...prevTemplate.params,\n            points: [\n              ...prevTemplate.params.points.slice(0, -1),\n              brushPosition,\n            ],\n            width: getWidthNormalized(),\n          },\n        };\n      });\n    }\n\n    function handlePointerClick(event: Konva.KonvaEventObject<MouseEvent>) {\n      if (!leftMouseButton(event)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition) {\n        return;\n      }\n      onSelectedTemplateIdChange(null);\n      setDrawingTemplate((prevTemplate) => {\n        if (!prevTemplate) {\n          return createTemplate(\"path\", brushPosition);\n        }\n        const points = prevTemplate.params.points || [];\n        return {\n          ...prevTemplate,\n          params: {\n            ...prevTemplate.params,\n            points: [...points.slice(0, -1), brushPosition, brushPosition],\n            width: getWidthNormalized(),\n          },\n        };\n      });\n    }\n\n    function finishPath() {\n      if (!drawingTemplate || !drawingTemplate.params.points) {\n        return;\n      }\n      const points = drawingTemplate.params.points.slice(0, -1);\n      if (points.length > 1) {\n        onTemplateAdd({\n          ...drawingTemplate,\n          params: { ...drawingTemplate.params, points },\n        });\n        onSelectedTemplateIdChange(drawingTemplate.id);\n      }\n      setDrawingTemplate(null);\n    }\n\n    function handlePointerDoubleClick(event: Konva.KonvaEventObject<MouseEvent>) {\n      event.evt.preventDefault();\n      finishPath();\n    }\n\n    function handleContextMenu(event: Konva.KonvaEventObject<MouseEvent>) {\n      event.evt.preventDefault();\n      finishPath();\n    }\n\n    mapStage?.on(\"mousemove touchmove\", handlePointerMove);\n    mapStage?.on(\"click tap\", handlePointerClick);\n    mapStage?.on(\"dblclick dbltap\", handlePointerDoubleClick);\n    mapStage?.on(\"contextmenu\", handleContextMenu);\n\n    return () => {\n      mapStage?.off(\"mousemove touchmove\", handlePointerMove);\n      mapStage?.off(\"click tap\", handlePointerClick);\n      mapStage?.off(\"dblclick dbltap\", handlePointerDoubleClick);\n      mapStage?.off(\"contextmenu\", handleContextMenu);\n    };\n  }, [\n    active,\n    editable,\n    toolSettings.type,\n    toolSettings.lineWidth,\n    drawingTemplate,\n    mapStageRef,\n    map,\n    onTemplateAdd,\n    onSelectedTemplateIdChange,\n    createTemplate,\n    getBrushPosition,\n    getWidthNormalized,\n  ]);\n  useEffect(() => {\n    if (!active) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n\n    function handleCursorMove() {\n      if (!mapStage) {\n        return;\n      }\n      const mapImage = mapStage.findOne(\"#mapImage\");\n      const position = getRelativePointerPosition(mapImage);\n      if (position) {\n        setCursorPosition(position);\n      }\n    }\n\n    mapStage?.on(\"mousemove touchmove\", handleCursorMove);\n    return () => {\n      mapStage?.off(\"mousemove touchmove\", handleCursorMove);\n    };\n  }, [active, mapStageRef]);\n\n  useEffect(() => {\n    if (!active || !editable || !rotatingTemplateId) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n\n    function handleRotateMove(event: Konva.KonvaEventObject<MouseEvent>) {\n      const templateId = rotatingTemplateId;\n      if (!templateId) {\n        return;\n      }\n      const template = templatesById[templateId];\n      if (!template) {\n        return;\n      }\n      const mapImage = mapStage?.findOne(\"#mapImage\");\n      if (!mapImage) {\n        return;\n      }\n      const position = getRelativePointerPosition(mapImage);\n      if (!position) {\n        return;\n      }\n      if (template.type === \"line\" || template.type === \"path\") {\n        const rotationState = rotationStateRef.current;\n        if (!rotationState || rotationState.id !== template.id) {\n          return;\n        }\n        const currentAngle =\n          (Math.atan2(\n            position.y - rotationState.pivot.y,\n            position.x - rotationState.pivot.x\n          ) *\n            180) /\n          Math.PI;\n        const delta = currentAngle - rotationState.startAngle;\n        const points = rotationState.points || [];\n        const rotated = points.map((point) => {\n          const pixel = Vector2.multiply(point, {\n            x: mapWidth,\n            y: mapHeight,\n          });\n          const nextPixel = Vector2.rotate(pixel, rotationState.pivot, delta);\n          return {\n            x: nextPixel.x / mapWidth,\n            y: nextPixel.y / mapHeight,\n          };\n        });\n        onTemplateEdit([\n          {\n            id: template.id,\n            params: { ...template.params, points: rotated },\n          },\n        ]);\n        return;\n      }\n      const originPixel = Vector2.multiply(template.origin, {\n        x: mapWidth,\n        y: mapHeight,\n      });\n      let rotation =\n        (Math.atan2(position.y - originPixel.y, position.x - originPixel.x) *\n          180) /\n        Math.PI;\n      if (event.evt.shiftKey) {\n        rotation = Math.round(rotation / 45) * 45;\n      }\n      onTemplateEdit([{ id: template.id, rotation }]);\n    }\n\n    function handleRotateEnd() {\n      setRotatingTemplateId(null);\n      setPreventMapInteraction(false);\n      rotationStateRef.current = null;\n      ignoreNextDragRef.current = false;\n    }\n\n    mapStage?.on(\"mousemove touchmove\", handleRotateMove);\n    mapStage?.on(\"mouseup touchend\", handleRotateEnd);\n\n    return () => {\n      mapStage?.off(\"mousemove touchmove\", handleRotateMove);\n      mapStage?.off(\"mouseup touchend\", handleRotateEnd);\n    };\n  }, [\n    active,\n    editable,\n    rotatingTemplateId,\n    templatesById,\n    mapStageRef,\n    mapWidth,\n    mapHeight,\n    onTemplateEdit,\n    setPreventMapInteraction,\n  ]);\n\n  useEffect(() => {\n    function handleKeyDown(event: KeyboardEvent) {\n      if (event.key === \"Escape\" && drawingTemplate) {\n        setDrawingTemplate(null);\n      }\n      if (event.key === \"Backspace\" || event.key === \"Delete\") {\n        if (drawingTemplate?.type === \"path\" && drawingTemplate.params.points) {\n          const points = drawingTemplate.params.points;\n          if (points.length > 2) {\n            setDrawingTemplate({\n              ...drawingTemplate,\n              params: {\n                ...drawingTemplate.params,\n                points: [...points.slice(0, -2), points[points.length - 1]],\n              },\n            });\n          } else {\n            setDrawingTemplate(null);\n          }\n        } else if (selectedTemplateId && onRemoveSelectedTemplate) {\n          onRemoveSelectedTemplate();\n        }\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [drawingTemplate, selectedTemplateId, onRemoveSelectedTemplate]);\n  const affectedCells: AffectedCell[] = useMemo(() => {\n    if (!activeTemplate || !map) {\n      return [];\n    }\n    if (\n      rotatingTemplateId &&\n      activeTemplate.id === rotatingTemplateId &&\n      !toolSettings.previewOnRotate\n    ) {\n      return [];\n    }\n    return getAffectedCells(\n      activeTemplate,\n      toolSettings.rule,\n      grid,\n      gridCellPixelSize,\n      gridOffset,\n      gridCellPixelOffset,\n      { x: mapWidth, y: mapHeight }\n    );\n  }, [\n    activeTemplate,\n    toolSettings.rule,\n    grid,\n    gridCellPixelSize,\n    gridOffset,\n    gridCellPixelOffset,\n    mapWidth,\n    mapHeight,\n    map,\n    rotatingTemplateId,\n    toolSettings.previewOnRotate,\n  ]);\n\n  const hitTokens = useMemo(() => {\n    if (!activeTemplate || tokens.length === 0) {\n      return [];\n    }\n    const mapSize = { x: mapWidth, y: mapHeight };\n    return tokens.filter((token) => {\n      if (!token.visible) {\n        return false;\n      }\n      const center = {\n        x: token.x * mapWidth,\n        y: token.y * mapHeight,\n      };\n      return isPointInTemplate(activeTemplate, mapSize, center);\n    });\n  }, [activeTemplate, tokens, mapWidth, mapHeight]);\n\n  function handleTemplateDragEnd(\n    template: SpellTemplate,\n    event: Konva.KonvaEventObject<DragEvent>\n  ) {\n    const finishDrag = () => {\n      onTemplateDragStateChange && onTemplateDragStateChange(false);\n      setPreventMapInteraction(false);\n    };\n    const node = event.target;\n    const delta = node.position();\n    node.position({ x: 0, y: 0 });\n    const nativeEvent = event.evt as MouseEvent | TouchEvent;\n    let clientX: number | undefined;\n    let clientY: number | undefined;\n    if (typeof (nativeEvent as MouseEvent).clientX === \"number\") {\n      clientX = (nativeEvent as MouseEvent).clientX;\n      clientY = (nativeEvent as MouseEvent).clientY;\n    } else if (\"changedTouches\" in nativeEvent && nativeEvent.changedTouches[0]) {\n      clientX = nativeEvent.changedTouches[0].clientX;\n      clientY = nativeEvent.changedTouches[0].clientY;\n    }\n    if (\n      clientX !== undefined &&\n      clientY !== undefined &&\n      isPointOverTrash &&\n      isPointOverTrash(clientX, clientY)\n    ) {\n      if (selectedTemplateId === template.id && onRemoveSelectedTemplate) {\n        onRemoveSelectedTemplate();\n      }\n      finishDrag();\n      return;\n    }\n    if (delta.x === 0 && delta.y === 0) {\n      finishDrag();\n      return;\n    }\n    const deltaNorm = {\n      x: delta.x / mapWidth,\n      y: delta.y / mapHeight,\n    };\n\n    if (template.type === \"line\" || template.type === \"path\") {\n      const points = (template.params.points || []).map((point) => ({\n        x: point.x + deltaNorm.x,\n        y: point.y + deltaNorm.y,\n      }));\n      onTemplateEdit([\n        {\n          id: template.id,\n          params: { ...template.params, points },\n        },\n      ]);\n      finishDrag();\n      return;\n    }\n\n    onTemplateEdit([\n      {\n        id: template.id,\n        origin: Vector2.add(template.origin, deltaNorm),\n      },\n    ]);\n    finishDrag();\n  }\n\n  const renderRotationHandle = useCallback(\n    (template: SpellTemplate) => {\n      if (\n        template.type !== \"rectangle\" &&\n        template.type !== \"cone\" &&\n        template.type !== \"line\" &&\n        template.type !== \"path\"\n      ) {\n        return null;\n      }\n      const bounds = getTemplateBoundingBox(template, {\n        x: mapWidth,\n        y: mapHeight,\n      });\n      const handlePosition = {\n        x: bounds.center.x,\n        y: bounds.min.y - ROTATION_HANDLE_DISTANCE,\n      };\n      const origin =\n        template.type === \"rectangle\" || template.type === \"cone\"\n          ? Vector2.multiply(template.origin, {\n              x: mapWidth,\n              y: mapHeight,\n            })\n          : bounds.center;\n\n      function startRotate(\n        event: Konva.KonvaEventObject<MouseEvent | TouchEvent>\n      ) {\n        event.cancelBubble = true;\n        ignoreNextDragRef.current = true;\n        setPreventMapInteraction(true);\n        setRotatingTemplateId(template.id);\n        if (template.type === \"line\" || template.type === \"path\") {\n          const mapStage = mapStageRef.current;\n          const mapImage = mapStage?.findOne(\"#mapImage\");\n          if (!mapImage) {\n            return;\n          }\n          const position = getRelativePointerPosition(mapImage);\n          if (!position) {\n            return;\n          }\n          const startAngle =\n            (Math.atan2(\n              position.y - bounds.center.y,\n              position.x - bounds.center.x\n            ) *\n              180) /\n            Math.PI;\n          rotationStateRef.current = {\n            id: template.id,\n            startAngle,\n            pivot: bounds.center,\n            points: template.params.points || [],\n          };\n        }\n      }\n\n      return (\n        <Group>\n          <Line\n            points={[origin.x, origin.y, handlePosition.x, handlePosition.y]}\n            stroke=\"white\"\n            strokeWidth={1}\n          />\n          <Circle\n            x={handlePosition.x}\n            y={handlePosition.y}\n            radius={6}\n            fill=\"white\"\n            stroke=\"black\"\n            strokeWidth={1}\n            onMouseDown={startRotate}\n            onTouchStart={startRotate}\n          />\n        </Group>\n      );\n    },\n    [mapWidth, mapHeight, mapStageRef, setPreventMapInteraction]\n  );\n\n  function renderTemplate(template: SpellTemplate) {\n    const isSelected = template.id === selectedTemplateId;\n    const bounds = getTemplateBoundingBox(template, {\n      x: mapWidth,\n      y: mapHeight,\n    });\n    const dragBoundFunc = (pos: { x: number; y: number }) => {\n      const minX = -bounds.min.x;\n      const maxX = mapWidth - bounds.max.x;\n      const minY = -bounds.min.y;\n      const maxY = mapHeight - bounds.max.y;\n      if (minX > maxX || minY > maxY) {\n        return pos;\n      }\n      return {\n        x: Math.min(Math.max(pos.x, minX), maxX),\n        y: Math.min(Math.max(pos.y, minY), maxY),\n      };\n    };\n    return (\n      <Group\n        key={template.id}\n        draggable={\n          active &&\n          editable &&\n          isSelected &&\n          !rotatingTemplateId &&\n          toolSettings.type === \"drag\"\n        }\n        onDragStart={() => {\n          setPreventMapInteraction(true);\n          onTemplateDragStateChange && onTemplateDragStateChange(true);\n        }}\n        onDragEnd={(event) => handleTemplateDragEnd(template, event)}\n        dragBoundFunc={dragBoundFunc}\n        onMouseDown={() => {\n          if (!active) {\n            return;\n          }\n          ignoreNextDragRef.current = true;\n          onSelectedTemplateIdChange(template.id);\n        }}\n        onTap={() => {\n          if (!active) {\n            return;\n          }\n          ignoreNextDragRef.current = true;\n          onSelectedTemplateIdChange(template.id);\n        }}\n        onMouseUp={() => {\n          ignoreNextDragRef.current = false;\n        }}\n        onTouchEnd={() => {\n          ignoreNextDragRef.current = false;\n        }}\n      >\n        <SpellTemplateShape template={template} />\n      </Group>\n    );\n  }\n\n  return (\n    <Group>\n      {templates.map(renderTemplate)}\n      {drawingTemplate && <SpellTemplateShape template={drawingTemplate} />}\n      {activeTemplate && affectedCells.length > 0 && (\n        <SpellTemplateGridOverlay\n          cells={affectedCells}\n          color={activeTemplate.style.color}\n          opacity={Math.min(activeTemplate.style.opacity + 0.1, 0.6)}\n        />\n      )}\n      {active &&\n        editable &&\n        selectedTemplateId &&\n        templatesById[selectedTemplateId] &&\n        renderRotationHandle(templatesById[selectedTemplateId])}\n      {activeTemplate && (\n        <SpellTemplateHud\n          template={activeTemplate}\n          affectedCells={affectedCells}\n          tokens={hitTokens}\n          cursorPosition={cursorPosition}\n          mapSize={{ x: mapWidth, y: mapHeight }}\n          grid={grid}\n          gridCellPixelSize={gridCellPixelSize}\n        />\n      )}\n    </Group>\n  );\n}\n\nexport default SpellTemplateTool;\n","import Color from \"color\";\nimport Konva from \"konva\";\nimport { useEffect, useRef } from \"react\";\nimport { Circle, Group, Line } from \"react-konva\";\nimport Vector2 from \"../../helpers/Vector2\";\n\ninterface PointerPoint extends Vector2 {\n  lifetime: number;\n}\n\ntype PointerProps = {\n  position: Vector2;\n  size: number;\n  duration: number;\n  segments: number;\n  color: string;\n};\n\nfunction Pointer({ position, size, duration, segments, color }: PointerProps) {\n  const trailRef = useRef<Konva.Line>(null);\n  const pointsRef = useRef<PointerPoint[]>([]);\n  const prevPositionRef = useRef(position);\n  const positionRef = useRef(position);\n  const circleRef = useRef<Konva.Circle>(null);\n  // Color of the end of the trail\n  const transparentColorRef = useRef(\n    Color(color).lighten(0.5).alpha(0).string()\n  );\n\n  useEffect(() => {\n    // Lighten color to give it a `glow` effect\n    transparentColorRef.current = Color(color).lighten(0.5).alpha(0).string();\n  }, [color]);\n\n  // Keep track of position so we can use it in the trail animation\n  useEffect(() => {\n    positionRef.current = position;\n  }, [position]);\n\n  // Add a new point every time position is changed\n  useEffect(() => {\n    if (Vector2.compare(position, prevPositionRef.current, 0.0001)) {\n      return;\n    }\n    pointsRef.current.push({ ...position, lifetime: duration });\n    prevPositionRef.current = position;\n  }, [position, duration]);\n\n  // Advance lifetime of trail\n  useEffect(() => {\n    let prevTime = performance.now();\n    let request = requestAnimationFrame(animate);\n    function animate(time: number) {\n      request = requestAnimationFrame(animate);\n      const deltaTime = time - prevTime;\n      prevTime = time;\n\n      if (pointsRef.current.length === 0) {\n        return;\n      }\n\n      let expired = 0;\n      for (let point of pointsRef.current) {\n        point.lifetime -= deltaTime;\n        if (point.lifetime < 0) {\n          expired++;\n        }\n      }\n      if (expired > 0) {\n        pointsRef.current = pointsRef.current.slice(expired);\n      }\n\n      // Update the circle position to keep it in sync with the trail\n      if (circleRef && circleRef.current) {\n        circleRef.current.x(positionRef.current.x);\n        circleRef.current.y(positionRef.current.y);\n      }\n\n      if (trailRef && trailRef.current) {\n        trailRef.current.getLayer()?.draw();\n      }\n    }\n\n    return () => {\n      cancelAnimationFrame(request);\n    };\n  }, []);\n\n  // Custom scene function for drawing a trail from a line\n  function sceneFunc(context: Konva.Context) {\n    // Resample points to ensure a smooth trail\n    const resampledPoints = Vector2.resample(pointsRef.current, segments);\n    if (resampledPoints.length === 0) {\n      return;\n    }\n    // Draws a line offset in the direction perpendicular to its travel direction\n    const drawOffsetLine = (from: Vector2, to: Vector2, alpha: number) => {\n      const forward = Vector2.normalize(Vector2.subtract(from, to));\n      // Rotate the forward vector 90 degrees based off of the direction\n      const side = Vector2.rotate90(forward);\n\n      // Offset the `to` position by the size of the point and in the side direction\n      const toSize = (alpha * size) / 2;\n      const toOffset = Vector2.add(to, Vector2.multiply(side, toSize));\n\n      context.lineTo(toOffset.x, toOffset.y);\n    };\n    context.beginPath();\n    // Sample the points starting from the tail then traverse counter clockwise drawing each point\n    // offset to make a taper, stops at the base of the trail\n    context.moveTo(resampledPoints[0].x, resampledPoints[0].y);\n    for (let i = 1; i < resampledPoints.length; i++) {\n      const from = resampledPoints[i - 1];\n      const to = resampledPoints[i];\n      drawOffsetLine(from, to, i / resampledPoints.length);\n    }\n    // Start from the base of the trail and continue drawing down back to the end of the tail\n    for (let i = resampledPoints.length - 2; i >= 0; i--) {\n      const from = resampledPoints[i + 1];\n      const to = resampledPoints[i];\n      drawOffsetLine(from, to, i / resampledPoints.length);\n    }\n    context.lineTo(resampledPoints[0].x, resampledPoints[0].y);\n    context.closePath();\n\n    // Create a radial gradient from the center of the trail to the tail\n    const gradientCenter = resampledPoints[resampledPoints.length - 1];\n    const gradientEnd = resampledPoints[0];\n    const gradientRadius = Vector2.magnitude(\n      Vector2.subtract(gradientCenter, gradientEnd)\n    );\n    let gradient = context.createRadialGradient(\n      gradientCenter.x,\n      gradientCenter.y,\n      0,\n      gradientCenter.x,\n      gradientCenter.y,\n      gradientRadius\n    );\n    gradient.addColorStop(0, color);\n    gradient.addColorStop(1, transparentColorRef.current);\n    // @ts-ignore\n    context.fillStyle = gradient;\n    context.fill();\n  }\n\n  return (\n    <Group>\n      <Line sceneFunc={sceneFunc} ref={trailRef} />\n      <Circle\n        x={position.x}\n        y={position.y}\n        fill={color}\n        width={size}\n        height={size}\n        ref={circleRef}\n      />\n    </Group>\n  );\n}\n\nPointer.defaultProps = {\n  // Duration of each point in milliseconds\n  duration: 200,\n  // Number of segments in the trail, resampled from the points\n  segments: 20,\n};\n\nexport default Pointer;\n","import { useEffect, useRef } from \"react\";\nimport { Group } from \"react-konva\";\n\nimport {\n  useMapWidth,\n  useMapHeight,\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n  rightMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\n\nimport { getRelativePointerPositionNormalized } from \"../../helpers/konva\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport Pointer from \"../konva/Pointer\";\n\nimport colors, { Color } from \"../../helpers/colors\";\n\ntype MapPointerProps = {\n  active: boolean;\n  position: Vector2;\n  onPointerDown?: (position: Vector2) => void;\n  onPointerMove?: (position: Vector2) => void;\n  onPointerUp?: (position: Vector2) => void;\n  visible: boolean;\n  color: Color;\n};\n\nfunction PointerTool({\n  active,\n  position,\n  onPointerDown,\n  onPointerMove,\n  onPointerUp,\n  visible,\n  color,\n}: MapPointerProps) {\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const interactionEmitter = useInteractionEmitter();\n  const gridStrokeWidth = useGridStrokeWidth();\n  const mapStageRef = useMapStage();\n\n  const brushDownRef = useRef(false);\n\n  useEffect(() => {\n    const mapStage = mapStageRef.current;\n\n    function getBrushPosition() {\n      if (!mapStage) {\n        return;\n      }\n      const mapImage = mapStage.findOne(\"#mapImage\");\n      return getRelativePointerPositionNormalized(mapImage);\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if ((leftMouseButton(props) && active) || rightMouseButton(props)) {\n        const brushPosition = getBrushPosition();\n        brushPosition && onPointerDown?.(brushPosition);\n        brushDownRef.current = true;\n      }\n    }\n\n    function handleBrushMove() {\n      if (brushDownRef.current) {\n        const brushPosition = getBrushPosition();\n        brushPosition && visible && onPointerMove?.(brushPosition);\n      }\n    }\n\n    function handleBrushUp() {\n      if (brushDownRef.current) {\n        const brushPosition = getBrushPosition();\n        brushPosition && onPointerUp?.(brushPosition);\n        brushDownRef.current = false;\n      }\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n    };\n  });\n\n  const size = 2 * gridStrokeWidth;\n\n  return (\n    <Group>\n      {visible && (\n        <Pointer\n          position={Vector2.multiply(position, { x: mapWidth, y: mapHeight })}\n          color={colors[color]}\n          size={size}\n          duration={200}\n        />\n      )}\n    </Group>\n  );\n}\n\nPointerTool.defaultProps = {\n  color: \"red\",\n};\n\nexport default PointerTool;\n","import { useState, useEffect, useRef } from \"react\";\nimport { Group } from \"react-konva\";\n\nimport { useUserId } from \"../contexts/UserIdContext\";\n\nimport PointerTool from \"../components/tools/PointerTool\";\nimport { isEmpty } from \"../helpers/shared\";\nimport Vector2 from \"../helpers/Vector2\";\n\nimport useSetting from \"../hooks/useSetting\";\nimport Session from \"./Session\";\nimport { Color } from \"../helpers/colors\";\nimport { PointerState } from \"../types/Pointer\";\n\n// Send pointer updates every 50ms (20fps)\nconst sendTickRate = 50;\n\ntype InterpolatedPointerState = PointerState & { time: number };\n\ntype PointerInterpolation = {\n  id: string;\n  from: InterpolatedPointerState | null;\n  to: InterpolatedPointerState;\n};\n\ntype NetworkedMapPointerProps = {\n  session: Session;\n  active: boolean;\n};\n\nfunction NetworkedMapPointer({ session, active }: NetworkedMapPointerProps) {\n  const userId = useUserId();\n  const [localPointerState, setLocalPointerState] = useState<\n    Record<string, PointerState>\n  >({});\n  const [pointerColor] = useSetting<Color>(\"pointer.color\");\n\n  const sessionRef = useRef(session);\n  useEffect(() => {\n    sessionRef.current = session;\n  }, [session]);\n\n  useEffect(() => {\n    if (userId && !(userId in localPointerState)) {\n      setLocalPointerState({\n        [userId]: {\n          position: { x: 0, y: 0 },\n          visible: false,\n          id: userId,\n          color: pointerColor,\n        },\n      });\n    }\n  }, [userId, localPointerState, pointerColor]);\n\n  // Send pointer updates every sendTickRate to peers to save on bandwidth\n  // We use requestAnimationFrame as setInterval was being blocked during\n  // re-renders on Chrome with Windows\n  const ownPointerUpdateRef = useRef<PointerState | null>(null);\n  useEffect(() => {\n    let prevTime = performance.now();\n    let request = requestAnimationFrame(update);\n    let counter = 0;\n    function update(time: number) {\n      request = requestAnimationFrame(update);\n      const deltaTime = time - prevTime;\n      counter += deltaTime;\n      prevTime = time;\n\n      if (counter > sendTickRate) {\n        counter -= sendTickRate;\n        if (\n          ownPointerUpdateRef.current &&\n          sessionRef.current &&\n          sessionRef.current.socket\n        ) {\n          sessionRef.current.socket.volatile.emit(\n            \"player_pointer\",\n            ownPointerUpdateRef.current\n          );\n          ownPointerUpdateRef.current = null;\n        }\n      }\n    }\n\n    return () => {\n      cancelAnimationFrame(request);\n    };\n  }, []);\n\n  function updateOwnPointerState(position: Vector2, visible: boolean) {\n    if (!userId) {\n      return;\n    }\n    setLocalPointerState((prev) => ({\n      ...prev,\n      [userId]: { position, visible, id: userId, color: pointerColor },\n    }));\n    ownPointerUpdateRef.current = {\n      position,\n      visible,\n      id: userId,\n      color: pointerColor,\n    };\n  }\n\n  function handleOwnPointerDown(position: Vector2) {\n    updateOwnPointerState(position, true);\n  }\n\n  function handleOwnPointerMove(position: Vector2) {\n    updateOwnPointerState(position, true);\n  }\n\n  function handleOwnPointerUp(position: Vector2) {\n    updateOwnPointerState(position, false);\n  }\n\n  // Handle pointer data receive\n  const interpolationsRef = useRef<Record<string, PointerInterpolation>>({});\n  useEffect(() => {\n    // TODO: Handle player disconnect while pointer visible\n    function handleSocketPlayerPointer(pointer: InterpolatedPointerState) {\n      const interpolations = interpolationsRef.current;\n      const id = pointer.id;\n      if (!(id in interpolations)) {\n        interpolations[id] = {\n          id,\n          from: null,\n          to: { ...pointer, time: performance.now() + sendTickRate },\n        };\n      } else if (\n        !Vector2.compare(\n          interpolations[id].to.position,\n          pointer.position,\n          0.0001\n        ) ||\n        interpolations[id].to.visible !== pointer.visible\n      ) {\n        const from = interpolations[id].to;\n        interpolations[id] = {\n          id,\n          from: {\n            ...from,\n            time: performance.now(),\n          },\n          to: {\n            ...pointer,\n            time: performance.now() + sendTickRate,\n          },\n        };\n      }\n    }\n\n    session.socket?.on(\"player_pointer\", handleSocketPlayerPointer);\n\n    return () => {\n      session.socket?.off(\"player_pointer\", handleSocketPlayerPointer);\n    };\n  }, [session]);\n\n  // Animate to the peer pointer positions\n  useEffect(() => {\n    let request = requestAnimationFrame(animate);\n\n    function animate() {\n      request = requestAnimationFrame(animate);\n      const time = performance.now();\n      let interpolatedPointerState: Record<string, PointerState> = {};\n      for (let interp of Object.values(interpolationsRef.current)) {\n        if (!interp.from || !interp.to) {\n          continue;\n        }\n        const totalInterpTime = interp.to.time - interp.from.time;\n        const currentInterpTime = time - interp.from.time;\n        const alpha = currentInterpTime / totalInterpTime;\n\n        if (alpha >= 0 && alpha <= 1) {\n          interpolatedPointerState[interp.id] = {\n            id: interp.id,\n            visible: interp.from.visible,\n            position: Vector2.lerp(\n              interp.from.position,\n              interp.to.position,\n              alpha\n            ),\n            color: interp.from.color,\n          };\n        }\n        if (alpha > 1 && !interp.to.visible) {\n          interpolatedPointerState[interp.id] = {\n            id: interp.id,\n            visible: interp.to.visible,\n            position: interp.to.position,\n            color: interp.to.color,\n          };\n          delete interpolationsRef.current[interp.id];\n        }\n      }\n      if (!isEmpty(interpolatedPointerState)) {\n        setLocalPointerState((prev) => ({\n          ...prev,\n          ...interpolatedPointerState,\n        }));\n      }\n    }\n\n    return () => {\n      cancelAnimationFrame(request);\n    };\n  }, []);\n\n  return (\n    <Group>\n      {Object.values(localPointerState).map((pointer) => (\n        <PointerTool\n          key={pointer.id}\n          active={pointer.id === userId ? active : false}\n          position={pointer.position}\n          visible={pointer.visible}\n          onPointerDown={\n            pointer.id === userId ? handleOwnPointerDown : undefined\n          }\n          onPointerMove={\n            pointer.id === userId ? handleOwnPointerMove : undefined\n          }\n          onPointerUp={pointer.id === userId ? handleOwnPointerUp : undefined}\n          color={pointer.color}\n        />\n      ))}\n    </Group>\n  );\n}\n\nexport default NetworkedMapPointer;\n","import { useEffect, useRef } from \"react\";\n\nfunction usePrevious<T>(value: T): T {\n  const ref = useRef<T>(value);\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref.current;\n}\n\nexport default usePrevious;\n","import { Circle, Group } from \"react-konva\";\n\nimport colors from \"../../helpers/colors\";\nimport { TokenState } from \"../../types/TokenState\";\n\ntype TokenStatusProps = {\n  tokenState: TokenState;\n  width: number;\n  height: number;\n};\n\nfunction TokenStatus({ tokenState, width, height }: TokenStatusProps) {\n  // Ensure statuses is an array and filter empty values\n  const statuses = [...new Set((tokenState?.statuses || []).filter((s) => s))];\n  return (\n    <Group x={width} y={height} offsetX={width / 2} offsetY={height / 2}>\n      {statuses.map((status, index) => (\n        <Circle\n          key={status}\n          width={width}\n          height={height}\n          stroke={colors[status]}\n          strokeWidth={width / 20 / tokenState.size}\n          scaleX={1 - index / 10 / tokenState.size}\n          scaleY={1 - index / 10 / tokenState.size}\n          opacity={0.8}\n          fillEnabled={false}\n        />\n      ))}\n    </Group>\n  );\n}\n\nexport default TokenStatus;\n","import Konva from \"konva\";\nimport { useRef, useEffect, useState } from \"react\";\nimport { Rect, Text, Group } from \"react-konva\";\n\nimport useSetting from \"../../hooks/useSetting\";\nimport { TokenState } from \"../../types/TokenState\";\n\nconst maxTokenSize = 3;\nconst defaultFontSize = 144;\nconst minFontSize = 16;\n\ntype TokenLabelProps = {\n  tokenState: TokenState;\n  width: number;\n  height: number;\n};\n\nfunction TokenLabel({ tokenState, width, height }: TokenLabelProps) {\n  const [labelSize] = useSetting<number>(\"map.labelSize\");\n\n  const paddingY =\n    (height / 12 / tokenState.size) * Math.min(tokenState.size, maxTokenSize);\n  const paddingX =\n    (height / 8 / tokenState.size) * Math.min(tokenState.size, maxTokenSize);\n\n  const [fontScale, setFontScale] = useState(0);\n  useEffect(() => {\n    const text = textSizerRef.current;\n\n    if (!text) {\n      return;\n    }\n\n    let fontSizes: number[] = [];\n    for (let size = minFontSize * labelSize; size >= 6; size--) {\n      const verticalSize = height / size / tokenState.size;\n      const tokenSize = Math.min(tokenState.size, maxTokenSize);\n      const fontSize = verticalSize * tokenSize * labelSize;\n      fontSizes.push(fontSize);\n    }\n\n    const findFontScale = () => {\n      const size = fontSizes.reduce((prev, curr) => {\n        text.fontSize(curr);\n        const textWidth = text.getTextWidth() + paddingX * 2;\n        if (textWidth < width) {\n          return curr;\n        } else {\n          return prev;\n        }\n      }, 1);\n\n      setFontScale(size / defaultFontSize);\n    };\n\n    findFontScale();\n  }, [\n    tokenState.label,\n    tokenState.visible,\n    width,\n    height,\n    tokenState,\n    labelSize,\n    paddingX,\n  ]);\n\n  const [rectWidth, setRectWidth] = useState(0);\n  const [textWidth, setTextWidth] = useState(0);\n  useEffect(() => {\n    const text = textRef.current;\n    if (text && tokenState.label) {\n      setRectWidth(text.getTextWidth() * fontScale + paddingX * 2);\n      setTextWidth(text.getTextWidth() * fontScale);\n    } else {\n      setRectWidth(0);\n      setTextWidth(0);\n    }\n  }, [tokenState.label, paddingX, width, fontScale]);\n\n  const textRef = useRef<Konva.Text>(null);\n  const textSizerRef = useRef<Konva.Text>(null);\n\n  const overlayOffset = Math.max(0, Math.round(height * 0.12));\n  const baseSize = Math.min(width, height);\n  const scale = Math.min(1, baseSize / 72);\n  const barHeight = Math.max(5, Math.round(baseSize * 0.11 * scale));\n  const barPadding = Math.max(3, Math.round(barHeight * 0.2));\n  const barGap = 0;\n  const barCount = tokenState.attributes?.bars?.length ?? 0;\n  const availableBarHeight = height * 0.5;\n  const stackDown = barCount > 2;\n  const maxBars = stackDown\n    ? barCount\n    : Math.max(\n        1,\n        Math.floor((availableBarHeight + barGap) / (barHeight + barGap))\n      );\n  const barsToShowCount = Math.min(barCount, maxBars);\n  const baseBarY = height - barPadding - barHeight;\n  const bottomBarY =\n    barsToShowCount > 0\n      ? stackDown\n        ? baseBarY + (barsToShowCount - 1) * (barHeight + barGap)\n        : baseBarY\n      : null;\n  const labelGap = Math.max(2, Math.round(barHeight * 0.35));\n  const defaultLabelY =\n    height - (defaultFontSize * fontScale + paddingY) / 2 + overlayOffset;\n  const labelY =\n    bottomBarY !== null\n      ? bottomBarY + barHeight + labelGap + paddingY / 2\n      : defaultLabelY;\n\n  return (\n    <Group y={labelY}>\n      <Rect\n        y={-paddingY / 2}\n        width={rectWidth}\n        offsetX={width / 2}\n        x={width - rectWidth / 2}\n        height={defaultFontSize * fontScale + paddingY}\n        fill=\"hsla(230, 25%, 18%, 0.8)\"\n        cornerRadius={(defaultFontSize * fontScale + paddingY) / 2}\n      />\n      <Group offsetX={(textWidth - width) / 2}>\n        <Text\n          ref={textRef}\n          text={tokenState.label}\n          fontSize={defaultFontSize}\n          lineHeight={1}\n          // Scale font instead of changing font size to avoid kerning issues with Firefox\n          scaleX={fontScale}\n          scaleY={fontScale}\n          fill=\"white\"\n          wrap=\"none\"\n          ellipsis={false}\n          hitFunc={() => {}}\n        />\n      </Group>\n      {/* Use an invisible text block to work out text sizing */}\n      <Text\n        visible={false}\n        ref={textSizerRef}\n        text={tokenState.label}\n        wrap=\"none\"\n      />\n    </Group>\n  );\n}\n\nexport default TokenLabel;\n","import Konva from \"konva\";\nimport { Rect, Circle, Line } from \"react-konva\";\n\nimport colors from \"../../helpers/colors\";\nimport { Outline } from \"../../types/Outline\";\n\ntype TokenOutlineProps = {\n  outline: Outline;\n  hidden: boolean;\n} & Konva.ShapeConfig;\n\nfunction TokenOutline({ outline, hidden, ...props }: TokenOutlineProps) {\n  const sharedProps = {\n    fill: colors.black,\n    opacity: hidden ? 0 : 0.8,\n  };\n  if (outline.type === \"rect\") {\n    return (\n      <Rect\n        width={outline.width}\n        height={outline.height}\n        x={outline.x}\n        y={outline.y}\n        {...sharedProps}\n        {...props}\n      />\n    );\n  } else if (outline.type === \"circle\") {\n    return (\n      <Circle\n        radius={outline.radius}\n        x={outline.x}\n        y={outline.y}\n        {...sharedProps}\n        {...props}\n      />\n    );\n  } else {\n    return (\n      <Line\n        points={outline.points}\n        closed\n        tension={outline.points.length < 200 ? 0 : 0.33}\n        {...sharedProps}\n        {...props}\n      />\n    );\n  }\n}\n\nexport default TokenOutline;\n","import Konva from \"konva\";\nimport { Circle, Group, Rect, Text } from \"react-konva\";\n\nimport colors from \"../../helpers/colors\";\nimport { TokenAttributeBar, TokenAttributeValue, TokenState } from \"../../types/TokenState\";\n\ntype TokenAttributeBubbleProps = {\n  tokenState: TokenState;\n  width: number;\n  height: number;\n  isMapOwner: boolean;\n  isTokenOwner: boolean;\n  onBarClick?: (bar: TokenAttributeBar, node: Konva.Node) => void;\n  onValueClick?: (value: TokenAttributeValue, node: Konva.Node) => void;\n};\n\nconst MAX_RING_ITEMS = 8;\n\nfunction isVisible(\n  visibility: \"public\" | \"private\" | undefined,\n  isMapOwner: boolean,\n  isTokenOwner: boolean\n) {\n  if (visibility === \"private\") {\n    return isMapOwner || isTokenOwner;\n  }\n  return true;\n}\n\nfunction formatNumber(value: number) {\n  const rounded = Math.round(value * 10) / 10;\n  if (Number.isInteger(rounded)) {\n    return `${rounded}`;\n  }\n  return `${rounded}`;\n}\n\nfunction buildBarText(bar: TokenAttributeBar) {\n  const currentText = formatNumber(bar.current);\n  if (bar.showMinMax && typeof bar.max === \"number\") {\n    return `${currentText}/${formatNumber(bar.max)}`;\n  }\n  return currentText;\n}\n\nfunction buildValueText(value: TokenAttributeValue) {\n  const raw =\n    typeof value.value === \"number\" ? formatNumber(value.value) : `${value.value}`;\n  const trimmed = raw.trim();\n  return trimmed.length > 5 ? `${trimmed.slice(0, 5)}` : trimmed;\n}\n\nfunction getBarRatio(bar: TokenAttributeBar) {\n  if (typeof bar.max !== \"number\") {\n    return 1;\n  }\n  const min = typeof bar.min === \"number\" ? Math.max(bar.min, 0) : 0;\n  const currentValue = Math.max(bar.current, 0);\n  const maxValue = Math.max(bar.max, 0);\n  const range = maxValue - min;\n  if (!Number.isFinite(range) || range <= 0) {\n    return 0;\n  }\n  const clamped = Math.min(Math.max(currentValue - min, 0), range);\n  return clamped / range;\n}\n\nfunction TokenAttributeBubble({\n  tokenState,\n  width,\n  height,\n  isMapOwner,\n  isTokenOwner,\n  onBarClick,\n  onValueClick,\n}: TokenAttributeBubbleProps) {\n  const attributes = tokenState.attributes;\n  if (!attributes) {\n    return null;\n  }\n\n  const visibleBars = (attributes.bars || []).filter((bar) =>\n    isVisible(bar.visibility, isMapOwner, isTokenOwner)\n  );\n  const visibleValues = (attributes.values || []).filter((value) =>\n    isVisible(value.visibility, isMapOwner, isTokenOwner)\n  );\n\n  if (visibleBars.length === 0 && visibleValues.length === 0) {\n    return null;\n  }\n\n  const ringItems = visibleValues\n    .map((value) => ({\n      id: value.id,\n      color: value.color || colors.blue,\n      text: buildValueText(value),\n      value,\n    }))\n    .slice(0, MAX_RING_ITEMS);\n\n  const baseSize = Math.min(width, height);\n  const scale = Math.min(1, baseSize / 72);\n  const markerRadius = Math.max(6, Math.round((baseSize / 9.5) * scale));\n  const minRingRadius = baseSize / 2 + markerRadius * 1.05;\n  const ringItemsCount = ringItems.length;\n  const gap = 2;\n  const ringRadius = Math.max(minRingRadius, markerRadius + 2);\n  const fontSize = Math.max(7, Math.round(markerRadius * 0.95));\n  const strokeWidth = Math.max(1, Math.round(markerRadius * 0.18));\n\n  const barHeight = Math.max(5, Math.round(baseSize * 0.11 * scale));\n  const barGap = Math.max(1, Math.round(barHeight * 0.15));\n  const barPadding = Math.max(2, Math.round(barHeight * 0.2));\n  const maxBarWidth = Math.min(width, Math.round(baseSize * 0.9));\n  const barWidth = Math.max(20, maxBarWidth - barPadding * 2);\n  const barX = barPadding;\n  const barRadius = Math.round(barHeight / 2);\n  const availableBarHeight = height * 0.5;\n  const stackDown = visibleBars.length > 2;\n  const maxBars = stackDown\n    ? visibleBars.length\n    : Math.max(\n        1,\n        Math.floor((availableBarHeight + barGap) / (barHeight + barGap))\n      );\n  const barsToShow = visibleBars.slice(0, maxBars);\n  const baseBarY = height - barPadding - barHeight;\n  const startAngle = 0;\n  const step =\n    ringItemsCount > 1 ? (markerRadius * 2 + gap) / ringRadius : 0;\n\n  const centerX = width / 2;\n  const centerY = height / 2;\n\n  function handleBarClick(\n    event: Konva.KonvaEventObject<Event>,\n    bar: TokenAttributeBar\n  ) {\n    if (!onBarClick) {\n      return;\n    }\n    event.cancelBubble = true;\n    onBarClick(bar, event.currentTarget);\n  }\n\n  function handleValueClick(\n    event: Konva.KonvaEventObject<Event>,\n    value: TokenAttributeValue\n  ) {\n    if (!onValueClick) {\n      return;\n    }\n    event.cancelBubble = true;\n    onValueClick(value, event.currentTarget);\n  }\n\n  return (\n    <Group x={0} y={0}>\n      {barsToShow.map((bar, index) => {\n        const barText = buildBarText(bar);\n        const barRatio = getBarRatio(bar);\n        const baseFontSize = Math.max(8, Math.round(barHeight * 0.95));\n        const estimatedTextWidth = barText.length * baseFontSize * 0.6;\n        const textScale = Math.min(1, barWidth / (estimatedTextWidth + 1));\n        const barFontSize = Math.max(8, Math.round(baseFontSize * textScale));\n        const barY = stackDown\n          ? baseBarY + index * (barHeight + barGap)\n          : baseBarY - index * (barHeight + barGap);\n        return (\n          <Group\n            key={bar.id}\n            onClick={(event) => handleBarClick(event, bar)}\n            onTap={(event) => handleBarClick(event, bar)}\n            listening={!!onBarClick}\n          >\n            <Rect\n              x={barX}\n              y={barY}\n              width={barWidth}\n              height={barHeight}\n              fill=\"rgba(10, 10, 12, 0.45)\"\n              cornerRadius={barRadius}\n            />\n            <Rect\n              x={barX}\n              y={barY}\n              width={Math.max(2, Math.round(barWidth * barRatio))}\n              height={barHeight}\n              fill={bar.color}\n              opacity={1}\n              cornerRadius={barRadius}\n            />\n            <Text\n              text={barText}\n              x={barX}\n              y={barY}\n              width={barWidth}\n              height={barHeight}\n              align=\"center\"\n              verticalAlign=\"top\"\n              fontSize={barFontSize}\n              fontStyle=\"bold\"\n              fill=\"white\"\n              opacity={1}\n              clipX={barX}\n              clipY={barY}\n              clipWidth={barWidth}\n              clipHeight={barHeight}\n              shadowColor=\"rgba(255, 255, 255, 0.6)\"\n              shadowBlur={2}\n              shadowOffsetX={0}\n              shadowOffsetY={0}\n              shadowOpacity={0.6}\n              listening={false}\n            />\n          </Group>\n        );\n      })}\n      {ringItems.map((item, index) => {\n        const angle = startAngle - index * step;\n        const x = centerX + Math.cos(angle) * ringRadius;\n        const y = centerY + Math.sin(angle) * ringRadius;\n        return (\n          <Group\n            key={item.id}\n            x={x}\n            y={y}\n            onClick={(event) => handleValueClick(event, item.value)}\n            onTap={(event) => handleValueClick(event, item.value)}\n            listening={!!onValueClick}\n          >\n            <Circle\n              radius={markerRadius}\n              fill={item.color}\n              stroke=\"rgba(0, 0, 0, 0.6)\"\n              strokeWidth={strokeWidth}\n              shadowColor=\"rgba(0, 0, 0, 0.4)\"\n              shadowBlur={2}\n              shadowOffsetX={0}\n              shadowOffsetY={1}\n              shadowOpacity={0.6}\n            />\n            <Text\n              text={item.text}\n              width={markerRadius * 2}\n              height={markerRadius * 2}\n              offsetX={markerRadius}\n              offsetY={markerRadius}\n              align=\"center\"\n              verticalAlign=\"middle\"\n              fontSize={fontSize}\n              fontStyle=\"bold\"\n              fill=\"white\"\n              opacity={1}\n              shadowColor=\"rgba(255, 255, 255, 0.6)\"\n              shadowBlur={2}\n              shadowOffsetX={0}\n              shadowOffsetY={0}\n              shadowOpacity={0.6}\n              listening={false}\n            />\n          </Group>\n        );\n      })}\n    </Group>\n  );\n}\n\nexport default TokenAttributeBubble;\n","import { v4 as uuid } from \"uuid\";\n\nimport colors from \"./colors\";\nimport {\n  TokenAttributeBar,\n  TokenAttributeState,\n  TokenAttributeValue,\n} from \"../types/TokenState\";\n\nexport type ParseNumberResult =\n  | { ok: true; value: number }\n  | { ok: false; error: string };\n\nconst DEFAULT_BAR_COLOR = colors.red;\n\nexport function createEmptyAttributes(userId: string, now = Date.now()): TokenAttributeState {\n  return {\n    bars: [],\n    values: [],\n    version: 0,\n    updatedAt: now,\n    updatedBy: userId || \"unknown\",\n  };\n}\n\nexport function createDefaultBar(): TokenAttributeBar {\n  return {\n    id: uuid(),\n    label: \"HP\",\n    current: 0,\n    min: 0,\n    max: 10,\n    color: DEFAULT_BAR_COLOR,\n    showMinMax: true,\n    visibility: \"public\",\n  };\n}\n\nexport function createDefaultValue(): TokenAttributeValue {\n  return {\n    id: uuid(),\n    label: \"Value\",\n    value: 0,\n    color: colors.blue,\n    visibility: \"public\",\n  };\n}\n\nexport function buildNextAttributes(\n  prev: TokenAttributeState | undefined,\n  nextBars: TokenAttributeBar[],\n  nextValues: TokenAttributeValue[],\n  userId: string,\n  now = Date.now()\n): TokenAttributeState {\n  return {\n    bars: nextBars,\n    values: nextValues,\n    version: prev?.version ?? 0,\n    updatedAt: now,\n    updatedBy: userId || prev?.updatedBy || \"unknown\",\n  };\n}\n\nexport function cloneAttributesWithNewIds(\n  source: TokenAttributeState,\n  userId: string,\n  now = Date.now()\n): TokenAttributeState {\n  return {\n    bars: (source.bars || []).map((bar) => ({ ...bar, id: uuid() })),\n    values: (source.values || []).map((value) => ({ ...value, id: uuid() })),\n    version: 0,\n    updatedAt: now,\n    updatedBy: userId || source.updatedBy || \"unknown\",\n  };\n}\n\nexport function parseNumericExpression(\n  current: number,\n  rawInput: string\n): ParseNumberResult {\n  const trimmed = rawInput.trim();\n  if (!trimmed) {\n    return { ok: false, error: \"\" };\n  }\n  const tokens = trimmed.split(/\\s+/).filter(Boolean);\n  if (tokens.length === 0) {\n    return { ok: false, error: \"\" };\n  }\n  const first = tokens[0];\n  const firstOp = first[0];\n  if (\n    tokens.length === 1 &&\n    firstOp !== \"+\" &&\n    firstOp !== \"-\" &&\n    firstOp !== \"*\" &&\n    firstOp !== \"/\" &&\n    firstOp !== \"=\"\n  ) {\n    const parsed = Number(first);\n    if (!Number.isFinite(parsed)) {\n      return { ok: false, error: \"\" };\n    }\n    return { ok: true, value: parsed };\n  }\n\n  let result = current;\n  for (const token of tokens) {\n    const op = token[0];\n    if (op !== \"+\" && op !== \"-\" && op !== \"*\" && op !== \"/\" && op !== \"=\") {\n      return { ok: false, error: \"\" };\n    }\n    const payload = token.slice(1).trim();\n    const parsed = Number(payload);\n    if (!Number.isFinite(parsed)) {\n      return { ok: false, error: \"\" };\n    }\n    if (op === \"+\") {\n      result = result + parsed;\n    } else if (op === \"-\") {\n      result = result - parsed;\n    } else if (op === \"*\") {\n      result = result * parsed;\n    } else if (op === \"/\") {\n      if (parsed === 0) {\n        return { ok: false, error: \" 0\" };\n      }\n      result = result / parsed;\n    } else if (op === \"=\") {\n      result = parsed;\n    }\n    if (!Number.isFinite(result)) {\n      return { ok: false, error: \"\" };\n    }\n  }\n  return { ok: true, value: result };\n}\n","import { v4 as uuid } from \"uuid\";\nimport Case from \"case\";\nimport Konva from \"konva\";\n\nimport blobToBuffer from \"./blobToBuffer\";\nimport { createThumbnail, getImageOutline, imageToWebp } from \"./image\";\nimport { cloneAttributesWithNewIds } from \"./tokenAttributes\";\nimport { getFileNameFromUrl, guessImageMimeFromUrl } from \"./url\";\nimport Vector2 from \"./Vector2\";\n\nimport { Token, FileToken, TokenCategory } from \"../types/Token\";\nimport { TokenState, BaseTokenState } from \"../types/TokenState\";\nimport { Asset } from \"../types/Asset\";\nimport { Outline } from \"../types/Outline\";\n\nconst webpMime = \"image/webp\";\n\nfunction clampQuality(value: number) {\n  if (Number.isNaN(value)) {\n    return 0.8;\n  }\n  return Math.min(1, Math.max(0.1, value));\n}\n\nexport function createTokenState(\n  token: Token,\n  position: Vector2,\n  userId: string,\n  options?: { autoEnableVision?: boolean; visionRange?: number }\n): TokenState {\n  let tokenState: BaseTokenState = {\n    id: uuid(),\n    tokenId: token.id,\n    owner: userId,\n    size: token.defaultSize,\n    category: token.defaultCategory,\n    label: token.defaultLabel,\n    statuses: [],\n    x: position.x,\n    y: position.y,\n    lastModifiedBy: userId,\n    lastModified: Date.now(),\n    rotation: 0,\n    locked: false,\n    visible: true,\n    outline: token.outline,\n    width: token.width,\n    height: token.height,\n  };\n  if (options?.autoEnableVision) {\n    tokenState = {\n      ...tokenState,\n      hasVision: true,\n      visionRange: options.visionRange ?? 4,\n    };\n  }\n  if (token.defaultAttributes) {\n    tokenState = {\n      ...tokenState,\n      attributes: cloneAttributesWithNewIds(token.defaultAttributes, userId),\n    };\n  }\n  if (token.type === \"file\") {\n    return {\n      ...tokenState,\n      type: \"file\",\n      file: token.file,\n    };\n  } else {\n    return {\n      ...tokenState,\n      type: \"default\",\n      key: token.key,\n    };\n  }\n}\n\nexport async function createTokenFromFile(\n  file: File,\n  userId: string,\n  compressionQuality = 0.8\n): Promise<{ token: Token; assets: Asset[] }> {\n  if (!file) {\n    return Promise.reject();\n  }\n  let name = \"Unknown Token\";\n  let category: TokenCategory = \"character\";\n  let defaultSize = 1;\n  if (file.name) {\n    name = file.name.toLowerCase();\n    // @ts-ignore Check match all exists\n    if (name.matchAll) {\n      // Match against a regex to find the grid size in the file name\n      // e.g. Cave 22x23 will return [[\"22x22\", \"22\", \"x\", \"23\"]]\n      const sizeMatches = [...name.matchAll(/(\\d+) ?(x|X) ?(\\d+)/g)];\n      for (let match of sizeMatches) {\n        const matchX = parseInt(match[1]);\n        const matchY = parseInt(match[3]);\n        if (\n          !isNaN(matchX) &&\n          !isNaN(matchY) &&\n          matchX < 256 // Add check to test match isn't resolution\n        ) {\n          defaultSize = matchX;\n        }\n      }\n    }\n    // Match only the category e.g mount and not mountain\n    if (/(\\b|_)prop(\\b|_)/.test(name)) {\n      category = \"prop\";\n      name = name.replace(/(\\b|_)prop(\\b|_)/, \"\");\n    } else if (/(\\b|_)mount(\\b|_)/.test(name)) {\n      category = \"vehicle\";\n      name = name.replace(/(\\b|_)mount(\\b|_)/, \"\");\n    } else if (/(\\b|_)attachment(\\b|_)/.test(name)) {\n      category = \"attachment\";\n      name = name.replace(/(\\b|_)attachment(\\b|_)/, \"\");\n    }\n    // Remove file extension\n    name = name.replace(/\\.[^/.]+$/, \"\");\n    // Removed grid size expression\n    name = name.replace(/(\\[ ?|\\( ?)?\\d+ ?(x|X) ?\\d+( ?\\]| ?\\))?/, \"\");\n    // Clean string\n    name = name.replace(/ +/g, \" \");\n    name = name.trim();\n    // Capitalize and remove underscores\n    name = Case.capital(name);\n  }\n  let image = new Image();\n  const buffer = await blobToBuffer(file);\n\n  // Copy file to avoid permissions issues\n  const blob = new Blob([buffer]);\n  // Create and load the image temporarily to get its dimensions\n  const url = URL.createObjectURL(blob);\n\n  return new Promise((resolve, reject) => {\n    image.onload = async function () {\n      const normalizedQuality = clampQuality(compressionQuality);\n      let assets: Asset[] = [];\n      const thumbnailImage =\n        (await createThumbnail(\n          image,\n          webpMime,\n          300,\n          normalizedQuality\n        )) ?? (await createThumbnail(image, file.type));\n      const thumbnailId = uuid();\n      if (thumbnailImage) {\n        const thumbnail = {\n          ...thumbnailImage,\n          id: thumbnailId,\n          owner: userId,\n          source: \"local\" as const,\n          size: thumbnailImage.file.length,\n          originalName: file.name,\n        };\n        assets.push(thumbnail);\n      }\n\n      const compressedImage = await imageToWebp(image, normalizedQuality);\n      const fileAsset = {\n        id: uuid(),\n        file: compressedImage?.file ?? buffer,\n        width: compressedImage?.width ?? image.width,\n        height: compressedImage?.height ?? image.height,\n        mime: compressedImage?.mime ?? file.type,\n        owner: userId,\n        size: compressedImage?.file.length ?? buffer.byteLength,\n        originalName: file.name,\n        source: \"local\" as const,\n      };\n      assets.push(fileAsset);\n\n      const outline = getImageOutline(image);\n\n      const token: FileToken = {\n        name,\n        defaultSize,\n        thumbnail: thumbnailId,\n        file: fileAsset.id,\n        id: uuid(),\n        type: \"file\",\n        created: Date.now(),\n        lastModified: Date.now(),\n        owner: userId,\n        defaultCategory: category,\n        defaultLabel: \"\",\n        hideInSidebar: false,\n        width: image.width,\n        height: image.height,\n        outline,\n      };\n\n      URL.revokeObjectURL(url);\n      resolve({ token, assets });\n    };\n    image.onerror = reject;\n    image.src = url;\n  });\n}\n\nexport async function createTokenFromUrl(\n  url: string,\n  userId: string\n): Promise<{ token: Token; assets: Asset[] }> {\n  if (!url) {\n    return Promise.reject();\n  }\n  function loadImage(source: string, useCors: boolean) {\n    return new Promise<HTMLImageElement>((resolve, reject) => {\n      const img = new Image();\n      if (useCors) {\n        img.crossOrigin = \"anonymous\";\n      }\n      img.onload = () => resolve(img);\n      img.onerror = reject;\n      img.src = source;\n    });\n  }\n\n  let name = \"Unknown Token\";\n  let category: TokenCategory = \"character\";\n  let defaultSize = 1;\n  const fileName = getFileNameFromUrl(url, `remote-${Date.now()}`);\n  if (fileName) {\n    name = fileName.toLowerCase();\n    // @ts-ignore Check match all exists\n    if (name.matchAll) {\n      const sizeMatches = [...name.matchAll(/(\\d+) ?(x|X) ?(\\d+)/g)];\n      for (let match of sizeMatches) {\n        const matchX = parseInt(match[1]);\n        const matchY = parseInt(match[3]);\n        if (\n          !isNaN(matchX) &&\n          !isNaN(matchY) &&\n          matchX < 256\n        ) {\n          defaultSize = matchX;\n        }\n      }\n    }\n    if (/(\\b|_)prop(\\b|_)/.test(name)) {\n      category = \"prop\";\n      name = name.replace(/(\\b|_)prop(\\b|_)/, \"\");\n    } else if (/(\\b|_)mount(\\b|_)/.test(name)) {\n      category = \"vehicle\";\n      name = name.replace(/(\\b|_)mount(\\b|_)/, \"\");\n    } else if (/(\\b|_)attachment(\\b|_)/.test(name)) {\n      category = \"attachment\";\n      name = name.replace(/(\\b|_)attachment(\\b|_)/, \"\");\n    }\n    name = name.replace(/\\.[^/.]+$/, \"\");\n    name = name.replace(/(\\[ ?|\\( ?)?\\d+ ?(x|X) ?\\d+( ?\\]| ?\\))?/, \"\");\n    name = name.replace(/ +/g, \" \");\n    name = name.trim();\n    name = Case.capital(name);\n  }\n  const image =\n    (await loadImage(url, true).catch(() => loadImage(url, false))) as\n      | HTMLImageElement\n      | undefined;\n  if (!image) {\n    return Promise.reject();\n  }\n  const mime = guessImageMimeFromUrl(url);\n\n  const fileAsset = {\n    id: uuid(),\n    file: new Uint8Array(),\n    width: image.width,\n    height: image.height,\n    mime,\n    owner: userId,\n    remoteUrl: url,\n    originalName: fileName,\n    source: \"external\" as const,\n  };\n\n  let outline: Outline;\n  try {\n    outline = getImageOutline(image);\n  } catch (error) {\n    outline = {\n      type: \"rect\",\n      x: 0,\n      y: 0,\n      width: image.width,\n      height: image.height,\n    };\n  }\n\n  const token: FileToken = {\n    name,\n    defaultSize,\n    thumbnail: fileAsset.id,\n    file: fileAsset.id,\n    id: uuid(),\n    type: \"file\",\n    created: Date.now(),\n    lastModified: Date.now(),\n    owner: userId,\n    defaultCategory: category,\n    defaultLabel: \"\",\n    hideInSidebar: false,\n    width: image.width,\n    height: image.height,\n    outline,\n  };\n\n  return { token, assets: [fileAsset] };\n}\n\nexport function clientPositionToMapPosition(\n  mapStage: Konva.Stage,\n  clientPosition: Vector2,\n  checkMapBounds = true\n): Vector2 | undefined {\n  const mapImage = mapStage.findOne(\"#mapImage\");\n  const map = document.querySelector(\".map\");\n  if (!map) {\n    return;\n  }\n  const mapRect = map.getBoundingClientRect();\n\n  // Check map bounds\n  if (\n    checkMapBounds &&\n    (clientPosition.x < mapRect.left ||\n      clientPosition.x > mapRect.right ||\n      clientPosition.y < mapRect.top ||\n      clientPosition.y > mapRect.bottom)\n  ) {\n    return;\n  }\n\n  // Convert relative to map rect\n  const mapPosition = {\n    x: clientPosition.x - mapRect.left,\n    y: clientPosition.y - mapRect.top,\n  };\n\n  // Convert relative to map image\n  const transform = mapImage.getAbsoluteTransform().copy().invert();\n  const relativePosition = transform.point(mapPosition);\n  const normalizedPosition = {\n    x: relativePosition.x / mapImage.width(),\n    y: relativePosition.y / mapImage.height(),\n  };\n\n  return normalizedPosition;\n}\n\nexport function getScaledOutline(\n  tokenState: TokenState,\n  tokenWidth: number,\n  tokenHeight: number\n): Outline {\n  let outline = tokenState.outline;\n  if (outline.type === \"rect\") {\n    return {\n      ...outline,\n      x: (outline.x / tokenState.width) * tokenWidth,\n      y: (outline.y / tokenState.height) * tokenHeight,\n      width: (outline.width / tokenState.width) * tokenWidth,\n      height: (outline.height / tokenState.height) * tokenHeight,\n    };\n  } else if (outline.type === \"circle\") {\n    return {\n      ...outline,\n      x: (outline.x / tokenState.width) * tokenWidth,\n      y: (outline.y / tokenState.height) * tokenHeight,\n      radius: (outline.radius / tokenState.width) * tokenWidth,\n    };\n  } else {\n    let points = [...outline.points]; // Copy array so we can edit it imutably\n    for (let i = 0; i < points.length; i += 2) {\n      // Scale outline to the token\n      points[i] = (points[i] / tokenState.width) * tokenWidth;\n      points[i + 1] = (points[i + 1] / tokenState.height) * tokenHeight;\n    }\n    return { ...outline, points };\n  }\n}\n\nexport class Intersection {\n  outline;\n  position;\n  center;\n  rotation;\n  points: Vector2[] | undefined;\n  /**\n   * @param {Outline} outline\n   * @param {Vector2} position - Top left position of the token\n   * @param {Vector2} center - Center position of the token\n   * @param {number} rotation - Rotation of the token in degrees\n   */\n  constructor(\n    outline: Outline,\n    position: Vector2,\n    center: Vector2,\n    rotation: number\n  ) {\n    this.outline = outline;\n    this.position = position;\n    this.center = center;\n    this.rotation = rotation;\n    // Save points for intersection\n    if (outline.type === \"rect\") {\n      this.points = [\n        Vector2.rotate(\n          Vector2.add(new Vector2(outline.x, outline.y), position),\n          center,\n          rotation\n        ),\n        Vector2.rotate(\n          Vector2.add(\n            new Vector2(outline.x + outline.width, outline.y),\n            position\n          ),\n          center,\n          rotation\n        ),\n        Vector2.rotate(\n          Vector2.add(\n            new Vector2(outline.x + outline.width, outline.y + outline.height),\n            position\n          ),\n          center,\n          rotation\n        ),\n        Vector2.rotate(\n          Vector2.add(\n            new Vector2(outline.x, outline.y + outline.height),\n            position\n          ),\n          center,\n          rotation\n        ),\n      ];\n    } else if (outline.type === \"path\") {\n      this.points = [];\n      for (let i = 0; i < outline.points.length; i += 2) {\n        this.points.push(\n          Vector2.rotate(\n            Vector2.add(\n              new Vector2(outline.points[i], outline.points[i + 1]),\n              position\n            ),\n            center,\n            rotation\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * @param {Vector2} point\n   * @returns {boolean}\n   */\n  intersects(point: Vector2) {\n    if (\n      this.points &&\n      (this.outline.type === \"rect\" || this.outline.type === \"path\")\n    ) {\n      return Vector2.pointInPolygon(point, this.points);\n    } else if (this.outline.type === \"circle\") {\n      return Vector2.distance(this.center, point) < this.outline.radius;\n    }\n    return false;\n  }\n}\n","import Konva from \"konva\";\nimport { Transform } from \"konva/lib/Util\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\nimport {\n  useGridCellPixelSize,\n  useGridSnappingSensitivity,\n} from \"../../contexts/GridContext\";\nimport { useSetPreventMapInteraction } from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\n\nimport { roundTo } from \"../../helpers/shared\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { parseGridScale } from \"../../helpers/grid\";\n\nimport scaleDark from \"../../images/ScaleDark.png\";\nimport rotateDark from \"../../images/RotateDark.png\";\n\nimport { CustomTransformEventHandler } from \"../../types/Events\";\n\ntype TransformerProps = {\n  active: boolean;\n  nodes: Konva.Node[];\n  attachments: Konva.Node[];\n  onTransformStart?: CustomTransformEventHandler;\n  onTransform?: CustomTransformEventHandler;\n  onTransformEnd?: CustomTransformEventHandler;\n  gridScale: string;\n  portalSelector: string;\n  enabledAnchors?: string[];\n  resizeEnabled?: boolean;\n};\n\nconst DEFAULT_ENABLED_ANCHORS = [\"middle-left\", \"middle-right\"];\n\nexport class CustomTransformer extends Konva.Transformer {\n  attachments: Konva.Node[] = [];\n\n  // Override fitNodesInto applying transform to attachments as well\n  _fitNodesInto(newAttrs: any, evt?: any) {\n    var oldAttrs = this._getNodeRect();\n\n    const minSize = 1;\n\n    if (\n      Konva.Util._inRange(\n        newAttrs.width,\n        -this.padding() * 2 - minSize,\n        minSize\n      )\n    ) {\n      this.update();\n      return;\n    }\n    if (\n      Konva.Util._inRange(\n        newAttrs.height,\n        -this.padding() * 2 - minSize,\n        minSize\n      )\n    ) {\n      this.update();\n      return;\n    }\n\n    const allowNegativeScale = this.flipEnabled();\n    var t = new Transform();\n    t.rotate(this.rotation());\n    if (\n      this._movingAnchorName &&\n      newAttrs.width < 0 &&\n      this._movingAnchorName.indexOf(\"left\") >= 0\n    ) {\n      const offset = t.point({\n        x: -this.padding() * 2,\n        y: 0,\n      });\n      newAttrs.x += offset.x;\n      newAttrs.y += offset.y;\n      newAttrs.width += this.padding() * 2;\n      this._movingAnchorName = this._movingAnchorName.replace(\"left\", \"right\");\n      this._anchorDragOffset.x -= offset.x;\n      this._anchorDragOffset.y -= offset.y;\n      if (!allowNegativeScale) {\n        this.update();\n        return;\n      }\n    } else if (\n      this._movingAnchorName &&\n      newAttrs.width < 0 &&\n      this._movingAnchorName.indexOf(\"right\") >= 0\n    ) {\n      const offset = t.point({\n        x: this.padding() * 2,\n        y: 0,\n      });\n      this._movingAnchorName = this._movingAnchorName.replace(\"right\", \"left\");\n      this._anchorDragOffset.x -= offset.x;\n      this._anchorDragOffset.y -= offset.y;\n      newAttrs.width += this.padding() * 2;\n      if (!allowNegativeScale) {\n        this.update();\n        return;\n      }\n    }\n    if (\n      this._movingAnchorName &&\n      newAttrs.height < 0 &&\n      this._movingAnchorName.indexOf(\"top\") >= 0\n    ) {\n      const offset = t.point({\n        x: 0,\n        y: -this.padding() * 2,\n      });\n      newAttrs.x += offset.x;\n      newAttrs.y += offset.y;\n      this._movingAnchorName = this._movingAnchorName.replace(\"top\", \"bottom\");\n      this._anchorDragOffset.x -= offset.x;\n      this._anchorDragOffset.y -= offset.y;\n      newAttrs.height += this.padding() * 2;\n      if (!allowNegativeScale) {\n        this.update();\n        return;\n      }\n    } else if (\n      this._movingAnchorName &&\n      newAttrs.height < 0 &&\n      this._movingAnchorName.indexOf(\"bottom\") >= 0\n    ) {\n      const offset = t.point({\n        x: 0,\n        y: this.padding() * 2,\n      });\n      this._movingAnchorName = this._movingAnchorName.replace(\"bottom\", \"top\");\n      this._anchorDragOffset.x -= offset.x;\n      this._anchorDragOffset.y -= offset.y;\n      newAttrs.height += this.padding() * 2;\n      if (!allowNegativeScale) {\n        this.update();\n        return;\n      }\n    }\n\n    if (this.boundBoxFunc()) {\n      const bounded = this.boundBoxFunc()(oldAttrs, newAttrs);\n      if (bounded) {\n        newAttrs = bounded;\n      } else {\n        Konva.Util.warn(\n          \"boundBoxFunc returned falsy. You should return new bound rect from it!\"\n        );\n      }\n    }\n\n    // base size value doesn't really matter\n    // we just need to think about bounding boxes as transforms\n    // but how?\n    // the idea is that we have a transformed rectangle with the size of \"baseSize\"\n    const baseSize = 10000000;\n    const oldTr = new Transform();\n    oldTr.translate(oldAttrs.x, oldAttrs.y);\n    oldTr.rotate(oldAttrs.rotation);\n    oldTr.scale(oldAttrs.width / baseSize, oldAttrs.height / baseSize);\n\n    const newTr = new Transform();\n    newTr.translate(newAttrs.x, newAttrs.y);\n    newTr.rotate(newAttrs.rotation);\n    newTr.scale(newAttrs.width / baseSize, newAttrs.height / baseSize);\n\n    // now lets think we had [old transform] and n ow we have [new transform]\n    // Now, the questions is: how can we transform \"parent\" to go from [old transform] into [new transform]\n    // in equation it will be:\n    // [delta transform] * [old transform] = [new transform]\n    // that means that\n    // [delta transform] = [new transform] * [old transform inverted]\n    const delta = newTr.multiply(oldTr.invert());\n\n    [...this._nodes, ...this.attachments].forEach((node) => {\n      // for each node we have the same [delta transform]\n      // the equations is\n      // [delta transform] * [parent transform] * [old local transform] = [parent transform] * [new local transform]\n      // and we need to find [new local transform]\n      // [new local] = [parent inverted] * [delta] * [parent] * [old local]\n      const parentTransform = node.getParent().getAbsoluteTransform();\n      const localTransform = node.getTransform().copy();\n      // skip offset:\n      localTransform.translate(node.offsetX(), node.offsetY());\n\n      const newLocalTransform = new Transform();\n      newLocalTransform\n        .multiply(parentTransform.copy().invert())\n        .multiply(delta)\n        .multiply(parentTransform)\n        .multiply(localTransform);\n\n      const attrs = newLocalTransform.decompose();\n      node.setAttrs(attrs);\n      this._fire(\"transform\", { evt: evt, target: node });\n      node._fire(\"transform\", { evt: evt, target: node });\n      node.getLayer()?.batchDraw();\n    });\n    this.rotation(Konva.Util._getRotation(newAttrs.rotation));\n    this._resetTransformCache();\n    this.update();\n    this.getLayer()?.batchDraw();\n  }\n}\n\nfunction Transformer({\n  active,\n  nodes,\n  attachments,\n  onTransformStart,\n  onTransform,\n  onTransformEnd,\n  gridScale,\n  portalSelector,\n  enabledAnchors,\n  resizeEnabled,\n}: TransformerProps) {\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n\n  const gridCellPixelSize = useGridCellPixelSize();\n  const gridCellAbsoluteSizeRef = useRef({\n    x: 0,\n    y: 0,\n  });\n  const scale = parseGridScale(gridScale);\n\n  const snappingSensitivity = useGridSnappingSensitivity();\n  // Clamp snapping to 0 to accound for -1 snapping override\n  const gridSnappingSensitivity = useMemo(\n    () => Math.max(snappingSensitivity, 0),\n    [snappingSensitivity]\n  );\n\n  const mapStageRef = useMapStage();\n  const transformerRef = useRef<CustomTransformer | null>(null);\n  const resolvedAnchors = enabledAnchors ?? DEFAULT_ENABLED_ANCHORS;\n  const resolvedResizeEnabled = resizeEnabled ?? true;\n\n  useEffect(() => {\n    let transformer = transformerRef.current;\n    const stage = mapStageRef.current;\n    if (active && stage && !transformer) {\n      transformer = new CustomTransformer({\n        centeredScaling: true,\n        rotateAnchorOffset: 16,\n        enabledAnchors: resolvedAnchors,\n        resizeEnabled: resolvedResizeEnabled,\n        flipEnabled: false,\n        ignoreStroke: true,\n        borderStroke: \"invisible\",\n        anchorStroke: \"invisible\",\n        anchorCornerRadius: 24,\n        borderStrokeWidth: 0,\n        anchorSize: 48,\n      });\n      const portal = stage.findOne<Konva.Group>(portalSelector);\n      if (portal) {\n        portal.add(transformer);\n        transformerRef.current = transformer;\n      }\n    }\n\n    return () => {\n      if (stage && transformer) {\n        transformer.destroy();\n        transformerRef.current = null;\n      }\n    };\n  }, [mapStageRef, portalSelector, active, resolvedAnchors, resolvedResizeEnabled]);\n\n  useEffect(() => {\n    const transformer = transformerRef.current;\n    if (active && transformer) {\n      transformer.enabledAnchors(resolvedAnchors);\n      transformer.resizeEnabled(resolvedResizeEnabled);\n      transformer.getLayer()?.batchDraw();\n    }\n  }, [active, resolvedAnchors, resolvedResizeEnabled]);\n\n  useEffect(() => {\n    const transformer = transformerRef.current;\n    if (!active || !transformer) {\n      return;\n    }\n    function handlePointerDown() {\n      setPreventMapInteraction(true);\n    }\n    function handlePointerUp() {\n      setPreventMapInteraction(false);\n    }\n    transformer.on(\"mousedown touchstart\", handlePointerDown);\n    transformer.on(\"mouseup touchend\", handlePointerUp);\n    return () => {\n      transformer.off(\"mousedown touchstart\", handlePointerDown);\n      transformer.off(\"mouseup touchend\", handlePointerUp);\n    };\n  }, [active, setPreventMapInteraction]);\n\n  useEffect(() => {\n    transformerRef.current?.boundBoxFunc((oldBox, newBox) => {\n      let snapBox = { ...newBox };\n      const movingAnchor = movingAnchorRef.current;\n      if (movingAnchor === \"middle-left\" || movingAnchor === \"middle-right\") {\n        // Account for grid snapping\n        const nearestCellWidth = roundTo(\n          snapBox.width,\n          gridCellAbsoluteSizeRef.current.x\n        );\n        const distanceToSnap = Math.abs(snapBox.width - nearestCellWidth);\n        let snapping = false;\n        if (\n          distanceToSnap <\n          gridCellAbsoluteSizeRef.current.x * gridSnappingSensitivity\n        ) {\n          snapBox.width = nearestCellWidth;\n          snapping = true;\n        }\n\n        const deltaWidth = snapBox.width - oldBox.width;\n        // Account for node ratio\n        const inverseRatio =\n          Math.round(oldBox.height) / Math.round(oldBox.width);\n        const deltaHeight = inverseRatio * deltaWidth;\n\n        // Account for node rotation\n        // Create a transform to unrotate the x,y position of the Box\n        const rotator = new Transform();\n        rotator.rotate(-snapBox.rotation);\n\n        // Unrotate and add the resize amount\n        let rotatedMin = rotator.point({ x: snapBox.x, y: snapBox.y });\n        rotatedMin.y = rotatedMin.y - deltaHeight / 2;\n        // Snap x position if needed\n        if (snapping) {\n          const snapDelta = newBox.width - nearestCellWidth;\n          rotatedMin.x = rotatedMin.x + snapDelta / 2;\n        }\n\n        // Rotated back\n        rotator.invert();\n        rotatedMin = rotator.point(rotatedMin);\n\n        snapBox = {\n          ...snapBox,\n          height: snapBox.height + deltaHeight,\n          x: rotatedMin.x,\n          y: rotatedMin.y,\n        };\n      }\n\n      if (snapBox.width < 5 || snapBox.height < 5) {\n        return oldBox;\n      }\n      return snapBox;\n    });\n  });\n\n  useEffect(() => {\n    transformerRef.current?.rotationSnaps(\n      snappingSensitivity === -1\n        ? [] // Disabled rotation snapping if grid snapping disabled with shortcut\n        : [...Array(24).keys()].map((n) => n * 15)\n    );\n  });\n\n  const movingAnchorRef = useRef<string>();\n  const transformTextRef = useRef<Konva.Group>();\n\n  useEffect(() => {\n    function updateGridCellAbsoluteSize() {\n      if (active) {\n        const transformer = transformerRef.current;\n        const stage = transformer?.getStage();\n        const mapImage = stage?.findOne(\"#mapImage\");\n        if (!mapImage) {\n          return;\n        }\n\n        // Use min side for hex grids\n        const minSize = Vector2.componentMin(gridCellPixelSize);\n        const size = new Vector2(minSize, minSize);\n\n        // Get grid cell size in screen coordinates\n        const mapTransform = mapImage.getAbsoluteTransform();\n        const absoluteSize = Vector2.subtract(\n          mapTransform.point(size),\n          mapTransform.point({ x: 0, y: 0 })\n        );\n\n        gridCellAbsoluteSizeRef.current = absoluteSize;\n      }\n    }\n\n    function handleTransformStart(e: Konva.KonvaEventObject<Event>) {\n      const transformer = transformerRef.current;\n      if (transformer) {\n        movingAnchorRef.current = transformer._movingAnchorName;\n        setPreventMapInteraction(true);\n\n        const transformText = new Konva.Label();\n        const stageScale = transformer.getStage()?.scale() || { x: 1, y: 1 };\n        transformText.scale(Vector2.divide({ x: 1, y: 1 }, stageScale));\n\n        const tag = new Konva.Tag();\n        tag.fill(\"hsla(230, 25%, 15%, 0.8)\");\n        tag.cornerRadius(4);\n        // @ts-ignore\n        tag.pointerDirection(\"down\");\n        tag.pointerHeight(4);\n        tag.pointerWidth(4);\n\n        const text = new Konva.Text();\n        text.fontSize(16);\n        text.padding(4);\n        text.fill(\"white\");\n\n        transformText.add(tag);\n        transformText.add(text);\n\n        transformer.getLayer()?.add(transformText);\n        transformTextRef.current = transformText;\n\n        updateGridCellAbsoluteSize();\n        updateTransformText();\n\n        onTransformStart && onTransformStart(e, attachments);\n      }\n    }\n\n    function updateTransformText() {\n      const movingAnchor = movingAnchorRef.current;\n      const transformText = transformTextRef.current;\n      const transformer = transformerRef.current;\n      const node = transformer?.nodes()[0];\n      if (node && transformText && transformer) {\n        const text = transformText.getChildren()[1] as Konva.Text;\n        if (movingAnchor === \"rotater\") {\n          text.text(`${node.rotation().toFixed(0)}`);\n        } else {\n          const nodeRect = node.getClientRect({ skipShadow: true });\n          const nodeScale = Vector2.divide(\n            { x: nodeRect.width, y: nodeRect.height },\n            gridCellAbsoluteSizeRef.current\n          );\n          text.text(\n            `${(nodeScale.x * scale.multiplier).toFixed(scale.digits)}${\n              scale.unit\n            }`\n          );\n        }\n\n        const nodePosition = node.getStage()?.getPointerPosition();\n        if (nodePosition) {\n          transformText.absolutePosition({\n            x: nodePosition.x,\n            y: nodePosition.y,\n          });\n        }\n      }\n    }\n\n    function handleTransform(e: Konva.KonvaEventObject<Event>) {\n      updateTransformText();\n      onTransform?.(e, attachments);\n    }\n\n    function handleTransformEnd(e: Konva.KonvaEventObject<Event>) {\n      setPreventMapInteraction(false);\n      transformTextRef.current?.destroy();\n      transformTextRef.current = undefined;\n      onTransformEnd && onTransformEnd(e, attachments);\n    }\n\n    transformerRef.current?.on(\"transformstart\", handleTransformStart);\n    transformerRef.current?.on(\"transform\", handleTransform);\n    transformerRef.current?.on(\"transformend\", handleTransformEnd);\n\n    return () => {\n      transformerRef.current?.off(\"transformstart\", handleTransformStart);\n      transformerRef.current?.off(\"transform\", handleTransform);\n      transformerRef.current?.off(\"transformend\", handleTransformEnd);\n    };\n  });\n\n  const [anchorScale, anchorScaleStatus] = useAnchorImage(96, scaleDark);\n  const [anchorRotate, anchorRotateStatus] = useAnchorImage(96, rotateDark);\n\n  // Add nodes to transformer and setup\n  useEffect(() => {\n    const transformer = transformerRef.current;\n    if (\n      active &&\n      transformer &&\n      anchorScaleStatus === \"loaded\" &&\n      anchorRotateStatus === \"loaded\"\n    ) {\n      transformer.setNodes(nodes);\n      transformer.attachments = attachments;\n\n      const middleLeft = transformer.findOne<Konva.Rect>(\".middle-left\");\n      const middleRight = transformer.findOne<Konva.Rect>(\".middle-right\");\n      const rotater = transformer.findOne<Konva.Rect>(\".rotater\");\n\n      if (middleLeft) {\n        middleLeft.fillPriority(\"pattern\");\n        middleLeft.fillPatternImage(anchorScale);\n        middleLeft.strokeEnabled(false);\n        middleLeft.fillPatternScaleX(-0.5);\n        middleLeft.fillPatternScaleY(0.5);\n      }\n\n      if (middleRight) {\n        middleRight.fillPriority(\"pattern\");\n        middleRight.fillPatternImage(anchorScale);\n        middleRight.strokeEnabled(false);\n        middleRight.fillPatternScaleX(0.5);\n        middleRight.fillPatternScaleY(0.5);\n      }\n\n      if (rotater) {\n        rotater.fillPriority(\"pattern\");\n        rotater.fillPatternImage(anchorRotate);\n        rotater.strokeEnabled(false);\n        rotater.fillPatternScaleX(0.5);\n        rotater.fillPatternScaleY(0.5);\n      }\n\n      transformer.getLayer()?.batchDraw();\n    }\n  }, [\n    active,\n    nodes,\n    attachments,\n    anchorScale,\n    anchorRotate,\n    anchorScaleStatus,\n    anchorRotateStatus,\n    resolvedAnchors,\n  ]);\n\n  return null;\n}\n\nTransformer.defaultProps = {\n  portalSelector: \"#portal\",\n  attachments: [],\n};\n\ntype AnchorImageStatus = \"loading\" | \"loaded\" | \"failed\";\n\nfunction useAnchorImage(\n  size: number,\n  source: string\n): [HTMLCanvasElement, AnchorImageStatus] {\n  const [canvas] = useState(document.createElement(\"canvas\"));\n  const [status, setStatus] = useState<AnchorImageStatus>(\"loading\");\n\n  useEffect(() => {\n    canvas.width = size;\n    canvas.height = size;\n    const ctx = canvas.getContext(\"2d\");\n    const image = new Image();\n    image.src = source;\n    image.onload = () => {\n      const imageRatio = image.width / image.height;\n      const imageWidth = canvas.height * imageRatio;\n      ctx?.drawImage(\n        image,\n        canvas.width / 2 - imageWidth / 2,\n        0,\n        imageWidth,\n        canvas.height\n      );\n      setStatus(\"loaded\");\n    };\n    image.onerror = () => {\n      setStatus(\"failed\");\n    };\n  }, [canvas, size, source]);\n\n  return [canvas, status];\n}\n\nexport default Transformer;\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import { Circle, Group, Rect } from \"react-konva\";\n\ntype TokenAttachmentProps = {\n  tokenHeight: number;\n  dragging: boolean;\n  highlight: boolean;\n  radius: number;\n};\n\nfunction TokenAttachment({\n  tokenHeight,\n  dragging,\n  highlight,\n  radius,\n}: TokenAttachmentProps) {\n  const width = radius / 3;\n  const height = radius / 8;\n  return (\n    <Group>\n      {/* Make a bigger hidden rect for hit registration */}\n      <Rect\n        width={width * 2}\n        height={height * 2}\n        x={-width}\n        y={tokenHeight / 2 - height}\n        cornerRadius={2.5}\n        fill=\"transparent\"\n      />\n      <Rect\n        width={width}\n        height={height}\n        x={-width / 2}\n        y={tokenHeight / 2 - height / 2}\n        cornerRadius={2.5}\n        fill=\"rgba(36, 39, 51, 0.8)\"\n        shadowColor=\"rgba(0,0,0,0.5)\"\n        shadowOffsetY={radius / 40}\n        shadowBlur={radius / 15}\n        hitFunc={() => {}}\n      />\n      {dragging ? (\n        <Circle\n          radius={radius}\n          stroke={\n            highlight ? \"hsl(260, 100%, 80%)\" : \"rgba(255, 255, 255, 0.85)\"\n          }\n          strokeWidth={0.5}\n        />\n      ) : null}\n    </Group>\n  );\n}\n\nexport default TokenAttachment;\n","import { useState, useRef, useCallback, useMemo } from \"react\";\nimport { Image as KonvaImage, Group } from \"react-konva\";\nimport { useSpring, animated } from \"@react-spring/konva\";\nimport Konva from \"konva\";\nimport useImage from \"use-image\";\n\nimport usePrevious from \"../../hooks/usePrevious\";\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport {\n  useSetPreventMapInteraction,\n  useMapWidth,\n  useMapHeight,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useGridCellPixelSize } from \"../../contexts/GridContext\";\nimport { useDataURL } from \"../../contexts/AssetsContext\";\n\nimport TokenStatus from \"./TokenStatus\";\nimport TokenLabel from \"./TokenLabel\";\nimport TokenOutline from \"./TokenOutline\";\nimport TokenAttributeBubble from \"./TokenAttributeBubble\";\n\nimport { Intersection, getScaledOutline } from \"../../helpers/token\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { tokenSources } from \"../../tokens\";\nimport { TokenAttributeBar, TokenAttributeValue, TokenState } from \"../../types/TokenState\";\nimport { Map } from \"../../types/Map\";\nimport { TokenNoteSettings } from \"../../types/Settings\";\nimport {\n  TokenDragEventHandler,\n  TokenDragMoveEventHandler,\n  TokenAttributeCountOpenEventHandler,\n  TokenMenuCloseChangeEventHandler,\n  TokenMenuOpenChangeEventHandler,\n  TokenStateChangeEventHandler,\n  CustomTransformEventHandler,\n} from \"../../types/Events\";\nimport Transformer from \"./Transformer\";\nimport TokenAttachment from \"./TokenAttachment\";\nimport { MapState } from \"../../types/MapState\";\n\ntype MapTokenProps = {\n  tokenState: TokenState;\n  onTokenStateChange: TokenStateChangeEventHandler;\n  onTokenMenuOpen: TokenMenuOpenChangeEventHandler;\n  onTokenMenuClose: TokenMenuCloseChangeEventHandler;\n  onTokenDragStart: TokenDragEventHandler;\n  onTokenDragEnd: TokenDragEventHandler;\n  onTokenDragMove?: TokenDragMoveEventHandler;\n  onTokenTransformStart: CustomTransformEventHandler;\n  onTokenTransformEnd: CustomTransformEventHandler;\n  onTokenAttributeCountOpen?: TokenAttributeCountOpenEventHandler;\n  transforming: boolean;\n  draggable: boolean;\n  selectable: boolean;\n  fadeOnHover: boolean;\n  map: Map;\n  mapState: MapState;\n  selected: boolean;\n  noteModeEnabled: boolean;\n  noteTrigger: TokenNoteSettings[\"trigger\"];\n  noteLongPressMs: number;\n  onTokenNoteOpen?: (\n    tokenStateId: string,\n    options?: { mode?: \"sheet\" | \"popover\"; anchor?: Konva.Node | null }\n  ) => void;\n};\n\nfunction Token({\n  tokenState,\n  onTokenStateChange,\n  onTokenMenuOpen,\n  onTokenMenuClose,\n  onTokenDragStart,\n  onTokenDragEnd,\n  onTokenDragMove,\n  onTokenTransformStart,\n  onTokenTransformEnd,\n  onTokenAttributeCountOpen,\n  transforming,\n  draggable,\n  selectable,\n  fadeOnHover,\n  map,\n  mapState,\n  selected,\n  noteModeEnabled,\n  noteTrigger,\n  noteLongPressMs,\n  onTokenNoteOpen,\n}: MapTokenProps) {\n  const userId = useUserId();\n  const isMapOwner = map.owner === userId;\n  const isTokenOwner = tokenState.owner === userId;\n  const canEditAttributes = isMapOwner || isTokenOwner;\n\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n\n  const gridCellPixelSize = useGridCellPixelSize();\n\n  const tokenURL = useDataURL(tokenState, tokenSources);\n  const [tokenImage] = useImage(tokenURL || \"\");\n\n  const tokenAspectRatio = tokenState.width / tokenState.height;\n\n  const snapPositionToGrid = useGridSnapping();\n\n  const [dragging, setDragging] = useState(false);\n  const previousDragPositionRef = useRef({ x: 0, y: 0 });\n\n  // Tokens that are attached to this token and should move when it moves\n  const attachedTokensRef = useRef<Konva.Node[]>([]);\n  // If this an attachment is it over a character\n  const [attachmentOverCharacter, setAttachmentOverCharacter] = useState(false);\n  // The characters that we're present when an attachment is dragged, used to highlight the attachment\n  const attachmentCharactersRef = useRef<Konva.Node[]>([]);\n  const attachmentThreshold = useMemo(\n    () => Vector2.componentMin(gridCellPixelSize) / 4,\n    [gridCellPixelSize]\n  );\n\n  function handleDragStart(event: Konva.KonvaEventObject<DragEvent>) {\n    clearNoteLongPress();\n    const tokenGroup = event.target as Konva.Shape;\n    previousDragPositionRef.current = tokenGroup.position();\n\n    attachedTokensRef.current = getAttachedTokens();\n\n    if (tokenState.category === \"attachment\") {\n      // If we're dragging an attachment add all characters to the attachment characters\n      // So we can check for highlights\n      const characters = tokenGroup.getLayer()?.find(\".character\") || [];\n      attachmentCharactersRef.current = characters;\n    }\n\n    setDragging(true);\n    onTokenDragStart(\n      event,\n      tokenState.id,\n      attachedTokensRef.current.map((token) => token.id())\n    );\n  }\n\n  function handleDragMove(event: Konva.KonvaEventObject<DragEvent>) {\n    const tokenGroup = event.target;\n    // Snap to corners of grid\n    if (map.snapToGrid) {\n      tokenGroup.position(snapPositionToGrid(tokenGroup.position()));\n    }\n    if (attachedTokensRef.current.length > 0) {\n      const deltaPosition = Vector2.subtract(\n        tokenGroup.position(),\n        previousDragPositionRef.current\n      );\n      for (let other of attachedTokensRef.current) {\n        other.position(Vector2.add(other.position(), deltaPosition));\n      }\n      previousDragPositionRef.current = tokenGroup.position();\n    }\n    // Check whether an attachment is over a character\n    if (tokenState.category === \"attachment\") {\n      const characters = attachmentCharactersRef.current;\n      let overCharacter = false;\n      for (let character of characters) {\n        const distance = Vector2.distance(\n          tokenGroup.position(),\n          character.position()\n        );\n        if (distance < attachmentThreshold) {\n          overCharacter = true;\n          break;\n        }\n      }\n      if (attachmentOverCharacter !== overCharacter) {\n        setAttachmentOverCharacter(overCharacter);\n      }\n    }\n\n    if (onTokenDragMove && mapWidth > 0 && mapHeight > 0) {\n      const updates: Record<string, { x: number; y: number }> = {\n        [tokenState.id]: {\n          x: tokenGroup.x() / mapWidth,\n          y: tokenGroup.y() / mapHeight,\n        },\n      };\n      if (attachedTokensRef.current.length > 0) {\n        for (let other of attachedTokensRef.current) {\n          updates[other.id()] = {\n            x: other.x() / mapWidth,\n            y: other.y() / mapHeight,\n          };\n        }\n      }\n      onTokenDragMove(updates);\n    }\n  }\n\n  function handleDragEnd(event: Konva.KonvaEventObject<DragEvent>) {\n    const tokenGroup = event.target;\n\n    const attachedTokenChanges: Record<string, Partial<TokenState>> = {};\n    if (attachedTokensRef.current.length > 0) {\n      for (let other of attachedTokensRef.current) {\n        attachedTokenChanges[other.id()] = {\n          x: other.x() / mapWidth,\n          y: other.y() / mapHeight,\n          lastModifiedBy: userId,\n          lastModified: Date.now(),\n        };\n      }\n    }\n\n    setPreventMapInteraction(false);\n    onTokenStateChange({\n      ...attachedTokenChanges,\n      [tokenState.id]: {\n        x: tokenGroup.x() / mapWidth,\n        y: tokenGroup.y() / mapHeight,\n        lastModifiedBy: userId,\n        lastModified: Date.now(),\n      },\n    });\n\n    setDragging(false);\n\n    onTokenDragEnd(\n      event,\n      tokenState.id,\n      attachedTokensRef.current.map((token) => token.id())\n    );\n\n    attachmentCharactersRef.current = [];\n    attachedTokensRef.current = [];\n    setAttachmentOverCharacter(false);\n  }\n\n  function handleClick(event: Konva.KonvaEventObject<MouseEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (noteLongPressTriggeredRef.current) {\n      noteLongPressTriggeredRef.current = false;\n      return;\n    }\n    if (suppressNoteClickRef.current) {\n      suppressNoteClickRef.current = false;\n      return;\n    }\n    if (noteModeEnabled && onTokenNoteOpen) {\n      onTokenNoteOpen(tokenState.id, {\n        mode: \"popover\",\n        anchor: event.target,\n      });\n      return;\n    }\n    if (selectable && draggable && transformRootRef.current) {\n      onTokenMenuOpen(tokenState.id, transformRootRef.current, true);\n    }\n  }\n\n  function handleDoubleClick(event: Konva.KonvaEventObject<MouseEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (noteModeEnabled && noteTrigger === \"doubleClick\" && onTokenNoteOpen) {\n      onTokenNoteOpen(tokenState.id, { mode: \"sheet\" });\n    }\n  }\n\n  const [tokenOpacity, setTokenOpacity] = useState(1);\n  // Store token pointer down time to check for a click when token is locked\n  const tokenPointerDownTimeRef = useRef<number>(0);\n  const noteLongPressTimerRef = useRef<number | null>(null);\n  const noteLongPressTriggeredRef = useRef(false);\n  const suppressNoteClickRef = useRef(false);\n\n  function clearNoteLongPress() {\n    if (noteLongPressTimerRef.current) {\n      window.clearTimeout(noteLongPressTimerRef.current);\n      noteLongPressTimerRef.current = null;\n    }\n  }\n  function handlePointerDown(event: Konva.KonvaEventObject<PointerEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (draggable) {\n      setPreventMapInteraction(true);\n    }\n    if (tokenState.locked && selectable) {\n      tokenPointerDownTimeRef.current = event.evt.timeStamp;\n    }\n    if (noteModeEnabled && noteTrigger === \"longPress\" && onTokenNoteOpen) {\n      noteLongPressTriggeredRef.current = false;\n      clearNoteLongPress();\n      noteLongPressTimerRef.current = window.setTimeout(() => {\n        noteLongPressTriggeredRef.current = true;\n        suppressNoteClickRef.current = true;\n        onTokenNoteOpen(tokenState.id, { mode: \"sheet\" });\n        window.setTimeout(() => {\n          suppressNoteClickRef.current = false;\n        }, 300);\n      }, noteLongPressMs);\n    }\n  }\n\n  function handlePointerUp(event: Konva.KonvaEventObject<PointerEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (draggable) {\n      setPreventMapInteraction(false);\n    }\n    if (noteModeEnabled && noteTrigger === \"longPress\") {\n      clearNoteLongPress();\n      if (noteLongPressTriggeredRef.current) {\n        noteLongPressTriggeredRef.current = false;\n        return;\n      }\n    }\n    // Check token click when locked and selectable\n    // We can't use onClick because that doesn't check pointer distance\n    if (tokenState.locked && selectable && transformRootRef.current) {\n      // If down and up time is small trigger a click\n      const delta = event.evt.timeStamp - tokenPointerDownTimeRef.current;\n      if (delta < 300) {\n        onTokenMenuOpen(tokenState.id, transformRootRef.current, true);\n      }\n    }\n  }\n\n  function handlePointerEnter() {\n    if (fadeOnHover) {\n      setTokenOpacity(0.5);\n    }\n  }\n\n  function handlePointerLeave() {\n    clearNoteLongPress();\n    if (tokenOpacity !== 1.0) {\n      setTokenOpacity(1.0);\n    }\n  }\n\n  const transformRootRef = useRef<Konva.Group>(null);\n\n  const minCellSize = Math.min(\n    gridCellPixelSize.width,\n    gridCellPixelSize.height\n  );\n  const tokenWidth = minCellSize * tokenState.size;\n  const tokenHeight = (minCellSize / tokenAspectRatio) * tokenState.size;\n\n  // Animate to new token positions if edited by others\n  const tokenX = tokenState.x * mapWidth;\n  const tokenY = tokenState.y * mapHeight;\n  const previousWidth = usePrevious(mapWidth);\n  const previousHeight = usePrevious(mapHeight);\n  const resized = mapWidth !== previousWidth || mapHeight !== previousHeight;\n  const skipAnimation = tokenState.lastModifiedBy === userId || resized;\n  const props = useSpring({\n    x: tokenX,\n    y: tokenY,\n    immediate: skipAnimation,\n  });\n\n  const getAttachedTokens = useCallback(() => {\n    const transformRoot = transformRootRef.current;\n    const tokenGroup = transformRoot?.parent;\n    const layer = transformRoot?.getLayer();\n    let attachedTokens: Konva.Node[] = [];\n    if (tokenGroup && layer) {\n      if (tokenState.category === \"vehicle\") {\n        const tokenIntersection = new Intersection(\n          getScaledOutline(tokenState, tokenWidth, tokenHeight),\n          { x: tokenX - tokenWidth / 2, y: tokenY - tokenHeight / 2 },\n          { x: tokenX, y: tokenY },\n          tokenState.rotation\n        );\n\n        // Find all other characters on the map and check whether they're\n        // intersecting the vehicle\n        const characters = layer.find(\".character\");\n        const attachments = layer.find(\".attachment\");\n        const tokens = [...characters, ...attachments];\n        for (let other of tokens) {\n          const id = other.id();\n          if (id in mapState.tokens) {\n            const position = {\n              x: mapState.tokens[id].x * mapWidth,\n              y: mapState.tokens[id].y * mapHeight,\n            };\n            if (tokenIntersection.intersects(position)) {\n              attachedTokens.push(other);\n            }\n          }\n        }\n      }\n\n      if (tokenState.category === \"character\") {\n        // Find all attachments and check whether they are close to the center of this token\n        const attachments = layer.find(\".attachment\");\n        for (let attachment of attachments) {\n          const id = attachment.id();\n          if (id in mapState.tokens) {\n            const position = {\n              x: mapState.tokens[id].x * mapWidth,\n              y: mapState.tokens[id].y * mapHeight,\n            };\n            const distance = Vector2.distance(tokenGroup.position(), position);\n            if (distance < attachmentThreshold) {\n              attachedTokens.push(attachment);\n            }\n          }\n        }\n      }\n    }\n\n    return attachedTokens;\n  }, [\n    attachmentThreshold,\n    tokenHeight,\n    tokenWidth,\n    tokenState,\n    tokenX,\n    tokenY,\n    mapState,\n    mapWidth,\n    mapHeight,\n  ]);\n\n  // Override transform active to always show this transformer when using it\n  const [overrideTransformActive, setOverrideTransformActive] = useState(false);\n\n  function handleTransformStart(\n    event: Konva.KonvaEventObject<Event>,\n    attachments: Konva.Node[]\n  ) {\n    setOverrideTransformActive(true);\n    onTokenTransformStart(event, attachments);\n    onTokenMenuClose();\n  }\n\n  function handleTransformEnd(\n    event: Konva.KonvaEventObject<Event>,\n    attachments: Konva.Node[]\n  ) {\n    const transformer = event.currentTarget as Konva.Transformer;\n    const nodes = [...transformer.nodes(), ...attachments];\n    const tokenChanges: Record<string, Partial<TokenState>> = {};\n    for (let node of nodes) {\n      const id = node.id();\n      if (id in mapState.tokens) {\n        const sizeChange = node.scaleX();\n        const rotation = node.rotation();\n        const xChange = node.x() / mapWidth;\n        const yChange = node.y() / mapHeight;\n        tokenChanges[id] = {\n          size: mapState.tokens[id].size * sizeChange,\n          rotation: rotation,\n          x: mapState.tokens[id].x + xChange,\n          y: mapState.tokens[id].y + yChange,\n        };\n      }\n      node.scaleX(1);\n      node.scaleY(1);\n      node.x(0);\n      node.y(0);\n    }\n\n    onTokenStateChange(tokenChanges);\n    if (transformRootRef.current) {\n      onTokenMenuOpen(tokenState.id, transformRootRef.current, false);\n    }\n    setOverrideTransformActive(false);\n    onTokenTransformEnd(event, attachments);\n  }\n\n  const transformerActive = useMemo(\n    () => (!tokenState.locked && selected) || overrideTransformActive,\n    [tokenState, selected, overrideTransformActive]\n  );\n\n  const transformerAttachments = useMemo(() => {\n    if (transformerActive) {\n      // Find attached transform roots\n      return getAttachedTokens().map((node) =>\n        (node as Konva.Group).findOne(\".transform-root\")\n      );\n    } else {\n      return [];\n    }\n  }, [getAttachedTokens, transformerActive]);\n\n  function handleBarCountRequest(bar: TokenAttributeBar, node: Konva.Node) {\n    if (!canEditAttributes || !onTokenAttributeCountOpen) {\n      return;\n    }\n    onTokenAttributeCountOpen({\n      tokenStateId: tokenState.id,\n      target: {\n        type: \"bar\",\n        id: bar.id,\n        label: bar.label || \"Bar\",\n        current: bar.current,\n      },\n      node,\n    });\n  }\n\n  function handleValueCountRequest(value: TokenAttributeValue, node: Konva.Node) {\n    if (!canEditAttributes || !onTokenAttributeCountOpen) {\n      return;\n    }\n    const numeric =\n      typeof value.value === \"number\" ? value.value : Number(value.value);\n    if (!Number.isFinite(numeric)) {\n      return;\n    }\n    onTokenAttributeCountOpen({\n      tokenStateId: tokenState.id,\n      target: {\n        type: \"value\",\n        id: value.id,\n        label: value.label || \"Value\",\n        current: numeric,\n      },\n      node,\n    });\n  }\n\n  // When a token is hidden if you aren't the map owner hide it completely\n  if (map && !tokenState.visible && map.owner !== userId) {\n    return null;\n  }\n\n  // Token name is used by on click to find whether a token is a vehicle or prop\n  let tokenName = \"\";\n  if (tokenState) {\n    tokenName = tokenState.category;\n  }\n  if (tokenState && tokenState.locked) {\n    tokenName = tokenName + \"-locked\";\n  }\n\n  const animatedGroupProps = props as any;\n  const AnimatedGroup = animated.Group as any;\n\n  return (\n    <>\n      <AnimatedGroup\n        {...animatedGroupProps}\n        width={tokenWidth}\n        height={tokenHeight}\n        draggable={draggable}\n        onMouseDown={handlePointerDown}\n        onMouseUp={handlePointerUp}\n        onMouseEnter={handlePointerEnter}\n        onMouseLeave={handlePointerLeave}\n        onTouchStart={handlePointerDown}\n        onTouchEnd={handlePointerUp}\n        onClick={handleClick}\n        onTap={handleClick}\n        onDblClick={handleDoubleClick}\n        onDragEnd={handleDragEnd}\n        onDragStart={handleDragStart}\n        onDragMove={handleDragMove}\n        opacity={tokenState.visible ? tokenOpacity : 0.5}\n        name={tokenName}\n        id={tokenState.id}\n      >\n        <Group\n          ref={transformRootRef}\n          id={tokenState.id}\n          name=\"transform-root\"\n          rotation={tokenState.rotation}\n          offsetX={tokenWidth / 2}\n          offsetY={tokenHeight / 2}\n        >\n          <Group width={tokenWidth} height={tokenHeight} x={0} y={0}>\n            <TokenOutline\n              outline={getScaledOutline(tokenState, tokenWidth, tokenHeight)}\n              hidden={!!tokenImage}\n              // Disable hit detection for attachments\n              hitFunc={\n                tokenState.category === \"attachment\" ? () => {} : undefined\n              }\n            />\n          </Group>\n          <KonvaImage\n            width={tokenWidth}\n            height={tokenHeight}\n            x={0}\n            y={0}\n            image={tokenImage}\n            hitFunc={() => {}}\n          />\n        </Group>\n        {!transforming ? (\n          <Group offsetX={tokenWidth / 2} offsetY={tokenHeight / 2}>\n            {tokenState.statuses?.length > 0 ? (\n              <TokenStatus\n                tokenState={tokenState}\n                width={tokenWidth}\n                height={tokenHeight}\n              />\n            ) : null}\n            {tokenState.category === \"attachment\" ? (\n              <Group offsetX={-tokenWidth / 2} offsetY={-tokenHeight / 2}>\n                <Group rotation={tokenState.rotation}>\n                  <TokenAttachment\n                    tokenHeight={tokenHeight}\n                    dragging={dragging}\n                    highlight={attachmentOverCharacter}\n                    radius={attachmentThreshold * 2}\n                  />\n                </Group>\n              </Group>\n            ) : null}\n            {tokenState.label ? (\n              <TokenLabel\n                tokenState={tokenState}\n                width={tokenWidth}\n                height={tokenHeight}\n              />\n            ) : null}\n            <TokenAttributeBubble\n              tokenState={tokenState}\n              width={tokenWidth}\n              height={tokenHeight}\n              isMapOwner={isMapOwner}\n              isTokenOwner={isTokenOwner}\n              onBarClick={canEditAttributes ? handleBarCountRequest : undefined}\n              onValueClick={canEditAttributes ? handleValueCountRequest : undefined}\n            />\n          </Group>\n        ) : null}\n      </AnimatedGroup>\n      <Transformer\n        active={transformerActive}\n        nodes={\n          transformRootRef.current\n            ? [transformRootRef.current as Konva.Node]\n            : []\n        }\n        attachments={transformerAttachments}\n        onTransformEnd={handleTransformEnd}\n        onTransformStart={handleTransformStart}\n        gridScale={map.grid.measurement.scale}\n      />\n    </>\n  );\n}\n\nexport default Token;\n","function TokenHideIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 6.5c2.76 0 5 2.24 5 5 0 .51-.1 1-.24 1.46l3.06 3.06c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l2.17 2.17c.47-.14.96-.24 1.47-.24zM2.71 3.16c-.39.39-.39 1.02 0 1.41l1.97 1.97C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.97-.3 4.31-.82l2.72 2.72c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L4.13 3.16c-.39-.39-1.03-.39-1.42 0zM12 16.5c-2.76 0-5-2.24-5-5 0-.77.18-1.5.49-2.14l1.57 1.57c-.03.18-.06.37-.06.57 0 1.66 1.34 3 3 3 .2 0 .38-.03.57-.07L14.14 16c-.65.32-1.37.5-2.14.5zm2.97-5.33c-.15-1.4-1.25-2.49-2.64-2.64l2.64 2.64z\" />\n    </svg>\n  );\n}\n\nexport default TokenHideIcon;\n","import { useState } from \"react\";\nimport { Box, Flex, Grid, Text, Input, IconButton } from \"theme-ui\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport colors, { colorOptions } from \"../../helpers/colors\";\nimport {\n  createDefaultBar,\n  createDefaultValue,\n  parseNumericExpression,\n} from \"../../helpers/tokenAttributes\";\nimport {\n  TokenAttributeBar,\n  TokenAttributeState,\n  TokenAttributeValue,\n} from \"../../types/TokenState\";\n\nimport AddIcon from \"../../icons/AddIcon\";\nimport TokenShowIcon from \"../../icons/TokenShowIcon\";\nimport TokenHideIcon from \"../../icons/TokenHideIcon\";\n\ntype TokenAttributeEditorProps = {\n  attributes: TokenAttributeState;\n  onChange: (nextBars: TokenAttributeBar[], nextValues: TokenAttributeValue[]) => void;\n  canEdit: boolean;\n  title?: string;\n  showHeader?: boolean;\n  compact?: boolean;\n};\n\nfunction TokenAttributeEditor({\n  attributes,\n  onChange,\n  canEdit,\n  title,\n  showHeader = true,\n  compact = true,\n}: TokenAttributeEditorProps) {\n  const { addToast } = useToasts();\n  const [draftInputs, setDraftInputs] = useState<Record<string, string>>({});\n  const [openColorPicker, setOpenColorPicker] = useState<string | null>(null);\n\n  function setDraftInput(key: string, value: string) {\n    setDraftInputs((prev) => ({ ...prev, [key]: value }));\n  }\n\n  function clearDraftInput(key: string) {\n    setDraftInputs((prev) => {\n      const next = { ...prev };\n      delete next[key];\n      return next;\n    });\n  }\n\n  function commitNumberField(\n    key: string,\n    rawValue: string,\n    currentValue: number,\n    onCommit: (next: number | undefined) => void,\n    allowEmpty: boolean\n  ) {\n    const trimmed = rawValue.trim();\n    if (allowEmpty && trimmed.length === 0) {\n      onCommit(undefined);\n      clearDraftInput(key);\n      return;\n    }\n    const result = parseNumericExpression(currentValue, trimmed);\n    if (!result.ok) {\n      addToast(result.error, { appearance: \"error\" });\n      return;\n    }\n    onCommit(result.value);\n    clearDraftInput(key);\n  }\n\n  function updateBarsValues(nextBars: TokenAttributeBar[], nextValues: TokenAttributeValue[]) {\n    onChange(nextBars, nextValues);\n  }\n\n  function updateBar(barId: string, change: Partial<TokenAttributeBar>) {\n    const nextBars = attributes.bars.map((bar) =>\n      bar.id === barId ? { ...bar, ...change } : bar\n    );\n    updateBarsValues(nextBars, attributes.values);\n  }\n\n  function updateValue(valueId: string, change: Partial<TokenAttributeValue>) {\n    const nextValues = attributes.values.map((value) =>\n      value.id === valueId ? { ...value, ...change } : value\n    );\n    updateBarsValues(attributes.bars, nextValues);\n  }\n\n  function removeBar(barId: string) {\n    updateBarsValues(\n      attributes.bars.filter((bar) => bar.id !== barId),\n      attributes.values\n    );\n  }\n\n  function removeValue(valueId: string) {\n    updateBarsValues(\n      attributes.bars,\n      attributes.values.filter((value) => value.id !== valueId)\n    );\n  }\n\n  function pickUnusedColor() {\n    const usedColors = new Set<string>();\n    attributes.bars.forEach((bar) => usedColors.add(bar.color));\n    attributes.values.forEach((value) =>\n      usedColors.add(value.color || colors.blue)\n    );\n    for (const color of paletteColors) {\n      if (!usedColors.has(color)) {\n        return color;\n      }\n    }\n    return paletteColors[0] || colors.blue;\n  }\n\n  function addBar() {\n    const nextBar = createDefaultBar();\n    if (attributes.bars.length > 0) {\n      nextBar.showMinMax = showMinMaxAll;\n    }\n    nextBar.visibility = allVisible ? \"public\" : \"private\";\n    nextBar.color = pickUnusedColor();\n    updateBarsValues([...attributes.bars, nextBar], attributes.values);\n  }\n\n  function addValue() {\n    const nextValue = createDefaultValue();\n    nextValue.visibility = allVisible ? \"public\" : \"private\";\n    nextValue.color = pickUnusedColor();\n    updateBarsValues(attributes.bars, [...attributes.values, nextValue]);\n  }\n\n  const allVisible =\n    [...attributes.bars, ...attributes.values].length === 0\n      ? true\n      : [...attributes.bars, ...attributes.values].every(\n          (item) => item.visibility !== \"private\"\n        );\n  const showMinMaxAll =\n    attributes.bars.length > 0 &&\n    attributes.bars.every((bar) => bar.showMinMax);\n\n  function setAllVisibility(nextVisible: boolean) {\n    updateBarsValues(\n      attributes.bars.map((bar) => ({\n        ...bar,\n        visibility: nextVisible ? \"public\" : \"private\",\n      })),\n      attributes.values.map((value) => ({\n        ...value,\n        visibility: nextVisible ? \"public\" : \"private\",\n      }))\n    );\n  }\n\n  function setAllShowMinMax(nextShow: boolean) {\n    updateBarsValues(\n      attributes.bars.map((bar) => ({ ...bar, showMinMax: nextShow })),\n      attributes.values\n    );\n  }\n\n  const headerJustify = title ? \"space-between\" : \"flex-end\";\n  const paletteColors = colorOptions\n    .filter((color) => color !== \"primary\")\n    .map((color) => colors[color]);\n  const blockSpacing = compact ? 0 : 2;\n  const blockPadding = compact ? 1 : 2;\n  const smallFontSize = compact ? \"12px\" : \"14px\";\n  const inputSx = { flex: 1, padding: \"4px\", fontSize: smallFontSize } as const;\n  const labelSx = { fontSize: smallFontSize } as const;\n  const dotSize = compact ? 14 : 16;\n\n  return (\n    <Box>\n      {showHeader && (\n        <Flex sx={{ alignItems: \"center\", justifyContent: headerJustify }}>\n          {title ? (\n            <Text as=\"label\" variant=\"body2\" sx={labelSx}>\n              {title}\n            </Text>\n          ) : null}\n          <Flex sx={{ alignItems: \"center\", gap: \"4px\" }}>\n            <IconButton\n              title={showMinMaxAll ? \"Hide Min/Max\" : \"Show Min/Max\"}\n              aria-label={showMinMaxAll ? \"Hide Min/Max\" : \"Show Min/Max\"}\n              onClick={() => setAllShowMinMax(!showMinMaxAll)}\n              disabled={!canEdit || attributes.bars.length === 0}\n              sx={{ padding: \"2px\", opacity: showMinMaxAll ? 1 : 0.6 }}\n            >\n              <Text as=\"span\" sx={{ fontSize: smallFontSize, fontWeight: 600 }}>\n                M/M\n              </Text>\n            </IconButton>\n            <IconButton\n              title={allVisible ? \"Hide From Others\" : \"Visible To Others\"}\n              aria-label={allVisible ? \"Hide From Others\" : \"Visible To Others\"}\n              onClick={() => setAllVisibility(!allVisible)}\n              disabled={!canEdit}\n              sx={{ padding: \"2px\", opacity: allVisible ? 1 : 0.6 }}\n            >\n              {allVisible ? <TokenShowIcon /> : <TokenHideIcon />}\n            </IconButton>\n            {canEdit && (\n              <>\n                <IconButton\n                  title=\"Add Bar\"\n                  aria-label=\"Add Bar\"\n                  onClick={addBar}\n                  sx={{ padding: \"2px\" }}\n                >\n                  <AddIcon />\n                </IconButton>\n                <IconButton\n                  title=\"Add Value\"\n                  aria-label=\"Add Value\"\n                  onClick={addValue}\n                  sx={{ padding: \"2px\" }}\n                >\n                  <Text as=\"span\" sx={{ fontSize: \"14px\" }}>\n                    +V\n                  </Text>\n                </IconButton>\n              </>\n            )}\n          </Flex>\n        </Flex>\n      )}\n      {attributes.bars.length === 0 && attributes.values.length === 0 && (\n        <Text variant=\"body2\" sx={{ opacity: 0.7, mt: 1, fontSize: smallFontSize }}>\n          No attributes\n        </Text>\n      )}\n      {attributes.bars.map((bar) => {\n        const currentKey = `bar:${bar.id}:current`;\n        const maxKey = `bar:${bar.id}:max`;\n        const currentText = draftInputs[currentKey] ?? `${bar.current}`;\n        const maxText =\n          draftInputs[maxKey] ?? (bar.max !== undefined ? `${bar.max}` : \"\");\n        return (\n          <Box\n            key={bar.id}\n            mt={blockSpacing}\n            p={blockPadding}\n            sx={{ borderRadius: \"6px\", backgroundColor: \"rgba(0,0,0,0.25)\" }}\n          >\n            <Grid columns=\"1fr 1fr\" gap={compact ? 2 : 3}>\n              <Box>\n                <Flex sx={{ alignItems: \"center\", gap: \"6px\" }}>\n                  <Input\n                    value={bar.label}\n                    onChange={(e) =>\n                      updateBar(bar.id, {\n                        label: e.target.value.substring(0, 32),\n                      })\n                    }\n                    sx={inputSx}\n                    disabled={!canEdit}\n                  />\n                  <IconButton\n                    title=\"Change Color\"\n                    aria-label=\"Change Color\"\n                    onClick={() =>\n                      setOpenColorPicker((prev) =>\n                        prev === `bar:${bar.id}:color` ? null : `bar:${bar.id}:color`\n                      )\n                    }\n                    sx={{\n                      width: `${dotSize}px`,\n                      height: `${dotSize}px`,\n                      padding: 0,\n                      borderRadius: \"50%\",\n                      backgroundColor: bar.color,\n                      border: \"1px solid rgba(255,255,255,0.4)\",\n                    }}\n                    disabled={!canEdit}\n                  />\n                  {canEdit && (\n                    <IconButton\n                      title=\"Remove Bar\"\n                      aria-label=\"Remove Bar\"\n                      onClick={() => removeBar(bar.id)}\n                      sx={{ padding: \"2px\" }}\n                    >\n                      <Text as=\"span\"></Text>\n                    </IconButton>\n                  )}\n                </Flex>\n                {openColorPicker === `bar:${bar.id}:color` && (\n                  <Flex sx={{ flexWrap: \"wrap\", gap: \"4px\", mt: 1 }}>\n                    {paletteColors.map((color) => (\n                      <Box\n                        key={color}\n                        onClick={() => {\n                          updateBar(bar.id, { color });\n                          setOpenColorPicker(null);\n                        }}\n                        sx={{\n                          width: `${dotSize}px`,\n                          height: `${dotSize}px`,\n                          borderRadius: \"50%\",\n                          backgroundColor: color,\n                          border: \"1px solid rgba(255,255,255,0.35)\",\n                          cursor: \"pointer\",\n                        }}\n                      />\n                    ))}\n                  </Flex>\n                )}\n              </Box>\n              <Box>\n                <Flex sx={{ alignItems: \"center\", gap: \"6px\" }}>\n                  <Input\n                    value={currentText}\n                    onChange={(e) => setDraftInput(currentKey, e.target.value)}\n                    onBlur={() =>\n                      commitNumberField(\n                        currentKey,\n                        currentText,\n                        bar.current,\n                        (next) =>\n                          typeof next === \"number\" && updateBar(bar.id, { current: next }),\n                        false\n                      )\n                    }\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        commitNumberField(\n                          currentKey,\n                          currentText,\n                          bar.current,\n                          (next) =>\n                            typeof next === \"number\" &&\n                            updateBar(bar.id, { current: next }),\n                          false\n                        );\n                      }\n                    }}\n                    sx={inputSx}\n                    disabled={!canEdit}\n                    placeholder=\"Cur\"\n                    aria-label=\"Current\"\n                  />\n                  <Input\n                    value={maxText}\n                    onChange={(e) => setDraftInput(maxKey, e.target.value)}\n                    onBlur={() =>\n                      commitNumberField(\n                        maxKey,\n                        maxText,\n                        bar.max ?? 0,\n                        (next) => updateBar(bar.id, { max: next }),\n                        true\n                      )\n                    }\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        commitNumberField(\n                          maxKey,\n                          maxText,\n                          bar.max ?? 0,\n                          (next) => updateBar(bar.id, { max: next }),\n                          true\n                        );\n                      }\n                    }}\n                    sx={inputSx}\n                    disabled={!canEdit}\n                    placeholder=\"Max\"\n                    aria-label=\"Max\"\n                  />\n                </Flex>\n              </Box>\n            </Grid>\n          </Box>\n        );\n      })}\n      {attributes.values.map((value) => {\n        const valueKey = `value:${value.id}:value`;\n        const valueText =\n          draftInputs[valueKey] ??\n          (typeof value.value === \"number\" ? `${value.value}` : `${value.value}`);\n        const valueColor = value.color ?? colors.blue;\n        return (\n          <Box\n            key={value.id}\n            mt={blockSpacing}\n            p={blockPadding}\n            sx={{ borderRadius: \"6px\", backgroundColor: \"rgba(0,0,0,0.25)\" }}\n          >\n            <Grid columns=\"1fr 1fr\" gap={compact ? 2 : 3}>\n              <Box>\n                <Flex sx={{ alignItems: \"center\", gap: \"6px\" }}>\n                  <Input\n                    value={value.label}\n                    onChange={(e) =>\n                      updateValue(value.id, {\n                        label: e.target.value.substring(0, 32),\n                      })\n                    }\n                    sx={inputSx}\n                    disabled={!canEdit}\n                  />\n                  <IconButton\n                    title=\"Change Color\"\n                    aria-label=\"Change Color\"\n                    onClick={() =>\n                      setOpenColorPicker((prev) =>\n                        prev === `value:${value.id}:color`\n                          ? null\n                          : `value:${value.id}:color`\n                      )\n                    }\n                    sx={{\n                      width: `${dotSize}px`,\n                      height: `${dotSize}px`,\n                      padding: 0,\n                      borderRadius: \"50%\",\n                      backgroundColor: valueColor,\n                      border: \"1px solid rgba(255,255,255,0.4)\",\n                    }}\n                    disabled={!canEdit}\n                  />\n                  {canEdit && (\n                    <IconButton\n                      title=\"Remove Value\"\n                      aria-label=\"Remove Value\"\n                      onClick={() => removeValue(value.id)}\n                      sx={{ padding: \"2px\" }}\n                    >\n                      <Text as=\"span\"></Text>\n                    </IconButton>\n                  )}\n                </Flex>\n                {openColorPicker === `value:${value.id}:color` && (\n                  <Flex sx={{ flexWrap: \"wrap\", gap: \"4px\", mt: 1 }}>\n                    {paletteColors.map((color) => (\n                      <Box\n                        key={color}\n                        onClick={() => {\n                          updateValue(value.id, { color });\n                          setOpenColorPicker(null);\n                        }}\n                        sx={{\n                          width: `${dotSize}px`,\n                          height: `${dotSize}px`,\n                          borderRadius: \"50%\",\n                          backgroundColor: color,\n                          border: \"1px solid rgba(255,255,255,0.35)\",\n                          cursor: \"pointer\",\n                        }}\n                      />\n                    ))}\n                  </Flex>\n                )}\n              </Box>\n              <Box>\n                <Flex sx={{ alignItems: \"center\", gap: \"6px\" }}>\n                  <Input\n                    value={valueText}\n                    onChange={(e) => setDraftInput(valueKey, e.target.value)}\n                    onBlur={() =>\n                      commitNumberField(\n                        valueKey,\n                        valueText,\n                        typeof value.value === \"number\" ? value.value : 0,\n                        (next) =>\n                          typeof next === \"number\" &&\n                          updateValue(value.id, { value: next }),\n                        false\n                      )\n                    }\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        commitNumberField(\n                          valueKey,\n                          valueText,\n                          typeof value.value === \"number\" ? value.value : 0,\n                          (next) =>\n                            typeof next === \"number\" &&\n                            updateValue(value.id, { value: next }),\n                          false\n                        );\n                      }\n                    }}\n                    sx={inputSx}\n                    disabled={!canEdit}\n                    placeholder=\"Value\"\n                    aria-label=\"Value\"\n                  />\n                </Flex>\n              </Box>\n            </Grid>\n          </Box>\n        );\n      })}\n    </Box>\n  );\n}\n\nexport default TokenAttributeEditor;\n","function TokenLockIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9z\" />\n    </svg>\n  );\n}\n\nexport default TokenLockIcon;\n","function TokenUnlockIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6-5h-1V6c0-2.76-2.24-5-5-5-2.28 0-4.27 1.54-4.84 3.75-.14.54.18 1.08.72 1.22.53.14 1.08-.18 1.22-.72C9.44 3.93 10.63 3 12 3c1.65 0 3 1.35 3 3v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 11c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1h10c.55 0 1 .45 1 1v8z\" />{\" \"}\n    </svg>\n  );\n}\n\nexport default TokenUnlockIcon;\n","function TokenCharacterIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M20.75 6.99c-.14-.55-.69-.87-1.24-.75-2.38.53-5.03.76-7.51.76s-5.13-.23-7.51-.76c-.55-.12-1.1.2-1.24.75-.14.56.2 1.13.75 1.26 1.61.36 3.35.61 5 .75v12c0 .55.45 1 1 1s1-.45 1-1v-5h2v5c0 .55.45 1 1 1s1-.45 1-1V9c1.65-.14 3.39-.39 4.99-.75.56-.13.9-.7.76-1.26zM12 6c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z\" />\n    </svg>\n  );\n}\n\nexport default TokenCharacterIcon;\n","function TokenPropIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M16.96,12h0.08c0.81,0,1.28-0.91,0.82-1.57l-5.08-7.25c-0.4-0.57-1.24-0.57-1.64,0L6.1,10.43C5.64,11.09,6.12,12,6.93,12 h0.04l-2.9,4.46C3.63,17.12,4.11,18,4.91,18h5.08v2.02c0,1.09,0.89,1.98,1.98,1.98h0c1.09,0,1.98-0.89,1.98-1.98V18h5.15 c0.8,0,1.28-0.89,0.83-1.55L16.96,12z\" />\n    </svg>\n  );\n}\n\nexport default TokenPropIcon;\n","function TokenMountIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M22.006 6v2.71c0 .472-.302.89-.75 1.04a1.005 1.005 0 01-1.17-.42l-1.12-1.79c-.13-.21-.46-.12-.46.13v3.58c0 .98-.39 1.86-1 2.53v5.97a1.25 1.25 0 01-2.5 0V15h-.25c-.21 0-.42-.03-.62-.06l-4.44-.74-1.12 2.01.712 3.55A1.037 1.037 0 018.27 21a1.559 1.559 0 01-1.525-1.238l-.74-3.512c-.03-.3 0-.6.16-.86l1.02-1.81a3.272 3.272 0 01-1.68-2.77c-.04.15-.06.37-.03.69.03.44.14 1.09.07 1.81-.04.72-.37 1.46-.79 1.95-.43.49-.9.83-1.4 1.09-.5.26-.89-.23-.7-.7.19-.47.38-.89.42-1.28.06-.37-.01-.67-.12-.94l-.53-1.13c-.21-.51-.47-1.25-.42-2.12.03-.85.5-1.96 1.39-2.57.9-.61 1.87-.69 2.66-.53.5.1 1.01.34 1.45.68.37-.17.8-.26 1.25-.26h5.75V7c0-2.21 1.79-4 4-4h3.5l-.89 1.34c.54.36.89.97.89 1.66z\" />\n    </svg>\n  );\n}\n\nexport default TokenMountIcon;\n","function TokenAttachmentIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12,2C6.49,2,2,6.49,2,12s4.49,10,10,10s10-4.49,10-10S17.51,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8 S16.41,20,12,20z M15,12c0,1.66-1.34,3-3,3s-3-1.34-3-3s1.34-3,3-3S15,10.34,15,12z\" />\n    </svg>\n  );\n}\n\nexport default TokenAttachmentIcon;\n","import React, { useEffect, useState, useRef } from \"react\";\nimport { Box, Input, Flex, Text, IconButton, Checkbox, Label } from \"theme-ui\";\nimport Konva from \"konva\";\n\nimport MapMenu from \"../map/MapMenu\";\nimport TokenAttributeEditor from \"./TokenAttributeEditor\";\n\nimport colors, { Color, colorOptions } from \"../../helpers/colors\";\nimport {\n  buildNextAttributes,\n  createEmptyAttributes,\n} from \"../../helpers/tokenAttributes\";\n\nimport usePrevious from \"../../hooks/usePrevious\";\n\nimport LockIcon from \"../../icons/TokenLockIcon\";\nimport UnlockIcon from \"../../icons/TokenUnlockIcon\";\nimport ShowIcon from \"../../icons/TokenShowIcon\";\nimport HideIcon from \"../../icons/TokenHideIcon\";\nimport TokenCharacterIcon from \"../../icons/TokenCharacterIcon\";\nimport TokenPropIcon from \"../../icons/TokenPropIcon\";\nimport TokenMountIcon from \"../../icons/TokenMountIcon\";\nimport TokenAttachmentIcon from \"../../icons/TokenAttachmentIcon\";\nimport TokenShowIcon from \"../../icons/TokenShowIcon\";\nimport TokenHideIcon from \"../../icons/TokenHideIcon\";\nimport ExpandMoreIcon from \"../../icons/ExpandMoreIcon\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport {\n  RequestCloseEventHandler,\n  TokenStateChangeEventHandler,\n} from \"../../types/Events\";\nimport { TokenState } from \"../../types/TokenState\";\nimport { Map } from \"../../types/Map\";\nimport { TokenCategory } from \"../../types/Token\";\n\nconst tokenCategories: Record<\n  TokenCategory,\n  { title: string; icon: React.ReactNode; next: TokenCategory }\n> = {\n  character: {\n    title: \"Character\",\n    icon: <TokenCharacterIcon />,\n    next: \"prop\",\n  },\n  prop: {\n    title: \"Prop\",\n    icon: <TokenPropIcon />,\n    next: \"vehicle\",\n  },\n  vehicle: {\n    title: \"Mount\",\n    icon: <TokenMountIcon />,\n    next: \"attachment\",\n  },\n  attachment: {\n    title: \"Attachment\",\n    icon: <TokenAttachmentIcon />,\n    next: \"character\",\n  },\n};\n\ntype TokenMenuProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  tokenState?: TokenState;\n  tokenImage?: Konva.Node;\n  focus: boolean;\n  onTokenStateChange: TokenStateChangeEventHandler;\n  map: Map | null;\n  fogEnabled?: boolean;\n};\n\nfunction TokenMenu({\n  isOpen,\n  onRequestClose,\n  tokenState,\n  tokenImage,\n  focus,\n  onTokenStateChange,\n  map,\n  fogEnabled = true,\n}: TokenMenuProps) {\n  const userId = useUserId();\n\n  const wasOpen = usePrevious(isOpen);\n\n  const menuWidth = 240;\n  const sidePanelWidth = 200;\n\n  const [menuLeft, setMenuLeft] = useState(0);\n  const [menuTop, setMenuTop] = useState(0);\n  const [visionLightOpen, setVisionLightOpen] = useState(false);\n  const [attributesOpen, setAttributesOpen] = useState(false);\n  const sidePanelRef = useRef<HTMLDivElement | null>(null);\n  const [sidePanelStyle, setSidePanelStyle] = useState<{\n    left?: number;\n    top?: number;\n  }>({});\n  const sidePanelOpen = visionLightOpen || attributesOpen;\n  useEffect(() => {\n    if (isOpen && !wasOpen && tokenState) {\n      setVisionLightOpen(false);\n      setAttributesOpen(false);\n      // Update menu position\n      if (tokenImage) {\n        const imageRect = tokenImage.getClientRect();\n        const mapElement = document.querySelector(\".map\");\n        if (mapElement) {\n          const mapRect = mapElement.getBoundingClientRect();\n          // Center X for the menu which is menuWidth px wide\n          setMenuLeft(\n            mapRect.left + imageRect.x + imageRect.width / 2 - menuWidth / 2\n          );\n          // Y 20px from the bottom\n          setMenuTop(mapRect.top + imageRect.y + imageRect.height + 20);\n        }\n      }\n    }\n  }, [isOpen, tokenState, wasOpen, tokenImage]);\n  useEffect(() => {\n    if (!fogEnabled && visionLightOpen) {\n      setVisionLightOpen(false);\n    }\n  }, [fogEnabled, visionLightOpen]);\n\n  useEffect(() => {\n    if (!sidePanelOpen) {\n      return;\n    }\n\n    function updateSidePanelPosition() {\n      const panel = sidePanelRef.current;\n      const panelWidth = sidePanelWidth;\n      const panelGap = 8;\n\n      let left = menuLeft - panelWidth - panelGap;\n      const minLeft = 8;\n      const maxLeft = window.innerWidth - panelWidth - 8;\n      if (left < minLeft) {\n        left = menuLeft + menuWidth + panelGap;\n      }\n      if (left > maxLeft) {\n        left = maxLeft;\n      }\n\n      let top = menuTop;\n      if (panel) {\n        const rect = panel.getBoundingClientRect();\n        const maxTop = window.innerHeight - rect.height - 8;\n        top = Math.min(Math.max(menuTop, 8), Math.max(8, maxTop));\n      }\n\n      setSidePanelStyle({ left, top });\n    }\n\n    updateSidePanelPosition();\n    window.addEventListener(\"resize\", updateSidePanelPosition);\n    return () => window.removeEventListener(\"resize\", updateSidePanelPosition);\n  }, [sidePanelOpen, menuLeft, menuTop]);\n\n  function handleLabelChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const label = event.target.value.substring(0, 48);\n    tokenState && onTokenStateChange({ [tokenState.id]: { label: label } });\n  }\n\n  function handleStatusChange(status: Color) {\n    if (!tokenState) {\n      return;\n    }\n    const statuses = new Set(tokenState.statuses.filter((s) => s));\n    if (statuses.has(status)) {\n      statuses.delete(status);\n    } else {\n      statuses.add(status);\n    }\n    onTokenStateChange({\n      [tokenState.id]: { statuses: [...statuses] },\n    });\n  }\n\n  function handleVisibleChange() {\n    tokenState &&\n      onTokenStateChange({\n        [tokenState.id]: { visible: !tokenState.visible },\n      });\n  }\n\n  function handleVisionChange() {\n    if (!tokenState) {\n      return;\n    }\n    const nextHasVision = !tokenState.hasVision;\n    const nextRange =\n      nextHasVision && (!tokenState.visionRange || tokenState.visionRange <= 0)\n        ? 6\n        : tokenState.visionRange;\n    onTokenStateChange({\n      [tokenState.id]: { hasVision: nextHasVision, visionRange: nextRange },\n    });\n  }\n\n  function handleLockChange() {\n    tokenState &&\n      onTokenStateChange({\n        [tokenState.id]: { locked: !tokenState.locked },\n      });\n  }\n\n  function handleCategoryChange() {\n    tokenState &&\n      onTokenStateChange({\n        [tokenState.id]: {\n          category: tokenCategories[tokenState.category].next,\n        },\n      });\n  }\n\n  const lightEnabled = !!tokenState?.lightConfig?.enabled;\n  const lightRadiusBright =\n    typeof tokenState?.lightConfig?.radiusBright === \"number\"\n      ? tokenState.lightConfig.radiusBright\n      : 0;\n  const lightRadiusDim =\n    typeof tokenState?.lightConfig?.radiusDim === \"number\"\n      ? tokenState.lightConfig.radiusDim\n      : 0;\n  const lightColor = tokenState?.lightConfig?.color || \"#ffffff\";\n  const visionRange =\n    typeof tokenState?.visionRange === \"number\" ? tokenState.visionRange : 0;\n\n  type LightConfig = NonNullable<TokenState[\"lightConfig\"]>;\n  function handleLightChange(next: Partial<LightConfig>) {\n    if (!tokenState) {\n      return;\n    }\n    onTokenStateChange({\n      [tokenState.id]: {\n        lightConfig: {\n          enabled: lightEnabled,\n          radiusBright: lightRadiusBright,\n          radiusDim: lightRadiusDim,\n          color: lightColor,\n          ...next,\n        },\n      },\n    });\n  }\n\n  function handleLightToggle(enabled: boolean) {\n    if (!tokenState) {\n      return;\n    }\n    const nextBright =\n      lightRadiusBright > 0 ? lightRadiusBright : enabled ? 4 : 0;\n    const nextDim = lightRadiusDim > 0 ? lightRadiusDim : enabled ? 8 : 0;\n    onTokenStateChange({\n      [tokenState.id]: {\n        lightConfig: {\n          enabled,\n          radiusBright: nextBright,\n          radiusDim: nextDim,\n          color: lightColor,\n        },\n      },\n      });\n  }\n\n  const canEditAttributes =\n    !!(map && tokenState && (map.owner === userId || tokenState.owner === userId));\n\n  const attributes = tokenState?.attributes\n    ? tokenState.attributes\n    : createEmptyAttributes(userId || \"unknown\");\n  const hasAttributes = attributes.bars.length > 0 || attributes.values.length > 0;\n  useEffect(() => {\n    if (hasAttributes) {\n      setAttributesOpen(true);\n    }\n  }, [hasAttributes, tokenState?.id]);\n\n  function updateAttributes(nextBars: typeof attributes.bars, nextValues: typeof attributes.values) {\n    if (!tokenState) {\n      return;\n    }\n    const nextAttributes = buildNextAttributes(\n      tokenState.attributes,\n      nextBars,\n      nextValues,\n      userId || \"unknown\"\n    );\n    onTokenStateChange({\n      [tokenState.id]: { attributes: nextAttributes },\n    });\n  }\n\n  function handleModalContent(node: HTMLElement) {\n    if (node) {\n      // Focus input\n      const tokenLabelInput =\n        node.querySelector<HTMLInputElement>(\"#changeTokenLabel\");\n      if (tokenLabelInput && focus) {\n        tokenLabelInput.focus();\n        tokenLabelInput.select();\n      }\n\n      // Ensure menu is in bounds\n      const nodeRect = node.getBoundingClientRect();\n      const mapElement = document.querySelector(\".map\");\n      if (mapElement) {\n        const mapRect = mapElement.getBoundingClientRect();\n        setMenuLeft((prevLeft) =>\n          Math.min(\n            mapRect.right - nodeRect.width,\n            Math.max(mapRect.left, prevLeft)\n          )\n        );\n        setMenuTop((prevTop) =>\n          Math.min(mapRect.bottom - nodeRect.height, prevTop)\n        );\n      }\n    }\n  }\n\n  return (\n    <MapMenu\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      top={`${menuTop}px`}\n      left={`${menuLeft}px`}\n      style={{ overflow: \"visible\" }}\n      onModalContent={handleModalContent}\n    >\n      <Box sx={{ width: `${menuWidth}px`, overflow: \"visible\" }} p={1}>\n        <Flex\n          as=\"form\"\n          onSubmit={(e) => {\n            e.preventDefault();\n            onRequestClose();\n          }}\n          sx={{ alignItems: \"center\" }}\n        >\n          <Text\n            as=\"label\"\n            variant=\"body2\"\n            sx={{ width: \"45%\", fontSize: \"16px\" }}\n            p={1}\n          >\n            Label:\n          </Text>\n          <Input\n            id=\"changeTokenLabel\"\n            onChange={handleLabelChange}\n            value={(tokenState && tokenState.label) || \"\"}\n            sx={{\n              padding: \"4px\",\n              border: \"none\",\n              \":focus\": {\n                outline: \"none\",\n              },\n            }}\n            autoComplete=\"off\"\n          />\n        </Flex>\n        <Box\n          sx={{\n            display: \"flex\",\n            flexWrap: \"wrap\",\n            justifyContent: \"space-between\",\n          }}\n        >\n          {colorOptions\n            .filter((color) => color !== \"primary\")\n            .map((color) => (\n              <Box\n                key={color}\n                sx={{\n                  width: \"16.66%\",\n                  paddingTop: \"16.66%\",\n                  borderRadius: \"50%\",\n                  transform: \"scale(0.75)\",\n                  backgroundColor: colors[color],\n                  cursor: \"pointer\",\n                }}\n                onClick={() => handleStatusChange(color)}\n                aria-label={`Token label Color ${color}`}\n              >\n                {tokenState &&\n                  tokenState.statuses &&\n                  tokenState.statuses.includes(color) && (\n                    <Box\n                      sx={{\n                        width: \"100%\",\n                        height: \"100%\",\n                        border: \"2px solid white\",\n                        position: \"absolute\",\n                        top: 0,\n                        borderRadius: \"50%\",\n                      }}\n                    />\n                  )}\n              </Box>\n            ))}\n        </Box>\n        {tokenState && (\n          <Box mt={2} sx={{ position: \"relative\" }}>\n            <Flex sx={{ alignItems: \"center\", justifyContent: \"space-between\" }}>\n              <Text as=\"label\" variant=\"body2\">\n                Attributes\n              </Text>\n              <IconButton\n                aria-label=\"Toggle Attributes\"\n                title=\"Toggle Attributes\"\n                onClick={() =>\n                  setAttributesOpen((prev) => {\n                    if (hasAttributes && prev) {\n                      return true;\n                    }\n                    const next = !prev;\n                    if (next) {\n                      setVisionLightOpen(false);\n                    }\n                    return next;\n                  })\n                }\n                sx={{ transform: attributesOpen ? \"rotate(180deg)\" : \"none\" }}\n                disabled={hasAttributes && attributesOpen}\n              >\n                <ExpandMoreIcon />\n              </IconButton>\n            </Flex>\n          </Box>\n        )}\n        {/* Only show hide and lock token actions to map owners */}\n        {map && map.owner === userId && tokenState && (\n          <>\n            <Flex sx={{ alignItems: \"center\", justifyContent: \"space-around\" }}>\n              <IconButton\n                onClick={handleVisibleChange}\n                title={tokenState.visible ? \"Hide Token\" : \"Show Token\"}\n                aria-label={tokenState.visible ? \"Hide Token\" : \"Show Token\"}\n              >\n                {tokenState.visible ? <ShowIcon /> : <HideIcon />}\n              </IconButton>\n              {fogEnabled && (\n                <IconButton\n                  onClick={handleVisionChange}\n                  title={\n                    tokenState.hasVision ? \"Disable Vision\" : \"Enable Vision\"\n                  }\n                  aria-label={\n                    tokenState.hasVision ? \"Disable Vision\" : \"Enable Vision\"\n                  }\n                >\n                  {tokenState.hasVision ? <TokenShowIcon /> : <TokenHideIcon />}\n                </IconButton>\n              )}\n              <IconButton\n                onClick={handleLockChange}\n                title={tokenState.locked ? \"Unlock Token\" : \"Lock Token\"}\n                aria-label={tokenState.locked ? \"Unlock Token\" : \"Lock Token\"}\n              >\n                {tokenState.locked ? <LockIcon /> : <UnlockIcon />}\n              </IconButton>\n              <IconButton\n                onClick={handleCategoryChange}\n                title={tokenCategories[tokenState.category].title}\n                aria-label={tokenCategories[tokenState.category].title}\n              >\n                {tokenCategories[tokenState.category].icon}\n              </IconButton>\n            </Flex>\n            {fogEnabled && (\n              <Box mt={2} sx={{ position: \"relative\" }}>\n                <Flex\n                  sx={{\n                    alignItems: \"center\",\n                    justifyContent: \"space-between\",\n                  }}\n                >\n                  <Text as=\"label\" variant=\"body2\">\n                    Vision & Light\n                  </Text>\n                  <IconButton\n                    aria-label=\"Toggle Vision and Light\"\n                    title=\"Toggle Vision and Light\"\n                    onClick={() =>\n                      setVisionLightOpen((prev) => {\n                        const next = !prev;\n                        if (next) {\n                          setAttributesOpen(false);\n                        }\n                        return next;\n                      })\n                    }\n                    sx={{\n                      transform: visionLightOpen ? \"rotate(180deg)\" : \"none\",\n                    }}\n                  >\n                    <ExpandMoreIcon />\n                  </IconButton>\n                </Flex>\n              </Box>\n            )}\n          </>\n        )}\n        {fogEnabled && visionLightOpen && (\n          <Box\n            ref={sidePanelRef}\n            sx={{\n              position: \"fixed\",\n              top: sidePanelStyle.top ?? menuTop,\n              left: sidePanelStyle.left ?? menuLeft + menuWidth + 8,\n              width: `${sidePanelWidth}px`,\n              backgroundColor: \"overlay\",\n              borderRadius: \"4px\",\n              zIndex: 1,\n            }}\n            p={2}\n          >\n            <Text as=\"label\" variant=\"body2\">\n              Vision\n            </Text>\n            <Text variant=\"body2\" sx={{ opacity: 0.8, mt: 1 }}>\n              Range (cells)\n            </Text>\n            <Input\n              type=\"number\"\n              min={0}\n              step={1}\n              value={visionRange}\n              onChange={(e) =>\n                tokenState &&\n                onTokenStateChange({\n                  [tokenState.id]: {\n                    visionRange: parseFloat(e.target.value) || 0,\n                  },\n                })\n              }\n              sx={{ width: \"100%\", px: 1, py: \"2px\", mt: 1 }}\n            />\n            <Text as=\"label\" variant=\"body2\" sx={{ mt: 2 }}>\n              Light\n            </Text>\n            <Label sx={{ display: \"flex\", alignItems: \"center\", mt: 1 }}>\n              <Checkbox\n                checked={lightEnabled}\n                onChange={(e) => handleLightToggle(e.target.checked)}\n              />\n              <Text variant=\"body2\" sx={{ ml: 2 }}>\n                Enable\n              </Text>\n            </Label>\n            <Text variant=\"body2\" sx={{ opacity: 0.8, mt: 1 }}>\n              Color\n            </Text>\n            <Input\n              type=\"color\"\n              value={lightColor}\n              onChange={(e) => handleLightChange({ color: e.target.value })}\n              sx={{ width: \"100%\", height: \"24px\", p: 0, mt: 1 }}\n            />\n            <Text variant=\"body2\" sx={{ opacity: 0.8, mt: 1 }}>\n              Bright\n            </Text>\n            <Input\n              type=\"number\"\n              value={lightRadiusBright}\n              min={0}\n              step={1}\n              onChange={(e) =>\n                handleLightChange({\n                  radiusBright: parseFloat(e.target.value) || 0,\n                })\n              }\n              sx={{ width: \"100%\", px: 1, py: \"2px\", mt: 1 }}\n            />\n            <Text variant=\"body2\" sx={{ opacity: 0.8, mt: 1 }}>\n              Dim\n            </Text>\n            <Input\n              type=\"number\"\n              value={lightRadiusDim}\n              min={0}\n              step={1}\n              onChange={(e) =>\n                handleLightChange({\n                  radiusDim: parseFloat(e.target.value) || 0,\n                })\n              }\n              sx={{ width: \"100%\", px: 1, py: \"2px\", mt: 1 }}\n            />\n          </Box>\n        )}\n        {tokenState && attributesOpen && (\n          <Box\n            ref={sidePanelRef}\n            sx={{\n              position: \"fixed\",\n              top: sidePanelStyle.top ?? menuTop,\n              left: sidePanelStyle.left ?? menuLeft + menuWidth + 8,\n              width: `${sidePanelWidth}px`,\n              backgroundColor: \"overlay\",\n              borderRadius: \"4px\",\n              zIndex: 1,\n            }}\n            p={2}\n          >\n            <TokenAttributeEditor\n              attributes={attributes}\n              onChange={updateAttributes}\n              canEdit={canEditAttributes}\n              title=\"Attributes\"\n              compact\n            />\n          </Box>\n        )}\n\n      </Box>\n    </MapMenu>\n  );\n}\n\nTokenMenu.defaultProps = {\n  focus: false,\n};\n\nexport default TokenMenu;\n","import { useEffect, useRef, useState } from \"react\";\nimport { Box, IconButton } from \"theme-ui\";\n\nimport RemoveTokenIcon from \"../../icons/RemoveTokenIcon\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\n\ntype DragOverlayProps = {\n  dragging: boolean;\n  onRemove: () => void;\n};\n\nfunction DragOverlay({ dragging, onRemove }: DragOverlayProps) {\n  const [isRemoveHovered, setIsRemoveHovered] = useState(false);\n  const removeTokenRef = useRef<HTMLDivElement>(null);\n\n  const mapStageRef = useMapStage();\n\n  // Detect token hover on remove icon manually to support touch devices\n  useEffect(() => {\n    function detectRemoveHover() {\n      const mapStage = mapStageRef.current;\n      if (!mapStage || !dragging || !removeTokenRef.current) {\n        return;\n      }\n      const map = document.querySelector(\".map\");\n      if (!map) {\n        return;\n      }\n      const mapRect = map.getBoundingClientRect();\n      const pointerPosition = mapStage.getPointerPosition();\n      if (!pointerPosition) {\n        return;\n      }\n      const screenSpacePointerPosition = {\n        x: pointerPosition.x + mapRect.left,\n        y: pointerPosition.y + mapRect.top,\n      };\n      const removeIconPosition = removeTokenRef.current.getBoundingClientRect();\n\n      if (\n        screenSpacePointerPosition.x > removeIconPosition.left &&\n        screenSpacePointerPosition.y > removeIconPosition.top &&\n        screenSpacePointerPosition.x < removeIconPosition.right &&\n        screenSpacePointerPosition.y < removeIconPosition.bottom\n      ) {\n        if (!isRemoveHovered) {\n          setIsRemoveHovered(true);\n        }\n      } else if (isRemoveHovered) {\n        setIsRemoveHovered(false);\n      }\n    }\n\n    let handler: NodeJS.Timeout;\n    if (dragging) {\n      handler = setInterval(detectRemoveHover, 100);\n    }\n\n    return () => {\n      if (handler) {\n        clearInterval(handler);\n      }\n    };\n  }, [isRemoveHovered, dragging, mapStageRef]);\n\n  // Detect drag end of token image and remove it if it is over the remove icon\n  useEffect(() => {\n    if (!dragging && isRemoveHovered) {\n      onRemove();\n    }\n  });\n\n  if (!dragging) {\n    return null;\n  }\n\n  return (\n    <Box\n      sx={{\n        position: \"absolute\",\n        bottom: \"32px\",\n        left: \"50%\",\n        borderRadius: \"50%\",\n        transform: isRemoveHovered\n          ? \"translateX(-50%) scale(2.0)\"\n          : \"translateX(-50%) scale(1.5)\",\n        transition: \"transform 250ms ease\",\n        color: isRemoveHovered ? \"primary\" : \"text\",\n        pointerEvents: \"none\",\n      }}\n      bg=\"overlay\"\n      ref={removeTokenRef}\n    >\n      <IconButton>\n        <RemoveTokenIcon />\n      </IconButton>\n    </Box>\n  );\n}\n\nexport default DragOverlay;\n","import DragOverlay from \"../map/DragOverlay\";\nimport { TokenStateRemoveHandler } from \"../../types/Events\";\nimport { TokenDraggingOptions } from \"../../types/Token\";\n\ntype TokenDragOverlayProps = {\n  onTokenStateRemove: TokenStateRemoveHandler;\n  draggingOptions: TokenDraggingOptions;\n};\n\nfunction TokenDragOverlay({\n  onTokenStateRemove,\n  draggingOptions,\n}: TokenDragOverlayProps) {\n  function handleTokenRemove() {\n    onTokenStateRemove([\n      draggingOptions.tokenStateId,\n      ...draggingOptions.attachedTokenStateIds,\n    ]);\n  }\n\n  return (\n    <DragOverlay\n      dragging={draggingOptions.dragging}\n      onRemove={handleTokenRemove}\n    />\n  );\n}\n\nexport default TokenDragOverlay;\n","import { Group } from \"react-konva\";\nimport { v4 as uuid } from \"uuid\";\n\nimport { Map, MapToolId } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport {\n  TokenCategory,\n  TokenDraggingOptions,\n  TokenMenuOptions,\n} from \"../types/Token\";\nimport { TokenState } from \"../types/TokenState\";\nimport { TokenNoteSettings } from \"../types/Settings\";\nimport {\n  TokenStateRemoveHandler,\n  TokenStateChangeEventHandler,\n  TokenDragMoveEventHandler,\n  TokensStateCreateHandler,\n  TokenAttributeCountOpenEventHandler,\n  TokenAttributeCountTarget,\n} from \"../types/Events\";\nimport { useEffect, useRef, useState } from \"react\";\nimport Konva from \"konva\";\nimport Token from \"../components/konva/Token\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport TokenMenu from \"../components/token/TokenMenu\";\nimport TokenDragOverlay from \"../components/token/TokenDragOverlay\";\nimport MapMenu from \"../components/map/MapMenu\";\nimport { Box, Input, Text } from \"theme-ui\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useBlur, useKeyboard } from \"../contexts/KeyboardContext\";\nimport shortcuts from \"../shortcuts\";\nimport { buildNextAttributes, parseNumericExpression } from \"../helpers/tokenAttributes\";\n\ntype MapTokenPreviewOptions = {\n  enableTokenDragPreview?: boolean;\n  onTokenDragMove?: TokenDragMoveEventHandler;\n  onTokenDragPreviewEnd?: () => void;\n};\n\ntype TokenAttributeCountMenuOptions = {\n  tokenStateId: string;\n  target: TokenAttributeCountTarget;\n  left: number;\n  top: number;\n};\n\nconst countMenuWidth = 160;\nconst countMenuHeight = 84;\nconst countMenuPadding = 8;\n\nfunction useMapTokens(\n  map: Map | null,\n  mapState: MapState | null,\n  onTokenStateChange: TokenStateChangeEventHandler,\n  onTokenStateRemove: TokenStateRemoveHandler,\n  onTokensStateCreate: TokensStateCreateHandler,\n  selectedToolId: MapToolId,\n  tokenNoteSettings: TokenNoteSettings,\n  onTokenNoteOpen?: (\n    tokenStateId: string,\n    options?: { mode?: \"sheet\" | \"popover\"; anchor?: Konva.Node | null }\n  ) => void,\n  previewOptions?: MapTokenPreviewOptions\n) {\n  const userId = useUserId();\n  const disabledTokens: Record<string, boolean> = {};\n  if (mapState && map) {\n    if (!mapState.editFlags.includes(\"tokens\") && map.owner !== userId) {\n      for (let token of Object.values(mapState.tokens)) {\n        if (token.owner !== userId) {\n          disabledTokens[token.id] = true;\n        }\n      }\n    }\n  }\n\n  const [isTokenMenuOpen, setIsTokenMenuOpen] = useState<boolean>(false);\n  const [tokenMenuOptions, setTokenMenuOptions] = useState<TokenMenuOptions>();\n  const [tokenDraggingOptions, setTokenDraggingOptions] =\n    useState<TokenDraggingOptions>();\n  const [tokenAttributeCountMenu, setTokenAttributeCountMenu] =\n    useState<TokenAttributeCountMenuOptions | null>(null);\n  const [countInput, setCountInput] = useState(\"\");\n  const [countError, setCountError] = useState<string | null>(null);\n  const countInputRef = useRef<HTMLInputElement | null>(null);\n\n  useEffect(() => {\n    if (tokenAttributeCountMenu && countInputRef.current) {\n      countInputRef.current.focus();\n      countInputRef.current.select();\n    }\n  }, [tokenAttributeCountMenu]);\n\n  function handleTokenMenuOpen(\n    tokenStateId: string,\n    tokenImage: Konva.Node,\n    focus: boolean\n  ) {\n    setTokenAttributeCountMenu(null);\n    setTokenMenuOptions({ tokenStateId, tokenImage, focus });\n    setIsTokenMenuOpen(true);\n  }\n\n  function handleTokenMenuClose() {\n    setIsTokenMenuOpen(false);\n  }\n\n  const handleTokenAttributeCountOpen: TokenAttributeCountOpenEventHandler = (\n    request\n  ) => {\n    const mapElement = document.querySelector(\".map\");\n    if (!mapElement) {\n      return;\n    }\n    const rect = request.node.getClientRect();\n    const mapRect = mapElement.getBoundingClientRect();\n    const anchorX = mapRect.left + rect.x + rect.width / 2;\n    const anchorY = mapRect.top + rect.y;\n\n    let left = anchorX - countMenuWidth / 2;\n    let top = anchorY - countMenuHeight - countMenuPadding;\n    if (top < countMenuPadding) {\n      top = anchorY + rect.height + countMenuPadding;\n    }\n    left = clamp(\n      left,\n      countMenuPadding,\n      window.innerWidth - countMenuWidth - countMenuPadding\n    );\n    top = clamp(\n      top,\n      countMenuPadding,\n      window.innerHeight - countMenuHeight - countMenuPadding\n    );\n\n    setTokenAttributeCountMenu({\n      tokenStateId: request.tokenStateId,\n      target: request.target,\n      left,\n      top,\n    });\n    setCountInput(`${request.target.current}`);\n    setCountError(null);\n  };\n\n  function closeTokenAttributeCountMenu() {\n    setTokenAttributeCountMenu(null);\n    setCountInput(\"\");\n    setCountError(null);\n  }\n\n  function commitCountInput() {\n    if (!tokenAttributeCountMenu || !mapState) {\n      closeTokenAttributeCountMenu();\n      return;\n    }\n    const expression = countInput.trim();\n    if (!expression) {\n      closeTokenAttributeCountMenu();\n      return;\n    }\n    setCountError(null);\n    const result = parseNumericExpression(\n      tokenAttributeCountMenu.target.current,\n      expression\n    );\n    if (!result.ok) {\n      setCountError(result.error);\n      return;\n    }\n    const tokenState = mapState.tokens[tokenAttributeCountMenu.tokenStateId];\n    if (!tokenState?.attributes) {\n      closeTokenAttributeCountMenu();\n      return;\n    }\n    const nextBars = tokenState.attributes.bars || [];\n    const nextValues = tokenState.attributes.values || [];\n    if (tokenAttributeCountMenu.target.type === \"bar\") {\n      const index = nextBars.findIndex(\n        (bar) => bar.id === tokenAttributeCountMenu.target.id\n      );\n      if (index < 0) {\n        closeTokenAttributeCountMenu();\n        return;\n      }\n      const updatedBars = nextBars.map((bar, idx) =>\n        idx === index ? { ...bar, current: result.value } : bar\n      );\n      const nextAttributes = buildNextAttributes(\n        tokenState.attributes,\n        updatedBars,\n        nextValues,\n        userId || \"unknown\"\n      );\n      onTokenStateChange({ [tokenState.id]: { attributes: nextAttributes } });\n    } else {\n      const index = nextValues.findIndex(\n        (value) => value.id === tokenAttributeCountMenu.target.id\n      );\n      if (index < 0) {\n        closeTokenAttributeCountMenu();\n        return;\n      }\n      const updatedValues = nextValues.map((value, idx) =>\n        idx === index ? { ...value, value: result.value } : value\n      );\n      const nextAttributes = buildNextAttributes(\n        tokenState.attributes,\n        nextBars,\n        updatedValues,\n        userId || \"unknown\"\n      );\n      onTokenStateChange({ [tokenState.id]: { attributes: nextAttributes } });\n    }\n\n    closeTokenAttributeCountMenu();\n  }\n\n  function handleTokenDragStart(\n    _: KonvaEventObject<DragEvent>,\n    tokenStateId: string,\n    attachedTokenStateIds: string[]\n  ) {\n    if (duplicateToken) {\n      let newStates: TokenState[] = [];\n      for (let id of [tokenStateId, ...attachedTokenStateIds]) {\n        const state = mapState?.tokens[id];\n        if (state) {\n          newStates.push({ ...state, id: uuid() });\n        }\n      }\n      onTokensStateCreate(newStates);\n    }\n    setTokenDraggingOptions({\n      dragging: true,\n      tokenStateId,\n      attachedTokenStateIds,\n    });\n  }\n\n  const enableTokenDragPreview =\n    !!previewOptions?.enableTokenDragPreview &&\n    typeof previewOptions.onTokenDragMove === \"function\";\n\n  function handleTokenDragEnd() {\n    tokenDraggingOptions &&\n      setTokenDraggingOptions({\n        ...tokenDraggingOptions,\n        dragging: false,\n      });\n    previewOptions?.onTokenDragPreviewEnd?.();\n  }\n\n  function handleTokenStateRemove(tokenStateIds: string[]) {\n    onTokenStateRemove(tokenStateIds);\n    setTokenDraggingOptions(undefined);\n  }\n\n  const [duplicateToken, setDuplicateToken] = useState(false);\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateToken(true);\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateToken(false);\n    }\n  }\n\n  function handleBlur() {\n    setDuplicateToken(false);\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n  useBlur(handleBlur);\n\n  const [transformingTokensIds, setTransformingTokenIds] = useState<string[]>(\n    []\n  );\n  function handleTokenTransformStart(\n    event: Konva.KonvaEventObject<Event>,\n    attachments: Konva.Node[]\n  ) {\n    const transformer = event.currentTarget as Konva.Transformer;\n    const nodes = transformer.nodes();\n    setTransformingTokenIds(\n      [...nodes, ...attachments].map((node) => node.id())\n    );\n  }\n\n  function handleTokenTransformEnd() {\n    setTransformingTokenIds([]);\n  }\n\n  function tokenFromTokenState(tokenState: TokenState) {\n    return (\n      map &&\n      mapState && (\n        <Token\n          key={tokenState.id}\n          tokenState={tokenState}\n          onTokenStateChange={onTokenStateChange}\n          onTokenMenuOpen={handleTokenMenuOpen}\n          onTokenMenuClose={handleTokenMenuClose}\n          onTokenAttributeCountOpen={handleTokenAttributeCountOpen}\n          onTokenDragStart={handleTokenDragStart}\n          onTokenDragEnd={handleTokenDragEnd}\n          onTokenDragMove={\n            enableTokenDragPreview ? previewOptions?.onTokenDragMove : undefined\n          }\n          onTokenTransformStart={handleTokenTransformStart}\n          onTokenTransformEnd={handleTokenTransformEnd}\n          transforming={transformingTokensIds.includes(tokenState.id)}\n          draggable={\n            selectedToolId === \"move\" &&\n            !(tokenState.id in disabledTokens) &&\n            !tokenState.locked\n          }\n          selectable={\n            selectedToolId === \"move\" &&\n            ((!(tokenState.id in disabledTokens) && !tokenState.locked) ||\n              map.owner === userId)\n          }\n          fadeOnHover={\n            tokenState.category !== \"prop\" && selectedToolId === \"drawing\"\n          }\n          map={map}\n          mapState={mapState}\n          noteModeEnabled={tokenNoteSettings.enabled}\n          noteTrigger={tokenNoteSettings.trigger}\n          noteLongPressMs={tokenNoteSettings.longPressMs}\n          onTokenNoteOpen={onTokenNoteOpen}\n          selected={\n            !!tokenMenuOptions &&\n            isTokenMenuOpen &&\n            tokenMenuOptions.tokenStateId === tokenState.id\n          }\n        />\n      )\n    );\n  }\n\n  const tokens = map && mapState && (\n    <Group id=\"tokens\">\n      {Object.values(mapState.tokens)\n        .filter((tokenState) => tokenState.category !== \"prop\")\n        .sort((a, b) => sortMapTokenStates(a, b, tokenDraggingOptions))\n        .map(tokenFromTokenState)}\n    </Group>\n  );\n\n  const propTokens = map && mapState && (\n    <Group id=\"tokens\">\n      {Object.values(mapState.tokens)\n        .filter((tokenState) => tokenState.category === \"prop\")\n        .sort((a, b) => sortMapTokenStates(a, b, tokenDraggingOptions))\n        .map(tokenFromTokenState)}\n    </Group>\n  );\n\n  const tokenMenu = (\n    <TokenMenu\n      isOpen={isTokenMenuOpen}\n      onRequestClose={handleTokenMenuClose}\n      onTokenStateChange={onTokenStateChange}\n      tokenState={\n        tokenMenuOptions && mapState?.tokens[tokenMenuOptions.tokenStateId]\n      }\n      focus={tokenMenuOptions?.focus}\n      tokenImage={tokenMenuOptions?.tokenImage}\n      map={map}\n      fogEnabled={mapState?.fogEnabled ?? true}\n    />\n  );\n\n  const tokenAttributeCountMenuOverlay = tokenAttributeCountMenu ? (\n    <MapMenu\n      isOpen={true}\n      onRequestClose={closeTokenAttributeCountMenu}\n      top={tokenAttributeCountMenu.top}\n      left={tokenAttributeCountMenu.left}\n      style={{ width: `${countMenuWidth}px` }}\n    >\n      <Box p={2}>\n        <Text variant=\"body2\" sx={{ opacity: 0.8, mb: 1 }}>\n          {tokenAttributeCountMenu.target.label}\n        </Text>\n        <Input\n          ref={countInputRef}\n          value={countInput}\n          onChange={(event) => setCountInput(event.target.value)}\n          onKeyDown={(event) => {\n            if (event.key === \"Enter\") {\n              event.preventDefault();\n              commitCountInput();\n            }\n            if (event.key === \"Escape\") {\n              event.preventDefault();\n              closeTokenAttributeCountMenu();\n            }\n          }}\n          sx={{ width: \"100%\", px: 2, py: 1, height: \"28px\" }}\n          placeholder={`${tokenAttributeCountMenu.target.current}`}\n          aria-label=\"Count\"\n        />\n        {countError ? (\n          <Text variant=\"body2\" sx={{ color: \"red\", mt: 1 }}>\n            {countError}\n          </Text>\n        ) : null}\n      </Box>\n    </MapMenu>\n  ) : null;\n\n  const tokenDragOverlay = tokenDraggingOptions && (\n    <TokenDragOverlay\n      onTokenStateRemove={handleTokenStateRemove}\n      draggingOptions={tokenDraggingOptions}\n    />\n  );\n\n  return {\n    tokens,\n    propTokens,\n    tokenMenu,\n    tokenAttributeCountMenu: tokenAttributeCountMenuOverlay,\n    tokenDragOverlay,\n  };\n}\n\nexport default useMapTokens;\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction getMapTokenCategoryWeight(category: TokenCategory) {\n  switch (category) {\n    case \"attachment\":\n      return 0;\n    case \"character\":\n      return 1;\n    case \"vehicle\":\n      return 2;\n    case \"prop\":\n      return 3;\n    default:\n      return 0;\n  }\n}\n\n// Sort so vehicles render below other tokens\nfunction sortMapTokenStates(\n  a: TokenState,\n  b: TokenState,\n  tokenDraggingOptions?: TokenDraggingOptions\n) {\n  // If categories are different sort in order \"prop\", \"vehicle\", \"character\", \"attachment\"\n  if (b.category !== a.category) {\n    const aWeight = getMapTokenCategoryWeight(a.category);\n    const bWeight = getMapTokenCategoryWeight(b.category);\n    return bWeight - aWeight;\n  } else if (\n    tokenDraggingOptions &&\n    tokenDraggingOptions.dragging &&\n    tokenDraggingOptions.tokenStateId === a.id\n  ) {\n    // If dragging token a move above\n    return 1;\n  } else if (\n    tokenDraggingOptions &&\n    tokenDraggingOptions.dragging &&\n    tokenDraggingOptions.tokenStateId === b.id\n  ) {\n    // If dragging token b move above\n    return -1;\n  } else {\n    // Else sort so last modified is on top\n    return a.lastModified - b.lastModified;\n  }\n}\n","import colors from \"./colors\";\nimport { Map } from \"../types/Map\";\nimport { Note, NoteContentFormat } from \"../types/Note\";\n\nexport function resolveColor(value: string | undefined, fallback: string) {\n  if (!value) {\n    return fallback;\n  }\n  const paletteValue = (colors as Record<string, string>)[value];\n  return paletteValue || value;\n}\n\nexport function getNoteContent(note: Note) {\n  return note.content ?? note.text ?? \"\";\n}\n\nexport function getNoteContentFormat(note: Note): NoteContentFormat {\n  return note.contentFormat || \"plain\";\n}\n\nexport function getNoteVisibility(note: Note, map: Map | null, userId?: string) {\n  const isMapOwner = !!map && !!userId && map.owner === userId;\n  const isNoteOwner = !!note.ownerId && !!userId && note.ownerId === userId;\n  const visibility = note.visibility || \"all\";\n\n  const canViewByVisibility =\n    visibility === \"gm\"\n      ? isMapOwner\n      : visibility === \"owner\"\n        ? isMapOwner || isNoteOwner\n        : true;\n\n  const textVisible = note.textVisible !== false;\n  const visibleByState = note.visible !== false || isMapOwner;\n  const canView = canViewByVisibility && visibleByState && (textVisible || isMapOwner);\n  const canViewText =\n    canViewByVisibility && visibleByState && (textVisible || isMapOwner);\n\n  return { canView, canViewText, isMapOwner, isNoteOwner };\n}\n","import { useEffect, useState, useRef } from \"react\";\nimport type { ComponentType, ReactNode, Ref } from \"react\";\nimport { Group, Rect, Text } from \"react-konva\";\nimport Konva from \"konva\";\nimport { useSpring, animated } from \"@react-spring/konva\";\nimport type { SpringValue } from \"@react-spring/core\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport {\n  useSetPreventMapInteraction,\n  useMapWidth,\n  useMapHeight,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useGridCellPixelSize } from \"../../contexts/GridContext\";\n\nimport colors from \"../../helpers/colors\";\n\nimport usePrevious from \"../../hooks/usePrevious\";\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport { Note as NoteType, NoteStyle } from \"../../types/Note\";\nimport {\n  NoteChangeEventHandler,\n  NoteDragEventHandler,\n  NoteMenuCloseEventHandler,\n  NoteMenuOpenEventHandler,\n} from \"../../types/Events\";\nimport { Map } from \"../../types/Map\";\nimport { getNoteContentFormat, getNoteVisibility, resolveColor } from \"../../helpers/notes\";\n\nimport Transformer from \"./Transformer\";\n\nconst defaultFontSize = 144;\nconst minFontSize = 16;\n\ntype KonvaEventHandler = (event: Konva.KonvaEventObject<any>) => void;\n\ntype NoteGroupEvents = {\n  onClick?: KonvaEventHandler;\n  onTap?: KonvaEventHandler;\n  onDragStart?: KonvaEventHandler;\n  onDragEnd?: KonvaEventHandler;\n  onDragMove?: KonvaEventHandler;\n  onMouseDown?: KonvaEventHandler;\n  onMouseUp?: KonvaEventHandler;\n  onTouchStart?: KonvaEventHandler;\n  onTouchEnd?: KonvaEventHandler;\n  onMouseEnter?: KonvaEventHandler;\n  onMouseLeave?: KonvaEventHandler;\n};\n\ntype AnimatedGroupProps = Omit<Konva.ContainerConfig, \"x\" | \"y\"> &\n  NoteGroupEvents & {\n    children?: ReactNode;\n    ref?: Ref<Konva.Group>;\n    x?: number | SpringValue<number>;\n    y?: number | SpringValue<number>;\n  };\n\n//  TS2589 \nconst animatedFactory = animated as unknown as (\n  component: ComponentType<any>\n) => ComponentType<any>;\n\nconst AnimatedGroup = animatedFactory(\n  Group as unknown as ComponentType<AnimatedGroupProps>\n) as ComponentType<AnimatedGroupProps>;\n\ntype NoteProps = {\n  note: NoteType;\n  map: Map | null;\n  onNoteChange?: NoteChangeEventHandler;\n  onNoteMenuOpen?: NoteMenuOpenEventHandler;\n  onNoteEditOpen?: NoteMenuOpenEventHandler;\n  onNoteMenuClose?: NoteMenuCloseEventHandler;\n  editable: boolean;\n  openOnClick?: boolean;\n  openOnDoubleClick?: boolean;\n  allowSingleClickEdit?: boolean;\n  draggable: boolean;\n  onNoteDragStart?: NoteDragEventHandler;\n  onNoteDragEnd?: NoteDragEventHandler;\n  fadeOnHover: boolean;\n  selected: boolean;\n};\n\nfunction Note({\n  note,\n  map,\n  onNoteChange,\n  onNoteMenuOpen,\n  onNoteEditOpen,\n  onNoteMenuClose,\n  editable,\n  openOnClick,\n  openOnDoubleClick,\n  allowSingleClickEdit,\n  draggable,\n  onNoteDragStart,\n  onNoteDragEnd,\n  fadeOnHover,\n  selected,\n}: NoteProps) {\n  const userId = useUserId();\n\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n\n  const gridCellPixelSize = useGridCellPixelSize();\n\n  const minCellSize = Math.min(\n    gridCellPixelSize.width,\n    gridCellPixelSize.height\n  );\n  const noteWidth = minCellSize * note.size;\n  const noteHeight = noteWidth;\n  const notePadding = noteWidth / 10;\n  const contentFormat = getNoteContentFormat(note);\n  const showKonvaText = contentFormat !== \"html\";\n  const usesTextHud = note.textOnly || contentFormat === \"html\";\n\n  const fontScaleMap = {\n    xs: 0.5,\n    sm: 0.75,\n    md: 1,\n    lg: 1.5,\n    xl: 2,\n    huge: 3,\n  } as const;\n\n  function resolveStyle(): NoteStyle {\n    if (note.style) {\n      return {\n        ...note.style,\n        fontSize:\n          typeof note.style.fontSize === \"number\"\n            ? note.style.fontSize\n            : fontScaleMap[note.style.fontScale || \"md\"],\n      };\n    }\n    return {\n      textColor: note.textOnly ? note.color : \"black\",\n      backgroundMode: note.textOnly ? \"none\" : \"frame\",\n      fontFamily: \"rounded\",\n      fontScale: \"md\",\n      fontSize: 1,\n    };\n  }\n\n  function resolveFontScale(value: number) {\n    let closest: keyof typeof fontScaleMap = \"md\";\n    let closestDistance = Number.POSITIVE_INFINITY;\n    (Object.keys(fontScaleMap) as Array<keyof typeof fontScaleMap>).forEach(\n      (key) => {\n        const distance = Math.abs(fontScaleMap[key] - value);\n        if (distance < closestDistance) {\n          closestDistance = distance;\n          closest = key;\n        }\n      }\n    );\n    return closest;\n  }\n\n  const snapPositionToGrid = useGridSnapping();\n\n  function handleDragStart(event: Konva.KonvaEventObject<DragEvent>) {\n    onNoteDragStart?.(event, note.id);\n  }\n\n  function handleDragMove(event: Konva.KonvaEventObject<DragEvent>) {\n    const noteGroup = event.target;\n    // Snap to corners of grid\n    if (map?.snapToGrid) {\n      noteGroup.position(snapPositionToGrid(noteGroup.position()));\n    }\n  }\n\n  function handleDragEnd(event: Konva.KonvaEventObject<DragEvent>) {\n    const noteGroup = event.target;\n    if (userId) {\n      onNoteChange?.({\n        [note.id]: {\n          x: noteGroup.x() / mapWidth,\n          y: noteGroup.y() / mapHeight,\n          lastModifiedBy: userId,\n          lastModified: Date.now(),\n        },\n      });\n    }\n    onNoteDragEnd?.(event, note.id);\n    setPreventMapInteraction(false);\n  }\n\n  function handleDoubleClick(event: Konva.KonvaEventObject<MouseEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (!openOnDoubleClick) {\n      return;\n    }\n    if (!(editable || (note.locked && map?.owner === userId))) {\n      return;\n    }\n    const noteNode = event.target;\n    const openHandler =\n      usesTextHud && allowSingleClickEdit && onNoteEditOpen\n        ? onNoteEditOpen\n        : onNoteMenuOpen;\n    openHandler && openHandler(note.id, noteNode, true);\n  }\n\n  function handleClick(event: Konva.KonvaEventObject<MouseEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (!openOnClick) {\n      return;\n    }\n    if (!(editable || (note.locked && map?.owner === userId))) {\n      return;\n    }\n    const noteNode = event.target;\n    const openHandler =\n      usesTextHud && onNoteEditOpen ? onNoteEditOpen : onNoteMenuOpen;\n    openHandler && openHandler(note.id, noteNode, true);\n  }\n\n  function handlePointerDown(event: Konva.KonvaEventObject<PointerEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (draggable) {\n      setPreventMapInteraction(true);\n    }\n  }\n\n  function handlePointerUp(event: Konva.KonvaEventObject<PointerEvent>) {\n    if (!leftMouseButton(event)) {\n      return;\n    }\n    if (draggable) {\n      setPreventMapInteraction(false);\n    }\n  }\n\n  const [noteOpacity, setNoteOpacity] = useState(1);\n  function handlePointerEnter() {\n    if (fadeOnHover) {\n      setNoteOpacity(0.5);\n    }\n  }\n\n  function handlePointerLeave() {\n    if (noteOpacity !== 1.0) {\n      setNoteOpacity(1.0);\n    }\n  }\n\n  const [fontScale, setFontScale] = useState(1);\n  useEffect(() => {\n    const textNode = textRef.current;\n    if (!textNode || !showKonvaText) {\n      setFontScale(1);\n      return;\n    }\n    function findFontSize() {\n      // Create an array from 1 / minFontSize of the note height to the full note height\n      let sizes = Array.from(\n        { length: Math.ceil(noteHeight - notePadding * 2) },\n        (_, i) => i + Math.ceil(noteHeight / minFontSize)\n      );\n\n      if (sizes.length > 0) {\n        const size = sizes.reduce((prev, curr) => {\n          if (!textNode) {\n            return prev;\n          }\n          textNode.fontSize(curr);\n          const width = textNode.getTextWidth() + notePadding * 2;\n          const height = textNode.height() + notePadding * 2;\n          if (width < noteWidth && height < noteHeight) {\n            return curr;\n          } else {\n            return prev;\n          }\n        });\n        setFontScale(size / defaultFontSize);\n      }\n    }\n\n    findFontSize();\n  }, [note, note.text, note.visible, noteWidth, noteHeight, notePadding, showKonvaText]);\n\n  const textRef = useRef<Konva.Text>(null);\n\n  const noteRef = useRef<Konva.Group>(null);\n  const [isTransforming, setIsTransforming] = useState(false);\n  function handleTransformStart() {\n    setIsTransforming(true);\n    onNoteMenuClose?.();\n  }\n\n  function handleTransformEnd(event: Konva.KonvaEventObject<Event>) {\n    if (noteRef.current) {\n      const target =\n        (event.target as Konva.Node | undefined) || noteRef.current;\n      if (!target || typeof (target as any).scaleX !== \"function\") {\n        setIsTransforming(false);\n        return;\n      }\n      const sizeChange = (target as Konva.Node).scaleX();\n      const rotation = (target as Konva.Node).rotation();\n      if (usesTextHud) {\n        const currentStyle = resolveStyle();\n        const currentScale =\n          typeof currentStyle.fontSize === \"number\"\n            ? currentStyle.fontSize\n            : fontScaleMap[currentStyle.fontScale];\n        const nextScale = currentScale * sizeChange;\n        const nextFontScale = resolveFontScale(nextScale);\n        const styleChanged =\n          Math.abs(nextScale - currentScale) > 0.001 ||\n          nextFontScale !== currentStyle.fontScale;\n        if (styleChanged || rotation !== note.rotation) {\n          const nextStyle: NoteStyle = {\n            ...currentStyle,\n            fontScale: nextFontScale,\n            fontSize: nextScale,\n          };\n          onNoteChange?.({\n            [note.id]: {\n              style: nextStyle,\n              textOnly: nextStyle.backgroundMode === \"none\",\n              rotation: rotation,\n            },\n          });\n        }\n      } else {\n        onNoteChange?.({\n          [note.id]: {\n            size: note.size * sizeChange,\n            rotation: rotation,\n          },\n        });\n        onNoteMenuOpen?.(note.id, noteRef.current, false);\n      }\n      noteRef.current.scaleX(1);\n      noteRef.current.scaleY(1);\n    }\n    setIsTransforming(false);\n  }\n\n  // Animate to new note positions if edited by others\n  const noteX = note.x * mapWidth;\n  const noteY = note.y * mapHeight;\n  const previousWidth = usePrevious(mapWidth);\n  const previousHeight = usePrevious(mapHeight);\n  const resized = mapWidth !== previousWidth || mapHeight !== previousHeight;\n  const skipAnimation = note.lastModifiedBy === userId || resized;\n  const springProps = useSpring<{ x: number; y: number }>({\n    x: noteX,\n    y: noteY,\n    immediate: skipAnimation,\n  });\n\n  const { canView, canViewText } = getNoteVisibility(note, map, userId || undefined);\n  if (!canView) {\n    return null;\n  }\n\n  const hasStyle = !!note.style;\n  const backgroundMode = note.style?.backgroundMode || \"none\";\n  const backgroundFill = hasStyle\n    ? backgroundMode === \"scrim\"\n      ? \"rgba(0, 0, 0, 0.5)\"\n      : backgroundMode === \"frame\"\n        ? \"rgb(255, 255, 255)\"\n        : null\n    : note.textOnly\n      ? null\n      : colors[note.color];\n  const needsHitRect = !showKonvaText && !backgroundFill;\n  const textColor = hasStyle\n    ? backgroundMode === \"frame\"\n      ? \"black\"\n      : resolveColor(note.style?.textColor, \"white\")\n    : note.textOnly\n      ? colors[note.color]\n      : note.color === \"black\" || note.color === \"darkGray\"\n        ? \"white\"\n        : \"black\";\n  const noteFontFamily = note.style?.fontFamily;\n  const fontFamily =\n    noteFontFamily === \"handwritten\"\n      ? \"Pacifico, cursive\"\n      : noteFontFamily === \"runic\"\n        ? \"Bree Serif, serif\"\n        : noteFontFamily === \"serif\"\n          ? \"Georgia, serif\"\n          : \"Arial, sans-serif\";\n\n  const noteName = `note${note.locked ? \"-locked\" : \"\"}`;\n\n  return (\n    <>\n      <AnimatedGroup\n        {...springProps}\n        id={note.id}\n        onClick={handleClick}\n        onDblClick={handleDoubleClick}\n        onTap={handleClick}\n        onDblTap={handleDoubleClick}\n        width={noteWidth}\n        height={backgroundFill ? noteHeight : undefined}\n        rotation={note.rotation}\n        offsetX={noteWidth / 2}\n        offsetY={noteHeight / 2}\n        draggable={draggable}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n        onDragMove={handleDragMove}\n        onMouseDown={handlePointerDown}\n        onMouseUp={handlePointerUp}\n        onTouchStart={handlePointerDown}\n        onTouchEnd={handlePointerUp}\n        onMouseEnter={handlePointerEnter}\n        onMouseLeave={handlePointerLeave}\n        opacity={note.visible ? noteOpacity : 0.5}\n        name={noteName}\n        ref={noteRef}\n      >\n        {needsHitRect && (\n          <Rect width={noteWidth} height={noteHeight} fill=\"rgba(0,0,0,0)\" />\n        )}\n        {backgroundFill && (\n          <Rect\n            width={noteWidth}\n            height={noteHeight}\n            shadowColor=\"rgba(0, 0, 0, 0.16)\"\n            shadowOffset={{ x: 0, y: 3 }}\n            shadowBlur={6}\n            cornerRadius={0.25}\n            fill={backgroundFill}\n          />\n        )}\n        {showKonvaText && canViewText && (\n          <>\n            <Text\n              text={note.text}\n              fill={textColor}\n              align=\"left\"\n              verticalAlign=\"middle\"\n              padding={notePadding / fontScale}\n              fontSize={defaultFontSize}\n              fontFamily={fontFamily}\n              // Scale font instead of changing font size to avoid kerning issues with Firefox\n              scaleX={fontScale}\n              scaleY={fontScale}\n              width={noteWidth / fontScale}\n              height={backgroundFill ? noteHeight / fontScale : undefined}\n              wrap=\"word\"\n            />\n            {/* Use an invisible text block to work out text sizing */}\n            <Text visible={false} ref={textRef} text={note.text} wrap=\"none\" />\n          </>\n        )}\n      </AnimatedGroup>\n      <Transformer\n        active={(!note.locked && selected) || isTransforming}\n        nodes={noteRef.current ? [noteRef.current] : []}\n        onTransformEnd={handleTransformEnd}\n        onTransformStart={handleTransformStart}\n        gridScale={map?.grid.measurement.scale || \"\"}\n        resizeEnabled={usesTextHud ? false : undefined}\n      />\n    </>\n  );\n}\n\nNote.defaultProps = {\n  fadeOnHover: false,\n  editable: false,\n  openOnClick: false,\n  openOnDoubleClick: false,\n  allowSingleClickEdit: false,\n  draggable: false,\n};\n\nexport default Note;\n","import { NoteRemoveEventHander } from \"../../types/Events\";\nimport { NoteDraggingOptions } from \"../../types/Note\";\n\nimport DragOverlay from \"../map/DragOverlay\";\n\ntype NoteDragOverlayProps = {\n  onNoteRemove: NoteRemoveEventHander;\n  draggingOptions: NoteDraggingOptions;\n};\n\nfunction NoteDragOverlay({\n  onNoteRemove,\n  draggingOptions,\n}: NoteDragOverlayProps) {\n  function handleNoteRemove() {\n    onNoteRemove([draggingOptions.noteId]);\n  }\n\n  return (\n    <DragOverlay\n      dragging={draggingOptions.dragging}\n      onRemove={handleNoteRemove}\n    />\n  );\n}\n\nexport default NoteDragOverlay;\n","import TextareaAutosize, {\n  TextareaAutosizeProps,\n} from \"react-textarea-autosize\";\nimport \"./TextareaAutoSize.css\";\n\nfunction StyledTextareaAutoSize(props: TextareaAutosizeProps) {\n  return <TextareaAutosize className=\"textarea-auto-size\" {...props} />;\n}\n\nexport default StyledTextareaAutoSize;\n","import React, { useEffect, useState } from \"react\";\nimport { Box, Flex, IconButton } from \"theme-ui\";\nimport Konva from \"konva\";\n\nimport TextareaAutosize from \"../TextareaAutoSize\";\n\nimport MapMenu from \"../map/MapMenu\";\n\nimport colors, { Color, colorOptions } from \"../../helpers/colors\";\n\nimport usePrevious from \"../../hooks/usePrevious\";\n\nimport LockIcon from \"../../icons/TokenLockIcon\";\nimport UnlockIcon from \"../../icons/TokenUnlockIcon\";\nimport ShowIcon from \"../../icons/TokenShowIcon\";\nimport HideIcon from \"../../icons/TokenHideIcon\";\nimport NoteIcon from \"../../icons/NoteToolIcon\";\nimport TextIcon from \"../../icons/NoteTextIcon\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport {\n  NoteChangeEventHandler,\n  RequestCloseEventHandler,\n} from \"../../types/Events\";\nimport { Note } from \"../../types/Note\";\nimport { Map } from \"../../types/Map\";\n\ntype NoteMenuProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  note?: Note;\n  noteNode?: Konva.Node;\n  focus: boolean;\n  onNoteChange: NoteChangeEventHandler;\n  map: Map | null;\n};\n\nfunction NoteMenu({\n  isOpen,\n  onRequestClose,\n  note,\n  noteNode,\n  focus,\n  onNoteChange,\n  map,\n}: NoteMenuProps) {\n  const userId = useUserId();\n\n  const wasOpen = usePrevious(isOpen);\n\n  const [menuLeft, setMenuLeft] = useState(0);\n  const [menuTop, setMenuTop] = useState(0);\n  useEffect(() => {\n    if (isOpen && !wasOpen && note) {\n      // Update menu position\n      if (noteNode) {\n        const nodeRect = noteNode.getClientRect();\n        const mapElement = document.querySelector(\".map\");\n        if (mapElement) {\n          const mapRect = mapElement.getBoundingClientRect();\n          // Center X for the menu which is 156px wide\n          setMenuLeft(mapRect.left + nodeRect.x + nodeRect.width / 2 - 156 / 2);\n          // Y 20px from the bottom\n          setMenuTop(mapRect.top + nodeRect.y + nodeRect.height + 20);\n        }\n      }\n    }\n  }, [isOpen, note, wasOpen, noteNode]);\n\n  function handleTextChange(event: React.ChangeEvent<HTMLTextAreaElement>) {\n    const text = event.target.value.substring(0, 1024);\n    note && onNoteChange({ [note.id]: { text: text } });\n  }\n\n  function handleColorChange(color: Color) {\n    if (!note) {\n      return;\n    }\n    onNoteChange({ [note.id]: { color: color } });\n  }\n\n  function handleVisibleChange() {\n    note && onNoteChange({ [note.id]: { visible: !note.visible } });\n  }\n\n  function handleLockChange() {\n    note && onNoteChange({ [note.id]: { locked: !note.locked } });\n  }\n\n  function handleModeChange() {\n    note && onNoteChange({ [note.id]: { textOnly: !note.textOnly } });\n  }\n\n  function handleModalContent(node: HTMLElement) {\n    if (node) {\n      // Focus input\n      const tokenLabelInput =\n        node.querySelector<HTMLInputElement>(\"#changeNoteText\");\n      if (tokenLabelInput && focus) {\n        tokenLabelInput.focus();\n        tokenLabelInput.select();\n      }\n\n      // Ensure menu is in bounds\n      const nodeRect = node.getBoundingClientRect();\n      const mapElement = document.querySelector(\".map\");\n      if (mapElement) {\n        const mapRect = mapElement.getBoundingClientRect();\n        setMenuLeft((prevLeft) =>\n          Math.min(\n            mapRect.right - nodeRect.width,\n            Math.max(mapRect.left, prevLeft)\n          )\n        );\n        setMenuTop((prevTop) =>\n          Math.min(mapRect.bottom - nodeRect.height, prevTop)\n        );\n      }\n    }\n  }\n\n  function handleTextKeyPress(e: React.KeyboardEvent<HTMLTextAreaElement>) {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      onRequestClose();\n    }\n  }\n\n  return (\n    <MapMenu\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      top={`${menuTop}px`}\n      left={`${menuLeft}px`}\n      onModalContent={handleModalContent}\n    >\n      <Box sx={{ width: \"156px\", overflow: \"hidden\" }} p={1}>\n        <Flex\n          as=\"form\"\n          onSubmit={(e) => {\n            e.preventDefault();\n            onRequestClose();\n          }}\n          sx={{ alignItems: \"center\" }}\n        >\n          <TextareaAutosize\n            id=\"changeNoteText\"\n            onChange={handleTextChange}\n            value={(note && note.text) || \"\"}\n            onKeyPress={handleTextKeyPress}\n            maxRows={4}\n          />\n        </Flex>\n        <Box\n          sx={{\n            display: \"flex\",\n            flexWrap: \"wrap\",\n            justifyContent: \"space-between\",\n          }}\n        >\n          {colorOptions\n            .filter((color) => color !== \"primary\")\n            .map((color) => (\n              <Box\n                key={color}\n                sx={{\n                  width: \"16.66%\",\n                  paddingTop: \"16.66%\",\n                  borderRadius: \"50%\",\n                  transform: \"scale(0.75)\",\n                  backgroundColor: colors[color],\n                  cursor: \"pointer\",\n                }}\n                onClick={() => handleColorChange(color)}\n                aria-label={`Note label Color ${color}`}\n              >\n                {note && note.color === color && (\n                  <Box\n                    sx={{\n                      width: \"100%\",\n                      height: \"100%\",\n                      border: \"2px solid white\",\n                      position: \"absolute\",\n                      top: 0,\n                      borderRadius: \"50%\",\n                    }}\n                  />\n                )}\n              </Box>\n            ))}\n        </Box>\n        {/* Only show hide and lock token actions to map owners */}\n        {map && map.owner === userId && (\n          <Flex sx={{ alignItems: \"center\", justifyContent: \"space-around\" }}>\n            <IconButton\n              onClick={handleVisibleChange}\n              title={note && note.visible ? \"Hide Note\" : \"Show Note\"}\n              aria-label={note && note.visible ? \"Hide Note\" : \"Show Note\"}\n            >\n              {note && note.visible ? <ShowIcon /> : <HideIcon />}\n            </IconButton>\n            <IconButton\n              onClick={handleLockChange}\n              title={note && note.locked ? \"Unlock Note\" : \"Lock Note\"}\n              aria-label={note && note.locked ? \"Unlock Note\" : \"Lock Note\"}\n            >\n              {note && note.locked ? <LockIcon /> : <UnlockIcon />}\n            </IconButton>\n            <IconButton\n              onClick={handleModeChange}\n              title={note && note.textOnly ? \"Note Mode\" : \"Text Mode\"}\n              aria-label={note && note.textOnly ? \"Note Mode\" : \"Text Mode\"}\n            >\n              {note && note.textOnly ? <TextIcon /> : <NoteIcon />}\n            </IconButton>\n          </Flex>\n        )}\n      </Box>\n    </MapMenu>\n  );\n}\n\nNoteMenu.defaultProps = {\n  focus: false,\n};\n\nexport default NoteMenu;\n","import { useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  Box,\n  Flex,\n  IconButton,\n  Input,\n  Text,\n  ThemeUIStyleObject,\n} from \"theme-ui\";\n\nimport Divider from \"../Divider\";\nimport colors from \"../../helpers/colors\";\nimport { resolveColor } from \"../../helpers/notes\";\nimport { Note, NoteStyle } from \"../../types/Note\";\n\ntype AdvancedTextHudProps = {\n  isOpen: boolean;\n  note?: Note;\n  draftStyle: NoteStyle;\n  canEdit: boolean;\n  canManage: boolean;\n  attachMode: boolean;\n  onRequestClose: () => void;\n  onStyleChange: (change: Partial<NoteStyle>) => void;\n  onCommand: (command: string, value?: string) => void;\n  onToggleTextVisible: () => void;\n  onToggleVisibility: () => void;\n  onToggleAttach: () => void;\n};\n\nconst palette: Array<keyof typeof colors> = [\n  \"red\",\n  \"yellow\",\n  \"white\",\n  \"black\",\n  \"teal\",\n  \"blue\",\n  \"green\",\n  \"pink\",\n  \"darkGray\",\n];\n\nconst fontOptions = [\n  { value: \"rounded\", label: \"Rounded\" },\n  { value: \"serif\", label: \"Serif\" },\n  { value: \"handwritten\", label: \"Handwritten\" },\n  { value: \"runic\", label: \"Runic\" },\n];\n\nconst sizeOptions = [\n  { fontScale: \"xs\", fontSize: 0.5, label: \"0.5x\" },\n  { fontScale: \"sm\", fontSize: 0.75, label: \"0.75x\" },\n  { fontScale: \"md\", fontSize: 1, label: \"1x\" },\n  { fontScale: \"lg\", fontSize: 1.5, label: \"1.5x\" },\n  { fontScale: \"xl\", fontSize: 2, label: \"2x\" },\n  { fontScale: \"huge\", fontSize: 3, label: \"3x\" },\n];\n\nfunction AdvancedTextHud({\n  isOpen,\n  note,\n  draftStyle,\n  canEdit,\n  canManage,\n  attachMode,\n  onRequestClose,\n  onStyleChange,\n  onCommand,\n  onToggleTextVisible,\n  onToggleVisibility,\n  onToggleAttach,\n}: AdvancedTextHudProps) {\n  const [hexValue, setHexValue] = useState(\"#ffffff\");\n  const [formatState, setFormatState] = useState({\n    bold: false,\n    italic: false,\n    ul: false,\n    ol: false,\n  });\n  const [colorMenuOpen, setColorMenuOpen] = useState(false);\n  const [fontMenuOpen, setFontMenuOpen] = useState(false);\n  const [sizeMenuOpen, setSizeMenuOpen] = useState(false);\n  const hudRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    if (!isOpen) {\n      setColorMenuOpen(false);\n      setFontMenuOpen(false);\n      setSizeMenuOpen(false);\n      return;\n    }\n    function handleSelectionChange() {\n      try {\n        setFormatState({\n          bold: document.queryCommandState(\"bold\"),\n          italic: document.queryCommandState(\"italic\"),\n          ul: document.queryCommandState(\"insertUnorderedList\"),\n          ol: document.queryCommandState(\"insertOrderedList\"),\n        });\n      } catch {\n        // Ignore unsupported environments\n      }\n    }\n    document.addEventListener(\"selectionchange\", handleSelectionChange);\n    handleSelectionChange();\n    return () => document.removeEventListener(\"selectionchange\", handleSelectionChange);\n  }, [isOpen]);\n\n  const anyMenuOpen = colorMenuOpen || fontMenuOpen || sizeMenuOpen;\n  useEffect(() => {\n    if (!anyMenuOpen) {\n      return;\n    }\n    function handlePointerDown(event: MouseEvent) {\n      if (!hudRef.current) {\n        return;\n      }\n      if (hudRef.current.contains(event.target as Node)) {\n        return;\n      }\n      setColorMenuOpen(false);\n      setFontMenuOpen(false);\n      setSizeMenuOpen(false);\n    }\n    document.addEventListener(\"mousedown\", handlePointerDown);\n    return () => document.removeEventListener(\"mousedown\", handlePointerDown);\n  }, [anyMenuOpen]);\n\n  useEffect(() => {\n    if (!note) {\n      return;\n    }\n    setHexValue(resolveColor(draftStyle.textColor, \"#ffffff\"));\n  }, [note, draftStyle.textColor]);\n\n  const visibilityLabel = useMemo(() => {\n    const visibility = note?.visibility || \"all\";\n    if (visibility === \"gm\") {\n      return \"GM\";\n    }\n    if (visibility === \"owner\") {\n      return \"Owner\";\n    }\n    return \"All\";\n  }, [note?.visibility]);\n\n  if (!isOpen || !note) {\n    return null;\n  }\n\n  const buttonSx = (active?: boolean) => ({\n    width: \"28px\",\n    height: \"28px\",\n    padding: 0,\n    borderRadius: \"999px\",\n    backgroundColor: active ? \"rgba(255, 255, 255, 0.16)\" : \"transparent\",\n    color: \"text\",\n    border: \"1px solid\",\n    borderColor: \"muted\",\n    \"&:hover\": {\n      backgroundColor: \"rgba(255, 255, 255, 0.1)\",\n    },\n  });\n\n  const pillButtonSx = (active?: boolean) => ({\n    height: \"28px\",\n    borderRadius: \"999px\",\n    border: \"1px solid\",\n    borderColor: \"muted\",\n    backgroundColor: active ? \"rgba(255, 255, 255, 0.16)\" : \"rgba(255, 255, 255, 0.08)\",\n    color: \"text\",\n    fontSize: 1,\n    px: 2,\n    cursor: \"pointer\",\n  });\n\n  const menuSx: ThemeUIStyleObject = {\n    position: \"absolute\",\n    top: \"calc(100% + 6px)\",\n    left: 0,\n    backgroundColor: \"rgba(20, 20, 24, 0.98)\",\n    borderRadius: \"12px\",\n    p: 2,\n    boxShadow: \"0 8px 24px rgba(0, 0, 0, 0.4)\",\n    minWidth: \"140px\",\n    zIndex: 2,\n  };\n\n  function handleHexCommit(value: string) {\n    const trimmed = value.trim();\n    const normalized = trimmed.startsWith(\"#\") ? trimmed : `#${trimmed}`;\n    if (/^#[0-9a-fA-F]{6}$/.test(normalized)) {\n      onStyleChange({ textColor: normalized.toLowerCase() });\n    }\n  }\n\n  function handleBackgroundToggle() {\n    const current = draftStyle.backgroundMode;\n    const next =\n      current === \"none\" ? \"scrim\" : current === \"scrim\" ? \"frame\" : \"none\";\n    onStyleChange({ backgroundMode: next });\n  }\n\n  const swatchColor = resolveColor(draftStyle.textColor, \"#ffffff\");\n  const currentFontLabel =\n    fontOptions.find((option) => option.value === draftStyle.fontFamily)\n      ?.label || \"Font\";\n  const currentSizeLabel = (() => {\n    if (typeof draftStyle.fontSize === \"number\") {\n      let closest = sizeOptions[2];\n      let closestDistance = Number.POSITIVE_INFINITY;\n      for (const option of sizeOptions) {\n        const distance = Math.abs(option.fontSize - draftStyle.fontSize);\n        if (distance < closestDistance) {\n          closestDistance = distance;\n          closest = option;\n        }\n      }\n      return closest.label;\n    }\n    return (\n      sizeOptions.find((option) => option.fontScale === draftStyle.fontScale)\n        ?.label || \"1x\"\n    );\n  })();\n\n  return (\n    <Box\n      data-text-hud=\"true\"\n      sx={{\n        position: \"absolute\",\n        top: 8,\n        left: \"50%\",\n        transform: \"translateX(-50%)\",\n        zIndex: 30,\n        pointerEvents: \"auto\",\n      }}\n    >\n      <Flex\n        ref={hudRef}\n        sx={{\n          alignItems: \"center\",\n          gap: 2,\n          px: 2,\n          py: 1,\n          borderRadius: 9999,\n          backgroundColor: \"rgba(20, 20, 24, 0.9)\",\n          color: \"text\",\n          boxShadow: \"0 6px 20px rgba(0, 0, 0, 0.35)\",\n          position: \"relative\",\n        }}\n      >\n        <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n          <Box sx={{ position: \"relative\" }}>\n            <IconButton\n              onClick={() => setColorMenuOpen((prev) => !prev)}\n              title=\"Text color\"\n              aria-label=\"Text color\"\n              sx={buttonSx()}\n              disabled={!canEdit}\n            >\n              <Box\n                sx={{\n                  width: \"14px\",\n                  height: \"14px\",\n                  borderRadius: \"999px\",\n                  backgroundColor: swatchColor,\n                  border: \"1px solid\",\n                  borderColor: \"muted\",\n                }}\n              />\n            </IconButton>\n            {colorMenuOpen && (\n              <Box\n                sx={{\n                  position: \"absolute\",\n                  top: \"calc(100% + 6px)\",\n                  left: 0,\n                  backgroundColor: \"rgba(20, 20, 24, 0.98)\",\n                  borderRadius: \"12px\",\n                  p: 2,\n                  boxShadow: \"0 8px 24px rgba(0, 0, 0, 0.4)\",\n                  width: \"116px\",\n                }}\n              >\n                <Box\n                  sx={{\n                    display: \"grid\",\n                    gridTemplateColumns: \"repeat(3, 12px)\",\n                    gap: \"6px\",\n                    mb: 2,\n                  }}\n                >\n                  {palette.map((colorKey) => (\n                    <Box\n                      key={colorKey}\n                      sx={{\n                        width: \"12px\",\n                        height: \"12px\",\n                        borderRadius: \"999px\",\n                        backgroundColor: colors[colorKey],\n                        outline:\n                          draftStyle.textColor === colorKey\n                            ? \"2px solid white\"\n                            : \"none\",\n                        cursor: \"pointer\",\n                      }}\n                      onClick={() => {\n                        setHexValue(colors[colorKey]);\n                        onStyleChange({ textColor: colorKey });\n                        setColorMenuOpen(false);\n                      }}\n                      aria-label={`Text color ${colorKey}`}\n                    />\n                  ))}\n                </Box>\n                <Input\n                  value={hexValue}\n                  onChange={(event) => setHexValue(event.target.value)}\n                  onBlur={(event) => handleHexCommit(event.target.value)}\n                  sx={{ width: \"100%\", height: \"26px\", fontSize: 1 }}\n                />\n              </Box>\n            )}\n          </Box>\n          <IconButton\n            onClick={handleBackgroundToggle}\n            title=\"Toggle background\"\n            aria-label=\"Toggle background\"\n            sx={buttonSx(draftStyle.backgroundMode !== \"none\")}\n            disabled={!canEdit}\n          >\n            <Box\n              sx={{\n                width: \"14px\",\n                height: \"14px\",\n                borderRadius: \"999px\",\n                border: \"1px solid\",\n                borderColor: \"text\",\n                position: \"relative\",\n                \"&::after\": {\n                  content: '\"\"',\n                  position: \"absolute\",\n                  left: \"-2px\",\n                  right: \"-2px\",\n                  top: \"50%\",\n                  height: \"1px\",\n                  backgroundColor: \"text\",\n                  transform: \"rotate(-45deg)\",\n                },\n              }}\n            />\n          </IconButton>\n          <Box sx={{ position: \"relative\" }}>\n            <Box\n              as=\"button\"\n              onClick={() => {\n                if (!canEdit) {\n                  return;\n                }\n                setFontMenuOpen((prev) => !prev);\n                setSizeMenuOpen(false);\n                setColorMenuOpen(false);\n              }}\n              sx={{ ...pillButtonSx(fontMenuOpen), minWidth: \"96px\" }}\n              aria-disabled={!canEdit}\n            >\n              {currentFontLabel}\n            </Box>\n            {fontMenuOpen && (\n              <Box sx={menuSx}>\n                {fontOptions.map((option) => {\n                  const active = option.value === draftStyle.fontFamily;\n                  return (\n                    <Box\n                      key={option.value}\n                      as=\"button\"\n                      onClick={() => {\n                        onStyleChange({\n                          fontFamily: option.value as NoteStyle[\"fontFamily\"],\n                        });\n                        setFontMenuOpen(false);\n                      }}\n                      sx={{\n                        display: \"block\",\n                        width: \"100%\",\n                        textAlign: \"left\",\n                        background: \"transparent\",\n                        border: \"none\",\n                        color: \"text\",\n                        px: 2,\n                        py: 1,\n                        borderRadius: \"8px\",\n                        cursor: \"pointer\",\n                        fontSize: 1,\n                        backgroundColor: active\n                          ? \"rgba(255, 255, 255, 0.12)\"\n                          : \"transparent\",\n                        \"&:hover\": {\n                          backgroundColor: \"rgba(255, 255, 255, 0.08)\",\n                        },\n                      }}\n                    >\n                      {option.label}\n                    </Box>\n                  );\n                })}\n              </Box>\n            )}\n          </Box>\n          <Box sx={{ position: \"relative\" }}>\n            <Box\n              as=\"button\"\n              onClick={() => {\n                if (!canEdit) {\n                  return;\n                }\n                setSizeMenuOpen((prev) => !prev);\n                setFontMenuOpen(false);\n                setColorMenuOpen(false);\n              }}\n              sx={{ ...pillButtonSx(sizeMenuOpen), minWidth: \"64px\" }}\n              aria-disabled={!canEdit}\n            >\n              {currentSizeLabel}\n            </Box>\n            {sizeMenuOpen && (\n              <Box sx={{ ...menuSx, minWidth: \"100px\" }}>\n                {sizeOptions.map((option) => {\n                  const active =\n                    option.fontScale === draftStyle.fontScale ||\n                    option.fontSize === draftStyle.fontSize;\n                  return (\n                    <Box\n                      key={option.fontScale}\n                      as=\"button\"\n                      onClick={() => {\n                        onStyleChange({\n                          fontScale: option.fontScale as NoteStyle[\"fontScale\"],\n                          fontSize: option.fontSize,\n                        });\n                        setSizeMenuOpen(false);\n                      }}\n                      sx={{\n                        display: \"block\",\n                        width: \"100%\",\n                        textAlign: \"center\",\n                        background: \"transparent\",\n                        border: \"none\",\n                        color: \"text\",\n                        px: 2,\n                        py: 1,\n                        borderRadius: \"8px\",\n                        cursor: \"pointer\",\n                        fontSize: 1,\n                        backgroundColor: active\n                          ? \"rgba(255, 255, 255, 0.12)\"\n                          : \"transparent\",\n                        \"&:hover\": {\n                          backgroundColor: \"rgba(255, 255, 255, 0.08)\",\n                        },\n                      }}\n                    >\n                      {option.label}\n                    </Box>\n                  );\n                })}\n              </Box>\n            )}\n          </Box>\n        </Flex>\n        <Divider vertical />\n        <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n          <IconButton\n            onClick={() => onCommand(\"bold\")}\n            title=\"Bold\"\n            aria-label=\"Bold\"\n            sx={buttonSx(formatState.bold)}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontWeight: \"bold\" }}>B</Text>\n          </IconButton>\n          <IconButton\n            onClick={() => onCommand(\"italic\")}\n            title=\"Italic\"\n            aria-label=\"Italic\"\n            sx={buttonSx(formatState.italic)}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontStyle: \"italic\" }}>I</Text>\n          </IconButton>\n        </Flex>\n        <Divider vertical />\n        <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n          <IconButton\n            onClick={() => onCommand(\"insertUnorderedList\")}\n            title=\"Bullet list\"\n            aria-label=\"Bullet list\"\n            sx={buttonSx(formatState.ul)}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontSize: 1 }}></Text>\n          </IconButton>\n          <IconButton\n            onClick={() => onCommand(\"insertOrderedList\")}\n            title=\"Numbered list\"\n            aria-label=\"Numbered list\"\n            sx={buttonSx(formatState.ol)}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontSize: 1 }}>1.</Text>\n          </IconButton>\n          <IconButton\n            onClick={() => onCommand(\"formatBlock\", \"H1\")}\n            title=\"Header 1\"\n            aria-label=\"Header 1\"\n            sx={buttonSx()}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontSize: 1 }}>H1</Text>\n          </IconButton>\n          <IconButton\n            onClick={() => onCommand(\"formatBlock\", \"H2\")}\n            title=\"Header 2\"\n            aria-label=\"Header 2\"\n            sx={buttonSx()}\n            disabled={!canEdit}\n          >\n            <Text sx={{ fontSize: 1 }}>H2</Text>\n          </IconButton>\n        </Flex>\n        <Divider vertical />\n        <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n          {canManage && (\n            <>\n              <IconButton\n                onClick={onToggleAttach}\n                title={attachMode ? \"Click token to attach\" : \"Attach to token\"}\n                aria-label=\"Attach to token\"\n                sx={buttonSx(attachMode || !!note.attachedToTokenId)}\n              >\n                <Text sx={{ fontSize: 1 }}>Link</Text>\n              </IconButton>\n              <IconButton\n                onClick={onToggleVisibility}\n                title=\"Toggle visibility\"\n                aria-label=\"Toggle visibility\"\n                sx={buttonSx()}\n              >\n                <Text sx={{ fontSize: 1 }}>{visibilityLabel}</Text>\n              </IconButton>\n              <IconButton\n                onClick={onToggleTextVisible}\n                title=\"Toggle text visibility\"\n                aria-label=\"Toggle text visibility\"\n                sx={buttonSx(note.textVisible === false)}\n              >\n                <Text sx={{ fontSize: 1 }}>Txt</Text>\n              </IconButton>\n            </>\n          )}\n          <IconButton\n            onClick={onRequestClose}\n            title=\"Done\"\n            aria-label=\"Done\"\n            sx={buttonSx()}\n          >\n            <Text sx={{ fontSize: 1 }}>OK</Text>\n          </IconButton>\n        </Flex>\n      </Flex>\n    </Box>\n  );\n}\n\nexport default AdvancedTextHud;\n","import { useEffect } from \"react\";\nimport { Box } from \"theme-ui\";\n\ntype NoteEditorProps = {\n  html: string;\n  editorRef: React.RefObject<HTMLDivElement>;\n  autoFocus: boolean;\n  fontFamily: string;\n  fontSize: number;\n  color: string;\n  padding?: number;\n  width?: number;\n  onChange: (html: string) => void;\n  onDone: () => void;\n};\n\nfunction NoteEditor({\n  html,\n  editorRef,\n  autoFocus,\n  fontFamily,\n  fontSize,\n  color,\n  padding,\n  width,\n  onChange,\n  onDone,\n}: NoteEditorProps) {\n  const widthStyle =\n    typeof width === \"number\" ? `${width}px` : \"fit-content\";\n  const paddingStyle =\n    typeof padding === \"number\" ? `${padding}px` : \"0px\";\n\n  useEffect(() => {\n    const node = editorRef.current;\n    if (!node) {\n      return;\n    }\n    if (node.innerHTML !== html) {\n      node.innerHTML = html;\n    }\n  }, [editorRef, html]);\n\n  useEffect(() => {\n    if (!autoFocus) {\n      return;\n    }\n    const node = editorRef.current;\n    if (!node) {\n      return;\n    }\n    node.focus();\n  }, [autoFocus, editorRef]);\n\n  function handleInput(event: React.FormEvent<HTMLDivElement>) {\n    onChange(event.currentTarget.innerHTML);\n  }\n\n  function handleKeyDown(event: React.KeyboardEvent<HTMLDivElement>) {\n    if ((event.ctrlKey || event.metaKey) && event.key === \"Enter\") {\n      event.preventDefault();\n      onDone();\n    }\n  }\n\n  return (\n    <Box\n      as=\"div\"\n      ref={editorRef}\n      contentEditable\n      suppressContentEditableWarning\n      onInput={handleInput}\n      onKeyDown={handleKeyDown}\n      sx={{\n        outline: \"none\",\n        display: \"inline-block\",\n        width: widthStyle,\n        color,\n        fontFamily,\n        fontSize: `${fontSize}px`,\n        lineHeight: 1.2,\n        padding: paddingStyle,\n        whiteSpace: \"pre-wrap\",\n        wordBreak: \"break-word\",\n        \"& p\": { margin: 0 },\n        \"& h1\": { margin: 0, fontSize: \"1.6em\", fontWeight: 700 },\n        \"& h2\": { margin: 0, fontSize: \"1.2em\", fontWeight: 700 },\n        \"& ul, & ol\": { margin: 0, paddingLeft: \"1.2em\" },\n      }}\n    />\n  );\n}\n\nNoteEditor.defaultProps = {\n  autoFocus: false,\n};\n\nexport default NoteEditor;\n","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Box } from \"theme-ui\";\n\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport {\n  useInteractionEmitter,\n  useMapWidth,\n  useMapHeight,\n  useStageScale,\n  useSetPreventMapInteraction,\n} from \"../../contexts/MapInteractionContext\";\nimport { useGridCellPixelSize } from \"../../contexts/GridContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport { Map } from \"../../types/Map\";\nimport { Note, NoteStyle } from \"../../types/Note\";\nimport { getNoteContent, getNoteContentFormat, getNoteVisibility, resolveColor } from \"../../helpers/notes\";\nimport NoteEditor from \"./NoteEditor\";\nimport useDebounce from \"../../hooks/useDebounce\";\n\ntype NoteTextOverlayProps = {\n  map: Map | null;\n  notes: Note[];\n  activeNoteId: string | null;\n  draftContent: string;\n  draftStyle: NoteStyle | null;\n  isEditing: boolean;\n  editorRef: React.RefObject<HTMLDivElement>;\n  autoFocus: boolean;\n  onContentChange: (html: string) => void;\n  onDone: () => void;\n  onRequestSizeChange?: (noteId: string, size: number) => void;\n};\n\nfunction NoteTextOverlay({\n  map,\n  notes,\n  activeNoteId,\n  draftContent,\n  draftStyle,\n  isEditing,\n  editorRef,\n  autoFocus,\n  onContentChange,\n  onDone,\n  onRequestSizeChange,\n}: NoteTextOverlayProps) {\n  const mapStageRef = useMapStage();\n  const interactionEmitter = useInteractionEmitter();\n  const setPreventMapInteraction = useSetPreventMapInteraction();\n  const userId = useUserId();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const stageScale = useStageScale();\n  const gridCellPixelSize = useGridCellPixelSize();\n  const [, setTick] = useState(0);\n  const frameRef = useRef<number | null>(null);\n  const debouncedContent = useDebounce(draftContent, 200);\n\n  const scheduleUpdate = useCallback(() => {\n    if (frameRef.current) {\n      return;\n    }\n    frameRef.current = requestAnimationFrame(() => {\n      frameRef.current = null;\n      setTick((prev) => prev + 1);\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!interactionEmitter) {\n      return;\n    }\n    interactionEmitter.on(\"dragStart\", scheduleUpdate);\n    interactionEmitter.on(\"drag\", scheduleUpdate);\n    interactionEmitter.on(\"dragEnd\", scheduleUpdate);\n    window.addEventListener(\"resize\", scheduleUpdate);\n    return () => {\n      interactionEmitter.off(\"dragStart\", scheduleUpdate);\n      interactionEmitter.off(\"drag\", scheduleUpdate);\n      interactionEmitter.off(\"dragEnd\", scheduleUpdate);\n      window.removeEventListener(\"resize\", scheduleUpdate);\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current);\n        frameRef.current = null;\n      }\n    };\n  }, [interactionEmitter, scheduleUpdate]);\n\n  useEffect(() => {\n    scheduleUpdate();\n  }, [scheduleUpdate, stageScale, mapWidth, mapHeight]);\n\n  useEffect(() => {\n    if (!isEditing || !activeNoteId || !onRequestSizeChange) {\n      return;\n    }\n    const activeNote = notes.find((note) => note.id === activeNoteId);\n    if (!activeNote) {\n      return;\n    }\n    const effectiveStyle =\n      draftStyle && activeNote.id === activeNoteId\n        ? draftStyle\n        : activeNote.style;\n    const backgroundMode =\n      effectiveStyle?.backgroundMode || (activeNote.textOnly ? \"none\" : \"frame\");\n    if (backgroundMode !== \"none\") {\n      return;\n    }\n    const editorNode = editorRef.current;\n    if (!editorNode) {\n      return;\n    }\n    const minCellSize = Math.min(\n      gridCellPixelSize.width,\n      gridCellPixelSize.height\n    );\n    if (!minCellSize || !stageScale) {\n      return;\n    }\n    const width = Math.max(editorNode.scrollWidth, editorNode.clientWidth);\n    const height = Math.max(editorNode.scrollHeight, editorNode.clientHeight);\n    const maxSizePx = Math.max(width, height);\n    if (!Number.isFinite(maxSizePx) || maxSizePx <= 0) {\n      return;\n    }\n    const nextSize = maxSizePx / (minCellSize * stageScale);\n    if (!Number.isFinite(nextSize) || nextSize <= 0) {\n      return;\n    }\n    const clampedSize = Math.max(nextSize, 0.5);\n    if (Math.abs(clampedSize - activeNote.size) < 0.05) {\n      return;\n    }\n    onRequestSizeChange(activeNoteId, clampedSize);\n  }, [\n    activeNoteId,\n    debouncedContent,\n    draftStyle,\n    editorRef,\n    gridCellPixelSize,\n    isEditing,\n    notes,\n    onRequestSizeChange,\n    stageScale,\n  ]);\n\n  useEffect(() => {\n    setPreventMapInteraction(isEditing);\n    return () => setPreventMapInteraction(false);\n  }, [isEditing, setPreventMapInteraction]);\n\n  const minCellSize = Math.min(\n    gridCellPixelSize.width,\n    gridCellPixelSize.height\n  );\n\n  const renderedNotes = notes.filter(\n    (note) => getNoteContentFormat(note) === \"html\" || note.id === activeNoteId\n  );\n  const mapStage = mapStageRef.current;\n  const mapImage = mapStage?.findOne(\"#mapImage\");\n\n  if (!mapStage || !mapImage) {\n    return null;\n  }\n\n  return (\n    <Box\n      sx={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        pointerEvents: \"none\",\n        zIndex: 20,\n      }}\n    >\n      {renderedNotes.map((note) => {\n        const { canView, canViewText } = getNoteVisibility(note, map, userId || undefined);\n        if (!canView || !canViewText) {\n          return null;\n        }\n        const noteWidth = minCellSize * note.size;\n        const notePadding = noteWidth / 10;\n        const effectiveStyle =\n          note.id === activeNoteId && draftStyle ? draftStyle : note.style;\n        const fontScale = effectiveStyle?.fontScale || \"md\";\n        const fontScaleMap: Record<string, number> = {\n          xs: 0.5,\n          sm: 0.75,\n          md: 1,\n          lg: 1.5,\n          xl: 2,\n          huge: 3,\n        };\n        const fontFactor =\n          typeof effectiveStyle?.fontSize === \"number\"\n            ? effectiveStyle.fontSize\n            : fontScaleMap[fontScale] ?? 1;\n        const fontSize = minCellSize * fontFactor * stageScale;\n        const fontFamily =\n          effectiveStyle?.fontFamily === \"handwritten\"\n            ? \"Pacifico, cursive\"\n            : effectiveStyle?.fontFamily === \"runic\"\n                ? \"Bree Serif, serif\"\n              : effectiveStyle?.fontFamily === \"serif\"\n                ? \"Georgia, serif\"\n                : \"Arial, sans-serif\";\n        const backgroundMode = effectiveStyle?.backgroundMode || \"none\";\n        const textColor =\n          backgroundMode === \"frame\"\n            ? \"black\"\n            : resolveColor(effectiveStyle?.textColor, \"white\");\n        const hasBackground = backgroundMode !== \"none\";\n        const width = hasBackground ? noteWidth * stageScale : undefined;\n        const padding = hasBackground ? notePadding * stageScale : 0;\n        const dimOpacity =\n          note.visible === false && map?.owner === userId ? 0.5 : 1;\n\n        const absolute = mapImage\n          .getAbsoluteTransform()\n          .copy()\n          .point({ x: note.x * mapWidth, y: note.y * mapHeight });\n        const left = absolute.x;\n        const top = absolute.y;\n        const rotation = note.rotation || 0;\n        const isActive = note.id === activeNoteId;\n        const html = isActive ? draftContent : getNoteContent(note);\n\n        return (\n          <Box\n            key={note.id}\n            sx={{\n              position: \"absolute\",\n              left: `${left}px`,\n              top: `${top}px`,\n              transform: `translate(-50%, -50%) rotate(${rotation}deg)`,\n              transformOrigin: \"center\",\n              pointerEvents: isActive && isEditing ? \"auto\" : \"none\",\n              opacity: dimOpacity,\n            }}\n          >\n            {isActive && isEditing ? (\n              <NoteEditor\n                html={html}\n                editorRef={editorRef}\n                autoFocus={autoFocus}\n                fontFamily={fontFamily}\n                fontSize={fontSize}\n                color={textColor}\n                padding={padding}\n                width={width}\n                onChange={onContentChange}\n                onDone={onDone}\n              />\n            ) : (\n              <Box\n                as=\"div\"\n                sx={{\n                  display: \"inline-block\",\n                  width: width ? `${width}px` : \"fit-content\",\n                  color: textColor,\n                  fontFamily,\n                  fontSize: `${fontSize}px`,\n                  lineHeight: 1.2,\n                  padding: `${padding}px`,\n                  whiteSpace: \"pre-wrap\",\n                  wordBreak: \"break-word\",\n                  \"& p\": { margin: 0 },\n                  \"& h1\": { margin: 0, fontSize: \"1.6em\", fontWeight: 700 },\n                  \"& h2\": { margin: 0, fontSize: \"1.2em\", fontWeight: 700 },\n                  \"& ul, & ol\": { margin: 0, paddingLeft: \"1.2em\" },\n                }}\n                dangerouslySetInnerHTML={{ __html: html }}\n              />\n            )}\n          </Box>\n        );\n      })}\n    </Box>\n  );\n}\n\nexport default NoteTextOverlay;\n","import { Rect } from \"react-konva\";\n\nimport {\n  useMapWidth,\n  useMapHeight,\n} from \"../../contexts/MapInteractionContext\";\nimport { useGridCellPixelSize } from \"../../contexts/GridContext\";\n\nimport colors from \"../../helpers/colors\";\n\nimport { Note as NoteType } from \"../../types/Note\";\n\ntype NoteProps = {\n  note: NoteType;\n};\n\nfunction BlankNote({ note }: NoteProps) {\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n\n  const gridCellPixelSize = useGridCellPixelSize();\n\n  const minCellSize = Math.min(\n    gridCellPixelSize.width,\n    gridCellPixelSize.height\n  );\n  const noteWidth = minCellSize * note.size;\n  const noteHeight = noteWidth;\n\n  return (\n    <Rect\n      x={note.x * mapWidth}\n      y={note.y * mapHeight}\n      width={noteWidth}\n      height={noteHeight}\n      offsetX={noteWidth / 2}\n      offsetY={noteHeight / 2}\n      shadowColor=\"rgba(0, 0, 0, 0.16)\"\n      shadowOffset={{ x: 3, y: 6 }}\n      shadowBlur={6}\n      cornerRadius={0.25}\n      fill={colors[note.color]}\n    />\n  );\n}\n\nexport default BlankNote;\n","import { useState, useEffect, useRef } from \"react\";\nimport shortid from \"shortid\";\nimport { Group } from \"react-konva\";\nimport Konva from \"konva\";\n\nimport {\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport Vector2 from \"../../helpers/Vector2\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\n\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nimport BlankNote from \"../konva/BlankNote\";\n\nimport { Map } from \"../../types/Map\";\nimport { Note as NoteType } from \"../../types/Note\";\nimport {\n  NoteCreateEventHander,\n  NoteMenuOpenEventHandler,\n} from \"../../types/Events\";\n\nconst defaultNoteSize = 2;\n\ntype MapNoteProps = {\n  map: Map | null;\n  active: boolean;\n  mode: \"note\" | \"text\";\n  onNoteCreate: NoteCreateEventHander;\n  onNoteMenuOpen: NoteMenuOpenEventHandler;\n};\n\nfunction NoteTool({\n  map,\n  active,\n  mode,\n  onNoteCreate,\n  onNoteMenuOpen,\n}: MapNoteProps) {\n  const interactionEmitter = useInteractionEmitter();\n  const userId = useUserId();\n  const mapStageRef = useMapStage();\n  const [noteData, setNoteData] = useState<NoteType | null>(null);\n\n  const creatingNoteRef = useRef<Konva.Group>(null);\n\n  const snapPositionToGrid = useGridSnapping();\n\n  useEffect(() => {\n    if (!active) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n\n    function getBrushPosition() {\n      if (!mapStage) {\n        return;\n      }\n      const mapImage = mapStage.findOne(\"#mapImage\");\n      let position = getRelativePointerPosition(mapImage);\n      if (!position) {\n        return;\n      }\n      if (map?.snapToGrid) {\n        position = snapPositionToGrid(position);\n      }\n      return Vector2.divide(position, {\n        x: mapImage.width(),\n        y: mapImage.height(),\n      });\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition || !userId) {\n        return;\n      }\n      const isText = mode === \"text\";\n      setNoteData({\n        x: brushPosition.x,\n        y: brushPosition.y,\n        size: defaultNoteSize,\n        text: \"\",\n        id: shortid.generate(),\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n        visible: true,\n        locked: false,\n        color: isText ? \"white\" : \"yellow\",\n        textOnly: isText,\n        ...(isText\n          ? {\n              content: \"\",\n              contentFormat: \"html\",\n              style: {\n                textColor: \"white\",\n                backgroundMode: \"none\",\n                fontFamily: \"rounded\",\n                fontScale: \"md\",\n                fontSize: 1,\n              },\n            }\n          : {}),\n        ownerId: userId,\n        visibility: \"all\",\n        textVisible: true,\n        rotation: 0,\n      });\n      if (creatingNoteRef.current) {\n        creatingNoteRef.current.visible(true);\n      }\n    }\n\n    function handleBrushMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (noteData) {\n        const brushPosition = getBrushPosition();\n        if (!brushPosition) {\n          return;\n        }\n        setNoteData((prev) => {\n          if (!prev) {\n            return prev;\n          }\n          return {\n            ...prev,\n            x: brushPosition.x,\n            y: brushPosition.y,\n          };\n        });\n      }\n    }\n\n    function handleBrushUp(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (noteData && creatingNoteRef.current) {\n        onNoteCreate([noteData]);\n        onNoteMenuOpen(noteData.id, creatingNoteRef.current, true);\n        // Hide creating note tool here as settings noteData to null\n        // was causing performance issues in FireFox\n        creatingNoteRef.current.visible(false);\n      }\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n    };\n  }, [\n    active,\n    interactionEmitter,\n    map,\n    mapStageRef,\n    noteData,\n    snapPositionToGrid,\n    userId,\n    mode,\n    onNoteCreate,\n    onNoteMenuOpen,\n  ]);\n\n  return (\n    <Group ref={creatingNoteRef}>\n      {noteData && !noteData.textOnly && <BlankNote note={noteData} />}\n    </Group>\n  );\n}\n\nexport default NoteTool;\n","import Konva from \"konva\";\nimport { Group } from \"react-konva\";\nimport { KonvaEventObject } from \"konva/lib/Node\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuid } from \"uuid\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport Note from \"../components/konva/Note\";\nimport NoteDragOverlay from \"../components/note/NoteDragOverlay\";\nimport NoteMenu from \"../components/note/NoteMenu\";\nimport AdvancedTextHud from \"../components/note/AdvancedTextHud\";\nimport NoteTextOverlay from \"../components/note/NoteTextOverlay\";\nimport NoteTool from \"../components/tools/NoteTool\";\nimport { useBlur, useKeyboard } from \"../contexts/KeyboardContext\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useMapStage } from \"../contexts/MapStageContext\";\nimport shortcuts from \"../shortcuts\";\nimport {\n  NoteChangeEventHandler,\n  NoteCreateEventHander,\n  NoteRemoveEventHander,\n} from \"../types/Events\";\nimport { Map, MapToolId } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport {\n  Note as NoteType,\n  NoteDraggingOptions,\n  NoteMenuOptions,\n  NoteStyle,\n} from \"../types/Note\";\nimport useDebounce from \"./useDebounce\";\nimport { getNoteContent, getNoteContentFormat } from \"../helpers/notes\";\n\nconst defaultNoteStyle: NoteStyle = {\n  textColor: \"white\",\n  backgroundMode: \"frame\",\n  fontFamily: \"rounded\",\n  fontScale: \"md\",\n  fontSize: 1,\n};\n\nconst fontScaleMap: Record<NoteStyle[\"fontScale\"], number> = {\n  xs: 0.5,\n  sm: 0.75,\n  md: 1,\n  lg: 1.5,\n  xl: 2,\n  huge: 3,\n};\n\nfunction escapeHtml(value: string) {\n  return value\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\");\n}\n\nfunction plainToHtml(value: string) {\n  return escapeHtml(value).replace(/\\n/g, \"<br />\");\n}\n\nfunction htmlToPlain(value: string) {\n  const container = document.createElement(\"div\");\n  container.innerHTML = value;\n  return container.textContent || \"\";\n}\n\nfunction resolveDraftStyle(note: NoteType): NoteStyle {\n  if (note.style) {\n    return {\n      ...note.style,\n      fontSize:\n        typeof note.style.fontSize === \"number\"\n          ? note.style.fontSize\n          : fontScaleMap[note.style.fontScale || \"md\"],\n    };\n  }\n  return {\n    textColor: note.textOnly ? note.color : \"black\",\n    backgroundMode: note.textOnly ? \"none\" : \"frame\",\n    fontFamily: \"rounded\",\n    fontScale: \"md\",\n    fontSize: 1,\n  };\n}\n\nfunction resolveHtmlContent(note: NoteType) {\n  if (getNoteContentFormat(note) === \"html\") {\n    return getNoteContent(note);\n  }\n  return plainToHtml(note.text || \"\");\n}\n\nfunction useMapNotes(\n  map: Map | null,\n  mapState: MapState | null,\n  onNoteCreate: NoteCreateEventHander,\n  onNoteChange: NoteChangeEventHandler,\n  onNoteRemove: NoteRemoveEventHander,\n  selectedToolId: MapToolId\n) {\n  const { addToast } = useToasts();\n  const userId = useUserId();\n  const mapStageRef = useMapStage();\n  const allowNoteEditing = !!(\n    map?.owner === userId || mapState?.editFlags.includes(\"notes\")\n  );\n  const canManage = !!userId && map?.owner === userId;\n\n  const [noteDraggingOptions, setNoteDraggingOptions] =\n    useState<NoteDraggingOptions>();\n  const [isNoteMenuOpen, setIsNoteMenuOpen] = useState(false);\n  const [noteMenuOptions, setNoteMenuOptions] = useState<NoteMenuOptions>();\n  const [activeNoteId, setActiveNoteId] = useState<string | null>(null);\n  const [isHudOpen, setIsHudOpen] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [draftContent, setDraftContent] = useState(\"\");\n  const [draftStyle, setDraftStyle] = useState<NoteStyle>(defaultNoteStyle);\n  const [autoFocusEditor, setAutoFocusEditor] = useState(false);\n  const [attachMode, setAttachMode] = useState(false);\n  const [hasEdited, setHasEdited] = useState(false);\n  const editorRef = useRef<HTMLDivElement | null>(null);\n  const lastRemoteEditRef = useRef<number>(0);\n\n  const activeNote = activeNoteId ? mapState?.notes[activeNoteId] : undefined;\n\n  function handleNoteMenuOpen(\n    noteId: string,\n    noteNode: Konva.Node,\n    focus: boolean\n  ) {\n    setNoteMenuOptions({ noteId, noteNode, focus });\n    setIsNoteMenuOpen(true);\n  }\n\n  function handleTextHudOpen(\n    noteId: string,\n    _noteNode: Konva.Node,\n    focus: boolean\n  ) {\n    setActiveNoteId(noteId);\n    setIsNoteMenuOpen(false);\n    setIsHudOpen(true);\n    setIsEditing(true);\n    setHasEdited(false);\n    setAutoFocusEditor(focus);\n    setAttachMode(false);\n  }\n\n  const commitDraftContent = useCallback((note: NoteType) => {\n    if (!activeNoteId || !allowNoteEditing || !userId) {\n      return;\n    }\n    if (!hasEdited) {\n      return;\n    }\n    if (draftContent === (note.content || \"\")) {\n      return;\n    }\n    const nextStyle = note.style || draftStyle;\n    const noteId = activeNoteId;\n    if (!noteId) {\n      return;\n    }\n    onNoteChange({\n      [noteId]: {\n        content: draftContent,\n        contentFormat: \"html\",\n        text: htmlToPlain(draftContent),\n        style: nextStyle,\n        textOnly: nextStyle.backgroundMode === \"none\",\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }, [\n    activeNoteId,\n    allowNoteEditing,\n    userId,\n    hasEdited,\n    draftContent,\n    draftStyle,\n    onNoteChange,\n  ]);\n\n  const handleNoteMenuClose = useCallback(() => {\n    setIsNoteMenuOpen(false);\n  }, []);\n\n  const handleTextHudClose = useCallback(() => {\n    if (activeNote) {\n      commitDraftContent(activeNote);\n    }\n    setIsHudOpen(false);\n    setIsEditing(false);\n    setActiveNoteId(null);\n    setAttachMode(false);\n    setAutoFocusEditor(false);\n    setHasEdited(false);\n  }, [activeNote, commitDraftContent]);\n\n  function handleNoteDragStart(_: KonvaEventObject<DragEvent>, noteId: string) {\n    if (duplicateNote) {\n      const note = mapState?.notes[noteId];\n      if (note) {\n        onNoteCreate([{ ...note, id: uuid() }]);\n      }\n    }\n    setNoteDraggingOptions({ dragging: true, noteId });\n  }\n\n  function handleNoteDragEnd() {\n    noteDraggingOptions &&\n      setNoteDraggingOptions({ ...noteDraggingOptions, dragging: false });\n  }\n\n  function handleNoteRemove(noteIds: string[]) {\n    onNoteRemove(noteIds);\n    setNoteDraggingOptions(undefined);\n  }\n\n  const [duplicateNote, setDuplicateNote] = useState(false);\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateNote(true);\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateNote(false);\n    }\n  }\n\n  function handleBlur() {\n    setDuplicateNote(false);\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n  useBlur(handleBlur);\n\n  useEffect(() => {\n    if (!activeNoteId) {\n      setDraftContent(\"\");\n      setDraftStyle(defaultNoteStyle);\n      lastRemoteEditRef.current = 0;\n      return;\n    }\n    if (!activeNote) {\n      return;\n    }\n    const isRemote =\n      !!userId &&\n      activeNote.lastModifiedBy &&\n      activeNote.lastModifiedBy !== userId;\n    if (isRemote && activeNote.lastModified !== lastRemoteEditRef.current) {\n      lastRemoteEditRef.current = activeNote.lastModified;\n      if (isEditing) {\n        addToast(\"\");\n        return;\n      }\n      setDraftContent(resolveHtmlContent(activeNote));\n      setDraftStyle(resolveDraftStyle(activeNote));\n      return;\n    }\n    if (!isEditing) {\n      setDraftContent(resolveHtmlContent(activeNote));\n      setDraftStyle(resolveDraftStyle(activeNote));\n    }\n  }, [activeNote, activeNoteId, addToast, isEditing, userId]);\n\n  useEffect(() => {\n    if (\n      isHudOpen &&\n      selectedToolId !== \"text\" &&\n      selectedToolId !== \"move\" &&\n      selectedToolId !== \"select\"\n    ) {\n      handleTextHudClose();\n    }\n    if (isNoteMenuOpen && selectedToolId === \"text\") {\n      handleNoteMenuClose();\n    }\n  }, [handleNoteMenuClose, handleTextHudClose, isHudOpen, isNoteMenuOpen, selectedToolId]);\n\n  useEffect(() => {\n    if (autoFocusEditor && editorRef.current) {\n      setAutoFocusEditor(false);\n    }\n  }, [autoFocusEditor]);\n\n  useEffect(() => {\n    if (!isEditing) {\n      return;\n    }\n    function handlePointerDown(event: MouseEvent | TouchEvent) {\n      const target = event.target as Node | null;\n      if (!target) {\n        return;\n      }\n      const editorNode = editorRef.current;\n      if (editorNode && editorNode.contains(target)) {\n        return;\n      }\n      const hudNode = document.querySelector(\"[data-text-hud='true']\");\n      if (hudNode && hudNode.contains(target)) {\n        return;\n      }\n      handleTextHudClose();\n    }\n    document.addEventListener(\"mousedown\", handlePointerDown);\n    document.addEventListener(\"touchstart\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"mousedown\", handlePointerDown);\n      document.removeEventListener(\"touchstart\", handlePointerDown);\n    };\n  }, [isEditing, handleTextHudClose]);\n\n  useEffect(() => {\n    if (!attachMode || !activeNoteId || !mapStageRef.current || !userId) {\n      return;\n    }\n    const stage = mapStageRef.current;\n    function handlePointerUp() {\n      const pointerPosition = stage.getPointerPosition();\n      if (!pointerPosition) {\n        setAttachMode(false);\n        return;\n      }\n      const shape = stage.getIntersection(pointerPosition);\n      let node: Konva.Node | null = shape || null;\n      let tokenId: string | null = null;\n      while (node) {\n        const id = node.id();\n        if (id && mapState?.tokens[id]) {\n          tokenId = id;\n          break;\n        }\n        node = node.getParent();\n      }\n      if (tokenId) {\n        const noteId = activeNoteId;\n        if (!noteId) {\n          setAttachMode(false);\n          return;\n        }\n        onNoteChange({\n          [noteId]: {\n            attachedToTokenId: tokenId,\n            lastModified: Date.now(),\n            lastModifiedBy: userId,\n          },\n        });\n      }\n      setAttachMode(false);\n    }\n    stage.on(\"pointerup\", handlePointerUp);\n    return () => {\n      stage.off(\"pointerup\", handlePointerUp);\n    };\n  }, [attachMode, activeNoteId, mapStageRef, mapState, onNoteChange, userId]);\n\n  const debouncedContent = useDebounce(draftContent, 400);\n\n  function handleTextSizeChange(noteId: string, size: number) {\n    if (!allowNoteEditing || !userId) {\n      return;\n    }\n    onNoteChange({\n      [noteId]: {\n        size,\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }\n\n  useEffect(() => {\n    if (\n      !activeNoteId ||\n      !activeNote ||\n      !allowNoteEditing ||\n      !isEditing ||\n      !userId\n    ) {\n      return;\n    }\n    if (!hasEdited) {\n      return;\n    }\n    if (debouncedContent === undefined) {\n      return;\n    }\n    if (!activeNoteId) {\n      return;\n    }\n    if (debouncedContent === (activeNote.content || \"\")) {\n      return;\n    }\n    const nextStyle = activeNote.style || draftStyle;\n    const noteId = activeNoteId;\n    if (!noteId) {\n      return;\n    }\n    onNoteChange({\n      [noteId]: {\n        content: debouncedContent,\n        contentFormat: \"html\",\n        text: htmlToPlain(debouncedContent),\n        style: nextStyle,\n        textOnly: nextStyle.backgroundMode === \"none\",\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }, [\n    activeNote,\n    activeNoteId,\n    allowNoteEditing,\n    debouncedContent,\n    draftStyle,\n    hasEdited,\n    isEditing,\n    onNoteChange,\n    userId,\n  ]);\n\n  useEffect(() => {\n    if (!activeNoteId || !mapState) {\n      return;\n    }\n    if (!mapState.notes[activeNoteId]) {\n      handleTextHudClose();\n    }\n  }, [activeNoteId, handleTextHudClose, mapState]);\n\n  function handleContentChange(value: string) {\n    if (!allowNoteEditing) {\n      return;\n    }\n    if (!isEditing) {\n      setIsEditing(true);\n    }\n    if (!hasEdited) {\n      setHasEdited(true);\n    }\n    setDraftContent(value);\n  }\n\n  function handleStyleChange(change: Partial<NoteStyle>) {\n    if (!allowNoteEditing || !activeNoteId || !userId) {\n      return;\n    }\n    const nextStyle = { ...draftStyle, ...change };\n    setDraftStyle(nextStyle);\n    if (!hasEdited) {\n      setHasEdited(true);\n    }\n    onNoteChange({\n      [activeNoteId]: {\n        style: nextStyle,\n        textOnly: nextStyle.backgroundMode === \"none\",\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }\n\n  function handleCommand(command: string, value?: string) {\n    if (!allowNoteEditing) {\n      return;\n    }\n    const node = editorRef.current;\n    if (!node) {\n      return;\n    }\n    node.focus();\n    document.execCommand(command, false, value);\n    handleContentChange(node.innerHTML);\n  }\n\n  function handleToggleTextVisible() {\n    if (!activeNoteId || !activeNote || !canManage || !userId) {\n      return;\n    }\n    onNoteChange({\n      [activeNoteId]: {\n        textVisible: activeNote.textVisible === false,\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }\n\n  function handleToggleVisibility() {\n    if (!activeNoteId || !activeNote || !canManage || !userId) {\n      return;\n    }\n    const current = activeNote.visibility || \"all\";\n    const next = current === \"all\" ? \"gm\" : current === \"gm\" ? \"owner\" : \"all\";\n    onNoteChange({\n      [activeNoteId]: {\n        visibility: next,\n        lastModified: Date.now(),\n        lastModifiedBy: userId,\n      },\n    });\n  }\n\n  function handleToggleAttach() {\n    if (!activeNoteId || !activeNote || !canManage || !userId) {\n      return;\n    }\n    if (activeNote.attachedToTokenId) {\n      onNoteChange({\n        [activeNoteId]: {\n          attachedToTokenId: \"\",\n          lastModified: Date.now(),\n          lastModifiedBy: userId,\n        },\n      });\n      setAttachMode(false);\n      return;\n    }\n    setAttachMode((prev) => !prev);\n  }\n\n  function resolveAttachedNote(note: NoteType) {\n    if (!note.attachedToTokenId || !mapState?.tokens[note.attachedToTokenId]) {\n      return note;\n    }\n    const tokenState = mapState.tokens[note.attachedToTokenId];\n    return { ...note, x: tokenState.x, y: tokenState.y };\n  }\n\n  const resolvedNotes = mapState\n    ? Object.values(mapState.notes).sort((a, b) =>\n        sortNotes(a, b, noteDraggingOptions)\n      )\n    : [];\n\n  const noteMenuEnabled = selectedToolId === \"note\" || selectedToolId === \"move\";\n  const textHudEnabled =\n    selectedToolId === \"text\" ||\n    selectedToolId === \"move\" ||\n    selectedToolId === \"select\";\n  const allowDoubleClickEdit = textHudEnabled;\n  const allowSingleClickEdit = selectedToolId === \"text\";\n\n  const notes = (\n    <Group id=\"notes\">\n      {resolvedNotes.map((note) => (\n        <Note\n          note={resolveAttachedNote(note)}\n          map={map}\n          key={note.id}\n          onNoteMenuOpen={noteMenuEnabled ? handleNoteMenuOpen : undefined}\n          onNoteEditOpen={allowDoubleClickEdit ? handleTextHudOpen : undefined}\n          onNoteMenuClose={handleNoteMenuClose}\n          editable={allowNoteEditing}\n          allowSingleClickEdit={allowSingleClickEdit}\n          openOnClick={noteMenuEnabled || allowSingleClickEdit}\n          openOnDoubleClick={allowDoubleClickEdit}\n          draggable={\n            allowNoteEditing &&\n            (selectedToolId === \"note\" ||\n              selectedToolId === \"text\" ||\n              selectedToolId === \"move\") &&\n            !note.locked &&\n            !note.attachedToTokenId\n          }\n          onNoteChange={onNoteChange}\n          onNoteDragStart={handleNoteDragStart}\n          onNoteDragEnd={handleNoteDragEnd}\n          fadeOnHover={selectedToolId === \"drawing\"}\n          selected={\n            (isHudOpen && activeNoteId === note.id) ||\n            (isNoteMenuOpen && noteMenuOptions?.noteId === note.id)\n          }\n        />\n      ))}\n      <NoteTool\n        map={map}\n        active={selectedToolId === \"note\"}\n        mode=\"note\"\n        onNoteCreate={onNoteCreate}\n        onNoteMenuOpen={handleNoteMenuOpen}\n      />\n      <NoteTool\n        map={map}\n        active={selectedToolId === \"text\"}\n        mode=\"text\"\n        onNoteCreate={onNoteCreate}\n        onNoteMenuOpen={handleTextHudOpen}\n      />\n    </Group>\n  );\n\n  const noteMenu = (\n    <NoteMenu\n      isOpen={isNoteMenuOpen}\n      onRequestClose={handleNoteMenuClose}\n      onNoteChange={onNoteChange}\n      note={noteMenuOptions && mapState?.notes[noteMenuOptions.noteId]}\n      noteNode={noteMenuOptions?.noteNode}\n      focus={noteMenuOptions?.focus}\n      map={map}\n    />\n  );\n\n  const noteHud = (\n    <AdvancedTextHud\n      isOpen={isHudOpen && textHudEnabled}\n      note={activeNote}\n      draftStyle={draftStyle}\n      canEdit={allowNoteEditing}\n      canManage={canManage}\n      attachMode={attachMode}\n      onRequestClose={handleTextHudClose}\n      onStyleChange={handleStyleChange}\n      onCommand={handleCommand}\n      onToggleTextVisible={handleToggleTextVisible}\n      onToggleVisibility={handleToggleVisibility}\n      onToggleAttach={handleToggleAttach}\n    />\n  );\n\n  const noteTextOverlay = (\n    <NoteTextOverlay\n      map={map}\n      notes={resolvedNotes.map(resolveAttachedNote)}\n      activeNoteId={activeNoteId}\n      draftContent={draftContent}\n      draftStyle={draftStyle}\n      isEditing={isEditing}\n      editorRef={editorRef}\n      autoFocus={autoFocusEditor}\n      onContentChange={handleContentChange}\n      onDone={handleTextHudClose}\n      onRequestSizeChange={handleTextSizeChange}\n    />\n  );\n\n  const noteDragOverlay = noteDraggingOptions ? (\n    <NoteDragOverlay\n      draggingOptions={noteDraggingOptions}\n      onNoteRemove={handleNoteRemove}\n    />\n  ) : null;\n\n  return { notes, noteMenu, noteHud, noteTextOverlay, noteDragOverlay };\n}\n\nexport default useMapNotes;\n\nfunction sortNotes(\n  a: NoteType,\n  b: NoteType,\n  noteDraggingOptions?: NoteDraggingOptions\n) {\n  if (\n    noteDraggingOptions &&\n    noteDraggingOptions.dragging &&\n    noteDraggingOptions.noteId === a.id\n  ) {\n    // If dragging token `a` move above\n    return 1;\n  } else if (\n    noteDraggingOptions &&\n    noteDraggingOptions.dragging &&\n    noteDraggingOptions.noteId === b.id\n  ) {\n    // If dragging token `b` move above\n    return -1;\n  } else {\n    // Else sort so last modified is on top\n    return a.lastModified - b.lastModified;\n  }\n}\n","import { SelectionItemsRemoveEventHandler } from \"../../types/Events\";\nimport { Selection } from \"../../types/Select\";\n\nimport DragOverlay from \"../map/DragOverlay\";\n\ntype NoteDragOverlayProps = {\n  onSelectionItemsRemove: SelectionItemsRemoveEventHandler;\n  selection: Selection;\n  dragging: boolean;\n};\n\nfunction NoteDragOverlay({\n  onSelectionItemsRemove,\n  selection,\n  dragging,\n}: NoteDragOverlayProps) {\n  function handleNoteRemove() {\n    const tokenIds: string[] = [];\n    const noteIds: string[] = [];\n    for (let item of selection.items) {\n      if (item.type === \"token\") {\n        tokenIds.push(item.id);\n      } else {\n        noteIds.push(item.id);\n      }\n    }\n    onSelectionItemsRemove(tokenIds, noteIds);\n  }\n\n  return <DragOverlay dragging={dragging} onRemove={handleNoteRemove} />;\n}\n\nexport default NoteDragOverlay;\n","function CopyIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M15,20H5V7c0-0.55-0.45-1-1-1h0C3.45,6,3,6.45,3,7v13c0,1.1,0.9,2,2,2h10c0.55,0,1-0.45,1-1v0C16,20.45,15.55,20,15,20z M20,16V4c0-1.1-0.9-2-2-2H9C7.9,2,7,2.9,7,4v12c0,1.1,0.9,2,2,2h9C19.1,18,20,17.1,20,16z M18,16H9V4h9V16z\" />\n    </svg>\n  );\n}\n\nexport default CopyIcon;\n","import { Selection } from \"../types/Select\";\nimport Vector2 from \"./Vector2\";\n\nexport function getSelectionPoints(selection: Selection): Vector2[] {\n  let points: Vector2[] = [];\n  if (selection.type === \"path\") {\n    points = selection.data.points;\n  } else {\n    points.push({ x: selection.data.x, y: selection.data.y });\n    points.push({\n      x: selection.data.x + selection.data.width,\n      y: selection.data.y,\n    });\n    points.push({\n      x: selection.data.x + selection.data.width,\n      y: selection.data.y + selection.data.height,\n    });\n    points.push({\n      x: selection.data.x,\n      y: selection.data.y + selection.data.height,\n    });\n  }\n  return points;\n}\n","import Ajv from \"ajv\";\nimport { Color } from \"../helpers/colors\";\n\nconst ajv = new Ajv();\n\nexport type ColorString = Color | string;\n\nexport const ColorSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/color.json\",\n  anyOf: [\n    {\n      enum: [\n        \"black\",\n        \"blue\",\n        \"darkGray\",\n        \"green\",\n        \"lightGray\",\n        \"orange\",\n        \"pink\",\n        \"primary\",\n        \"purple\",\n        \"red\",\n        \"teal\",\n        \"white\",\n        \"yellow\",\n      ],\n      type: \"string\",\n    },\n    {\n      type: \"string\",\n      pattern: \"^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$\",\n    },\n  ],\n};\n\nexport const isColor = ajv.compile<ColorString>(ColorSchema);\n","import Ajv, { JSONSchemaType } from \"ajv\";\nimport Vector2 from \"../helpers/Vector2\";\n\nconst ajv = new Ajv();\n\nexport const Vector2Schema: JSONSchemaType<Vector2> = {\n  $id: \"https://www.owlbear.rodeo/schemas/vector2.json\",\n  properties: {\n    x: {\n      type: \"number\",\n    },\n    y: {\n      type: \"number\",\n    },\n  },\n  required: [\"x\", \"y\"],\n  type: \"object\",\n};\n\nexport const isVector2 = ajv.compile<Vector2>(Vector2Schema);\n","import Ajv from \"ajv\";\nimport { Drawing } from \"../types/Drawing\";\n\nimport { ColorSchema } from \"./Color\";\nimport { Vector2Schema } from \"./Vector2\";\n\nexport const DrawingSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/drawing.json\",\n  anyOf: [\n    {\n      $ref: \"#/definitions/Shape\",\n    },\n    {\n      $ref: \"#/definitions/Path\",\n    },\n  ],\n  definitions: {\n    PointsData: {\n      properties: {\n        points: {\n          items: {\n            $ref: \"vector2.json\",\n          },\n          type: \"array\",\n        },\n      },\n      required: [\"points\"],\n      type: \"object\",\n    },\n    RectData: {\n      properties: {\n        height: {\n          type: \"number\",\n        },\n        width: {\n          type: \"number\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\"height\", \"width\", \"x\", \"y\"],\n      type: \"object\",\n    },\n    CircleData: {\n      properties: {\n        radius: {\n          type: \"number\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\"radius\", \"x\", \"y\"],\n      type: \"object\",\n    },\n    BaseDrawing: {\n      properties: {\n        blend: {\n          type: \"boolean\",\n        },\n        color: {\n          $ref: \"color.json\",\n        },\n        dashStyle: {\n          enum: [\"solid\", \"dashed\", \"dotted\"],\n          type: \"string\",\n        },\n        id: {\n          type: \"string\",\n        },\n        opacity: {\n          type: \"number\",\n        },\n        strokeWidth: {\n          type: \"number\",\n        },\n      },\n      required: [\"blend\", \"color\", \"id\", \"strokeWidth\"],\n      type: \"object\",\n    },\n    BaseShape: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseDrawing\",\n        },\n        {\n          properties: {\n            type: {\n              enum: [\"shape\"],\n              type: \"string\",\n            },\n          },\n          required: [\"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n    Line: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseShape\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"#/definitions/PointsData\",\n            },\n            shapeType: {\n              enum: [\"line\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"shapeType\"],\n          type: \"object\",\n        },\n      ],\n    },\n    Rectangle: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseShape\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"#/definitions/RectData\",\n            },\n            shapeType: {\n              enum: [\"rectangle\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"shapeType\"],\n          type: \"object\",\n        },\n      ],\n    },\n    Circle: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseShape\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"#/definitions/CircleData\",\n            },\n            shapeType: {\n              enum: [\"circle\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"shapeType\"],\n          type: \"object\",\n        },\n      ],\n    },\n    Triangle: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseShape\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"#/definitions/PointsData\",\n            },\n            shapeType: {\n              enum: [\"triangle\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"shapeType\"],\n          type: \"object\",\n        },\n      ],\n    },\n    Shape: {\n      anyOf: [\n        {\n          $ref: \"#/definitions/Line\",\n        },\n        {\n          $ref: \"#/definitions/Rectangle\",\n        },\n        {\n          $ref: \"#/definitions/Circle\",\n        },\n        {\n          $ref: \"#/definitions/Triangle\",\n        },\n      ],\n    },\n    Path: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseDrawing\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"#/definitions/PointsData\",\n            },\n            pathType: {\n              enum: [\"fill\", \"stroke\"],\n              type: \"string\",\n            },\n            type: {\n              enum: [\"path\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"pathType\", \"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n  },\n};\n\nexport const ajv = new Ajv({\n  schemas: [DrawingSchema, ColorSchema, Vector2Schema],\n});\n\nexport const isDrawing = ajv.compile<Drawing>(DrawingSchema);\n","import Ajv from \"ajv\";\nimport { Fog } from \"../types/Fog\";\n\nimport { Vector2Schema } from \"./Vector2\";\nimport { ColorSchema } from \"./Color\";\n\nexport const FogSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/fog.json\",\n  properties: {\n    color: {\n      $ref: \"color.json\",\n    },\n    data: {\n      $ref: \"#/definitions/FogData\",\n    },\n    id: {\n      type: \"string\",\n    },\n    strokeWidth: {\n      type: \"number\",\n    },\n    type: {\n      enum: [\"fog\"],\n      type: \"string\",\n    },\n    visible: {\n      type: \"boolean\",\n    },\n  },\n  required: [\"color\", \"data\", \"id\", \"strokeWidth\", \"type\", \"visible\"],\n  type: \"object\",\n  definitions: {\n    FogData: {\n      properties: {\n        holes: {\n          items: {\n            items: {\n              $ref: \"vector2.json\",\n            },\n            type: \"array\",\n          },\n          type: \"array\",\n        },\n        points: {\n          items: {\n            $ref: \"vector2.json\",\n          },\n          type: \"array\",\n        },\n      },\n      required: [\"holes\", \"points\"],\n      type: \"object\",\n    },\n  },\n};\n\nconst ajv = new Ajv({ schemas: [FogSchema, ColorSchema, Vector2Schema] });\n\nexport const isFog = ajv.compile<Fog>(FogSchema);\n","import Ajv, { JSONSchemaType } from \"ajv\";\nimport { Note } from \"../types/Note\";\n\nimport { Vector2Schema } from \"./Vector2\";\nimport { ColorSchema } from \"./Color\";\n\nexport const NoteSchema: JSONSchemaType<Note> = {\n  $id: \"https://www.owlbear.rodeo/schemas/note.json\",\n  properties: {\n    color: {\n      $ref: \"color.json\",\n    },\n    id: {\n      type: \"string\",\n    },\n    lastModified: {\n      type: \"number\",\n    },\n    lastModifiedBy: {\n      type: \"string\",\n    },\n    locked: {\n      type: \"boolean\",\n    },\n    size: {\n      type: \"number\",\n    },\n    text: {\n      type: \"string\",\n    },\n    textOnly: {\n      type: \"boolean\",\n    },\n    visible: {\n      type: \"boolean\",\n    },\n    content: {\n      type: \"string\",\n      nullable: true,\n    },\n    contentFormat: {\n      type: \"string\",\n      enum: [\"plain\", \"html\"],\n      nullable: true,\n    },\n    style: {\n      type: \"object\",\n      nullable: true,\n      properties: {\n        textColor: {\n          type: \"string\",\n        },\n        backgroundMode: {\n          type: \"string\",\n          enum: [\"none\", \"scrim\", \"frame\"],\n        },\n        fontFamily: {\n          type: \"string\",\n          enum: [\"rounded\", \"serif\", \"handwritten\", \"runic\"],\n        },\n        fontScale: {\n          type: \"string\",\n          enum: [\"xs\", \"sm\", \"md\", \"lg\", \"xl\", \"huge\"],\n        },\n        fontSize: {\n          type: \"number\",\n          nullable: true,\n        },\n      },\n      required: [\"textColor\", \"backgroundMode\", \"fontFamily\", \"fontScale\"],\n    },\n    ownerId: {\n      type: \"string\",\n      nullable: true,\n    },\n    visibility: {\n      type: \"string\",\n      enum: [\"all\", \"gm\", \"owner\"],\n      nullable: true,\n    },\n    textVisible: {\n      type: \"boolean\",\n      nullable: true,\n    },\n    attachedToTokenId: {\n      type: \"string\",\n      nullable: true,\n    },\n    x: {\n      type: \"number\",\n    },\n    y: {\n      type: \"number\",\n    },\n    rotation: {\n      type: \"number\",\n    },\n  },\n  required: [\n    \"color\",\n    \"id\",\n    \"lastModified\",\n    \"lastModifiedBy\",\n    \"locked\",\n    \"size\",\n    \"text\",\n    \"textOnly\",\n    \"visible\",\n    \"x\",\n    \"y\",\n    \"rotation\",\n  ],\n  type: \"object\",\n};\n\nconst ajv = new Ajv({ schemas: [NoteSchema, ColorSchema, Vector2Schema] });\n\nexport const isNote = ajv.compile<Note>(NoteSchema);\n","import Ajv, { JSONSchemaType } from \"ajv\";\nimport { TokenNote } from \"../types/TokenNote\";\n\nexport const TokenNoteSchema: JSONSchemaType<TokenNote> = {\n  $id: \"https://www.owlbear.rodeo/schemas/token-note.json\",\n  properties: {\n    id: {\n      type: \"string\",\n    },\n    tokenStateId: {\n      type: \"string\",\n    },\n    content: {\n      type: \"string\",\n    },\n    style: {\n      type: \"object\",\n      properties: {\n        fontFamily: {\n          enum: [\"default\", \"handwritten\", \"rune\"],\n          type: \"string\",\n        },\n        backgroundColor: {\n          type: \"string\",\n          nullable: true,\n        },\n      },\n      required: [\"fontFamily\"],\n    },\n    permissions: {\n      type: \"object\",\n      properties: {\n        default: {\n          enum: [\"none\", \"read\", \"write\"],\n          type: \"string\",\n        },\n        owners: {\n          items: {\n            type: \"string\",\n          },\n          type: \"array\",\n        },\n      },\n      required: [\"default\", \"owners\"],\n    },\n    lastEditedBy: {\n      type: \"string\",\n    },\n    lastEditedAt: {\n      type: \"number\",\n    },\n    editingBy: {\n      type: \"string\",\n      nullable: true,\n    },\n  },\n  required: [\n    \"id\",\n    \"tokenStateId\",\n    \"content\",\n    \"style\",\n    \"permissions\",\n    \"lastEditedBy\",\n    \"lastEditedAt\",\n  ],\n  type: \"object\",\n};\n\nconst ajv = new Ajv({ schemas: [TokenNoteSchema] });\n\nexport const isTokenNote = ajv.compile<TokenNote>(TokenNoteSchema);\n","import Ajv from \"ajv\";\nimport { SpellTemplate } from \"../types/SpellTemplate\";\n\nimport { Vector2Schema } from \"./Vector2\";\n\nexport const SpellTemplateSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/spell-template.json\",\n  type: \"object\",\n  properties: {\n    id: { type: \"string\" },\n    type: {\n      enum: [\"circle\", \"rectangle\", \"cone\", \"line\", \"ring\", \"path\"],\n      type: \"string\",\n    },\n    origin: {\n      $ref: \"vector2.json\",\n    },\n    rotation: { type: \"number\" },\n    params: {\n      type: \"object\",\n      properties: {\n        radius: { type: \"number\" },\n        innerRadius: { type: \"number\" },\n        width: { type: \"number\" },\n        height: { type: \"number\" },\n        length: { type: \"number\" },\n        angle: { type: \"number\" },\n        points: {\n          type: \"array\",\n          items: { $ref: \"vector2.json\" },\n        },\n      },\n      required: [],\n    },\n    style: {\n      type: \"object\",\n      properties: {\n        color: { type: \"string\" },\n        opacity: { type: \"number\" },\n        strokeWidth: { type: \"number\" },\n      },\n      required: [\"color\", \"opacity\", \"strokeWidth\"],\n    },\n  },\n  required: [\"id\", \"type\", \"origin\", \"rotation\", \"params\", \"style\"],\n};\n\nexport const ajv = new Ajv({ schemas: [SpellTemplateSchema, Vector2Schema] });\n\nexport const isSpellTemplate = ajv.compile<SpellTemplate>(SpellTemplateSchema);\n","import Ajv from \"ajv\";\nimport { Outline } from \"../types/Outline\";\n\nconst ajv = new Ajv();\n\nexport const OutlineSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/outline.json\",\n  anyOf: [\n    {\n      $ref: \"#/definitions/CircleOutline\",\n    },\n    {\n      $ref: \"#/definitions/RectOutline\",\n    },\n    {\n      $ref: \"#/definitions/PathOutline\",\n    },\n  ],\n  definitions: {\n    CircleOutline: {\n      properties: {\n        radius: {\n          type: \"number\",\n        },\n        type: {\n          enum: [\"circle\"],\n          type: \"string\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\"radius\", \"type\", \"x\", \"y\"],\n      type: \"object\",\n    },\n    RectOutline: {\n      properties: {\n        height: {\n          type: \"number\",\n        },\n        type: {\n          enum: [\"rect\"],\n          type: \"string\",\n        },\n        width: {\n          type: \"number\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\"height\", \"type\", \"width\", \"x\", \"y\"],\n      type: \"object\",\n    },\n    PathOutline: {\n      properties: {\n        points: {\n          items: {\n            type: \"number\",\n          },\n          type: \"array\",\n        },\n        type: {\n          enum: [\"path\"],\n          type: \"string\",\n        },\n      },\n      required: [\"points\", \"type\"],\n      type: \"object\",\n    },\n  },\n};\n\nexport const isOutline = ajv.compile<Outline>(OutlineSchema);\n","import Ajv from \"ajv\";\nimport { TokenState } from \"../types/TokenState\";\n\nimport { ColorSchema } from \"./Color\";\nimport { OutlineSchema } from \"./Outline\";\n\nexport const TokenStateSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/token-state.json\",\n  anyOf: [\n    {\n      $ref: \"#/definitions/DefaultTokenState\",\n    },\n    {\n      $ref: \"#/definitions/FileTokenState\",\n    },\n  ],\n  definitions: {\n    TokenCategory: {\n      enum: [\"character\", \"prop\", \"vehicle\", \"attachment\"],\n      type: \"string\",\n    },\n    LightConfig: {\n      type: \"object\",\n      properties: {\n        enabled: { type: \"boolean\" },\n        radiusBright: { type: \"number\" },\n        radiusDim: { type: \"number\" },\n        color: { type: \"string\" },\n      },\n      required: [\"enabled\", \"radiusBright\"],\n    },\n    TokenAttributeVisibility: {\n      enum: [\"public\", \"private\"],\n      type: \"string\",\n    },\n    TokenAttributeBar: {\n      type: \"object\",\n      properties: {\n        id: { type: \"string\" },\n        label: { type: \"string\" },\n        current: { type: \"number\" },\n        min: { type: \"number\" },\n        max: { type: \"number\" },\n        color: { type: \"string\" },\n        showMinMax: { type: \"boolean\" },\n        visibility: { $ref: \"#/definitions/TokenAttributeVisibility\" },\n      },\n      required: [\"id\", \"label\", \"current\", \"color\"],\n    },\n    TokenAttributeValue: {\n      type: \"object\",\n      properties: {\n        id: { type: \"string\" },\n        label: { type: \"string\" },\n        value: {\n          anyOf: [{ type: \"number\" }, { type: \"string\" }],\n        },\n        color: { type: \"string\" },\n        visibility: { $ref: \"#/definitions/TokenAttributeVisibility\" },\n      },\n      required: [\"id\", \"label\", \"value\"],\n    },\n    TokenAttributeState: {\n      type: \"object\",\n      properties: {\n        bars: {\n          type: \"array\",\n          items: { $ref: \"#/definitions/TokenAttributeBar\" },\n        },\n        values: {\n          type: \"array\",\n          items: { $ref: \"#/definitions/TokenAttributeValue\" },\n        },\n        version: { type: \"number\" },\n        updatedAt: { type: \"number\" },\n        updatedBy: { type: \"string\" },\n      },\n      required: [\"bars\", \"values\", \"version\", \"updatedAt\", \"updatedBy\"],\n    },\n    BaseTokenState: {\n      properties: {\n        category: {\n          $ref: \"#/definitions/TokenCategory\",\n        },\n        height: {\n          type: \"number\",\n        },\n        id: {\n          type: \"string\",\n        },\n        label: {\n          type: \"string\",\n        },\n        lastModified: {\n          type: \"number\",\n        },\n        lastModifiedBy: {\n          type: \"string\",\n        },\n        locked: {\n          type: \"boolean\",\n        },\n        outline: {\n          $ref: \"outline.json\",\n        },\n        owner: {\n          type: \"string\",\n        },\n        rotation: {\n          type: \"number\",\n        },\n        size: {\n          type: \"number\",\n        },\n        statuses: {\n          items: {\n            $ref: \"color.json\",\n          },\n          type: \"array\",\n        },\n        attributes: {\n          $ref: \"#/definitions/TokenAttributeState\",\n        },\n        tokenId: {\n          type: \"string\",\n        },\n        visible: {\n          type: \"boolean\",\n        },\n        hasVision: {\n          type: \"boolean\",\n        },\n        visionRange: {\n          type: \"number\",\n        },\n        visionAngle: {\n          type: \"number\",\n        },\n        lightConfig: {\n          $ref: \"#/definitions/LightConfig\",\n        },\n        width: {\n          type: \"number\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\n        \"category\",\n        \"height\",\n        \"id\",\n        \"label\",\n        \"lastModified\",\n        \"lastModifiedBy\",\n        \"locked\",\n        \"outline\",\n        \"owner\",\n        \"rotation\",\n        \"size\",\n        \"statuses\",\n        \"tokenId\",\n        \"visible\",\n        \"width\",\n        \"x\",\n        \"y\",\n      ],\n      type: \"object\",\n    },\n    DefaultTokenState: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseTokenState\",\n        },\n        {\n          properties: {\n            key: {\n              type: \"string\",\n            },\n            type: {\n              enum: [\"default\"],\n              type: \"string\",\n            },\n          },\n          required: [\"key\", \"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n    FileTokenState: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseTokenState\",\n        },\n        {\n          properties: {\n            file: {\n              type: \"string\",\n            },\n            type: {\n              enum: [\"file\"],\n              type: \"string\",\n            },\n          },\n          required: [\"file\", \"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n  },\n};\n\nexport const ajv = new Ajv({\n  schemas: [TokenStateSchema, ColorSchema, OutlineSchema],\n});\n\nexport const isTokenState = ajv.compile<TokenState>(TokenStateSchema);\n","import { Wall } from \"../types/Wall\";\nimport { Vector2Schema } from \"./Vector2\";\n\nexport const WallSchema: any = {\n  $id: \"https://www.owlbear.rodeo/schemas/wall.json\",\n  type: \"object\",\n  properties: {\n    id: { type: \"string\" },\n    type: { enum: [\"wall\"], type: \"string\" },\n    points: {\n      type: \"array\",\n      items: { $ref: \"vector2.json\" },\n    },\n    blocksVision: { type: \"boolean\" },\n  },\n  required: [\"id\", \"type\", \"points\", \"blocksVision\"],\n};\n\nexport const isWall = (wall: any): wall is Wall => {\n  return (\n    wall &&\n    typeof wall.id === \"string\" &&\n    wall.type === \"wall\" &&\n    Array.isArray(wall.points)\n  );\n};\n\nexport const wallSchemas = [WallSchema, Vector2Schema];\n","import Ajv from \"ajv\";\nimport { MapState } from \"../types/MapState\";\n\nimport { DrawingSchema } from \"./Drawing\";\nimport { FogSchema } from \"./Fog\";\nimport { NoteSchema } from \"./Note\";\nimport { TokenNoteSchema } from \"./TokenNote\";\nimport { SpellTemplateSchema } from \"./SpellTemplate\";\nimport { TokenStateSchema } from \"./TokenState\";\nimport { Vector2Schema } from \"./Vector2\";\nimport { ColorSchema } from \"./Color\";\nimport { OutlineSchema } from \"./Outline\";\nimport { WallSchema } from \"./Wall\";\n\nexport const MapStateSchema: any = {\n  $id: \"https://www.owlbear.rodeo/schemas/map-state.json\",\n  properties: {\n    tokens: {\n      $ref: \"#/definitions/TokenStates\",\n    },\n    drawings: {\n      $ref: \"#/definitions/DrawingState\",\n    },\n    fogs: {\n      $ref: \"#/definitions/FogState\",\n    },\n    templates: {\n      $ref: \"#/definitions/SpellTemplateState\",\n    },\n    walls: {\n      $ref: \"#/definitions/WallState\",\n    },\n    explored: {\n      $ref: \"#/definitions/ExploredState\",\n    },\n    fogEnabled: {\n      type: \"boolean\",\n    },\n    showExplored: {\n      type: \"boolean\",\n    },\n    editFlags: {\n      items: {\n        enum: [\"drawing\", \"fog\", \"notes\", \"tokens\"],\n        type: \"string\",\n      },\n      type: \"array\",\n    },\n    notes: {\n      $ref: \"#/definitions/Notes\",\n    },\n    tokenNotes: {\n      $ref: \"#/definitions/TokenNotes\",\n    },\n    mapId: {\n      type: \"string\",\n    },\n  },\n  required: [\n    \"drawings\",\n    \"editFlags\",\n    \"fogs\",\n    \"templates\",\n    \"mapId\",\n    \"notes\",\n    \"tokenNotes\",\n    \"tokens\",\n  ],\n  type: \"object\",\n  definitions: {\n    TokenStates: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"token-state.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    DrawingState: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"drawing.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    FogState: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"fog.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    SpellTemplateState: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"spell-template.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    Notes: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"note.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    TokenNotes: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"token-note.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    WallState: {\n      propertyNames: {\n        type: \"string\",\n      },\n      additionalProperties: {\n        $ref: \"wall.json\",\n      },\n      required: [],\n      type: \"object\",\n    },\n    ExploredState: {\n      type: \"array\",\n      items: {\n        type: \"array\",\n        items: {\n          type: \"array\",\n          items: {\n            type: \"array\",\n            minItems: 2,\n            maxItems: 2,\n            items: {\n              type: \"number\",\n            },\n          },\n        },\n      },\n    },\n  },\n};\n\nexport const ajv = new Ajv({\n  schemas: [\n    MapStateSchema,\n    DrawingSchema,\n    FogSchema,\n    SpellTemplateSchema,\n    NoteSchema,\n    TokenNoteSchema,\n    TokenStateSchema,\n    Vector2Schema,\n    ColorSchema,\n    OutlineSchema,\n    WallSchema,\n  ],\n});\n\nexport const isMapState = ajv.compile<MapState>(MapStateSchema);\n","import Ajv from \"ajv\";\nimport { Selection } from \"../types/Select\";\n\nimport { DrawingSchema } from \"./Drawing\";\nimport { Vector2Schema } from \"./Vector2\";\nimport { ColorSchema } from \"./Color\";\n\nexport const SelectionSchema = {\n  $id: \"https://www.owlbear.rodeo/schemas/selection.json\",\n  anyOf: [\n    {\n      $ref: \"#/definitions/RectSelection\",\n    },\n    {\n      $ref: \"#/definitions/PathSelection\",\n    },\n  ],\n  definitions: {\n    SelectionItemType: {\n      enum: [\"token\", \"note\"],\n      type: \"string\",\n    },\n    SelectionItem: {\n      properties: {\n        type: {\n          $ref: \"#/definitions/SelectionItemType\",\n        },\n        id: {\n          type: \"string\",\n        },\n      },\n      required: [\"type\", \"id\"],\n      type: \"object\",\n    },\n    BaseSelection: {\n      properties: {\n        items: {\n          items: {\n            $ref: \"#/definitions/SelectionItem\",\n          },\n          type: \"array\",\n        },\n        x: {\n          type: \"number\",\n        },\n        y: {\n          type: \"number\",\n        },\n      },\n      required: [\"items\", \"x\", \"y\"],\n      type: \"object\",\n    },\n    RectSelection: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseSelection\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"drawing.json#/definitions/RectData\",\n            },\n            type: {\n              enum: [\"rectangle\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n    PathSelection: {\n      allOf: [\n        {\n          $ref: \"#/definitions/BaseSelection\",\n        },\n        {\n          properties: {\n            data: {\n              $ref: \"drawing.json#/definitions/PointsData\",\n            },\n            type: {\n              enum: [\"path\"],\n              type: \"string\",\n            },\n          },\n          required: [\"data\", \"type\"],\n          type: \"object\",\n        },\n      ],\n    },\n  },\n};\n\nconst ajv = new Ajv({\n  schemas: [SelectionSchema, DrawingSchema, Vector2Schema, ColorSchema],\n});\n\nexport const isSelection = ajv.compile<Selection>(SelectionSchema);\n","import { useEffect, useRef, useState } from \"react\";\nimport { Box, Flex, IconButton, Input, Text } from \"theme-ui\";\nimport { useToasts } from \"react-toast-notifications\";\nimport { v4 as uuid } from \"uuid\";\n\nimport MapMenu from \"../map/MapMenu\";\n\nimport usePrevious from \"../../hooks/usePrevious\";\n\nimport LockIcon from \"../../icons/TokenLockIcon\";\nimport UnlockIcon from \"../../icons/TokenUnlockIcon\";\nimport ShowIcon from \"../../icons/TokenShowIcon\";\nimport HideIcon from \"../../icons/TokenHideIcon\";\nimport CopyIcon from \"../../icons/CopyIcon\";\nimport PasteIcon from \"../../icons/PasteIcon\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport {\n  SelectionItemsChangeEventHandler,\n  RequestCloseEventHandler,\n  SelectionItemsCreateEventHandler,\n} from \"../../types/Events\";\nimport { Map } from \"../../types/Map\";\nimport { Selection, SelectionItem } from \"../../types/Select\";\nimport { TokenState, TokenStates } from \"../../types/TokenState\";\nimport { Note, Notes } from \"../../types/Note\";\nimport { getSelectionPoints } from \"../../helpers/selection\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { MapState } from \"../../types/MapState\";\nimport { isMapState } from \"../../validators/MapState\";\nimport { isSelection } from \"../../validators/Selection\";\nimport { getRelativePointerPosition } from \"../../helpers/konva\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\nimport shortcuts from \"../../shortcuts\";\nimport { clipboardSupported } from \"../../helpers/shared\";\nimport { buildNextAttributes, parseNumericExpression } from \"../../helpers/tokenAttributes\";\n\ntype SelectionMenuProps = {\n  isOpen: boolean;\n  active: boolean;\n  effectMode: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onRequestOpen: () => void;\n  selection: Selection | null;\n  onSelectionChange: React.Dispatch<React.SetStateAction<Selection | null>>;\n  onSelectionItemsChange: SelectionItemsChangeEventHandler;\n  onSelectionItemsCreate: SelectionItemsCreateEventHandler;\n  map: Map | null;\n  mapState: MapState | null;\n};\n\nfunction SelectionMenu({\n  isOpen,\n  active,\n  effectMode,\n  onRequestClose,\n  onRequestOpen,\n  selection,\n  onSelectionChange,\n  onSelectionItemsChange,\n  onSelectionItemsCreate,\n  map,\n  mapState,\n}: SelectionMenuProps) {\n  const { addToast } = useToasts();\n\n  const userId = useUserId();\n\n  const wasOpen = usePrevious(isOpen);\n\n  const mapStageRef = useMapStage();\n\n  const [menuLeft, setMenuLeft] = useState(0);\n  const [menuTop, setMenuTop] = useState(0);\n\n  const selectionMenuWidth =\n    selection === null ? 48 : effectMode ? 260 : 156;\n\n  useEffect(() => {\n    const mapStage = mapStageRef.current;\n    if (isOpen && !wasOpen && mapStage) {\n      const mapImage = mapStage.findOne(\"#mapImage\");\n      if (!mapImage) {\n        return;\n      }\n      let menuPosition = { x: 0, y: 0 };\n      if (selection) {\n        const points = getSelectionPoints(selection);\n        const bounds = Vector2.getBoundingBox(points);\n\n        menuPosition = new Vector2(\n          bounds.center.x + selection.x,\n          bounds.max.y + selection.y\n        );\n        menuPosition = Vector2.multiply(menuPosition, {\n          x: mapImage.width(),\n          y: mapImage.height(),\n        });\n      } else {\n        const position = getRelativePointerPosition(mapImage);\n        if (position) {\n          menuPosition = position;\n        }\n      }\n\n      const transform = mapImage.getAbsoluteTransform().copy();\n      const absolutePosition = transform.point(menuPosition);\n      const mapElement = document.querySelector(\".map\");\n      if (mapElement) {\n        const mapRect = mapElement.getBoundingClientRect();\n        setMenuLeft(mapRect.left + absolutePosition.x - selectionMenuWidth / 2);\n        setMenuTop(mapRect.top + absolutePosition.y + 12);\n      }\n    }\n  }, [isOpen, selection, wasOpen, mapStageRef, selectionMenuWidth]);\n\n  // Open paste menu if clicking without a selection\n  // Ensure that paste menu is closed when clicking and that the click hasn't moved far\n  const openOnDownRef = useRef(false);\n  const downPositionRef = useRef({ x: 0, y: 0 });\n  useEffect(() => {\n    if (!active) {\n      return;\n    }\n    function handlePointerDown(event: PointerEvent) {\n      openOnDownRef.current = isOpen || !!selection;\n      downPositionRef.current = { x: event.clientX, y: event.clientY };\n    }\n    function handlePointerUp(event: MouseEvent | TouchEvent) {\n      let position;\n      if (event instanceof MouseEvent) {\n        position = { x: event.clientX, y: event.clientY };\n      } else {\n        position = {\n          x: event.changedTouches[0].clientX,\n          y: event.changedTouches[0].clientY,\n        };\n      }\n      const deltaPosition = Vector2.distance(position, downPositionRef.current);\n      if (\n        !openOnDownRef.current &&\n        !selection &&\n        deltaPosition < 10 &&\n        event.target instanceof HTMLCanvasElement\n      ) {\n        onRequestOpen();\n      }\n    }\n    const mapElement = document.querySelector<HTMLElement>(\".map\");\n    mapElement?.addEventListener(\"pointerdown\", handlePointerDown);\n    mapElement?.addEventListener(\"mouseup\", handlePointerUp);\n    mapElement?.addEventListener(\"touchend\", handlePointerUp);\n\n    return () => {\n      mapElement?.removeEventListener(\"pointerdown\", handlePointerDown);\n      mapElement?.removeEventListener(\"mouseup\", handlePointerUp);\n      mapElement?.removeEventListener(\"touchend\", handlePointerUp);\n    };\n  }, [isOpen, active, selection, onRequestOpen]);\n\n  function handleModalContent(node: HTMLElement) {\n    if (node) {\n      // Ensure menu is in bounds\n      const nodeRect = node.getBoundingClientRect();\n      const mapElement = document.querySelector(\".map\");\n      if (mapElement) {\n        const mapRect = mapElement.getBoundingClientRect();\n        setMenuLeft((prevLeft) =>\n          Math.min(\n            mapRect.right - nodeRect.width,\n            Math.max(mapRect.left, prevLeft)\n          )\n        );\n        setMenuTop((prevTop) =>\n          Math.min(mapRect.bottom - nodeRect.height, prevTop)\n        );\n      }\n    }\n  }\n\n  function updateSelectedItems(change: Partial<TokenState> | Partial<Note>) {\n    if (selection) {\n      const tokenChanges: Record<string, Partial<TokenState>> = {};\n      const noteChanges: Record<string, Partial<Note>> = {};\n      for (let item of selection.items) {\n        if (item.type === \"token\") {\n          tokenChanges[item.id] = change;\n        } else {\n          noteChanges[item.id] = change;\n        }\n      }\n      onSelectionItemsChange(tokenChanges, noteChanges);\n    }\n  }\n\n  const [itemsVisible, setItemsVisible] = useState(false);\n  function handleVisibleChange() {\n    updateSelectedItems({ visible: !itemsVisible });\n    setItemsVisible(!itemsVisible);\n  }\n\n  const [itemsLocked, setItemsLocked] = useState(false);\n  function handleLockChange() {\n    updateSelectedItems({ locked: !itemsLocked });\n    setItemsLocked(!itemsLocked);\n  }\n\n  function handleApplyEffect() {\n    if (!selection || !mapState) {\n      addToast(\"No selection\", { appearance: \"warning\" });\n      return;\n    }\n    const label = effectLabel.trim();\n    const expression = effectExpression.trim();\n    if (!expression) {\n      addToast(\"\", { appearance: \"error\" });\n      return;\n    }\n    const tokenChanges: Record<string, Partial<TokenState>> = {};\n    let affected = 0;\n    for (let item of selection.items) {\n      if (item.type !== \"token\") {\n        continue;\n      }\n      const tokenState = mapState.tokens[item.id];\n      if (!tokenState || !tokenState.attributes) {\n        continue;\n      }\n      const bars = tokenState.attributes.bars || [];\n      const barIndex = label\n        ? bars.findIndex(\n            (bar) => bar.label.toLowerCase() === label.toLowerCase()\n          )\n        : bars.length > 0\n        ? 0\n        : -1;\n      if (barIndex < 0) {\n        continue;\n      }\n      const bar = bars[barIndex];\n      const result = parseNumericExpression(bar.current, expression);\n      if (!result.ok) {\n        addToast(result.error, { appearance: \"error\" });\n        return;\n      }\n      const nextBars = bars.map((existing, index) =>\n        index === barIndex ? { ...existing, current: result.value } : existing\n      );\n      const nextAttributes = buildNextAttributes(\n        tokenState.attributes,\n        nextBars,\n        tokenState.attributes.values,\n        userId || \"unknown\"\n      );\n      tokenChanges[tokenState.id] = { attributes: nextAttributes };\n      affected += 1;\n    }\n    if (affected === 0) {\n      addToast(\"\", { appearance: \"warning\" });\n      return;\n    }\n    onSelectionItemsChange(tokenChanges, {});\n    addToast(` ${affected}  token`, { appearance: \"success\" });\n  }\n\n  const [effectLabel, setEffectLabel] = useState(\"HP\");\n  const [effectExpression, setEffectExpression] = useState(\"+0\");\n\n  // Update lock and visible state depending on selected items\n  useEffect(() => {\n    if (isOpen && selection && mapState) {\n      let allVisible = true;\n      let allLocked = true;\n      for (let item of selection.items) {\n        if (item.type === \"token\") {\n          const tokenState = mapState.tokens[item.id];\n          if (!tokenState.visible) {\n            allVisible = false;\n          }\n          if (!tokenState.locked) {\n            allLocked = false;\n          }\n        } else {\n          const note = mapState.notes[item.id];\n          if (!note.visible) {\n            allVisible = false;\n          }\n          if (!note.locked) {\n            allLocked = false;\n          }\n        }\n      }\n      setItemsVisible(allVisible);\n      setItemsLocked(allLocked);\n    }\n  }, [mapState, selection, isOpen]);\n\n  function addSuccessToast(\n    message: string,\n    tokens?: TokenStates,\n    notes?: Notes\n  ) {\n    const numTokens = tokens ? Object.keys(tokens).length : 0;\n    const numNotes = notes ? Object.keys(notes).length : 0;\n    const tokenText = `${numTokens} token${numTokens > 1 ? \"s\" : \"\"}`;\n    const noteText = `${numNotes} note${numNotes > 1 ? \"s\" : \"\"}`;\n    if (numTokens > 0 && numNotes > 0) {\n      addToast(`${message} ${tokenText} and ${noteText}`);\n    } else if (numTokens > 0) {\n      addToast(`${message} ${tokenText}`);\n    } else if (numNotes > 0) {\n      addToast(`${message} ${noteText}`);\n    }\n  }\n\n  // Keep a local copy of the clipboard if the device doesn't support the clipboard api i.e. iOS\n  const localClipboardDataRef = useRef<string>(\"\");\n  async function handleCopy() {\n    let version = process.env.REACT_APP_VERSION;\n    if (!version || !selection || !mapState) {\n      return;\n    }\n    let clipboard: { version: string; data: MapState; selection: Selection } = {\n      version,\n      selection,\n      data: {\n        tokens: {},\n        notes: {},\n        drawings: {},\n        templates: {},\n        editFlags: [],\n        fogs: {},\n        tokenNotes: {},\n        mapId: mapState.mapId,\n      },\n    };\n    for (let item of selection.items) {\n      if (item.type === \"token\" && clipboard.data.tokens) {\n        clipboard.data.tokens[item.id] = mapState.tokens[item.id];\n      } else if (item.type === \"note\" && clipboard.data.notes) {\n        clipboard.data.notes[item.id] = mapState.notes[item.id];\n      }\n    }\n    if (await clipboardSupported()) {\n      await navigator.clipboard.writeText(JSON.stringify(clipboard));\n    } else {\n      localClipboardDataRef.current = JSON.stringify(clipboard);\n    }\n    addSuccessToast(\"Copied\", clipboard.data.tokens, clipboard.data.notes);\n  }\n\n  async function handlePaste() {\n    let version = process.env.REACT_APP_VERSION;\n\n    if (!version || !mapState) {\n      return;\n    }\n    try {\n      let clipboardText;\n      if (await clipboardSupported()) {\n        clipboardText = await navigator.clipboard.readText();\n      } else {\n        clipboardText = localClipboardDataRef.current;\n      }\n      const clipboard = JSON.parse(clipboardText);\n      const clipboardData = clipboard?.data;\n      if (clipboardData && typeof clipboardData === \"object\") {\n        if (!clipboardData.templates) {\n          clipboardData.templates = {};\n        }\n        if (!clipboardData.tokenNotes) {\n          clipboardData.tokenNotes = {};\n        }\n      }\n      if (\n        clipboard.version === version &&\n        isMapState(clipboardData) &&\n        isSelection(clipboard.selection)\n      ) {\n        // Find new selection position\n        const mapStage = mapStageRef.current;\n        const mapImage = mapStage?.findOne(\"#mapImage\");\n        if (!mapImage) {\n          return;\n        }\n        const position = getRelativePointerPosition(mapImage);\n        if (!position) {\n          return;\n        }\n        const normalizedPosition = Vector2.divide(position, {\n          x: mapImage.width(),\n          y: mapImage.height(),\n        });\n\n        const clipboardSelection = clipboard.selection as Selection;\n        const points = getSelectionPoints(clipboardSelection);\n        const center = Vector2.centroid(points);\n\n        let selectionDelta = Vector2.subtract(normalizedPosition, center);\n\n        const clipboardState = clipboard.data as MapState;\n        let tokenStates: TokenState[] = [];\n        let notes: Note[] = [];\n        let selectionItems: SelectionItem[] = [];\n        for (let token of Object.values(clipboardState.tokens)) {\n          const newId = uuid();\n          tokenStates.push({\n            ...token,\n            x: token.x + selectionDelta.x,\n            y: token.y + selectionDelta.y,\n            id: newId,\n          });\n          selectionItems.push({ id: newId, type: \"token\" });\n        }\n        for (let note of Object.values(clipboardState.notes)) {\n          const newId = uuid();\n          notes.push({\n            ...note,\n            x: note.x + selectionDelta.x,\n            y: note.y + selectionDelta.y,\n            id: newId,\n          });\n          selectionItems.push({ id: newId, type: \"note\" });\n        }\n        onSelectionItemsCreate(tokenStates, notes);\n\n        onSelectionChange({\n          ...clipboardSelection,\n          items: selectionItems,\n          x: clipboardSelection.x + selectionDelta.x,\n          y: clipboardSelection.y + selectionDelta.y,\n        });\n\n        onRequestClose();\n      } else {\n        addToast(\"Invalid data\");\n      }\n    } catch {\n      addToast(\"Unable to paste\");\n    }\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (active) {\n      if (selection && shortcuts.copy(event)) {\n        handleCopy();\n      }\n      if (shortcuts.paste(event)) {\n        handlePaste();\n      }\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  return (\n    <MapMenu\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      top={`${menuTop}px`}\n      left={`${menuLeft}px`}\n      onModalContent={handleModalContent}\n    >\n      <Box sx={{ width: `${selectionMenuWidth}px`, overflow: \"hidden\" }} p={1}>\n        <Flex sx={{ alignItems: \"center\", justifyContent: \"space-around\" }}>\n          {selection ? (\n            <>\n              {/* Only show hide and lock token actions to map owners */}\n              {map && map.owner === userId && (\n                <>\n                  <IconButton\n                    onClick={handleVisibleChange}\n                    title={itemsVisible ? \"Hide Items\" : \"Show Items\"}\n                    aria-label={itemsVisible ? \"Hide Items\" : \"Show Items\"}\n                  >\n                    {itemsVisible ? <ShowIcon /> : <HideIcon />}\n                  </IconButton>\n                  <IconButton\n                    onClick={handleLockChange}\n                    title={itemsLocked ? \"Unlock Items\" : \"Lock Items\"}\n                    aria-label={itemsLocked ? \"Unlock Items\" : \"Lock Items\"}\n                  >\n                    {itemsLocked ? <LockIcon /> : <UnlockIcon />}\n                  </IconButton>\n                </>\n              )}\n              <IconButton\n                title=\"Copy Items\"\n                aria-label=\"Copy Items\"\n                onClick={handleCopy}\n              >\n                <CopyIcon />\n              </IconButton>\n            </>\n          ) : (\n            <IconButton\n              title=\"Paste Items\"\n              aria-label=\"Paste Items\"\n              onClick={handlePaste}\n            >\n              <PasteIcon />\n            </IconButton>\n          )}\n        </Flex>\n        {effectMode && selection && (\n          <Box mt={2}>\n            <Text variant=\"body2\"></Text>\n            <Box mt={1}>\n              <Text variant=\"body2\" sx={{ opacity: 0.8 }}>\n                \n              </Text>\n              <Input\n                value={effectLabel}\n                onChange={(e) => setEffectLabel(e.target.value)}\n                sx={{ width: \"100%\", px: 1, py: \"2px\", mt: 1 }}\n              />\n            </Box>\n            <Box mt={2}>\n              <Text variant=\"body2\" sx={{ opacity: 0.8 }}>\n                \n              </Text>\n              <Input\n                value={effectExpression}\n                onChange={(e) => setEffectExpression(e.target.value)}\n                sx={{ width: \"100%\", px: 1, py: \"2px\", mt: 1 }}\n              />\n            </Box>\n            <Box mt={2}>\n              <IconButton\n                onClick={handleApplyEffect}\n                aria-label=\"Apply Effect\"\n                title=\"Apply Effect\"\n                sx={{\n                  width: \"100%\",\n                  justifyContent: \"center\",\n                  backgroundColor: \"muted\",\n                }}\n              >\n                <Text as=\"span\" sx={{ fontSize: \"14px\" }}>\n                  \n                </Text>\n              </IconButton>\n            </Box>\n          </Box>\n        )}\n      </Box>\n    </MapMenu>\n  );\n}\n\nexport default SelectionMenu;\n","import Konva from \"konva\";\nimport { Line, Rect } from \"react-konva\";\n\nimport colors from \"../../helpers/colors\";\nimport { scaleAndFlattenPoints } from \"../../helpers/konva\";\n\nimport { useGridStrokeWidth } from \"../../contexts/GridContext\";\nimport {\n  useMapHeight,\n  useMapWidth,\n  useStageScale,\n} from \"../../contexts/MapInteractionContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport {\n  Selection as SelectionType,\n  SelectionItemType,\n} from \"../../types/Select\";\nimport { useEffect, useRef } from \"react\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { SelectionItemsChangeEventHandler } from \"../../types/Events\";\nimport { TokenState } from \"../../types/TokenState\";\nimport { Map } from \"../../types/Map\";\nimport { Note } from \"../../types/Note\";\nimport useGridSnapping from \"../../hooks/useGridSnapping\";\n\nconst dashAnimationSpeed = -0.01;\n\ntype SelectionProps = {\n  selection: SelectionType;\n  onSelectionChange: (selection: SelectionType | null) => void;\n  onSelectionItemsChange: SelectionItemsChangeEventHandler;\n  onPreventSelectionChange: (preventSelection: boolean) => void;\n  onSelectionDragStart: () => void;\n  onSelectionDragEnd: () => void;\n  map: Map;\n} & Konva.ShapeConfig;\n\nfunction Selection({\n  selection,\n  onSelectionChange,\n  onSelectionItemsChange,\n  onPreventSelectionChange,\n  onSelectionDragStart,\n  onSelectionDragEnd,\n  map,\n  ...props\n}: SelectionProps) {\n  const userId = useUserId();\n\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const stageScale = useStageScale();\n  const gridStrokeWidth = useGridStrokeWidth();\n\n  const snapPositionToGrid = useGridSnapping();\n\n  const intersectingNodesRef = useRef<\n    {\n      type: SelectionItemType;\n      node: Konva.Node;\n      id: string;\n      initialX: number;\n      initialY: number;\n    }[]\n  >([]);\n  const initialDragPositionRef = useRef({ x: 0, y: 0 });\n\n  function handleDragStart(event: Konva.KonvaEventObject<DragEvent>) {\n    initialDragPositionRef.current = event.target.position();\n    const stage = event.target.getStage();\n    if (stage) {\n      for (let item of selection.items) {\n        const node = stage.findOne(`#${item.id}`);\n        // Don't drag locked nodes\n        if (node && !node.name().endsWith(\"-locked\")) {\n          intersectingNodesRef.current.push({\n            ...item,\n            node,\n            initialX: node.x(),\n            initialY: node.y(),\n          });\n        }\n      }\n    }\n    onSelectionDragStart();\n  }\n\n  function handleDragMove(event: Konva.KonvaEventObject<DragEvent>) {\n    const deltaPosition = Vector2.subtract(\n      event.target.position(),\n      initialDragPositionRef.current\n    );\n    for (let item of intersectingNodesRef.current) {\n      let itemPosition = Vector2.add(\n        { x: item.initialX, y: item.initialY },\n        deltaPosition\n      );\n      if (map.snapToGrid) {\n        itemPosition = snapPositionToGrid(itemPosition);\n      }\n      item.node.position(itemPosition);\n    }\n  }\n\n  function handleDragEnd(event: Konva.KonvaEventObject<DragEvent>) {\n    const tokenChanges: Record<string, Partial<TokenState>> = {};\n    const noteChanges: Record<string, Partial<Note>> = {};\n    for (let item of intersectingNodesRef.current) {\n      if (item.type === \"token\") {\n        tokenChanges[item.id] = {\n          x: item.node.x() / mapWidth,\n          y: item.node.y() / mapHeight,\n          lastModifiedBy: userId,\n          lastModified: Date.now(),\n        };\n      } else {\n        noteChanges[item.id] = {\n          x: item.node.x() / mapWidth,\n          y: item.node.y() / mapHeight,\n          lastModifiedBy: userId,\n          lastModified: Date.now(),\n        };\n      }\n    }\n    onSelectionItemsChange(tokenChanges, noteChanges);\n    onSelectionChange({\n      ...selection,\n      x: event.target.x() / mapWidth,\n      y: event.target.y() / mapHeight,\n    });\n    intersectingNodesRef.current = [];\n    onPreventSelectionChange(false);\n    onSelectionDragEnd();\n  }\n\n  function handlePointerDown() {\n    onPreventSelectionChange(true);\n  }\n\n  function handlePointerUp() {\n    onPreventSelectionChange(false);\n  }\n\n  const hasItems = selection.items.length > 0;\n\n  // Update cursor when mouse enter and out of selection\n  function handleMouseEnter(event: Konva.KonvaEventObject<MouseEvent>) {\n    let stage = event.target.getStage();\n    if (stage && hasItems) {\n      stage.content.style.cursor = \"move\";\n    }\n  }\n\n  function handleMouseOut(event: Konva.KonvaEventObject<MouseEvent>) {\n    let stage = event.target.getStage();\n    if (stage) {\n      stage.content.style.cursor = \"\";\n    }\n  }\n\n  // Update cursor to move when selection is made or removed\n  useEffect(() => {\n    var node: Konva.Node | null = null;\n    if (lineRef.current) {\n      node = lineRef.current;\n    } else if (rectRef.current) {\n      node = rectRef.current;\n    }\n    let stage = node?.getStage();\n    if (stage && hasItems) {\n      stage.content.style.cursor = \"move\";\n    }\n    return () => {\n      if (stage) {\n        stage.content.style.cursor = \"\";\n      }\n    };\n  }, [hasItems]);\n\n  const requestRef = useRef<number>();\n  const lineRef = useRef<Konva.Line>(null);\n  const rectRef = useRef<Konva.Rect>(null);\n  useEffect(() => {\n    let prevTime = performance.now();\n    function animate(time: number) {\n      const delta = time - prevTime;\n      prevTime = time;\n      if (!hasItems) {\n        return;\n      }\n      requestRef.current = requestAnimationFrame(animate);\n      if (lineRef.current) {\n        lineRef.current.dashOffset(\n          lineRef.current.dashOffset() + delta * dashAnimationSpeed\n        );\n      }\n      if (rectRef.current) {\n        rectRef.current.dashOffset(\n          rectRef.current.dashOffset() + delta * dashAnimationSpeed\n        );\n      }\n    }\n\n    requestRef.current = requestAnimationFrame(animate);\n\n    return () => {\n      if (requestRef.current !== undefined) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [hasItems]);\n\n  const strokeWidth = (gridStrokeWidth * 0.75) / stageScale;\n  const defaultProps = {\n    stroke: colors.primary,\n    strokeWidth: strokeWidth,\n    dash: hasItems ? [strokeWidth / 2, strokeWidth * 2] : [],\n    onDragStart: handleDragStart,\n    onDragMove: handleDragMove,\n    onDragEnd: handleDragEnd,\n    draggable: true,\n    onMouseDown: handlePointerDown,\n    onMouseUp: handlePointerUp,\n    onTouchStart: handlePointerDown,\n    onTouchEnd: handlePointerUp,\n    onMouseEnter: handleMouseEnter,\n    onMouseOut: handleMouseOut,\n    // Increase stroke width when drawing a selection to\n    // prevent deselection click event from firing\n    hitStrokeWidth: hasItems ? undefined : 100,\n    id: \"selection\",\n  };\n  const x = selection.x * mapWidth;\n  const y = selection.y * mapHeight;\n\n  if (selection.type === \"path\") {\n    return (\n      <Line\n        points={scaleAndFlattenPoints(selection.data.points, {\n          x: mapWidth,\n          y: mapHeight,\n        })}\n        tension={0.5}\n        closed={hasItems}\n        lineCap=\"round\"\n        lineJoin=\"round\"\n        x={x}\n        y={y}\n        {...defaultProps}\n        {...props}\n        ref={lineRef}\n      />\n    );\n  } else {\n    return (\n      <Rect\n        x={x}\n        y={y}\n        offsetX={-selection.data.x * mapWidth}\n        offsetY={-selection.data.y * mapHeight}\n        width={selection.data.width * mapWidth}\n        height={selection.data.height * mapHeight}\n        lineCap=\"round\"\n        lineJoin=\"round\"\n        {...defaultProps}\n        {...props}\n        ref={rectRef}\n      />\n    );\n  }\n}\n\nexport default Selection;\n","import { useState, useEffect, useRef } from \"react\";\nimport { Group } from \"react-konva\";\nimport Konva from \"konva\";\n\nimport {\n  useDebouncedStageScale,\n  useMapWidth,\n  useMapHeight,\n  useInteractionEmitter,\n  MapDragEvent,\n  leftMouseButton,\n} from \"../../contexts/MapInteractionContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\n\nimport {\n  getDefaultShapeData,\n  getUpdatedShapeData,\n  simplifyPoints,\n} from \"../../helpers/drawing\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport {\n  getRelativePointerPosition,\n  scaleAndFlattenPoints,\n} from \"../../helpers/konva\";\nimport { Intersection } from \"../../helpers/token\";\n\nimport {\n  Selection as SelectionType,\n  SelectionItem,\n  SelectToolSettings,\n} from \"../../types/Select\";\nimport { RectData } from \"../../types/Drawing\";\nimport { Map } from \"../../types/Map\";\nimport { useGridCellNormalizedSize } from \"../../contexts/GridContext\";\nimport Selection from \"../konva/Selection\";\nimport { SelectionItemsChangeEventHandler } from \"../../types/Events\";\nimport { getSelectionPoints } from \"../../helpers/selection\";\n\ntype MapSelectProps = {\n  active: boolean;\n  toolSettings: SelectToolSettings;\n  onSelectionItemsChange: SelectionItemsChangeEventHandler;\n  selection: SelectionType | null;\n  onSelectionChange: React.Dispatch<React.SetStateAction<SelectionType | null>>;\n  onSelectionMenuOpen: (open: boolean) => void;\n  onSelectionDragStart: () => void;\n  onSelectionDragEnd: () => void;\n  disabledTokens: Record<string, boolean>;\n  disabledNotes: Record<string, boolean>;\n  map: Map;\n};\n\nfunction SelectTool({\n  active,\n  toolSettings,\n  onSelectionItemsChange,\n  selection,\n  onSelectionChange,\n  onSelectionMenuOpen,\n  onSelectionDragStart,\n  onSelectionDragEnd,\n  disabledTokens,\n  disabledNotes,\n  map,\n}: MapSelectProps) {\n  const stageScale = useDebouncedStageScale();\n  const mapWidth = useMapWidth();\n  const mapHeight = useMapHeight();\n  const interactionEmitter = useInteractionEmitter();\n\n  const gridCellNormalizedSize = useGridCellNormalizedSize();\n\n  const mapStageRef = useMapStage();\n  const [isBrushDown, setIsBrushDown] = useState(false);\n\n  // Use a ref here to prevent case where brush down event\n  // would fire before React state was refreshed\n  const preventSelectionRef = useRef(false);\n\n  useEffect(() => {\n    if (!active) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n    const mapImage = mapStage?.findOne(\"#mapImage\");\n\n    function getBrushPosition() {\n      if (!mapImage) {\n        return;\n      }\n      let position = getRelativePointerPosition(mapImage);\n      if (!position) {\n        return;\n      }\n      return Vector2.divide(position, {\n        x: mapImage.width(),\n        y: mapImage.height(),\n      });\n    }\n\n    function handleBrushDown(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition || preventSelectionRef.current) {\n        return;\n      }\n      if (toolSettings.type === \"path\") {\n        onSelectionChange({\n          type: \"path\",\n          items: [],\n          data: { points: [brushPosition] },\n          x: 0,\n          y: 0,\n        });\n      } else {\n        onSelectionChange({\n          type: \"rectangle\",\n          items: [],\n          data: getDefaultShapeData(\"rectangle\", brushPosition) as RectData,\n          x: 0,\n          y: 0,\n        });\n      }\n      setIsBrushDown(true);\n    }\n\n    function handleBrushMove(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      const brushPosition = getBrushPosition();\n      if (!brushPosition || preventSelectionRef.current) {\n        return;\n      }\n      if (isBrushDown && selection && mapImage) {\n        if (selection.type === \"path\") {\n          onSelectionChange((prevSelection) => {\n            if (prevSelection?.type !== \"path\") {\n              return prevSelection;\n            }\n            const prevPoints = prevSelection.data.points;\n            if (\n              Vector2.compare(\n                prevPoints[prevPoints.length - 1],\n                brushPosition,\n                0.001\n              )\n            ) {\n              return prevSelection;\n            }\n            const simplified = simplifyPoints(\n              [...prevPoints, brushPosition],\n              1 / 1000 / stageScale\n            );\n            return {\n              ...prevSelection,\n              data: { points: simplified },\n            };\n          });\n        } else {\n          onSelectionChange((prevSelection) => {\n            if (prevSelection?.type !== \"rectangle\") {\n              return prevSelection;\n            }\n            return {\n              ...prevSelection,\n              data: getUpdatedShapeData(\n                \"rectangle\",\n                prevSelection.data,\n                brushPosition,\n                gridCellNormalizedSize,\n                mapWidth,\n                mapHeight\n              ) as RectData,\n            };\n          });\n        }\n      }\n    }\n\n    function handleBrushUp(props: MapDragEvent) {\n      if (!leftMouseButton(props)) {\n        return;\n      }\n      if (preventSelectionRef.current) {\n        return;\n      }\n      if (selection && mapStage) {\n        const tokensGroups = mapStage.find<Konva.Group>(\"#tokens\");\n        const notesGroups = mapStage.find<Konva.Group>(\"#notes\");\n        const points = getSelectionPoints(selection);\n        const intersection = new Intersection(\n          {\n            type: \"path\",\n            points: scaleAndFlattenPoints(points, {\n              x: mapWidth,\n              y: mapHeight,\n            }),\n          },\n          { x: selection.x, y: selection.y },\n          { x: 0, y: 0 },\n          0\n        );\n\n        let intersectingItems: SelectionItem[] = [];\n\n        for (let tokensGroup of tokensGroups) {\n          const tokens = tokensGroup.children;\n          if (tokens) {\n            for (let token of tokens) {\n              if (\n                token.id() &&\n                !(token.id() in disabledTokens) &&\n                intersection.intersects(token.position())\n              ) {\n                intersectingItems.push({ type: \"token\", id: token.id() });\n              }\n            }\n          }\n        }\n\n        for (let notesGroup of notesGroups) {\n          const notes = notesGroup.children;\n          if (notes) {\n            for (let note of notes) {\n              if (\n                note.id() &&\n                !(note.id() in disabledNotes) &&\n                intersection.intersects(note.position())\n              ) {\n                intersectingItems.push({ type: \"note\", id: note.id() });\n              }\n            }\n          }\n        }\n\n        if (intersectingItems.length > 0) {\n          onSelectionChange((prevSelection) => {\n            if (!prevSelection) {\n              return prevSelection;\n            }\n            return { ...prevSelection, items: intersectingItems };\n          });\n          onSelectionMenuOpen(true);\n        } else {\n          onSelectionChange(null);\n        }\n      } else {\n        onSelectionChange(null);\n      }\n\n      setIsBrushDown(false);\n    }\n\n    function handlePointerClick(event: Konva.KonvaEventObject<MouseEvent>) {\n      if (event.target.id() === \"selection\") {\n        onSelectionMenuOpen(true);\n      } else {\n        onSelectionChange(null);\n        onSelectionMenuOpen(false);\n      }\n    }\n\n    interactionEmitter?.on(\"dragStart\", handleBrushDown);\n    interactionEmitter?.on(\"drag\", handleBrushMove);\n    interactionEmitter?.on(\"dragEnd\", handleBrushUp);\n    mapStage?.on(\"click tap\", handlePointerClick);\n\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleBrushDown);\n      interactionEmitter?.off(\"drag\", handleBrushMove);\n      interactionEmitter?.off(\"dragEnd\", handleBrushUp);\n      mapStage?.off(\"click tap\", handlePointerClick);\n    };\n  });\n\n  return (\n    <Group>\n      {selection && (\n        <Selection\n          selection={selection}\n          onSelectionChange={onSelectionChange}\n          onSelectionItemsChange={onSelectionItemsChange}\n          onPreventSelectionChange={(prevent: boolean) =>\n            (preventSelectionRef.current = prevent)\n          }\n          onSelectionDragStart={onSelectionDragStart}\n          onSelectionDragEnd={onSelectionDragEnd}\n          map={map}\n        />\n      )}\n    </Group>\n  );\n}\n\nexport default SelectTool;\n","import { useEffect, useState } from \"react\";\nimport { v4 as uuid } from \"uuid\";\n\nimport SelectionDragOverlay from \"../components/selection/SelectionDragOverlay\";\nimport SelectionMenu from \"../components/selection/SelectionMenu\";\nimport SelectTool from \"../components/tools/SelectTool\";\nimport { useBlur, useKeyboard } from \"../contexts/KeyboardContext\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport shortcuts from \"../shortcuts\";\nimport {\n  SelectionItemsChangeEventHandler,\n  SelectionItemsCreateEventHandler,\n  SelectionItemsRemoveEventHandler,\n} from \"../types/Events\";\nimport { Map, MapToolId } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport { Note } from \"../types/Note\";\nimport { Selection } from \"../types/Select\";\nimport { SelectToolSettings } from \"../types/Select\";\nimport { TokenState } from \"../types/TokenState\";\n\nfunction useMapSelection(\n  map: Map | null,\n  mapState: MapState | null,\n  onSelectionItemsChange: SelectionItemsChangeEventHandler,\n  onSelectionItemsRemove: SelectionItemsRemoveEventHandler,\n  onSelectionItemsCreate: SelectionItemsCreateEventHandler,\n  selectedToolId: MapToolId,\n  settings: SelectToolSettings\n) {\n  const userId = useUserId();\n  const disabledTokens: Record<string, boolean> = {};\n  const disabledNotes: Record<string, boolean> = {};\n  if (mapState && map && map.owner !== userId) {\n    if (!mapState.editFlags.includes(\"tokens\")) {\n      for (let token of Object.values(mapState.tokens)) {\n        if (token.owner !== userId) {\n          disabledTokens[token.id] = true;\n        }\n      }\n    }\n    if (!mapState.editFlags.includes(\"notes\")) {\n      for (let note of Object.values(mapState.notes)) {\n        disabledNotes[note.id] = true;\n      }\n    }\n  }\n\n  const [isSelectionMenuOpen, setIsSelectionMenuOpen] =\n    useState<boolean>(false);\n  const [isSelectionDragging, setIsSelectionDragging] = useState(false);\n  const [selection, setSelection] = useState<Selection | null>(null);\n\n  function handleSelectionMenuOpen(open: boolean) {\n    setIsSelectionMenuOpen(open);\n  }\n\n  const active = selectedToolId === \"select\" || selectedToolId === \"effect\";\n\n  // Remove selection when changing tools\n  useEffect(() => {\n    if (!active) {\n      setSelection(null);\n      setIsSelectionMenuOpen(false);\n    }\n  }, [active]);\n\n  // Remove selection when changing maps\n  useEffect(() => {\n    setSelection(null);\n    setIsSelectionMenuOpen(false);\n  }, [map]);\n\n  function handleSelectionDragStart() {\n    if (duplicateSelection && selection) {\n      const tokenStates: TokenState[] = [];\n      const notes: Note[] = [];\n      for (let item of selection.items) {\n        if (item.type === \"token\") {\n          const token = mapState?.tokens[item.id];\n          if (token && !token.locked) {\n            tokenStates.push({ ...token, id: uuid() });\n          }\n        } else {\n          const note = mapState?.notes[item.id];\n          if (note && !note.locked) {\n            notes.push({ ...note, id: uuid() });\n          }\n        }\n      }\n      onSelectionItemsCreate(tokenStates, notes);\n    }\n    setIsSelectionDragging(true);\n  }\n\n  function handleSelectionDragEnd() {\n    setIsSelectionDragging(false);\n  }\n\n  function handleSelectionItemsRemove(\n    tokenStateIds: string[],\n    noteIds: string[]\n  ) {\n    setSelection(null);\n    onSelectionItemsRemove(tokenStateIds, noteIds);\n  }\n\n  const [duplicateSelection, setDuplicateSelection] = useState(false);\n  function handleKeyDown(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateSelection(true);\n    }\n    if (shortcuts.delete(event) && selection && active) {\n      const tokenIds: string[] = [];\n      const noteIds: string[] = [];\n      for (let item of selection.items) {\n        if (item.type === \"token\") {\n          tokenIds.push(item.id);\n        } else {\n          noteIds.push(item.id);\n        }\n      }\n      handleSelectionItemsRemove(tokenIds, noteIds);\n      setIsSelectionMenuOpen(false);\n    }\n  }\n\n  function handleKeyUp(event: KeyboardEvent) {\n    if (shortcuts.duplicate(event)) {\n      setDuplicateSelection(false);\n    }\n  }\n\n  function handleBlur() {\n    setDuplicateSelection(false);\n  }\n\n  useKeyboard(handleKeyDown, handleKeyUp);\n  useBlur(handleBlur);\n\n  const selectionTool = map ? (\n    <SelectTool\n      active={active}\n      toolSettings={settings}\n      onSelectionItemsChange={onSelectionItemsChange}\n      selection={selection}\n      onSelectionChange={setSelection}\n      onSelectionMenuOpen={handleSelectionMenuOpen}\n      onSelectionDragStart={handleSelectionDragStart}\n      onSelectionDragEnd={handleSelectionDragEnd}\n      disabledTokens={disabledTokens}\n      disabledNotes={disabledNotes}\n      map={map}\n    />\n  ) : null;\n\n  const selectionMenu = (\n    <SelectionMenu\n      isOpen={isSelectionMenuOpen}\n      active={active}\n      effectMode={selectedToolId === \"effect\"}\n      onRequestClose={() => setIsSelectionMenuOpen(false)}\n      onRequestOpen={() => setIsSelectionMenuOpen(true)}\n      selection={selection}\n      onSelectionChange={setSelection}\n      onSelectionItemsChange={onSelectionItemsChange}\n      onSelectionItemsCreate={onSelectionItemsCreate}\n      map={map}\n      mapState={mapState}\n    />\n  );\n\n  const selectionDragOverlay = selection ? (\n    <SelectionDragOverlay\n      dragging={isSelectionDragging}\n      selection={selection}\n      onSelectionItemsRemove={handleSelectionItemsRemove}\n    />\n  ) : null;\n\n  return { selectionTool, selectionMenu, selectionDragOverlay };\n}\n\nexport default useMapSelection;\n","import { TokenNoteStyle } from \"../types/TokenNote\";\n\nexport const TOKEN_NOTE_LOCK_TOPIC_PREFIX = \"ext.token_notes\";\n\nexport const TOKEN_NOTE_LOCK_TOPICS = {\n  lockRequest: \"ext.token_notes.lock.request\",\n  lockGranted: \"ext.token_notes.lock.granted\",\n  lockDenied: \"ext.token_notes.lock.denied\",\n  lockTouch: \"ext.token_notes.lock.touch\",\n  lockReleased: \"ext.token_notes.lock.released\",\n  unlock: \"ext.token_notes.unlock\",\n} as const;\n\nexport type TokenNoteLockTopic =\n  typeof TOKEN_NOTE_LOCK_TOPICS[keyof typeof TOKEN_NOTE_LOCK_TOPICS];\n\nexport type TokenNoteLockReleaseReason = \"timeout\" | \"disconnect\" | \"owner\";\n\nexport type TokenNoteLockBasePayload = {\n  mapId: string;\n  tokenStateId: string;\n  userId: string;\n  ts: number;\n};\nexport type TokenNoteLockRequestPayload = TokenNoteLockBasePayload & {\n  clientLockId: string;\n};\n\nexport type TokenNoteLockGrantedPayload = TokenNoteLockBasePayload & {\n  lockId: string;\n  expiresAt: number;\n};\n\nexport type TokenNoteLockDeniedPayload = {\n  mapId: string;\n  tokenStateId: string;\n  ownerUserId: string;\n  lockId: string;\n  expiresAt: number;\n  ts: number;\n};\n\nexport type TokenNoteLockTouchPayload = TokenNoteLockBasePayload & {\n  lockId: string;\n};\nexport type TokenNoteLockReleasedPayload = TokenNoteLockBasePayload & {\n  lockId: string;\n  reason: TokenNoteLockReleaseReason;\n};\n\nexport type TokenNoteUnlockPayload = TokenNoteLockBasePayload & {\n  lockId: string;\n  content: string;\n  style: TokenNoteStyle;\n  lastEditedAt: number;\n};\n","import { Outline } from \"../../types/Outline\";\n\ntype TokenOutlineSVGProps = {\n  outline: Outline;\n  width: number;\n  height: number;\n};\n\nexport function TokenOutlineSVG({\n  outline,\n  width,\n  height,\n}: TokenOutlineSVGProps) {\n  if (outline.type === \"rect\") {\n    return (\n      <svg\n        width=\"100%\"\n        height=\"100%\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        fill=\"rgba(0, 0, 0, 0.3)\"\n        viewBox={`0, 0, ${width} ${height}`}\n        preserveAspectRatio=\"xMidYMid slice\"\n      >\n        <rect\n          x={outline.x}\n          y={outline.y}\n          width={outline.width}\n          height={outline.height}\n        />\n      </svg>\n    );\n  } else if (outline.type === \"circle\") {\n    return (\n      <svg\n        width=\"100%\"\n        height=\"100%\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        fill=\"rgba(0, 0, 0, 0.3)\"\n        viewBox={`0, 0, ${width} ${height}`}\n        preserveAspectRatio=\"xMidYMid slice\"\n      >\n        <circle r={outline.radius} cx={outline.x} cy={outline.y} />\n      </svg>\n    );\n  } else {\n    let points = [];\n    for (let i = 0; i < outline.points.length; i += 2) {\n      points.push(`${outline.points[i]}, ${outline.points[i + 1]}`);\n    }\n    return (\n      <svg\n        width=\"100%\"\n        height=\"100%\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        fill=\"rgba(0, 0, 0, 0.3)\"\n        viewBox={`0, 0, ${width} ${height}`}\n        preserveAspectRatio=\"xMidYMid slice\"\n      >\n        <polygon points={points.join(\" \")} />\n      </svg>\n    );\n  }\n}\n\nexport default TokenOutlineSVG;\n","import { useState } from \"react\";\nimport { Image, Box, ImageProps } from \"theme-ui\";\n\nimport { useDataURL } from \"../../contexts/AssetsContext\";\n\nimport { tokenSources as defaultTokenSources } from \"../../tokens\";\nimport { Token } from \"../../types/Token\";\n\nimport TokenOutlineSVG from \"./TokenOutline\";\n\ntype TokenImageProps = {\n  token: Token;\n} & ImageProps;\n\nfunction TokenImage({ token, ...props }: TokenImageProps) {\n  const tokenURL = useDataURL(\n    token,\n    defaultTokenSources,\n    undefined,\n    token.type === \"file\"\n  );\n\n  const [showOutline, setShowOutline] = useState(true);\n\n  return (\n    <>\n      {showOutline && (\n        <Box\n          title={props.alt}\n          aria-label={props.alt}\n          sx={{ width: \"100%\", height: \"100%\", minHeight: 0 }}\n        >\n          <TokenOutlineSVG\n            outline={token.outline}\n            width={token.width}\n            height={token.height}\n          />\n        </Box>\n      )}\n      <Image\n        onLoad={() => setShowOutline(false)}\n        src={tokenURL}\n        style={showOutline ? { display: \"none\" } : props.style}\n        {...props}\n      />\n    </>\n  );\n}\n\nexport default TokenImage;\n","import { useEffect } from \"react\";\nimport { Box, Button, Flex } from \"theme-ui\";\nimport type { FocusEvent } from \"react\";\nimport { EditorContent, useEditor } from \"@tiptap/react\";\nimport StarterKit from \"@tiptap/starter-kit\";\n\ntype TokenNoteEditorProps = {\n  content: string;\n  editable: boolean;\n  showToolbar: boolean;\n  onChange: (value: string) => void;\n  onBlur?: (event: FocusEvent<HTMLDivElement>) => void;\n};\n\nfunction TokenNoteEditor({\n  content,\n  editable,\n  showToolbar,\n  onChange,\n  onBlur,\n}: TokenNoteEditorProps) {\n  const editor = useEditor({\n    extensions: [StarterKit],\n    content,\n    editable,\n    onUpdate: ({ editor: activeEditor }) => {\n      onChange(activeEditor.getHTML());\n    },\n  });\n  useEffect(() => {\n    if (editor && editor.getHTML() !== content) {\n      editor.commands.setContent(content, { emitUpdate: false });\n    }\n  }, [content, editor]);\n\n  useEffect(() => {\n    if (editor) {\n      editor.setEditable(editable);\n    }\n  }, [editable, editor]);\n\n  if (!editor) {\n    return null;\n  }\n  return (\n    <Box\n      data-note-scroll=\"true\"\n      sx={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        height: \"100%\",\n        minHeight: 0,\n      }}\n    >\n      {showToolbar && (\n        <Flex sx={{ gap: 2, pb: 2 }}>\n          <Button\n            variant=\"secondary\"\n            onClick={() => editor.chain().focus().toggleBold().run()}\n            disabled={!editor.can().toggleBold()}\n          >\n            B\n          </Button>\n          <Button\n            variant=\"secondary\"\n            onClick={() => editor.chain().focus().toggleItalic().run()}\n            disabled={!editor.can().toggleItalic()}\n          >\n            I\n          </Button>\n          <Button\n            variant=\"secondary\"\n            onClick={() => editor.chain().focus().toggleStrike().run()}\n            disabled={!editor.can().toggleStrike()}\n          >\n            S\n          </Button>\n        </Flex>\n      )}\n      <Box\n        sx={{\n          flexGrow: 1,\n          minHeight: 0,\n          overflow: \"hidden\",\n          \"& .ProseMirror\": {\n            outline: \"none\",\n            minHeight: \"100%\",\n            lineHeight: 1.4,\n            height: \"100%\",\n            overflowY: \"auto\",\n            overscrollBehavior: \"contain\",\n            scrollbarWidth: \"thin\",\n            \"&::-webkit-scrollbar\": {\n              width: \"2px\",\n            },\n            \"&::-webkit-scrollbar-thumb\": {\n              backgroundColor: \"rgba(0, 0, 0, 0.18)\",\n              borderRadius: \"999px\",\n            },\n            \"&::-webkit-scrollbar-track\": {\n              backgroundColor: \"transparent\",\n            },\n          },\n        }}\n      >\n        <EditorContent editor={editor} onBlur={onBlur} />\n      </Box>\n    </Box>\n  );\n}\n\nexport default TokenNoteEditor;\n","import { useEffect, useRef } from \"react\";\nimport { Box, Button, Flex, IconButton, Text, useColorMode } from \"theme-ui\";\n\nimport FullScreenExitIcon from \"../../icons/FullScreenExitIcon\";\nimport FullScreenIcon from \"../../icons/FullScreenIcon\";\nimport EditTileIcon from \"../../icons/EditTileIcon\";\n\nimport TokenImage from \"./TokenImage\";\nimport TokenNoteEditor from \"./TokenNoteEditor\";\n\nimport { Token } from \"../../types/Token\";\nimport { TokenState } from \"../../types/TokenState\";\nimport { TokenNoteStyle } from \"../../types/TokenNote\";\nimport type { TokenNoteLockReleaseReason } from \"../../network/TokenNoteLockProtocol\";\n\ntype TokenNoteSheetProps = {\n  isOpen: boolean;\n  tokenState?: TokenState;\n  token?: Token;\n  content: string;\n  style: TokenNoteStyle;\n  canRead: boolean;\n  canEdit: boolean;\n  isEditing: boolean;\n  isExpanded: boolean;\n  blur: \"none\" | \"low\" | \"high\";\n  fontSize: \"sm\" | \"md\" | \"lg\";\n  lockOwnerId?: string;\n  lockReleaseReason?: TokenNoteLockReleaseReason | null;\n  onRequestClose: () => void;\n  onToggleExpanded: () => void;\n  onRequestEdit: () => void;\n  onEditorBlur: () => void;\n  onContentChange: (value: string) => void;\n  onStyleChange: (style: Partial<TokenNoteStyle>) => void;\n};\n\nfunction TokenNoteSheet({\n  isOpen,\n  tokenState,\n  token,\n  content,\n  style,\n  canRead,\n  canEdit,\n  isEditing,\n  isExpanded,\n  blur,\n  fontSize,\n  lockOwnerId,\n  lockReleaseReason,\n  onRequestClose,\n  onToggleExpanded,\n  onRequestEdit,\n  onEditorBlur,\n  onContentChange,\n  onStyleChange,\n}: TokenNoteSheetProps) {\n  const [colorMode] = useColorMode();\n  const sheetRef = useRef<HTMLDivElement>(null);\n  const isLocked = !!lockOwnerId;\n  const releaseMessage =\n    lockReleaseReason === \"timeout\"\n      ? \"\"\n      : lockReleaseReason === \"disconnect\"\n      ? \"\"\n      : lockReleaseReason === \"owner\"\n      ? \"\"\n      : \"\";\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n    function handlePointerDown(event: MouseEvent | TouchEvent) {\n      if (!sheetRef.current) {\n        return;\n      }\n      const target = event.target as Node | null;\n      if (target && !sheetRef.current.contains(target)) {\n        onRequestClose();\n      }\n    }\n    document.addEventListener(\"mousedown\", handlePointerDown);\n    document.addEventListener(\"touchstart\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"mousedown\", handlePointerDown);\n      document.removeEventListener(\"touchstart\", handlePointerDown);\n    };\n  }, [isOpen, onRequestClose]);\n\n  if (!isOpen || !canRead) {\n    return null;\n  }\n\n  const background =\n    colorMode === \"light\"\n      ? \"rgba(255, 255, 255, 0.6)\"\n      : \"rgba(30, 30, 35, 0.6)\";\n  const blurAmount = blur === \"none\" ? \"0px\" : blur === \"low\" ? \"6px\" : \"12px\";\n  const sheetHeight = isExpanded ? [\"80vh\", \"70vh\"] : [\"55vh\", \"40vh\"];\n  const fontFamily =\n    style.fontFamily === \"handwritten\"\n      ? \"Pacifico, cursive\"\n      : style.fontFamily === \"rune\"\n        ? \"Bree Serif, serif\"\n        : \"inherit\";\n  const fontSizeValue = fontSize === \"sm\" ? \"12px\" : fontSize === \"lg\" ? \"16px\" : \"14px\";\n  const headerTitle = tokenState?.label || token?.name || \"Token\";\n\n  const palette = [\n    { id: \"red\", color: \"rgba(220, 70, 70, 0.2)\" },\n    { id: \"green\", color: \"rgba(70, 180, 120, 0.2)\" },\n    { id: \"blue\", color: \"rgba(70, 120, 200, 0.2)\" },\n    { id: \"purple\", color: \"rgba(160, 90, 200, 0.2)\" },\n    { id: \"gold\", color: \"rgba(200, 170, 80, 0.2)\" },\n  ];\n  return (\n    <Box\n      sx={{\n        position: \"fixed\",\n        left: 0,\n        right: 0,\n        bottom: 0,\n        zIndex: 30,\n        display: \"flex\",\n        justifyContent: \"center\",\n        pointerEvents: isOpen ? \"auto\" : \"none\",\n        px: [2, 3],\n        pb: [2, 2],\n        paddingBottom: \"env(safe-area-inset-bottom)\",\n      }}\n    >\n      <Box\n        ref={sheetRef}\n        sx={{\n          width: \"100%\",\n          maxWidth: [\"100%\", \"720px\"],\n          height: sheetHeight,\n          backgroundColor: background,\n          borderTopLeftRadius: \"16px\",\n          borderTopRightRadius: \"16px\",\n          borderBottomLeftRadius: 0,\n          borderBottomRightRadius: 0,\n          border: \"1px solid\",\n          borderColor: \"border\",\n          backdropFilter: `blur(${blurAmount})`,\n          WebkitBackdropFilter: `blur(${blurAmount})`,\n          transform: isOpen ? \"translateY(0)\" : \"translateY(100%)\",\n          opacity: isOpen ? 1 : 0,\n          transition: \"transform 200ms ease, opacity 200ms ease\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          overflow: \"hidden\",\n        }}\n      >\n        <Flex\n          sx={{\n            alignItems: \"center\",\n            justifyContent: \"space-between\",\n            px: [2, 3],\n            py: 2,\n          }}\n        >\n          <Flex sx={{ alignItems: \"center\", gap: 2 }}>\n            {token && (\n              <Box sx={{ width: \"32px\", height: \"32px\" }}>\n                <TokenImage token={token} alt={headerTitle} />\n              </Box>\n            )}\n            <Text variant=\"body2\">{headerTitle}</Text>\n          </Flex>\n          <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n            {canEdit && !isEditing && !isLocked && (\n              <IconButton\n                aria-label=\"Edit\"\n                title=\"Edit\"\n                onClick={onRequestEdit}\n              >\n                <EditTileIcon />\n              </IconButton>\n            )}\n            <IconButton\n              aria-label={isExpanded ? \"Exit Fullscreen\" : \"Fullscreen\"}\n              title={isExpanded ? \"Exit Fullscreen\" : \"Fullscreen\"}\n              onClick={onToggleExpanded}\n            >\n              {isExpanded ? <FullScreenExitIcon /> : <FullScreenIcon />}\n            </IconButton>\n            <IconButton aria-label=\"Close\" title=\"Close\" onClick={onRequestClose}>\n              <Text as=\"span\">X</Text>\n            </IconButton>\n          </Flex>\n        </Flex>\n        <Box\n          sx={{\n            width: \"48px\",\n            height: \"4px\",\n            backgroundColor: \"border\",\n            borderRadius: \"999px\",\n            alignSelf: \"center\",\n            mb: 2,\n          }}\n        />\n        {isLocked && (\n          <Text variant=\"caption\" sx={{ px: [2, 3], pb: 2 }}>\n            \n          </Text>\n        )}\n        {!isLocked && releaseMessage && (\n          <Text variant=\"caption\" sx={{ px: [2, 3], pb: 2 }}>\n            {releaseMessage}\n          </Text>\n        )}\n        {isEditing && canEdit && (\n          <Flex sx={{ px: [2, 3], pb: 2, gap: 2, flexWrap: \"wrap\" }}>\n            <Flex sx={{ gap: 1 }}>\n              <Button\n                variant=\"secondary\"\n                onClick={() => onStyleChange({ fontFamily: \"default\" })}\n              >\n                System\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => onStyleChange({ fontFamily: \"handwritten\" })}\n              >\n                Handwritten\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => onStyleChange({ fontFamily: \"rune\" })}\n              >\n                Runic\n              </Button>\n            </Flex>\n            <Flex sx={{ gap: 1 }}>\n              {palette.map((item) => (\n                <Box\n                  key={item.id}\n                  sx={{\n                    width: \"20px\",\n                    height: \"20px\",\n                    borderRadius: \"50%\",\n                    backgroundColor: item.color,\n                    border: \"1px solid\",\n                    borderColor: \"border\",\n                    cursor: \"pointer\",\n                  }}\n                  onClick={() => onStyleChange({ backgroundColor: item.color })}\n                />\n              ))}\n              <Box\n                sx={{\n                  width: \"20px\",\n                  height: \"20px\",\n                  borderRadius: \"50%\",\n                  border: \"1px solid\",\n                  borderColor: \"border\",\n                  cursor: \"pointer\",\n                  backgroundColor: \"transparent\",\n                }}\n                onClick={() => onStyleChange({ backgroundColor: undefined })}\n              />\n            </Flex>\n          </Flex>\n        )}\n        <Box\n          data-note-scroll=\"true\"\n          sx={{\n            flexGrow: 1,\n            px: [2, 3],\n            pb: [2, 3],\n            fontFamily,\n            fontSize: fontSizeValue,\n            lineHeight: 1.4,\n            backgroundColor: style.backgroundColor || \"transparent\",\n            opacity: isLocked ? 0.6 : 1,\n            filter: isLocked ? \"grayscale(0.15)\" : \"none\",\n            transition: \"opacity 150ms ease\",\n            minHeight: 0,\n            overflowY: \"auto\",\n            scrollbarWidth: \"thin\",\n            \"&::-webkit-scrollbar\": {\n              width: \"2px\",\n            },\n            \"&::-webkit-scrollbar-thumb\": {\n              backgroundColor: \"rgba(0, 0, 0, 0.15)\",\n              borderRadius: \"999px\",\n            },\n            \"&::-webkit-scrollbar-track\": {\n              backgroundColor: \"transparent\",\n            },\n            touchAction: \"pan-y\",\n            overscrollBehavior: \"contain\",\n          }}\n          onWheel={(event) => event.stopPropagation()}\n          onWheelCapture={(event) => event.stopPropagation()}\n        onTouchMove={(event) => event.stopPropagation()}\n        onTouchMoveCapture={(event) => event.stopPropagation()}\n      >\n        <TokenNoteEditor\n          content={content}\n          editable={canEdit && isEditing}\n          showToolbar={canEdit && isEditing}\n          onChange={onContentChange}\n          onBlur={(event) => {\n            const nextTarget = event.relatedTarget as Node | null;\n            if (nextTarget && sheetRef.current?.contains(nextTarget)) {\n              return;\n            }\n            onEditorBlur();\n          }}\n        />\n      </Box>\n      </Box>\n    </Box>\n  );\n}\n\nexport default TokenNoteSheet;\n","import { useEffect, useRef, useState } from \"react\";\nimport { Box, Button, Flex, IconButton, Text, useColorMode } from \"theme-ui\";\nimport Konva from \"konva\";\n\nimport { useInteractionEmitter } from \"../../contexts/MapInteractionContext\";\nimport { Token } from \"../../types/Token\";\nimport { TokenState } from \"../../types/TokenState\";\nimport { TokenNoteStyle } from \"../../types/TokenNote\";\nimport EditTileIcon from \"../../icons/EditTileIcon\";\nimport TokenNoteEditor from \"./TokenNoteEditor\";\n\ntype TokenNotePopoverProps = {\n  isOpen: boolean;\n  tokenState?: TokenState;\n  token?: Token;\n  content: string;\n  style: TokenNoteStyle;\n  canRead: boolean;\n  canEdit: boolean;\n  isEditing: boolean;\n  anchorNode?: Konva.Node;\n  lockOwnerId?: string;\n  onRequestClose: () => void;\n  onRequestExpand: () => void;\n  onRequestEdit: () => void;\n  onEditorBlur: () => void;\n  onContentChange: (value: string) => void;\n};\n\nfunction TokenNotePopover({\n  isOpen,\n  tokenState,\n  token,\n  content,\n  style,\n  canRead,\n  canEdit,\n  isEditing,\n  anchorNode,\n  lockOwnerId,\n  onRequestClose,\n  onRequestExpand,\n  onRequestEdit,\n  onEditorBlur,\n  onContentChange,\n}: TokenNotePopoverProps) {\n  const [colorMode] = useColorMode();\n  const interactionEmitter = useInteractionEmitter();\n  const popoverRef = useRef<HTMLDivElement>(null);\n  const anchorRectRef =\n    useRef<{ x: number; y: number; width: number; height: number } | null>(null);\n\n  const [left, setLeft] = useState(0);\n  const [top, setTop] = useState(0);\n\n  useEffect(() => {\n    if (!isOpen || !anchorNode) {\n      return;\n    }\n    const rect = anchorNode.getClientRect();\n    anchorRectRef.current = rect;\n    const mapElement = document.querySelector(\".map\");\n    if (!mapElement) {\n      return;\n    }\n    const mapRect = mapElement.getBoundingClientRect();\n    const nextLeft = mapRect.left + rect.x + rect.width / 2;\n    const nextTop = mapRect.top + rect.y;\n    setLeft(nextLeft);\n    setTop(nextTop);\n  }, [anchorNode, isOpen]);\n\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n    const node = popoverRef.current;\n    const mapElement = document.querySelector(\".map\");\n    const anchorRect = anchorRectRef.current;\n    if (!node || !mapElement || !anchorRect) {\n      return;\n    }\n    const mapRect = mapElement.getBoundingClientRect();\n    const nodeRect = node.getBoundingClientRect();\n    let desiredLeft =\n      mapRect.left + anchorRect.x + anchorRect.width / 2 - nodeRect.width / 2;\n    let desiredTop = mapRect.top + anchorRect.y - nodeRect.height - 12;\n    if (desiredTop < mapRect.top + 8) {\n      desiredTop = mapRect.top + anchorRect.y + anchorRect.height + 12;\n    }\n    const clampedLeft = Math.min(\n      mapRect.right - nodeRect.width - 8,\n      Math.max(mapRect.left + 8, desiredLeft)\n    );\n    const clampedTop = Math.min(\n      mapRect.bottom - nodeRect.height - 8,\n      Math.max(mapRect.top + 8, desiredTop)\n    );\n    if (Math.abs(clampedLeft - left) > 1) {\n      setLeft(clampedLeft);\n    }\n    if (Math.abs(clampedTop - top) > 1) {\n      setTop(clampedTop);\n    }\n  }, [isOpen, left, top]);\n\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n    function handlePointerDown(event: MouseEvent | TouchEvent) {\n      if (!popoverRef.current) {\n        return;\n      }\n      const target = event.target as Node | null;\n      if (target && !popoverRef.current.contains(target)) {\n        onRequestClose();\n      }\n    }\n    document.addEventListener(\"mousedown\", handlePointerDown);\n    document.addEventListener(\"touchstart\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"mousedown\", handlePointerDown);\n      document.removeEventListener(\"touchstart\", handlePointerDown);\n    };\n  }, [isOpen, onRequestClose]);\n\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n    function handleDragStart() {\n      onRequestClose();\n    }\n    interactionEmitter?.on(\"dragStart\", handleDragStart);\n    return () => {\n      interactionEmitter?.off(\"dragStart\", handleDragStart);\n    };\n  }, [interactionEmitter, isOpen, onRequestClose]);\n\n  if (!isOpen || !canRead) {\n    return null;\n  }\n\n  const background =\n    colorMode === \"light\"\n      ? \"rgba(255, 255, 255, 0.7)\"\n      : \"rgba(30, 30, 35, 0.7)\";\n  const fontFamily =\n    style.fontFamily === \"handwritten\"\n      ? \"Pacifico, cursive\"\n      : style.fontFamily === \"rune\"\n        ? \"Bree Serif, serif\"\n        : \"inherit\";\n  const headerTitle = tokenState?.label || token?.name || \"Token\";\n\n  return (\n    <Box\n      ref={popoverRef}\n      sx={{\n        position: \"fixed\",\n        zIndex: 30,\n        left: `${left}px`,\n        top: `${top}px`,\n        width: [\"92vw\", \"230px\"],\n        maxWidth: \"240px\",\n        backgroundColor: background,\n        borderRadius: \"12px\",\n        border: \"1px solid\",\n        borderColor: \"border\",\n        backdropFilter: \"blur(10px)\",\n        WebkitBackdropFilter: \"blur(10px)\",\n        boxShadow: \"0 6px 20px rgba(0, 0, 0, 0.25)\",\n        overflow: \"hidden\",\n      }}\n    >\n      <Flex sx={{ alignItems: \"center\", justifyContent: \"space-between\", px: 2, py: 1 }}>\n        <Text variant=\"body2\" sx={{ fontSize: \"12px\" }}>\n          {headerTitle}\n        </Text>\n        <Flex sx={{ alignItems: \"center\", gap: 1 }}>\n          {canEdit && !isEditing && !lockOwnerId && (\n            <IconButton\n              aria-label=\"Edit\"\n              title=\"Edit\"\n              onClick={onRequestEdit}\n              sx={{ p: 1 }}\n            >\n              <EditTileIcon />\n            </IconButton>\n          )}\n          <Button\n            variant=\"secondary\"\n            onClick={onRequestExpand}\n            sx={{ fontSize: \"12px\", px: 2, py: 0 }}\n          >\n            \n          </Button>\n          <IconButton aria-label=\"Close\" title=\"Close\" onClick={onRequestClose}>\n            <Text as=\"span\">X</Text>\n          </IconButton>\n        </Flex>\n      </Flex>\n      {lockOwnerId && (\n        <Text variant=\"caption\" sx={{ px: 2, pb: 1 }}>\n          \n        </Text>\n      )}\n      <Box\n        data-note-scroll=\"true\"\n        sx={{\n          px: 2,\n          pb: 2,\n          fontFamily,\n          fontSize: \"12px\",\n          backgroundColor: style.backgroundColor || \"transparent\",\n          lineHeight: 1.4,\n          height: [\"45vh\", \"200px\"],\n          maxHeight: [\"45vh\", \"200px\"],\n          overflow: \"hidden\",\n          minHeight: 0,\n          touchAction: \"pan-y\",\n          overscrollBehavior: \"contain\",\n        }}\n        onWheel={(event) => event.stopPropagation()}\n        onWheelCapture={(event) => event.stopPropagation()}\n        onTouchMove={(event) => event.stopPropagation()}\n        onTouchMoveCapture={(event) => event.stopPropagation()}\n      >\n        <TokenNoteEditor\n          content={content}\n          editable={canEdit && isEditing}\n          showToolbar={false}\n          onChange={onContentChange}\n          onBlur={(event) => {\n            const nextTarget = event.relatedTarget as Node | null;\n            if (nextTarget && popoverRef.current?.contains(nextTarget)) {\n              return;\n            }\n            onEditorBlur();\n          }}\n        />\n      </Box>\n    </Box>\n  );\n}\n\nexport default TokenNotePopover;\n","import { ReactNode, useCallback, useEffect, useRef, useState } from \"react\";\nimport { useToasts } from \"react-toast-notifications\";\nimport Konva from \"konva\";\nimport shortid from \"shortid\";\n\nimport { Map } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport { TokenNote, TokenNoteStyle } from \"../types/TokenNote\";\nimport { TokenNoteSettings } from \"../types/Settings\";\nimport {\n  TokenNoteChangeEventHandler,\n  TokenNoteCreateEventHandler,\n  TokenNoteRemoveEventHandler,\n} from \"../types/Events\";\nimport Session, { StreamEventHandler } from \"../network/Session\";\nimport {\n  TOKEN_NOTE_LOCK_TOPICS,\n  TokenNoteLockDeniedPayload,\n  TokenNoteLockGrantedPayload,\n  TokenNoteLockReleasedPayload,\n  TokenNoteLockReleaseReason,\n  TokenNoteLockRequestPayload,\n  TokenNoteLockTouchPayload,\n  TokenNoteUnlockPayload,\n} from \"../network/TokenNoteLockProtocol\";\n\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useTokenData } from \"../contexts/TokenDataContext\";\n\nimport TokenNoteSheet from \"../components/token/TokenNoteSheet\";\nimport TokenNotePopover from \"../components/token/TokenNotePopover\";\n\ntype TokenNoteOpenMode = \"sheet\" | \"popover\";\n\ntype TokenNoteOpenOptions = {\n  mode?: TokenNoteOpenMode;\n  anchor?: Konva.Node | null;\n};\n\ntype TokenNoteHook = {\n  tokenNoteSheet: ReactNode;\n  tokenNotePopover: ReactNode;\n  openTokenNote: (tokenStateId: string, options?: TokenNoteOpenOptions) => void;\n};\n\nconst LOCK_TTL_MS = 30000;\nconst LOCK_TOUCH_INTERVAL_MS = 10000;\nconst LOCK_REQUEST_COOLDOWN_MS = 1000;\n\ntype TokenNoteLockState = {\n  tokenStateId: string;\n  ownerUserId: string;\n  lockId: string;\n  expiresAt: number;\n  lastTouchAt: number;\n};\n\nfunction useTokenNotes(\n  map: Map | null,\n  mapState: MapState | null,\n  session: Session,\n  onTokenNoteCreate: TokenNoteCreateEventHandler,\n  onTokenNoteChange: TokenNoteChangeEventHandler,\n  onTokenNoteRemove: TokenNoteRemoveEventHandler,\n  settings: TokenNoteSettings\n): TokenNoteHook {\n  const { addToast } = useToasts();\n  const userId = useUserId();\n  const { tokensById } = useTokenData();\n\n  const [lockState, setLockState] = useState<TokenNoteLockState | null>(null);\n  const [lockReleaseReason, setLockReleaseReason] =\n    useState<TokenNoteLockReleaseReason | null>(null);\n  const lockStateRef = useRef<TokenNoteLockState | null>(null);\n  const openTokenStateIdRef = useRef<string | null>(null);\n  const mapIdRef = useRef<string | null>(null);\n  const userIdRef = useRef<string | null>(null);\n  const noteRef = useRef<TokenNote | undefined>(undefined);\n  const canEditRef = useRef<boolean>(false);\n  const draftContentRef = useRef<string>(\"\");\n  const draftStyleRef = useRef<TokenNoteStyle>({\n    fontFamily: settings.defaultFont,\n  });\n  const lastActivityRef = useRef<number>(0);\n  const lockRequestAtRef = useRef<number>(0);\n  const lockExpiryTimeoutRef = useRef<number | null>(null);\n  const inactivityTimeoutRef = useRef<number | null>(null);\n  const touchIntervalRef = useRef<number | null>(null);\n  const releaseLockRef = useRef<(reason: TokenNoteLockReleaseReason) => void>(() => {});\n  const previousOpenTokenStateIdRef = useRef<string | null>(null);\n\n  const [openTokenStateId, setOpenTokenStateId] = useState<string | null>(null);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [openMode, setOpenMode] = useState<TokenNoteOpenMode | null>(null);\n  const [anchorNode, setAnchorNode] = useState<Konva.Node | null>(null);\n  const [draftContent, setDraftContent] = useState(\"\");\n  const [draftStyle, setDraftStyle] = useState<TokenNoteStyle>({\n    fontFamily: settings.defaultFont,\n  });\n  const createdRef = useRef<Record<string, boolean>>({});\n  const lastRemoteEditRef = useRef<number>(0);\n  const tokenState = openTokenStateId\n    ? mapState?.tokens[openTokenStateId]\n    : undefined;\n  const token = tokenState ? tokensById[tokenState.tokenId] : undefined;\n  const note = openTokenStateId ? mapState?.tokenNotes?.[openTokenStateId] : undefined;\n\n  const isMapOwner = !!userId && map?.owner === userId;\n  const isTokenOwner = !!userId && tokenState?.owner === userId;\n  const noteOwners = note?.permissions?.owners || [];\n  const isExplicitOwner = !!userId && noteOwners.includes(userId);\n  const defaultPermission = note?.permissions?.default || settings.defaultPermission;\n  const canEdit =\n    !!userId &&\n    (isMapOwner || isTokenOwner || isExplicitOwner || defaultPermission === \"write\");\n  const canRead = !!userId && (canEdit || defaultPermission !== \"none\");\n  const isLockOwner = !!userId && lockState?.ownerUserId === userId;\n  const isEditingActive = isEditing && isLockOwner;\n\n  useEffect(() => {\n    openTokenStateIdRef.current = openTokenStateId;\n  }, [openTokenStateId]);\n\n  useEffect(() => {\n    mapIdRef.current = map?.id || null;\n  }, [map?.id]);\n\n  useEffect(() => {\n    userIdRef.current = userId || null;\n  }, [userId]);\n\n  useEffect(() => {\n    noteRef.current = note;\n  }, [note]);\n\n  useEffect(() => {\n    canEditRef.current = canEdit;\n  }, [canEdit]);\n\n  useEffect(() => {\n    lockStateRef.current = lockState;\n  }, [lockState]);\n\n  useEffect(() => {\n    draftContentRef.current = draftContent;\n  }, [draftContent]);\n\n  useEffect(() => {\n    draftStyleRef.current = draftStyle;\n  }, [draftStyle]);\n\n  const isStyleEqual = useCallback(\n    (left: TokenNoteStyle, right?: TokenNoteStyle) =>\n      !!right &&\n      left.fontFamily === right.fontFamily &&\n      left.backgroundColor === right.backgroundColor,\n    []\n  );\n\n  const clearLockTimers = useCallback(() => {\n    if (lockExpiryTimeoutRef.current) {\n      window.clearTimeout(lockExpiryTimeoutRef.current);\n      lockExpiryTimeoutRef.current = null;\n    }\n    if (inactivityTimeoutRef.current) {\n      window.clearTimeout(inactivityTimeoutRef.current);\n      inactivityTimeoutRef.current = null;\n    }\n    if (touchIntervalRef.current) {\n      window.clearInterval(touchIntervalRef.current);\n      touchIntervalRef.current = null;\n    }\n  }, []);\n\n  const scheduleLockExpiry = useCallback(\n    (expiresAt: number) => {\n      if (lockExpiryTimeoutRef.current) {\n        window.clearTimeout(lockExpiryTimeoutRef.current);\n      }\n      const delay = Math.max(0, expiresAt - Date.now());\n      lockExpiryTimeoutRef.current = window.setTimeout(() => {\n        const current = lockStateRef.current;\n        const now = Date.now();\n        if (!current || current.expiresAt > now) {\n          return;\n        }\n        if (current.ownerUserId === userIdRef.current) {\n          releaseLockRef.current(\"timeout\");\n          return;\n        }\n        setLockReleaseReason(\"timeout\");\n        setLockState(null);\n        setIsEditing(false);\n      }, delay + 25);\n    },\n    []\n  );\n\n  const emitStream = useCallback(\n    (topic: string, payload: any, includeSelf = true) => {\n      session.sendStream(topic, payload, { includeSelf });\n    },\n    [session]\n  );\n\n  const emitLockRequest = useCallback(() => {\n    const mapId = mapIdRef.current;\n    const tokenStateId = openTokenStateIdRef.current;\n    const currentUserId = userIdRef.current;\n    if (!mapId || !tokenStateId || !currentUserId || !canEditRef.current) {\n      return;\n    }\n    const now = Date.now();\n    if (now - lockRequestAtRef.current < LOCK_REQUEST_COOLDOWN_MS) {\n      return;\n    }\n    const current = lockStateRef.current;\n    if (current && current.tokenStateId === tokenStateId && current.expiresAt > now) {\n      return;\n    }\n    lockRequestAtRef.current = now;\n    const clientLockId = shortid();\n    const payload: TokenNoteLockRequestPayload = {\n      mapId,\n      tokenStateId,\n      userId: currentUserId,\n      ts: now,\n      clientLockId,\n    };\n    emitStream(TOKEN_NOTE_LOCK_TOPICS.lockRequest, payload, true);\n  }, [emitStream]);\n\n  const emitLockGranted = useCallback(\n    (payload: TokenNoteLockGrantedPayload) => {\n      emitStream(TOKEN_NOTE_LOCK_TOPICS.lockGranted, payload, true);\n    },\n    [emitStream]\n  );\n\n  const emitLockDenied = useCallback(\n    (payload: TokenNoteLockDeniedPayload) => {\n      emitStream(TOKEN_NOTE_LOCK_TOPICS.lockDenied, payload, true);\n    },\n    [emitStream]\n  );\n\n  const emitLockTouch = useCallback(() => {\n    const current = lockStateRef.current;\n    const currentUserId = userIdRef.current;\n    const mapId = mapIdRef.current;\n    if (!current || !currentUserId || current.ownerUserId !== currentUserId || !mapId) {\n      return;\n    }\n    const now = Date.now();\n    const payload: TokenNoteLockTouchPayload = {\n      mapId,\n      tokenStateId: current.tokenStateId,\n      userId: currentUserId,\n      lockId: current.lockId,\n      ts: now,\n    };\n    emitStream(TOKEN_NOTE_LOCK_TOPICS.lockTouch, payload, true);\n    setLockState((prev) => {\n      if (!prev || prev.lockId !== current.lockId) {\n        return prev;\n      }\n      return { ...prev, lastTouchAt: now, expiresAt: now + LOCK_TTL_MS };\n    });\n    scheduleLockExpiry(now + LOCK_TTL_MS);\n  }, [emitStream, scheduleLockExpiry]);\n\n  const emitUnlock = useCallback(\n    (payload: TokenNoteUnlockPayload) => {\n      emitStream(TOKEN_NOTE_LOCK_TOPICS.unlock, payload, true);\n    },\n    [emitStream]\n  );\n\n  const emitLockReleased = useCallback(\n    (payload: TokenNoteLockReleasedPayload) => {\n      emitStream(TOKEN_NOTE_LOCK_TOPICS.lockReleased, payload, true);\n    },\n    [emitStream]\n  );\n\n  const commitDraftIfNeeded = useCallback(() => {\n    const currentNote = noteRef.current;\n    const tokenStateId = openTokenStateIdRef.current;\n    const currentUserId = userIdRef.current;\n    if (!currentNote || !tokenStateId || !currentUserId || !canEditRef.current) {\n      return;\n    }\n    const nextContent = draftContentRef.current;\n    const nextStyle = draftStyleRef.current;\n    const changed =\n      nextContent !== currentNote.content || !isStyleEqual(nextStyle, currentNote.style);\n    if (!changed) {\n      return;\n    }\n    onTokenNoteChange({\n      [tokenStateId]: {\n        content: nextContent,\n        style: nextStyle,\n        lastEditedBy: currentUserId,\n        lastEditedAt: Date.now(),\n      },\n    });\n  }, [isStyleEqual, onTokenNoteChange]);\n\n  const releaseLock = useCallback(\n    (reason: TokenNoteLockReleaseReason) => {\n      const current = lockStateRef.current;\n      const currentUserId = userIdRef.current;\n      const mapId = mapIdRef.current;\n      if (!current) {\n        clearLockTimers();\n        lockStateRef.current = null;\n        setLockState(null);\n        setIsEditing(false);\n        return;\n      }\n      const isOwner = !!currentUserId && current.ownerUserId === currentUserId;\n      if (isOwner && mapId && currentUserId) {\n        const now = Date.now();\n        commitDraftIfNeeded();\n        const unlockPayload: TokenNoteUnlockPayload = {\n          mapId,\n          tokenStateId: current.tokenStateId,\n          userId: currentUserId,\n          lockId: current.lockId,\n          ts: now,\n          content: draftContentRef.current,\n          style: draftStyleRef.current,\n          lastEditedAt: now,\n        };\n        emitUnlock(unlockPayload);\n        emitLockReleased({\n          mapId,\n          tokenStateId: current.tokenStateId,\n          userId: currentUserId,\n          lockId: current.lockId,\n          reason,\n          ts: now,\n        });\n      }\n      clearLockTimers();\n      lockStateRef.current = null;\n      setLockState(null);\n      setIsEditing(false);\n      if (!isOwner) {\n        setLockReleaseReason(reason);\n      }\n    },\n    [clearLockTimers, commitDraftIfNeeded, emitLockReleased, emitUnlock]\n  );\n\n  useEffect(() => {\n    releaseLockRef.current = releaseLock;\n  }, [releaseLock]);\n\n  const registerActivity = useCallback(() => {\n    lastActivityRef.current = Date.now();\n    if (inactivityTimeoutRef.current) {\n      window.clearTimeout(inactivityTimeoutRef.current);\n    }\n    inactivityTimeoutRef.current = window.setTimeout(() => {\n      const current = lockStateRef.current;\n      if (!current || current.ownerUserId !== userIdRef.current) {\n        return;\n      }\n      releaseLock(\"timeout\");\n    }, LOCK_TTL_MS);\n  }, [releaseLock]);\n\n  const handleRequestClose = useCallback(() => {\n    if (!userId) {\n      clearLockTimers();\n      lockStateRef.current = null;\n      setLockState(null);\n      setIsEditing(false);\n      setIsExpanded(false);\n      setOpenTokenStateId(null);\n      setOpenMode(null);\n      setAnchorNode(null);\n      setLockReleaseReason(null);\n      return;\n    }\n    if (isLockOwner) {\n      releaseLock(\"owner\");\n    } else {\n      clearLockTimers();\n      lockStateRef.current = null;\n      setLockState(null);\n      setIsEditing(false);\n    }\n    setIsEditing(false);\n    setIsExpanded(false);\n    setOpenTokenStateId(null);\n    setOpenMode(null);\n    setAnchorNode(null);\n    setLockReleaseReason(null);\n  }, [userId, isLockOwner, releaseLock, clearLockTimers]);\n\n  function openTokenNote(tokenStateId: string, options?: TokenNoteOpenOptions) {\n    if (!settings.enabled) {\n      return;\n    }\n    if (openTokenStateId && openTokenStateId !== tokenStateId) {\n      handleRequestClose();\n    }\n    setOpenTokenStateId(tokenStateId);\n    setOpenMode(options?.mode || \"sheet\");\n    setAnchorNode(options?.anchor || null);\n    setIsExpanded(false);\n    setIsEditing(false);\n    setLockReleaseReason(null);\n  }\n\n  useEffect(() => {\n    if (!openTokenStateId || !tokenState || !mapState) {\n      return;\n    }\n    if (!userId) {\n      return;\n    }\n    if (!note && !createdRef.current[openTokenStateId]) {\n      const now = Date.now();\n      const newNote: TokenNote = {\n        id: openTokenStateId,\n        tokenStateId: openTokenStateId,\n        content: \"\",\n        style: {\n          fontFamily: settings.defaultFont,\n        },\n        permissions: {\n          default: settings.defaultPermission,\n          owners: [],\n        },\n        lastEditedBy: userId,\n        lastEditedAt: now,\n      };\n      createdRef.current[openTokenStateId] = true;\n      onTokenNoteCreate([newNote]);\n    }\n  }, [\n    openTokenStateId,\n    tokenState,\n    mapState,\n    note,\n    onTokenNoteCreate,\n    settings.defaultFont,\n    settings.defaultPermission,\n    userId,\n  ]);\n  useEffect(() => {\n    if (!openTokenStateId) {\n      return;\n    }\n    if (!note) {\n      setDraftContent(\"\");\n      setDraftStyle({ fontFamily: settings.defaultFont });\n      lastRemoteEditRef.current = 0;\n      return;\n    }\n    if (!isEditingActive) {\n      setDraftContent(note.content);\n      setDraftStyle(note.style);\n      lastRemoteEditRef.current = note.lastEditedAt;\n      return;\n    }\n    const isRemote = !!userId && note.lastEditedBy && note.lastEditedBy !== userId;\n    if (isRemote && note.lastEditedAt !== lastRemoteEditRef.current) {\n      lastRemoteEditRef.current = note.lastEditedAt;\n      addToast(\"\");\n    }\n  }, [\n    addToast,\n    isEditingActive,\n    note,\n    openTokenStateId,\n    settings.defaultFont,\n    userId,\n  ]);\n\n  useEffect(() => {\n    const previous = previousOpenTokenStateIdRef.current;\n    if (previous && previous !== openTokenStateId) {\n      clearLockTimers();\n      setLockState(null);\n      setIsEditing(false);\n      setLockReleaseReason(null);\n    }\n    previousOpenTokenStateIdRef.current = openTokenStateId;\n  }, [clearLockTimers, openTokenStateId]);\n\n  useEffect(() => {\n    if (!isLockOwner) {\n      if (touchIntervalRef.current) {\n        window.clearInterval(touchIntervalRef.current);\n        touchIntervalRef.current = null;\n      }\n      return;\n    }\n    emitLockTouch();\n    touchIntervalRef.current = window.setInterval(() => {\n      emitLockTouch();\n    }, LOCK_TOUCH_INTERVAL_MS);\n    return () => {\n      if (touchIntervalRef.current) {\n        window.clearInterval(touchIntervalRef.current);\n        touchIntervalRef.current = null;\n      }\n    };\n  }, [emitLockTouch, isLockOwner]);\n\n  useEffect(() => {\n    const handleLockRequest: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteLockRequestPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      if (\n        typeof payload.userId !== \"string\" ||\n        typeof payload.clientLockId !== \"string\" ||\n        typeof payload.ts !== \"number\"\n      ) {\n        return;\n      }\n      const now = Date.now();\n      const current = lockStateRef.current;\n      if (current && current.expiresAt > now) {\n        if (\n          current.ownerUserId === userIdRef.current &&\n          payload.userId !== current.ownerUserId\n        ) {\n          emitLockDenied({\n            mapId: payload.mapId,\n            tokenStateId: payload.tokenStateId,\n            ownerUserId: current.ownerUserId,\n            lockId: current.lockId,\n            expiresAt: current.expiresAt,\n            ts: now,\n          });\n        }\n        return;\n      }\n      const lockId = payload.clientLockId;\n      const expiresAt = now + LOCK_TTL_MS;\n      setLockState({\n        tokenStateId: payload.tokenStateId,\n        ownerUserId: payload.userId,\n        lockId,\n        expiresAt,\n        lastTouchAt: now,\n      });\n      setLockReleaseReason(null);\n      scheduleLockExpiry(expiresAt);\n      if (payload.userId === userIdRef.current) {\n        emitLockGranted({\n          mapId: payload.mapId,\n          tokenStateId: payload.tokenStateId,\n          userId: payload.userId,\n          lockId,\n          expiresAt,\n          ts: now,\n        });\n        setIsEditing(true);\n        registerActivity();\n      } else {\n        setIsEditing(false);\n      }\n    };\n\n    const handleLockGranted: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteLockGrantedPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      if (\n        typeof payload.userId !== \"string\" ||\n        typeof payload.lockId !== \"string\" ||\n        typeof payload.expiresAt !== \"number\"\n      ) {\n        return;\n      }\n      const now = Date.now();\n      const current = lockStateRef.current;\n      if (current && current.expiresAt > now && current.lockId !== payload.lockId) {\n        return;\n      }\n      setLockState({\n        tokenStateId: payload.tokenStateId,\n        ownerUserId: payload.userId,\n        lockId: payload.lockId,\n        expiresAt: payload.expiresAt,\n        lastTouchAt: payload.ts || now,\n      });\n      setLockReleaseReason(null);\n      scheduleLockExpiry(payload.expiresAt);\n      if (payload.userId === userIdRef.current) {\n        setIsEditing(true);\n        registerActivity();\n      } else {\n        setIsEditing(false);\n      }\n    };\n\n    const handleLockDenied: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteLockDeniedPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      if (\n        typeof payload.ownerUserId !== \"string\" ||\n        typeof payload.lockId !== \"string\" ||\n        typeof payload.expiresAt !== \"number\"\n      ) {\n        return;\n      }\n      setLockState({\n        tokenStateId: payload.tokenStateId,\n        ownerUserId: payload.ownerUserId,\n        lockId: payload.lockId,\n        expiresAt: payload.expiresAt,\n        lastTouchAt: payload.ts || Date.now(),\n      });\n      setLockReleaseReason(null);\n      scheduleLockExpiry(payload.expiresAt);\n      setIsEditing(false);\n    };\n\n    const handleLockTouch: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteLockTouchPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      if (\n        typeof payload.userId !== \"string\" ||\n        typeof payload.lockId !== \"string\" ||\n        typeof payload.ts !== \"number\"\n      ) {\n        return;\n      }\n      const now = Date.now();\n      const expiresAt = payload.ts + LOCK_TTL_MS;\n      const current = lockStateRef.current;\n      if (\n        current &&\n        current.lockId === payload.lockId &&\n        current.ownerUserId === payload.userId\n      ) {\n        setLockState({\n          ...current,\n          lastTouchAt: payload.ts,\n          expiresAt,\n        });\n        scheduleLockExpiry(expiresAt);\n        return;\n      }\n      if (!current || current.expiresAt <= now) {\n        setLockState({\n          tokenStateId: payload.tokenStateId,\n          ownerUserId: payload.userId,\n          lockId: payload.lockId,\n          expiresAt,\n          lastTouchAt: payload.ts,\n        });\n        setLockReleaseReason(null);\n        scheduleLockExpiry(expiresAt);\n        setIsEditing(false);\n      }\n    };\n\n    const handleUnlock: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteUnlockPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      const current = lockStateRef.current;\n      if (!current || current.lockId !== payload.lockId) {\n        return;\n      }\n      if (!isEditingActive) {\n        if (typeof payload.content === \"string\") {\n          setDraftContent(payload.content);\n        }\n        if (payload.style) {\n          setDraftStyle(payload.style);\n        }\n        if (typeof payload.lastEditedAt === \"number\") {\n          lastRemoteEditRef.current = payload.lastEditedAt;\n        }\n      }\n      clearLockTimers();\n      setLockState(null);\n      setIsEditing(false);\n      setLockReleaseReason(\"owner\");\n    };\n\n    const handleLockReleased: StreamEventHandler = (event) => {\n      const payload = event.data as TokenNoteLockReleasedPayload;\n      if (\n        !payload ||\n        payload.mapId !== mapIdRef.current ||\n        payload.tokenStateId !== openTokenStateIdRef.current\n      ) {\n        return;\n      }\n      const current = lockStateRef.current;\n      if (!current || current.lockId !== payload.lockId) {\n        return;\n      }\n      clearLockTimers();\n      setLockState(null);\n      setIsEditing(false);\n      setLockReleaseReason(payload.reason);\n    };\n\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.lockRequest, handleLockRequest);\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.lockGranted, handleLockGranted);\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.lockDenied, handleLockDenied);\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.lockTouch, handleLockTouch);\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.unlock, handleUnlock);\n    session.onStream(TOKEN_NOTE_LOCK_TOPICS.lockReleased, handleLockReleased);\n\n    return () => {\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.lockRequest}`, handleLockRequest);\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.lockGranted}`, handleLockGranted);\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.lockDenied}`, handleLockDenied);\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.lockTouch}`, handleLockTouch);\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.unlock}`, handleUnlock);\n      session.off(`stream:${TOKEN_NOTE_LOCK_TOPICS.lockReleased}`, handleLockReleased);\n    };\n  }, [\n    clearLockTimers,\n    emitLockDenied,\n    emitLockGranted,\n    registerActivity,\n    scheduleLockExpiry,\n    session,\n    isEditingActive,\n  ]);\n\n  useEffect(() => {\n    if (!openTokenStateId || !mapState) {\n      return;\n    }\n    if (!mapState.tokens[openTokenStateId]) {\n      onTokenNoteRemove([openTokenStateId]);\n      handleRequestClose();\n    }\n  }, [handleRequestClose, mapState, onTokenNoteRemove, openTokenStateId]);\n\n  useEffect(() => {\n    if (!settings.enabled && openTokenStateId) {\n      handleRequestClose();\n    }\n  }, [handleRequestClose, openTokenStateId, settings.enabled]);\n  function handleContentChange(value: string) {\n    if (!canEdit || !isLockOwner) {\n      return;\n    }\n    if (!isEditing) {\n      setIsEditing(true);\n    }\n    setDraftContent(value);\n    registerActivity();\n  }\n\n  function handleStyleChange(change: Partial<TokenNoteStyle>) {\n    if (!canEdit || !isLockOwner) {\n      return;\n    }\n    if (!isEditing) {\n      setIsEditing(true);\n    }\n    setDraftStyle((prev) => ({ ...prev, ...change }));\n    registerActivity();\n  }\n\n  const lockOwnerId =\n    lockState?.ownerUserId && lockState.ownerUserId !== userId\n      ? lockState.ownerUserId\n      : undefined;\n\n  const tokenNoteSheet = (\n    <TokenNoteSheet\n      isOpen={!!openTokenStateId && openMode === \"sheet\"}\n      tokenState={tokenState}\n      token={token}\n      content={draftContent}\n      style={draftStyle}\n      canRead={canRead}\n      canEdit={canEdit}\n      isEditing={isEditingActive}\n      isExpanded={isExpanded}\n      blur={settings.blur}\n      fontSize={settings.fontSize}\n      lockOwnerId={lockOwnerId}\n      lockReleaseReason={lockReleaseReason}\n      onRequestClose={handleRequestClose}\n      onToggleExpanded={() => setIsExpanded((prev) => !prev)}\n      onRequestEdit={() => {\n        if (canEdit) {\n          if (isLockOwner) {\n            setIsEditing(true);\n            registerActivity();\n            return;\n          }\n          emitLockRequest();\n        }\n      }}\n      onEditorBlur={() => {\n        if (isLockOwner) {\n          releaseLock(\"owner\");\n        }\n      }}\n      onContentChange={handleContentChange}\n      onStyleChange={handleStyleChange}\n    />\n  );\n\n  const tokenNotePopover = (\n    <TokenNotePopover\n      isOpen={!!openTokenStateId && openMode === \"popover\"}\n      tokenState={tokenState}\n      token={token}\n      content={draftContent}\n      style={draftStyle}\n      canRead={canRead}\n      canEdit={canEdit}\n      isEditing={isEditingActive}\n      anchorNode={anchorNode || undefined}\n      lockOwnerId={lockOwnerId}\n      onRequestClose={handleRequestClose}\n      onRequestExpand={() => setOpenMode(\"sheet\")}\n      onRequestEdit={() => {\n        if (!canEdit) {\n          return;\n        }\n        if (isLockOwner) {\n          setIsEditing(true);\n          registerActivity();\n          return;\n        }\n        emitLockRequest();\n      }}\n      onEditorBlur={() => {\n        if (isLockOwner) {\n          releaseLock(\"owner\");\n        }\n      }}\n      onContentChange={handleContentChange}\n    />\n  );\n\n  return { tokenNoteSheet, tokenNotePopover, openTokenNote };\n}\n\nexport default useTokenNotes;\n","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Box } from \"theme-ui\";\n\nimport MapControls from \"./MapControls\";\nimport MapInteraction from \"./MapInteraction\";\nimport MapGrid from \"./MapGrid\";\nimport FogOfWarLayer from \"./FogOfWarLayer\";\n\nimport DrawingTool from \"../tools/DrawingTool\";\nimport WallTool from \"../tools/WallTool\";\nimport MeasureTool from \"../tools/MeasureTool\";\nimport SpellTemplateTool from \"../tools/SpellTemplateTool\";\nimport NetworkedMapPointer from \"../../network/NetworkedMapPointer\";\n\nimport { useSettings } from \"../../contexts/SettingsContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\nimport Action from \"../../actions/Action\";\nimport {\n  AddStatesAction,\n  EditStatesAction,\n  RemoveStatesAction,\n} from \"../../actions\";\n\nimport Session from \"../../network/Session\";\n\nimport { Drawing, DrawingState } from \"../../types/Drawing\";\nimport { Wall, WallState } from \"../../types/Wall\";\nimport { Map as MapType, MapToolId } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\nimport { Settings } from \"../../types/Settings\";\nimport { SpellTemplate, SpellTemplateState } from \"../../types/SpellTemplate\";\nimport RemoveTokenIcon from \"../../icons/RemoveTokenIcon\";\nimport {\n  MapChangeEventHandler,\n  MapResetEventHandler,\n  MapStateSettingsChangeEventHandler,\n  TokenStateRemoveHandler,\n  NoteChangeEventHandler,\n  NoteRemoveEventHander,\n  TokenStateChangeEventHandler,\n  NoteCreateEventHander,\n  TokenNoteChangeEventHandler,\n  TokenNoteCreateEventHandler,\n  TokenNoteRemoveEventHandler,\n  SelectionItemsChangeEventHandler,\n  SelectionItemsRemoveEventHandler,\n  SelectionItemsCreateEventHandler,\n  TokensStateCreateHandler,\n} from \"../../types/Events\";\n\nimport useMapTokens from \"../../hooks/useMapTokens\";\nimport useMapNotes from \"../../hooks/useMapNotes\";\nimport { MapActions } from \"../../hooks/useMapActions\";\nimport useMapSelection from \"../../hooks/useMapSelection\";\nimport useTokenNotes from \"../../hooks/useTokenNotes\";\n\ntype MapProps = {\n  map: MapType | null;\n  mapState: MapState | null;\n  mapActions: MapActions;\n  onMapTokenStateChange: TokenStateChangeEventHandler;\n  onMapTokenStateRemove: TokenStateRemoveHandler;\n  onMapTokensStateCreate: TokensStateCreateHandler;\n  onSelectionItemsChange: SelectionItemsChangeEventHandler;\n  onSelectionItemsRemove: SelectionItemsRemoveEventHandler;\n  onSelectionItemsCreate: SelectionItemsCreateEventHandler;\n  onMapChange: MapChangeEventHandler;\n  onMapReset: MapResetEventHandler;\n  onMapStateChange: MapStateSettingsChangeEventHandler;\n  onMapDraw: (action: Action<DrawingState>) => void;\n  onWallDraw: (action: Action<WallState>) => void;\n  onMapTemplateDraw: (action: Action<SpellTemplateState>) => void;\n  onMapNoteCreate: NoteCreateEventHander;\n  onMapNoteChange: NoteChangeEventHandler;\n  onMapNoteRemove: NoteRemoveEventHander;\n  onMapTokenNoteCreate: TokenNoteCreateEventHandler;\n  onMapTokenNoteChange: TokenNoteChangeEventHandler;\n  onMapTokenNoteRemove: TokenNoteRemoveEventHandler;\n  allowMapChange: boolean;\n  session: Session;\n  onUndo: () => void;\n  onRedo: () => void;\n};\n\nfunction Map({\n  map,\n  mapState,\n  mapActions,\n  onMapTokenStateChange,\n  onMapTokenStateRemove,\n  onMapTokensStateCreate,\n  onSelectionItemsChange,\n  onSelectionItemsRemove,\n  onSelectionItemsCreate,\n  onMapChange,\n  onMapReset,\n  onMapStateChange,\n  onMapDraw,\n  onWallDraw,\n  onMapTemplateDraw,\n  onMapNoteCreate,\n  onMapNoteChange,\n  onMapNoteRemove,\n  onMapTokenNoteCreate,\n  onMapTokenNoteChange,\n  onMapTokenNoteRemove,\n  allowMapChange,\n  session,\n  onUndo,\n  onRedo,\n}: MapProps) {\n  const userId = useUserId();\n\n  const [selectedToolId, setSelectedToolId] = useState<MapToolId>(\"move\");\n  const { settings, setSettings } = useSettings();\n\n  const [selectedTemplateId, setSelectedTemplateId] = useState<string | null>(\n    null\n  );\n  const [isTemplateDragging, setIsTemplateDragging] = useState(false);\n  const templateTrashRef = useRef<HTMLDivElement | null>(null);\n\n  const [tokenDragPreview, setTokenDragPreview] = useState<\n    Record<string, { x: number; y: number }> | null\n  >(null);\n  const tokenDragPreviewEnabled = !!settings.fog?.previewOnDrag;\n  const tokenDragPreviewActive =\n    tokenDragPreviewEnabled &&\n    !!tokenDragPreview &&\n    Object.keys(tokenDragPreview).length > 0;\n\n  useEffect(() => {\n    if (!tokenDragPreviewEnabled && tokenDragPreview) {\n      setTokenDragPreview(null);\n    }\n  }, [tokenDragPreviewEnabled, tokenDragPreview]);\n\n  const handleTokenDragPreviewChange = useCallback(\n    (updates: Record<string, { x: number; y: number }>) => {\n      if (!tokenDragPreviewEnabled) {\n        return;\n      }\n      setTokenDragPreview(updates);\n    },\n    [tokenDragPreviewEnabled]\n  );\n\n  const handleTokenDragPreviewEnd = useCallback(() => {\n    if (!tokenDragPreviewEnabled) {\n      return;\n    }\n    setTokenDragPreview(null);\n  }, [tokenDragPreviewEnabled]);\n\n  function handleToolSettingChange(change: Partial<Settings>) {\n    setSettings((prevSettings) => ({\n      ...prevSettings,\n      ...change,\n    }));\n  }\n\n  const drawShapes = Object.values(mapState?.drawings || {});\n  const wallShapes = Object.values(mapState?.walls || {});\n  const templateShapes = Object.values(mapState?.templates || {});\n  const templateTokens = Object.values(mapState?.tokens || {});\n\n  function handleToolAction(action: string) {\n    if (action === \"eraseAll\") {\n      if (selectedToolId === \"drawing\") {\n        onMapDraw(new RemoveStatesAction(drawShapes.map((s) => s.id)));\n      } else if (selectedToolId === \"fog\") {\n        onWallDraw(new RemoveStatesAction(wallShapes.map((s) => s.id)));\n      }\n    } else if (action === \"toggleFogEnabled\") {\n      onMapStateChange({ fogEnabled: !(mapState?.fogEnabled ?? true) });\n    } else if (action === \"toggleExplored\") {\n      onMapStateChange({ showExplored: !(mapState?.showExplored ?? false) });\n    } else if (action === \"resetExplored\") {\n      onMapStateChange({ explored: [] });\n    } else if (action.startsWith(\"setGmOpacity:\")) {\n      const rawValue = parseFloat(action.split(\":\")[1]);\n      const nextValue = Number.isFinite(rawValue)\n        ? Math.min(Math.max(rawValue, 0), 1)\n        : 0.35;\n      setSettings((prevSettings) => ({\n        ...prevSettings,\n        fog: {\n          ...prevSettings.fog,\n          gmOpacity: nextValue,\n        },\n      }));\n    }\n  }\n\n  function handleMapShapeAdd(shape: Drawing) {\n    onMapDraw(new AddStatesAction([shape]));\n  }\n\n  function handleMapShapesRemove(shapeIds: string[]) {\n    onMapDraw(new RemoveStatesAction(shapeIds));\n  }\n\n  function handleMapShapesEdit(shapes: Partial<Drawing>[]) {\n    onMapDraw(new EditStatesAction(shapes));\n  }\n\n  function handleWallAdd(shapes: Wall[]) {\n    onWallDraw(new AddStatesAction(shapes));\n  }\n\n  function handleWallRemove(shapeIds: string[]) {\n    onWallDraw(new RemoveStatesAction(shapeIds));\n  }\n\n\n  function handleTemplateAdd(template: SpellTemplate) {\n    onMapTemplateDraw(new AddStatesAction([template]));\n  }\n\n  function handleTemplateEdit(edits: Partial<SpellTemplate>[]) {\n    onMapTemplateDraw(new EditStatesAction(edits));\n  }\n\n  function handleTemplateRemove(templateIds: string[]) {\n    onMapTemplateDraw(new RemoveStatesAction(templateIds));\n  }\n\n  function handleRemoveSelectedTemplate() {\n    if (!selectedTemplateId) {\n      return;\n    }\n    handleTemplateRemove([selectedTemplateId]);\n    setSelectedTemplateId(null);\n  }\n\n  function handleRemoveAllTemplates() {\n    if (templateShapes.length === 0) {\n      return;\n    }\n    handleTemplateRemove(templateShapes.map((template) => template.id));\n    setSelectedTemplateId(null);\n  }\n\n  function isPointOverTemplateTrash(clientX: number, clientY: number) {\n    const trash = templateTrashRef.current;\n    if (!trash) {\n      return false;\n    }\n    const rect = trash.getBoundingClientRect();\n    return (\n      clientX >= rect.left &&\n      clientX <= rect.right &&\n      clientY >= rect.top &&\n      clientY <= rect.bottom\n    );\n  }\n\n  const { tokenNoteSheet, tokenNotePopover, openTokenNote } = useTokenNotes(\n    map,\n    mapState,\n    session,\n    onMapTokenNoteCreate,\n    onMapTokenNoteChange,\n    onMapTokenNoteRemove,\n    settings.tokenNote\n  );\n\n  const {\n    tokens,\n    propTokens,\n    tokenMenu,\n    tokenAttributeCountMenu,\n    tokenDragOverlay,\n  } = useMapTokens(\n    map,\n    mapState,\n    onMapTokenStateChange,\n    onMapTokenStateRemove,\n    onMapTokensStateCreate,\n    selectedToolId,\n    settings.tokenNote,\n    openTokenNote,\n    {\n      enableTokenDragPreview: tokenDragPreviewEnabled,\n      onTokenDragMove: handleTokenDragPreviewChange,\n      onTokenDragPreviewEnd: handleTokenDragPreviewEnd,\n    }\n  );\n\n  const { notes, noteMenu, noteHud, noteTextOverlay, noteDragOverlay } =\n    useMapNotes(\n      map,\n      mapState,\n      onMapNoteCreate,\n      onMapNoteChange,\n      onMapNoteRemove,\n      selectedToolId\n    );\n\n  const { selectionTool, selectionMenu, selectionDragOverlay } =\n    useMapSelection(\n      map,\n      mapState,\n      onSelectionItemsChange,\n      onSelectionItemsRemove,\n      onSelectionItemsCreate,\n      selectedToolId,\n      settings.select\n    );\n\n  return (\n    <Box sx={{ flexGrow: 1 }}>\n      <MapInteraction\n        map={map}\n        mapState={mapState}\n        overlay={\n          <FogOfWarLayer\n            map={map}\n            mapState={mapState}\n            fogSettings={settings.fog}\n            onExploredChange={\n              tokenDragPreviewActive\n                ? undefined\n                : (explored) => onMapStateChange({ explored })\n            }\n            tokenPreview={\n              tokenDragPreviewActive ? tokenDragPreview ?? undefined : undefined\n            }\n            useTokenPreview={tokenDragPreviewEnabled}\n          />\n        }\n        controls={\n          <>\n            <MapControls\n              onMapChange={onMapChange}\n              onMapReset={onMapReset}\n              map={map}\n              mapState={mapState}\n              mapActions={mapActions}\n              allowMapChange={allowMapChange}\n              onSelectedToolChange={setSelectedToolId}\n              selectedToolId={selectedToolId}\n              toolSettings={settings}\n              onToolSettingChange={handleToolSettingChange}\n              onToolAction={handleToolAction}\n              selectedTemplateId={selectedTemplateId}\n              onRemoveSelectedTemplate={handleRemoveSelectedTemplate}\n              hasTemplates={templateShapes.length > 0}\n              onRemoveAllTemplates={handleRemoveAllTemplates}\n              onUndo={onUndo}\n              onRedo={onRedo}\n            />\n            {selectedToolId === \"spellTemplates\" && isTemplateDragging && (\n              <Box\n                ref={templateTrashRef}\n                sx={{\n                  position: \"absolute\",\n                  left: \"50%\",\n                  bottom: \"12px\",\n                  transform: \"translateX(-50%)\",\n                  backgroundColor: \"overlay\",\n                  borderRadius: \"999px\",\n                  padding: \"8px\",\n                  pointerEvents: \"none\",\n                }}\n              >\n                <RemoveTokenIcon />\n              </Box>\n            )}\n            {tokenMenu}\n            {tokenAttributeCountMenu}\n            {noteMenu}\n            {noteHud}\n            {noteTextOverlay}\n            {selectionMenu}\n            {tokenNotePopover}\n            {tokenNoteSheet}\n            {tokenDragOverlay}\n            {noteDragOverlay}\n            {selectionDragOverlay}\n          </>\n        }\n        selectedToolId={selectedToolId}\n        onSelectedToolChange={setSelectedToolId}\n      >\n        {map && map.showGrid && <MapGrid map={map} />}\n        {propTokens}\n        <DrawingTool\n          map={map}\n          drawings={drawShapes}\n          onDrawingAdd={handleMapShapeAdd}\n          onDrawingsRemove={handleMapShapesRemove}\n          onDrawingsEdit={handleMapShapesEdit}\n          active={selectedToolId === \"drawing\"}\n          toolSettings={settings.drawing}\n        />\n        <SpellTemplateTool\n          map={map}\n          templates={templateShapes}\n          active={selectedToolId === \"spellTemplates\"}\n          toolSettings={settings.spellTemplates}\n          onTemplateAdd={handleTemplateAdd}\n          onTemplateEdit={handleTemplateEdit}\n          selectedTemplateId={selectedTemplateId}\n          onSelectedTemplateIdChange={setSelectedTemplateId}\n          onRemoveSelectedTemplate={handleRemoveSelectedTemplate}\n          onTemplateDragStateChange={setIsTemplateDragging}\n          isPointOverTrash={isPointOverTemplateTrash}\n          tokens={templateTokens}\n          editable={\n            !!(map?.owner === userId || mapState?.editFlags.includes(\"drawing\"))\n          }\n        />\n        {notes}\n        {tokens}\n        <WallTool\n          map={map}\n          walls={wallShapes}\n          onWallsAdd={handleWallAdd}\n          onWallsRemove={handleWallRemove}\n          active={selectedToolId === \"fog\"}\n          toolSettings={settings.fog}\n          editable={\n            !!(map?.owner === userId || mapState?.editFlags.includes(\"fog\")) &&\n            !settings.fog.preview\n          }\n        />\n        <NetworkedMapPointer\n          active={selectedToolId === \"pointer\"}\n          session={session}\n        />\n        <MeasureTool map={map} active={selectedToolId === \"measure\"} />\n        {selectionTool}\n      </MapInteraction>\n    </Box>\n  );\n}\n\nexport default Map;\n","import { Box } from \"theme-ui\";\nimport { useInView } from \"react-intersection-observer\";\n\nimport TokenImage from \"./TokenImage\";\n\nimport { Token } from \"../../types/Token\";\n\ntype TokenBarTokenProps = {\n  token: Token;\n};\n\nfunction TokenBarToken({ token }: TokenBarTokenProps) {\n  const [ref, inView] = useInView({ triggerOnce: true });\n\n  return (\n    <Box ref={ref} sx={{ width: \"48px\", height: \"48px\" }} title={token.name}>\n      {inView && (\n        <TokenImage\n          token={token}\n          sx={{\n            userSelect: \"none\",\n            touchAction: \"none\",\n            width: \"100%\",\n            height: \"100%\",\n            objectFit: \"cover\",\n            pointerEvents: \"none\",\n          }}\n          alt={token.name}\n          title={token.name}\n        />\n      )}\n    </Box>\n  );\n}\n\nexport default TokenBarToken;\n","import React from \"react\";\nimport { useDraggable } from \"@dnd-kit/core\";\nimport { Data } from \"@dnd-kit/core/dist/store/types\";\n\ntype DraggableProps = {\n  id: string;\n  children: React.ReactNode;\n  data?: Data;\n};\n\nfunction Draggable({ id, children, data }: DraggableProps) {\n  const { attributes, listeners, setNodeRef, isDragging } = useDraggable({\n    id,\n    data,\n  });\n\n  const style = {\n    cursor: isDragging ? \"grabbing\" : \"grab\",\n    touchAction: \"none\",\n    opacity: isDragging ? 0.5 : undefined,\n  };\n\n  return (\n    <div ref={setNodeRef} style={style} {...listeners} {...attributes}>\n      {children}\n    </div>\n  );\n}\n\nexport default Draggable;\n","function GroupIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M20 6h-8l-1.41-1.41C10.21 4.21 9.7 4 9.17 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-1 12H5c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h14c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1z\" />\n    </svg>\n  );\n}\n\nexport default GroupIcon;\n","import { useState, useRef } from \"react\";\nimport { Grid, Flex, Box } from \"theme-ui\";\nimport { useSpring, animated } from \"react-spring\";\nimport { useDraggable } from \"@dnd-kit/core\";\n\nimport TokenImage from \"./TokenImage\";\nimport TokenBarToken from \"./TokenBarToken\";\n\nimport Draggable from \"../drag/Draggable\";\n\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport GroupIcon from \"../../icons/GroupIcon\";\nimport { GroupContainer } from \"../../types/Group\";\nimport { Token } from \"../../types/Token\";\n\ntype TokenBarTokenGroupProps = {\n  group: GroupContainer;\n  tokens: Token[];\n  draggable: boolean;\n};\n\nfunction TokenBarTokenGroup({\n  group,\n  tokens,\n  draggable,\n}: TokenBarTokenGroupProps) {\n  const { attributes, listeners, setNodeRef, isDragging } = useDraggable({\n    id: draggable ? group.id : \"\",\n    disabled: !draggable,\n  });\n  const [isOpen, setIsOpen] = useState(false);\n\n  const { height } = useSpring({\n    height: isOpen ? (tokens.length + 1) * 56 : 56,\n  });\n\n  function renderToken(token: Token) {\n    if (draggable) {\n      return (\n        <Draggable id={token.id} key={token.id}>\n          <TokenBarToken token={token} />\n        </Draggable>\n      );\n    } else {\n      return <TokenBarToken token={token} key={token.id} />;\n    }\n  }\n\n  function renderTokens() {\n    if (isOpen) {\n      return (\n        <Grid\n          columns=\"1fr\"\n          bg=\"muted\"\n          sx={{ borderRadius: \"8px\" }}\n          p={0}\n          gap={2}\n        >\n          <Flex\n            sx={{\n              width: \"48px\",\n              height: \"48px\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              cursor: isDragging ? \"grabbing\" : \"pointer\",\n              color: \"primary\",\n            }}\n            onClick={(e) => handleOpenClick(e, false)}\n            key=\"group\"\n            title={group.name}\n            {...listeners}\n            {...attributes}\n          >\n            <GroupIcon />\n          </Flex>\n          {tokens.map(renderToken)}\n        </Grid>\n      );\n    } else {\n      return (\n        <Grid\n          columns=\"1fr 1fr\"\n          bg=\"muted\"\n          sx={{\n            borderRadius: \"8px\",\n            gridGap: \"4px\",\n            height: \"48px\",\n            gridTemplateRows: \"1fr 1fr\",\n          }}\n          p=\"2px\"\n          title={group.name}\n          {...listeners}\n          {...attributes}\n        >\n          {tokens.slice(0, 4).map((token) => (\n            <TokenImage\n              token={token}\n              key={token.id}\n              sx={{\n                userSelect: \"none\",\n                touchAction: \"none\",\n                pointerEvents: \"none\",\n              }}\n            />\n          ))}\n        </Grid>\n      );\n    }\n  }\n\n  // Reject the opening of a group if the pointer has moved\n  const clickDownPositionRef = useRef(new Vector2(0, 0));\n  function handleOpenDown(event: React.PointerEvent<HTMLDivElement>) {\n    clickDownPositionRef.current = new Vector2(event.clientX, event.clientY);\n  }\n  function handleOpenClick(\n    event: React.MouseEvent<HTMLDivElement>,\n    newOpen: boolean\n  ) {\n    const clickPosition = new Vector2(event.clientX, event.clientY);\n    const distance = Vector2.distance(\n      clickPosition,\n      clickDownPositionRef.current\n    );\n    if (distance < 5) {\n      setIsOpen(newOpen);\n    }\n  }\n\n  return (\n    <Box ref={setNodeRef}>\n      <animated.div\n        style={{\n          padding: \"4px 0\",\n          width: \"48px\",\n          height,\n          cursor: isOpen ? \"default\" : isDragging ? \"grabbing\" : \"pointer\",\n        }}\n        onPointerDown={handleOpenDown}\n        onClick={(e) => !isOpen && handleOpenClick(e, true)}\n      >\n        {renderTokens()}\n      </animated.div>\n    </Box>\n  );\n}\n\nexport default TokenBarTokenGroup;\n","function SelectMapIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1z\" />\n    </svg>\n  );\n}\n\nexport default SelectMapIcon;\n","import { useState } from \"react\";\nimport { Flex, Box, Input, Label, IconButton, Text } from \"theme-ui\";\n\nimport { isEmpty } from \"../../helpers/shared\";\n\nimport Select from \"../Select\";\nimport TokenAttributeEditor from \"./TokenAttributeEditor\";\n\nimport { Token, TokenCategory } from \"../../types/Token\";\nimport { TokenSettingsChangeEventHandler } from \"../../types/Events\";\nimport { buildNextAttributes, createEmptyAttributes } from \"../../helpers/tokenAttributes\";\nimport ExpandMoreIcon from \"../../icons/ExpandMoreIcon\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\n\ntype CategorySetting = { value: TokenCategory; label: string };\nconst categorySettings: CategorySetting[] = [\n  { value: \"character\", label: \"Character\" },\n  { value: \"prop\", label: \"Prop\" },\n  { value: \"vehicle\", label: \"Mount\" },\n  { value: \"attachment\", label: \"Attachment\" },\n];\n\ntype TokenSettingsProps = {\n  token: Token;\n  onSettingsChange: TokenSettingsChangeEventHandler;\n};\n\nfunction TokenSettings({ token, onSettingsChange }: TokenSettingsProps) {\n  const tokenEmpty = !token || isEmpty(token);\n  const userId = useUserId();\n  const [showDefaultAttributes, setShowDefaultAttributes] = useState(false);\n\n  const defaultAttributes = token?.defaultAttributes\n    ? token.defaultAttributes\n    : createEmptyAttributes(userId || \"unknown\");\n\n  function updateDefaultAttributes(nextBars: typeof defaultAttributes.bars, nextValues: typeof defaultAttributes.values) {\n    if (tokenEmpty) {\n      return;\n    }\n    const nextAttributes = buildNextAttributes(\n      token.defaultAttributes,\n      nextBars,\n      nextValues,\n      userId || \"unknown\"\n    );\n    onSettingsChange({ defaultAttributes: nextAttributes });\n  }\n\n  return (\n    <Flex sx={{ flexDirection: \"column\" }}>\n      <Box mt={2} sx={{ flexGrow: 1 }}>\n        <Label htmlFor=\"name\">Name</Label>\n        <Input\n          name=\"name\"\n          value={(token && token.name) || \"\"}\n          onChange={(e) => onSettingsChange({ name: e.target.value })}\n          disabled={tokenEmpty}\n          my={1}\n        />\n      </Box>\n      <Box mt={2}>\n        <Label>Default Category</Label>\n        <Select\n          options={categorySettings}\n          value={\n            tokenEmpty\n              ? undefined\n              : categorySettings.find((s) => s.value === token.defaultCategory)\n          }\n          isDisabled={tokenEmpty}\n          onChange={\n            ((option: CategorySetting) =>\n              onSettingsChange({ defaultCategory: option.value })) as any\n          }\n          isSearchable={false}\n        />\n      </Box>\n      <Box mt={2} sx={{ flexGrow: 1 }}>\n        <Label htmlFor=\"tokenSize\">Default Size</Label>\n        <Input\n          type=\"number\"\n          name=\"tokenSize\"\n          value={`${(token && token.defaultSize) || 0}`}\n          onChange={(e) =>\n            onSettingsChange({ defaultSize: parseFloat(e.target.value) })\n          }\n          disabled={tokenEmpty}\n          min={1}\n          my={1}\n        />\n      </Box>\n      <Box my={2} mb={3} sx={{ flexGrow: 1 }}>\n        <Label htmlFor=\"label\">Default Label</Label>\n        <Input\n          name=\"label\"\n          value={(token && token.defaultLabel) || \"\"}\n          onChange={(e) => onSettingsChange({ defaultLabel: e.target.value })}\n          disabled={tokenEmpty}\n          my={1}\n        />\n      </Box>\n      <Box mt={2}>\n        <Flex\n          sx={{ alignItems: \"center\", justifyContent: \"space-between\", cursor: \"pointer\" }}\n          onClick={() => setShowDefaultAttributes((prev) => !prev)}\n        >\n          <Text as=\"label\" variant=\"body2\">\n            Default Attributes\n          </Text>\n          <IconButton\n            title={showDefaultAttributes ? \"Show Less\" : \"Show More\"}\n            aria-label={showDefaultAttributes ? \"Show Less\" : \"Show More\"}\n            sx={{ transform: showDefaultAttributes ? \"rotate(180deg)\" : \"none\" }}\n          >\n            <ExpandMoreIcon />\n          </IconButton>\n        </Flex>\n        {showDefaultAttributes && (\n          <Box mt={2}>\n            <TokenAttributeEditor\n              attributes={defaultAttributes}\n              onChange={updateDefaultAttributes}\n              canEdit={!tokenEmpty}\n              compact\n              showHeader\n            />\n          </Box>\n        )}\n      </Box>\n    </Flex>\n  );\n}\n\nexport default TokenSettings;\n","import { useState, useRef } from \"react\";\nimport { Box, IconButton } from \"theme-ui\";\nimport { Stage, Layer, Image, Rect, Group } from \"react-konva\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport useImage from \"use-image\";\nimport Konva from \"konva\";\n\nimport usePreventOverscroll from \"../../hooks/usePreventOverscroll\";\nimport useStageInteraction from \"../../hooks/useStageInteraction\";\nimport useImageCenter from \"../../hooks/useImageCenter\";\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\n\nimport { GridProvider } from \"../../contexts/GridContext\";\nimport { useDataURL } from \"../../contexts/AssetsContext\";\n\nimport GridOnIcon from \"../../icons/GridOnIcon\";\nimport GridOffIcon from \"../../icons/GridOffIcon\";\n\nimport { tokenSources } from \"../../tokens\";\n\nimport Grid from \"../konva/Grid\";\nimport { Token } from \"../../types/Token\";\nimport SettingsContext, { useSettings } from \"../../contexts/SettingsContext\";\n\ntype TokenPreviewProps = {\n  token: Token;\n};\n\nfunction TokenPreview({ token }: TokenPreviewProps) {\n  const settings = useSettings();\n\n  const tokenURL = useDataURL(token, tokenSources);\n  const [tokenSourceImage] = useImage(tokenURL || \"\");\n\n  const [stageWidth, setStageWidth] = useState(1);\n  const [stageHeight, setStageHeight] = useState(1);\n  const [stageScale, setStageScale] = useState(1);\n\n  const stageTranslateRef = useRef({ x: 0, y: 0 });\n  const tokenStageRef = useRef<Konva.Stage>(null);\n  const tokenLayerRef = useRef<Konva.Layer>(null);\n\n  function handleResize(width?: number, height?: number) {\n    if (width && height) {\n      setStageWidth(width);\n      setStageHeight(height);\n    }\n  }\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  usePreventOverscroll(containerRef);\n\n  const [tokenWidth, tokenHeight] = useImageCenter(\n    token,\n    tokenStageRef,\n    stageWidth,\n    stageHeight,\n    stageTranslateRef,\n    setStageScale,\n    tokenLayerRef,\n    containerRef,\n    true\n  );\n\n  useStageInteraction(\n    tokenStageRef,\n    stageScale,\n    setStageScale,\n    stageTranslateRef,\n    tokenLayerRef\n  );\n\n  const [showGridPreview, setShowGridPreview] = useState(true);\n  const gridWidth = tokenWidth;\n  const gridX = token.defaultSize;\n  const gridSize = gridWidth / gridX;\n  const gridY = Math.round(tokenHeight / gridSize);\n  const gridHeight = gridY > 0 ? gridY * gridSize : tokenHeight;\n  const borderWidth = Math.max(\n    (Math.min(tokenWidth, gridHeight) / 200) * Math.max(1 / stageScale, 1),\n    1\n  );\n\n  const layout = useResponsiveLayout();\n\n  return (\n    <Box\n      sx={{\n        width: \"100%\",\n        height: layout.screenSize === \"large\" ? \"500px\" : \"300px\",\n        cursor: \"move\",\n        touchAction: \"none\",\n        outline: \"none\",\n        position: \"relative\",\n      }}\n      bg=\"muted\"\n      ref={containerRef}\n    >\n      <ReactResizeDetector\n        handleWidth\n        handleHeight\n        onResize={handleResize}\n        targetRef={containerRef}\n      >\n        <Stage\n          width={stageWidth}\n          height={stageHeight}\n          scale={{ x: stageScale, y: stageScale }}\n          ref={tokenStageRef}\n        >\n          <SettingsContext.Provider value={settings}>\n            <Layer ref={tokenLayerRef}>\n              <Image\n                image={tokenSourceImage}\n                width={tokenWidth}\n                height={tokenHeight}\n              />\n              {showGridPreview && (\n                <Group offsetY={gridHeight - tokenHeight}>\n                  <GridProvider\n                    grid={{\n                      size: { x: gridX, y: gridY },\n                      inset: {\n                        topLeft: { x: 0, y: 0 },\n                        bottomRight: { x: 1, y: 1 },\n                      },\n                      type: \"square\",\n                      measurement: { type: \"chebyshev\", scale: \"5ft\" },\n                    }}\n                    width={gridWidth}\n                    height={gridHeight}\n                  >\n                    <Grid />\n                  </GridProvider>\n                  <Rect\n                    width={gridWidth}\n                    height={gridHeight}\n                    fill=\"transparent\"\n                    stroke=\"rgba(255, 255, 255, 0.75)\"\n                    strokeWidth={borderWidth}\n                  />\n                </Group>\n              )}\n            </Layer>\n          </SettingsContext.Provider>\n        </Stage>\n      </ReactResizeDetector>\n      <IconButton\n        title={showGridPreview ? \"Hide Grid Preview\" : \"Show Grid Preview\"}\n        aria-label={showGridPreview ? \"Hide Grid Preview\" : \"Show Grid Preview\"}\n        onClick={() => setShowGridPreview(!showGridPreview)}\n        bg=\"overlay\"\n        sx={{\n          borderRadius: \"50%\",\n          position: \"absolute\",\n          bottom: 0,\n          right: 0,\n        }}\n        m={2}\n        p=\"6px\"\n      >\n        {showGridPreview ? <GridOnIcon /> : <GridOffIcon />}\n      </IconButton>\n    </Box>\n  );\n}\n\nexport default TokenPreview;\n","import { useState } from \"react\";\nimport { Button, Flex, Label, useThemeUI } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport Modal from \"../components/Modal\";\nimport TokenSettings from \"../components/token/TokenSettings\";\nimport TokenPreview from \"../components/token/TokenPreview\";\n\nimport { isEmpty } from \"../helpers/shared\";\n\nimport useResponsiveLayout from \"../hooks/useResponsiveLayout\";\n\nimport { Token } from \"../types/Token\";\n\nimport { UpdateTokenEventHandler } from \"../contexts/TokenDataContext\";\n\ntype EditModalProps = {\n  isOpen: boolean;\n  onDone: () => void;\n  token: Token;\n  onUpdateToken: UpdateTokenEventHandler;\n};\n\nfunction EditTokenModal({\n  isOpen,\n  onDone,\n  token,\n  onUpdateToken,\n}: EditModalProps) {\n  const { theme } = useThemeUI();\n\n  function handleClose() {\n    setTokenSettingChanges({});\n    onDone();\n  }\n\n  async function handleSave() {\n    await applyTokenChanges();\n    onDone();\n  }\n\n  const [tokenSettingChanges, setTokenSettingChanges] = useState<\n    Partial<Token>\n  >({});\n\n  // TODO: CHANGE MAP BACK? OR CHANGE THIS TO PARTIAL\n  function handleTokenSettingsChange(change: Partial<Token>) {\n    setTokenSettingChanges((prevChanges) => ({\n      ...prevChanges,\n      ...change,\n    }));\n  }\n\n  async function applyTokenChanges() {\n    if (token && !isEmpty(tokenSettingChanges)) {\n      // Ensure size value is positive\n      let verifiedChanges = { ...tokenSettingChanges };\n      if (\"defaultSize\" in verifiedChanges) {\n        verifiedChanges.defaultSize = verifiedChanges.defaultSize || 1;\n      }\n\n      await onUpdateToken(token.id, verifiedChanges);\n      setTokenSettingChanges({});\n    }\n  }\n\n  const selectedTokenWithChanges = {\n    ...token,\n    ...tokenSettingChanges,\n  } as Token;\n\n  const layout = useResponsiveLayout();\n\n  if (!token) {\n    return null;\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={handleClose}\n      style={{\n        content: {\n          maxWidth: layout.modalSize,\n          width: \"calc(100% - 16px)\",\n          padding: 0,\n          display: \"flex\",\n          overflow: \"hidden\",\n        },\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          width: \"100%\",\n        }}\n      >\n        <Label pt={2} pb={1} px={3}>\n          Edit token\n        </Label>\n        <SimpleBar\n          style={{\n            minHeight: 0,\n            padding: \"16px\",\n            backgroundColor: theme.colors?.muted as string,\n            margin: \"0 8px\",\n            height: \"100%\",\n          }}\n        >\n          <TokenPreview token={selectedTokenWithChanges} />\n          <TokenSettings\n            token={selectedTokenWithChanges}\n            onSettingsChange={handleTokenSettingsChange}\n          />\n        </SimpleBar>\n        <Button m={3} onClick={handleSave}>\n          Save\n        </Button>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default EditTokenModal;\n","import React from \"react\";\nimport { Token } from \"../../types/Token\";\n\nimport Tile from \"../tile/Tile\";\nimport TokenImage from \"./TokenImage\";\n\ntype TokenTileProps = {\n  token: Token;\n  isSelected: boolean;\n  onSelect: (tokenId: string) => void;\n  onTokenEdit: (tokenId: string) => void;\n  canEdit: boolean;\n  badges: React.ReactChild[];\n};\n\nfunction TokenTile({\n  token,\n  isSelected,\n  onSelect,\n  onTokenEdit,\n  canEdit,\n  badges,\n}: TokenTileProps) {\n  return (\n    <Tile\n      title={token.name}\n      isSelected={isSelected}\n      onSelect={() => onSelect(token.id)}\n      onEdit={() => onTokenEdit(token.id)}\n      canEdit={canEdit}\n      badges={badges}\n      editTitle=\"Edit Token\"\n    >\n      <TokenImage token={token} />\n    </Tile>\n  );\n}\n\nexport default TokenTile;\n","import { Grid } from \"theme-ui\";\n\nimport Tile from \"../tile/Tile\";\nimport TokenImage from \"./TokenImage\";\n\nimport useResponsiveLayout from \"../../hooks/useResponsiveLayout\";\nimport { GroupContainer } from \"../../types/Group\";\nimport { Token } from \"../../types/Token\";\n\ntype TokenTileProps = {\n  group: GroupContainer;\n  tokens: Token[];\n  isSelected: boolean;\n  onSelect: (tokenId: string) => void;\n  onDoubleClick: () => void;\n};\n\nfunction TokenTileGroup({\n  group,\n  tokens,\n  isSelected,\n  onSelect,\n  onDoubleClick,\n}: TokenTileProps) {\n  const layout = useResponsiveLayout();\n\n  return (\n    <Tile\n      title={group.name}\n      isSelected={isSelected}\n      onSelect={() => onSelect(group.id)}\n      onDoubleClick={onDoubleClick}\n    >\n      <Grid\n        columns={`repeat(${layout.groupGridColumns}, 1fr)`}\n        p={2}\n        gap={2}\n        sx={{\n          height: \"100%\",\n          gridTemplateRows: `repeat(${layout.groupGridColumns}, 1fr)`,\n        }}\n      >\n        {tokens\n          .slice(0, layout.groupGridColumns * layout.groupGridColumns)\n          .map((token) => (\n            <TokenImage\n              sx={{ borderRadius: \"8px\" }}\n              token={token}\n              key={`${token.id}-group-tile`}\n            />\n          ))}\n      </Grid>\n    </Tile>\n  );\n}\n\nexport default TokenTileGroup;\n","import { Flex } from \"theme-ui\";\n\nimport TokenShowIcon from \"../../icons/TokenShowIcon\";\nimport TokenHideIcon from \"../../icons/TokenHideIcon\";\n\ntype TokenHiddenBadgeProps = {\n  hidden: boolean;\n};\n\nfunction TokenHiddenBadge({ hidden }: TokenHiddenBadgeProps) {\n  return (\n    <Flex\n      sx={{\n        height: \"15px\",\n        width: \"15px\",\n        alignItems: \"center\",\n      }}\n    >\n      {hidden ? <TokenHideIcon /> : <TokenShowIcon />}\n    </Flex>\n  );\n}\n\nexport default TokenHiddenBadge;\n","import TokenTile from \"./TokenTile\";\nimport TokenTileGroup from \"./TokenTileGroup\";\nimport TokenHiddenBadge from \"./TokenHiddenBadge\";\n\nimport SortableTiles from \"../tile/SortableTiles\";\nimport SortableTilesDragOverlay from \"../tile/SortableTilesDragOverlay\";\n\nimport { getGroupItems } from \"../../helpers/group\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { Token } from \"../../types/Token\";\nimport { Group } from \"../../types/Group\";\n\ntype TokenTilesProps = {\n  tokensById: Record<string, Token>;\n  onTokenEdit: (tokenId: string) => void;\n  subgroup: boolean;\n};\n\nfunction TokenTiles({ tokensById, onTokenEdit, subgroup }: TokenTilesProps) {\n  const { selectedGroupIds, selectMode, onGroupOpen, onGroupSelect } =\n    useGroup();\n\n  function renderTile(group: Group) {\n    if (group.type === \"item\") {\n      const token = tokensById[group.id];\n      if (token) {\n        const isSelected = selectedGroupIds.includes(group.id);\n        const canEdit =\n          isSelected &&\n          selectMode === \"single\" &&\n          selectedGroupIds.length === 1;\n\n        return (\n          <TokenTile\n            key={token.id}\n            token={token}\n            isSelected={isSelected}\n            onSelect={onGroupSelect}\n            onTokenEdit={onTokenEdit}\n            canEdit={canEdit}\n            badges={[\n              `${token.defaultSize}x`,\n              <TokenHiddenBadge hidden={token.hideInSidebar} />,\n            ]}\n          />\n        );\n      }\n    } else {\n      const isSelected = selectedGroupIds.includes(group.id);\n      const items = getGroupItems(group);\n      const canOpen =\n        isSelected && selectMode === \"single\" && selectedGroupIds.length === 1;\n      return (\n        <TokenTileGroup\n          key={group.id}\n          group={group}\n          tokens={items.map((item) => tokensById[item.id])}\n          isSelected={isSelected}\n          onSelect={onGroupSelect}\n          onDoubleClick={() => canOpen && onGroupOpen(group.id)}\n        />\n      );\n    }\n  }\n\n  return (\n    <>\n      <SortableTiles renderTile={renderTile} subgroup={subgroup} />\n      <SortableTilesDragOverlay renderTile={renderTile} subgroup={subgroup} />\n    </>\n  );\n}\n\nTokenTiles.defaultProps = {\n  subgroup: false,\n};\n\nexport default TokenTiles;\n","import { useState, useEffect } from \"react\";\nimport { Flex, Close, IconButton } from \"theme-ui\";\n\nimport { groupsFromIds, itemsFromGroups } from \"../../helpers/group\";\n\nimport ConfirmModal from \"../../modals/ConfirmModal\";\n\nimport TokenShowIcon from \"../../icons/TokenShowIcon\";\nimport TokenHideIcon from \"../../icons/TokenHideIcon\";\nimport RemoveTokenIcon from \"../../icons/RemoveTokenIcon\";\n\nimport { useGroup } from \"../../contexts/GroupContext\";\nimport { useTokenData } from \"../../contexts/TokenDataContext\";\nimport { useKeyboard } from \"../../contexts/KeyboardContext\";\n\nimport shortcuts from \"../../shortcuts\";\n\ntype TokenEditBarProps = {\n  disabled: boolean;\n  onLoad: (load: boolean) => void;\n};\n\nfunction TokenEditBar({ disabled, onLoad }: TokenEditBarProps) {\n  const { tokens, removeTokens, updateTokensHidden } = useTokenData();\n\n  const { activeGroups, selectedGroupIds, onClearSelection } = useGroup();\n\n  const [allTokensVisible, setAllTokensVisisble] = useState(false);\n\n  useEffect(() => {\n    const selectedGroups = groupsFromIds(selectedGroupIds, activeGroups);\n    const selectedTokens = itemsFromGroups(selectedGroups, tokens);\n\n    setAllTokensVisisble(selectedTokens.every((token) => !token.hideInSidebar));\n  }, [selectedGroupIds, tokens, activeGroups]);\n\n  function getSelectedTokens() {\n    const selectedGroups = groupsFromIds(selectedGroupIds, activeGroups);\n    return itemsFromGroups(selectedGroups, tokens);\n  }\n\n  const [isTokensRemoveModalOpen, setIsTokensRemoveModalOpen] = useState(false);\n  async function handleTokensRemove() {\n    onLoad(true);\n    setIsTokensRemoveModalOpen(false);\n    const selectedTokens = getSelectedTokens();\n    const selectedTokenIds = selectedTokens.map((token) => token.id);\n    onClearSelection();\n    await removeTokens(selectedTokenIds);\n    onLoad(false);\n  }\n\n  async function handleTokensHide(hideInSidebar: boolean) {\n    const selectedTokens = getSelectedTokens();\n    const selectedTokenIds = selectedTokens.map((token) => token.id);\n    // Show loading indicator if hiding more than 10 tokens\n    if (selectedTokenIds.length > 10) {\n      onLoad(true);\n      await updateTokensHidden(selectedTokenIds, hideInSidebar);\n      onLoad(false);\n    } else {\n      updateTokensHidden(selectedTokenIds, hideInSidebar);\n    }\n  }\n\n  /**\n   * Shortcuts\n   */\n  function handleKeyDown(event: KeyboardEvent) {\n    if (disabled) {\n      return;\n    }\n    if (shortcuts.delete(event)) {\n      const selectedTokens = getSelectedTokens();\n      if (selectedTokens.length > 0) {\n        // Ensure all other modals are closed\n        setIsTokensRemoveModalOpen(true);\n      }\n    }\n  }\n\n  useKeyboard(handleKeyDown);\n\n  if (selectedGroupIds.length === 0) {\n    return null;\n  }\n\n  let hideTitle = \"\";\n  if (allTokensVisible) {\n    hideTitle = \"Hide Selected Token(s) in Sidebar\";\n  } else {\n    hideTitle = \"Show Selected Token(s) in Sidebar\";\n  }\n\n  return (\n    <Flex\n      sx={{\n        position: \"absolute\",\n        bottom: 0,\n        left: 0,\n        right: 0,\n        justifyContent: \"space-between\",\n      }}\n      bg=\"overlay\"\n    >\n      <Close\n        title=\"Clear Selection\"\n        aria-label=\"Clear Selection\"\n        onClick={() => onClearSelection()}\n      />\n      <Flex>\n        <IconButton\n          aria-label={hideTitle}\n          title={hideTitle}\n          onClick={() => handleTokensHide(allTokensVisible)}\n        >\n          {allTokensVisible ? <TokenShowIcon /> : <TokenHideIcon />}\n        </IconButton>\n        <IconButton\n          aria-label=\"Remove Selected Token(s)\"\n          title=\"Remove Selected Token(s)\"\n          onClick={() => setIsTokensRemoveModalOpen(true)}\n        >\n          <RemoveTokenIcon />\n        </IconButton>\n      </Flex>\n      <ConfirmModal\n        isOpen={isTokensRemoveModalOpen}\n        onRequestClose={() => setIsTokensRemoveModalOpen(false)}\n        onConfirm={handleTokensRemove}\n        confirmText=\"Remove\"\n        label=\"Remove Selected Token(s)\"\n        description=\"This operation cannot be undone.\"\n      />\n    </Flex>\n  );\n}\n\nexport default TokenEditBar;\n","import { useRef, useState, useEffect } from \"react\";\nimport { Flex, Label, Button, Box } from \"theme-ui\";\nimport { useToasts } from \"react-toast-notifications\";\nimport ReactResizeDetector from \"react-resize-detector\";\n\nimport EditTokenModal from \"./EditTokenModal\";\nimport ConfirmModal from \"./ConfirmModal\";\n\nimport Modal from \"../components/Modal\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\nimport DatabaseDisabledMessage from \"../components/DatabaseDisabledMessage\";\n\nimport ImageDrop from \"../components/image/ImageDrop\";\n\nimport TokenTiles from \"../components/token/TokenTiles\";\nimport TokenEditBar from \"../components/token/TokenEditBar\";\n\nimport TilesOverlay from \"../components/tile/TilesOverlay\";\nimport TilesContainer from \"../components/tile/TilesContainer\";\nimport TileActionBar from \"../components/tile/TileActionBar\";\n\nimport { getGroupItems, getItemNames } from \"../helpers/group\";\nimport {\n  createTokenFromFile,\n  createTokenState,\n  clientPositionToMapPosition,\n} from \"../helpers/token\";\nimport Vector2 from \"../helpers/Vector2\";\n\nimport useResponsiveLayout from \"../hooks/useResponsiveLayout\";\nimport useSetting from \"../hooks/useSetting\";\n\nimport { useTokenData } from \"../contexts/TokenDataContext\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useAssets } from \"../contexts/AssetsContext\";\nimport { GroupProvider } from \"../contexts/GroupContext\";\nimport { TileDragProvider } from \"../contexts/TileDragContext\";\nimport { useMapStage } from \"../contexts/MapStageContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\n\nimport { TokenState } from \"../types/TokenState\";\nimport {\n  TokensStateCreateHandler,\n  RequestCloseEventHandler,\n} from \"../types/Events\";\n\ntype SelectTokensModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onMapTokensStateCreate: TokensStateCreateHandler;\n};\n\nfunction SelectTokensModal({\n  isOpen,\n  onRequestClose,\n  onMapTokensStateCreate,\n}: SelectTokensModalProps) {\n  const { addToast } = useToasts();\n\n  const { databaseStatus } = useDatabase();\n\n  const userId = useUserId();\n  const {\n    tokens,\n    addToken,\n    tokensLoading,\n    tokenGroups,\n    updateTokenGroups,\n    updateToken,\n    tokensById,\n  } = useTokenData();\n  const { addAssets } = useAssets();\n  const [imageCompressionQuality] = useSetting<number>(\n    \"asset.compressionQuality\"\n  );\n  const [autoVisionOnDrop] = useSetting<boolean>(\"fog.autoVisionOnDrop\");\n\n  // Get token names for group filtering\n  const [tokenNames, setTokenNames] = useState(getItemNames(tokens));\n  useEffect(() => {\n    setTokenNames(getItemNames(tokens));\n  }, [tokens]);\n\n  /**\n   * Image Upload\n   */\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [isLargeImageWarningModalOpen, setShowLargeImageWarning] =\n    useState(false);\n  const largeImageWarningFiles = useRef<File[]>();\n\n  async function handleImagesUpload(files: File[]) {\n    if (navigator.storage) {\n      // Attempt to enable persistant storage\n      await navigator.storage.persist();\n    }\n\n    let tokenFiles = [];\n    for (let file of files) {\n      if (file.size > 5e7) {\n        addToast(`Unable to import token ${file.name} as it is over 50MB`);\n      } else {\n        tokenFiles.push(file);\n      }\n    }\n\n    // Any file greater than 20MB\n    if (tokenFiles.some((file) => file.size > 2e7)) {\n      largeImageWarningFiles.current = tokenFiles;\n      setShowLargeImageWarning(true);\n      return;\n    }\n\n    for (let file of tokenFiles) {\n      await handleImageUpload(file);\n    }\n\n    clearFileInput();\n  }\n\n  function clearFileInput() {\n    // Set file input to null to allow adding the same image 2 times in a row\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  }\n\n  function openImageDialog() {\n    if (fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  }\n\n  function handleLargeImageWarningCancel() {\n    largeImageWarningFiles.current = undefined;\n    setShowLargeImageWarning(false);\n    clearFileInput();\n  }\n\n  async function handleLargeImageWarningConfirm() {\n    setShowLargeImageWarning(false);\n    const files = largeImageWarningFiles.current;\n    if (!files) {\n      return;\n    }\n    for (let file of files) {\n      await handleImageUpload(file);\n    }\n    largeImageWarningFiles.current = undefined;\n    clearFileInput();\n  }\n\n  async function handleImageUpload(file: File) {\n    if (!userId) {\n      return;\n    }\n    setIsLoading(true);\n    try {\n      const compressionQuality = imageCompressionQuality ?? 0.8;\n      const { token, assets } = await createTokenFromFile(\n        file,\n        userId,\n        compressionQuality\n      );\n      await addToken(token);\n      await addAssets(assets);\n    } catch (error) {\n      console.error(\"TOKEN_IMPORT_FAILED\", error);\n      addToast(\"\");\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  /**\n   * Token controls\n   */\n  const [editingTokenId, setEditingTokenId] = useState<string>();\n\n  const [isDraggingToken, setIsDraggingToken] = useState(false);\n\n  const mapStageRef = useMapStage();\n  function handleTokensAddToMap(groupIds: string[], rect: DOMRect) {\n    let clientPosition = new Vector2(\n      rect.width / 2 + rect.left,\n      rect.height / 2 + rect.top\n    );\n    const mapStage = mapStageRef.current;\n    if (!mapStage) {\n      return;\n    }\n\n    let position = clientPositionToMapPosition(mapStage, clientPosition, false);\n    if (!position || !userId) {\n      return;\n    }\n\n    let newTokenStates: TokenState[] = [];\n\n    for (let id of groupIds) {\n      if (id in tokensById) {\n        newTokenStates.push(\n          createTokenState(tokensById[id], position, userId, {\n            autoEnableVision: autoVisionOnDrop,\n          })\n        );\n        position = Vector2.add(position, 0.01);\n      } else {\n        // Check if a group is selected\n        const group = tokenGroups.find(\n          (group) => group.id === id && group.type === \"group\"\n        );\n        if (group) {\n          // Add all tokens of group\n          const items = getGroupItems(group);\n          for (let item of items) {\n            if (item.id in tokensById) {\n              newTokenStates.push(\n                createTokenState(tokensById[item.id], position, userId, {\n                  autoEnableVision: autoVisionOnDrop,\n                })\n              );\n              position = Vector2.add(position, 0.01);\n            }\n          }\n        }\n      }\n    }\n\n    if (newTokenStates.length > 0) {\n      onMapTokensStateCreate(newTokenStates);\n    }\n  }\n\n  const layout = useResponsiveLayout();\n\n  const [modalSize, setModalSize] = useState({ width: 0, height: 0 });\n  function handleModalResize(width?: number, height?: number) {\n    if (width && height) {\n      setModalSize({ width, height });\n    }\n  }\n\n  const editingToken =\n    editingTokenId && tokens.find((token) => token.id === editingTokenId);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{\n        content: { maxWidth: layout.modalSize, width: \"calc(100% - 16px)\" },\n      }}\n      shouldCloseOnEsc={!isDraggingToken}\n    >\n      <ImageDrop\n        onDrop={({ files }) => handleImagesUpload(files)}\n        dropText=\"Drop token to import\"\n      >\n        <input\n          onChange={(event) =>\n            event.target.files &&\n            handleImagesUpload(Array.from(event.target.files))\n          }\n          type=\"file\"\n          accept=\"image/jpeg, image/gif, image/png, image/webp\"\n          style={{ display: \"none\" }}\n          ref={fileInputRef}\n          multiple\n        />\n        <ReactResizeDetector\n          handleWidth\n          handleHeight\n          onResize={handleModalResize}\n          refreshMode=\"debounce\"\n        >\n          <GroupProvider\n            groups={tokenGroups}\n            itemNames={tokenNames}\n            onGroupsChange={updateTokenGroups}\n            disabled={!isOpen}\n          >\n            <Flex\n              sx={{\n                flexDirection: \"column\",\n              }}\n            >\n              <Label pt={2} pb={1}>\n                Edit or import a token\n              </Label>\n              <TileActionBar\n                onAdd={openImageDialog}\n                addTitle=\"Import Token(s)\"\n              />\n              <Box sx={{ position: \"relative\" }}>\n                <TileDragProvider\n                  onDragAdd={handleTokensAddToMap}\n                  onDragStart={() => setIsDraggingToken(true)}\n                  onDragEnd={() => setIsDraggingToken(false)}\n                  onDragCancel={() => setIsDraggingToken(false)}\n                >\n                  <TilesContainer>\n                    {databaseStatus === \"disabled\" && (\n                      <DatabaseDisabledMessage type=\"Token\" />\n                    )}\n                    <TokenTiles\n                      tokensById={tokensById}\n                      onTokenEdit={setEditingTokenId}\n                    />\n                  </TilesContainer>\n                </TileDragProvider>\n                <TileDragProvider\n                  onDragAdd={handleTokensAddToMap}\n                  onDragStart={() => setIsDraggingToken(true)}\n                  onDragEnd={() => setIsDraggingToken(false)}\n                  onDragCancel={() => setIsDraggingToken(false)}\n                >\n                  <TilesOverlay modalSize={modalSize}>\n                    <TokenTiles\n                      tokensById={tokensById}\n                      onTokenEdit={setEditingTokenId}\n                      subgroup\n                    />\n                  </TilesOverlay>\n                </TileDragProvider>\n                <TokenEditBar\n                  onLoad={setIsLoading}\n                  disabled={isLoading || !isOpen}\n                />\n              </Box>\n              <Button\n                variant=\"primary\"\n                disabled={isLoading}\n                onClick={onRequestClose}\n                mt={2}\n              >\n                Done\n              </Button>\n            </Flex>\n          </GroupProvider>\n        </ReactResizeDetector>\n      </ImageDrop>\n      <>{(isLoading || tokensLoading) && <LoadingOverlay bg=\"overlay\" />}</>\n      <>\n        {editingToken && (\n          <EditTokenModal\n            isOpen={!!editingTokenId}\n            onDone={() => setEditingTokenId(undefined)}\n            token={editingToken}\n            onUpdateToken={updateToken}\n          />\n        )}\n      </>\n      <ConfirmModal\n        isOpen={isLargeImageWarningModalOpen}\n        onRequestClose={handleLargeImageWarningCancel}\n        onConfirm={handleLargeImageWarningConfirm}\n        confirmText=\"Continue\"\n        label=\"Warning\"\n        description=\"An imported image is larger than 20MB, this may cause slowness. Continue?\"\n      />\n    </Modal>\n  );\n}\n\nexport default SelectTokensModal;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport SelectTokensIcon from \"../../icons/SelectTokensIcon\";\n\nimport SelectTokensModal from \"../../modals/SelectTokensModal\";\nimport { TokensStateCreateHandler } from \"../../types/Events\";\n\ntype SelectTokensButtonProps = {\n  onMapTokensStateCreate: TokensStateCreateHandler;\n};\n\nfunction SelectTokensButton({\n  onMapTokensStateCreate,\n}: SelectTokensButtonProps) {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  function openModal() {\n    setIsModalOpen(true);\n  }\n  function closeModal() {\n    setIsModalOpen(false);\n  }\n\n  return (\n    <>\n      <IconButton\n        aria-label=\"Edit Tokens\"\n        title=\"Edit Tokens\"\n        onClick={openModal}\n      >\n        <SelectTokensIcon />\n      </IconButton>\n      <SelectTokensModal\n        isOpen={isModalOpen}\n        onRequestClose={closeModal}\n        onMapTokensStateCreate={onMapTokensStateCreate}\n      />\n    </>\n  );\n}\n\nexport default SelectTokensButton;\n","import { useState } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { Box, Flex, Grid } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\nimport {\n  DragOverlay,\n  MouseSensor,\n  TouchSensor,\n  KeyboardSensor,\n  useSensor,\n  useSensors,\n  DragStartEvent,\n} from \"@dnd-kit/core\";\n\nimport TokenBarToken from \"./TokenBarToken\";\nimport TokenBarTokenGroup from \"./TokenBarTokenGroup\";\nimport SelectTokensButton from \"./SelectTokensButton\";\n\nimport Draggable from \"../drag/Draggable\";\n\nimport useSetting from \"../../hooks/useSetting\";\nimport usePreventSelect from \"../../hooks/usePreventSelect\";\n\nimport { useTokenData } from \"../../contexts/TokenDataContext\";\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport DragContext, { CustomDragEndEvent } from \"../../contexts/DragContext\";\n\nimport {\n  createTokenState,\n  clientPositionToMapPosition,\n} from \"../../helpers/token\";\nimport { findGroup } from \"../../helpers/group\";\nimport Vector2 from \"../../helpers/Vector2\";\nimport { TokensStateCreateHandler } from \"../../types/Events\";\nimport { Group } from \"../../types/Group\";\n\ntype TokenBarProps = {\n  onMapTokensStateCreate: TokensStateCreateHandler;\n};\n\nfunction TokenBar({ onMapTokensStateCreate }: TokenBarProps) {\n  const userId = useUserId();\n  const { tokensById, tokenGroups } = useTokenData();\n  const [fullScreen] = useSetting<boolean>(\"map.fullScreen\");\n  const [autoVisionOnDrop] = useSetting<boolean>(\"fog.autoVisionOnDrop\");\n\n  const [dragId, setDragId] = useState<string | null>(null);\n\n  const mapStageRef = useMapStage();\n\n  const mouseSensor = useSensor(MouseSensor, {\n    activationConstraint: { distance: 5 },\n  });\n  const touchSensor = useSensor(TouchSensor, {\n    activationConstraint: { distance: 5 },\n  });\n  const keyboardSensor = useSensor(KeyboardSensor);\n  const sensors = useSensors(mouseSensor, touchSensor, keyboardSensor);\n\n  const [preventSelect, resumeSelect] = usePreventSelect();\n\n  function handleDragStart({ active }: DragStartEvent) {\n    setDragId(active.id);\n    preventSelect();\n  }\n\n  function handleDragEnd({\n    active,\n    overlayNodeClientRect,\n  }: CustomDragEndEvent) {\n    setDragId(null);\n    resumeSelect();\n    if (!userId) {\n      return;\n    }\n    const mapStage = mapStageRef.current;\n    if (mapStage && overlayNodeClientRect) {\n      const dragRect = overlayNodeClientRect;\n      const dragPosition = {\n        x: dragRect.left + dragRect.width / 2,\n        y: dragRect.top + dragRect.height / 2,\n      };\n      const mapPosition = clientPositionToMapPosition(mapStage, dragPosition);\n      const group = findGroup(tokenGroups, active.id);\n      if (group && mapPosition) {\n        if (group.type === \"item\") {\n          const token = tokensById[group.id];\n          const tokenState = createTokenState(token, mapPosition, userId, {\n            autoEnableVision: autoVisionOnDrop,\n          });\n          onMapTokensStateCreate([tokenState]);\n        } else {\n          let tokenStates = [];\n          let offset = new Vector2(0, 0);\n          for (let item of group.items) {\n            const token = tokensById[item.id];\n            if (token && !token.hideInSidebar) {\n              tokenStates.push(\n                createTokenState(\n                  token,\n                  Vector2.add(mapPosition, offset),\n                  userId,\n                  { autoEnableVision: autoVisionOnDrop }\n                )\n              );\n              offset = Vector2.add(offset, 0.01);\n            }\n          }\n          if (tokenStates.length > 0) {\n            onMapTokensStateCreate(tokenStates);\n          }\n        }\n      }\n    }\n  }\n\n  function handleDragCancel() {\n    setDragId(null);\n    resumeSelect();\n  }\n\n  function renderToken(group: Group, draggable = true) {\n    if (group.type === \"item\") {\n      const token = tokensById[group.id];\n      if (token && !token.hideInSidebar) {\n        if (draggable) {\n          return (\n            <Draggable id={token.id} key={token.id}>\n              <TokenBarToken token={token} />\n            </Draggable>\n          );\n        } else {\n          return <TokenBarToken token={token} key={token.id} />;\n        }\n      }\n    } else {\n      const groupTokens = [];\n      for (let item of group.items) {\n        const token = tokensById[item.id];\n        if (token && !token.hideInSidebar) {\n          groupTokens.push(token);\n        }\n      }\n      if (groupTokens.length > 0) {\n        return (\n          <TokenBarTokenGroup\n            group={group}\n            tokens={groupTokens}\n            key={group.id}\n            draggable={draggable}\n          />\n        );\n      }\n    }\n  }\n\n  const dragGroup = dragId && findGroup(tokenGroups, dragId);\n\n  return (\n    <DragContext\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragCancel={handleDragCancel}\n      autoScroll={false}\n      sensors={sensors}\n    >\n      <Box\n        sx={{\n          height: \"100%\",\n          width: \"80px\",\n          minWidth: \"80px\",\n          overflowY: \"hidden\",\n          overflowX: \"hidden\",\n          display: fullScreen ? \"none\" : \"block\",\n        }}\n      >\n        <SimpleBar\n          style={{\n            height: \"calc(100% - 48px)\",\n            overflowX: \"hidden\",\n            padding: \"0 16px\",\n          }}\n        >\n          <Grid\n            columns=\"1fr\"\n            gap={2}\n            py={2}\n            // Prevent selection on 3D touch for iOS\n            onTouchStart={preventSelect}\n            onTouchEnd={resumeSelect}\n          >\n            {tokenGroups.map((group) => renderToken(group))}\n          </Grid>\n        </SimpleBar>\n        <Flex\n          bg=\"muted\"\n          sx={{\n            justifyContent: \"center\",\n            height: \"48px\",\n            alignItems: \"center\",\n          }}\n        >\n          <SelectTokensButton onMapTokensStateCreate={onMapTokensStateCreate} />\n        </Flex>\n        {createPortal(\n          <DragOverlay dropAnimation={null}>\n            {dragGroup && renderToken(dragGroup, false)}\n          </DragOverlay>,\n          document.body\n        )}\n      </Box>\n    </DragContext>\n  );\n}\n\nexport default TokenBar;\n","import React, { useState, useRef } from \"react\";\nimport { Box, Flex, Text, Button, Input } from \"theme-ui\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport LoadingOverlay from \"../LoadingOverlay\";\n\nimport ConfirmModal from \"../../modals/ConfirmModal\";\nimport Modal from \"../Modal\";\n\nimport { createMapFromFile, createMapFromUrl } from \"../../helpers/map\";\nimport { createTokenFromFile, createTokenFromUrl } from \"../../helpers/token\";\nimport {\n  createTokenState,\n  clientPositionToMapPosition,\n} from \"../../helpers/token\";\nimport Vector2 from \"../../helpers/Vector2\";\n\nimport { useUserId } from \"../../contexts/UserIdContext\";\nimport { useMapData } from \"../../contexts/MapDataContext\";\nimport { useTokenData } from \"../../contexts/TokenDataContext\";\nimport { useAssets } from \"../../contexts/AssetsContext\";\nimport { useMapStage } from \"../../contexts/MapStageContext\";\nimport { ImageImportProvider } from \"../../contexts/ImageImportContext\";\n\nimport useImageDrop, { ImageDropEvent } from \"../../hooks/useImageDrop\";\nimport useSetting from \"../../hooks/useSetting\";\n\nimport { Map } from \"../../types/Map\";\nimport { MapState } from \"../../types/MapState\";\nimport { TokenState } from \"../../types/TokenState\";\n\ntype GlobalImageDropProps = {\n  children?: React.ReactNode;\n  onMapChange: (map: Map, mapState: MapState) => void;\n  onMapTokensStateCreate: (states: TokenState[]) => void;\n};\n\nfunction GlobalImageDrop({\n  children,\n  onMapChange,\n  onMapTokensStateCreate,\n}: GlobalImageDropProps) {\n  const { addToast } = useToasts();\n\n  const userId = useUserId();\n  const { addMap, getMapState } = useMapData();\n  const { addToken } = useTokenData();\n  const { addAssets } = useAssets();\n  const [imageCompressionQuality] = useSetting<number>(\n    \"asset.compressionQuality\"\n  );\n  const [autoVisionOnDrop] = useSetting<boolean>(\"fog.autoVisionOnDrop\");\n\n  const mapStageRef = useMapStage();\n\n  const [isLargeImageWarningModalOpen, setShowLargeImageWarning] =\n    useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const droppedImagesRef = useRef<File[]>();\n  const dropPositionRef = useRef<Vector2>();\n  const [droppingType, setDroppingType] = useState<\"maps\" | \"tokens\">(\"maps\");\n  const [isUrlModalOpen, setUrlModalOpen] = useState(false);\n  const [externalUrl, setExternalUrl] = useState(\"\");\n  const [externalType, setExternalType] = useState<\"maps\" | \"tokens\">(\"maps\");\n  const [isUrlModalDragActive, setUrlModalDragActive] = useState(false);\n\n  const supportedFileTypes = [\n    \"image/jpeg\",\n    \"image/gif\",\n    \"image/png\",\n    \"image/webp\",\n  ];\n\n  function isHttpUrl(value: string) {\n    try {\n      const parsed = new URL(value);\n      return parsed.protocol === \"http:\" || parsed.protocol === \"https:\";\n    } catch (error) {\n      return false;\n    }\n  }\n\n  function extractFirstUrl(text: string) {\n    const match = text.match(/https?:\\/\\/[^\\s]+/i);\n    return match ? match[0] : \"\";\n  }\n\n  function extractUrlFromDataTransfer(dataTransfer: DataTransfer) {\n    const uri = dataTransfer.getData(\"text/uri-list\");\n    if (uri) {\n      const uriUrl = extractFirstUrl(uri);\n      if (uriUrl && isHttpUrl(uriUrl)) {\n        return uriUrl;\n      }\n    }\n    const text = dataTransfer.getData(\"text/plain\");\n    if (text) {\n      const textUrl = extractFirstUrl(text);\n      if (textUrl && isHttpUrl(textUrl)) {\n        return textUrl;\n      }\n    }\n    const html = dataTransfer.getData(\"text/html\");\n    if (html) {\n      const urlMatch = html.match(/src=\"?([^\"\\s]+)\"?\\s*/);\n      if (urlMatch) {\n        const url = urlMatch[1].replace(\"&amp;\", \"&\");\n        if (isHttpUrl(url)) {\n          return url;\n        }\n      }\n    }\n    return \"\";\n  }\n\n  function getSupportedFiles(files: File[] | FileList) {\n    const nextFiles: File[] = [];\n    for (let file of Array.from(files)) {\n      if (!supportedFileTypes.includes(file.type)) {\n        addToast(`Unsupported file type for ${file.name}`);\n        continue;\n      }\n      if (file.size > 5e7) {\n        addToast(`Unable to import image ${file.name} as it is over 50MB`);\n        continue;\n      }\n      nextFiles.push(file);\n    }\n    return nextFiles;\n  }\n\n  async function queueImportFromFiles(\n    files: File[],\n    type: \"maps\" | \"tokens\",\n    dropPosition?: Vector2\n  ) {\n    if (navigator.storage) {\n      // Attempt to enable persistant storage\n      await navigator.storage.persist();\n    }\n\n    const nextFiles = getSupportedFiles(files);\n    if (nextFiles.length === 0) {\n      return;\n    }\n\n    dropPositionRef.current = dropPosition;\n    droppedImagesRef.current = nextFiles;\n    setDroppingType(type);\n\n    if (droppedImagesRef.current.some((file) => file.size > 2e7)) {\n      setShowLargeImageWarning(true);\n      return;\n    }\n\n    if (type === \"maps\") {\n      await handleMaps();\n    } else {\n      await handleTokens();\n    }\n  }\n\n  async function handleDrop({ files, dropPosition }: ImageDropEvent) {\n    await queueImportFromFiles(files, droppingType, dropPosition);\n  }\n\n  function handleLargeImageWarningCancel() {\n    droppedImagesRef.current = undefined;\n    setShowLargeImageWarning(false);\n  }\n\n  async function handleLargeImageWarningConfirm() {\n    setShowLargeImageWarning(false);\n    if (droppingType === \"maps\") {\n      await handleMaps();\n    } else {\n      await handleTokens();\n    }\n  }\n\n  function openImportFromUrl(type: \"maps\" | \"tokens\") {\n    setExternalType(type);\n    setExternalUrl(\"\");\n    setUrlModalOpen(true);\n  }\n\n  function handleUrlModalClose() {\n    if (!isLoading) {\n      setUrlModalOpen(false);\n      setExternalUrl(\"\");\n      setUrlModalDragActive(false);\n    }\n  }\n\n  function handleUrlModalDragOver(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.dataTransfer) {\n      event.dataTransfer.dropEffect = \"copy\";\n    }\n    setUrlModalDragActive(true);\n  }\n\n  function handleUrlModalDragLeave(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    setUrlModalDragActive(false);\n  }\n\n  function handleUrlModalDrop(event: React.DragEvent<HTMLDivElement>) {\n    event.preventDefault();\n    event.stopPropagation();\n    setUrlModalDragActive(false);\n    const files = event.dataTransfer?.files || [];\n    if (files.length > 0) {\n      void queueImportFromFiles(\n        Array.from(files),\n        externalType,\n        undefined\n      );\n      return;\n    }\n\n    const droppedUrl = event.dataTransfer\n      ? extractUrlFromDataTransfer(event.dataTransfer)\n      : \"\";\n    if (droppedUrl) {\n      setExternalUrl(droppedUrl);\n    }\n  }\n\n  function handleUrlModalPaste(event: React.ClipboardEvent<HTMLElement>) {\n    const items = event.clipboardData?.items;\n    const files: File[] = [];\n    if (items) {\n      for (const item of Array.from(items)) {\n        if (item.kind === \"file\") {\n          const file = item.getAsFile();\n          if (file) {\n            files.push(file);\n          }\n        }\n      }\n    }\n    if (files.length > 0) {\n      event.preventDefault();\n      void queueImportFromFiles(files, externalType, undefined);\n      return;\n    }\n\n    const rawText =\n      event.clipboardData?.getData(\"text/uri-list\") ||\n      event.clipboardData?.getData(\"text/plain\") ||\n      \"\";\n    const pastedUrl = extractFirstUrl(rawText);\n    if (pastedUrl && isHttpUrl(pastedUrl)) {\n      setExternalUrl(pastedUrl);\n    }\n  }\n\n  async function handleExternalUrlImport(\n    event?: React.FormEvent<HTMLFormElement>\n  ) {\n    event?.preventDefault();\n    const trimmedUrl = externalUrl.trim();\n    if (!trimmedUrl) {\n      addToast(\" URL\");\n      return;\n    }\n    if (!isHttpUrl(trimmedUrl)) {\n      addToast(\" URL\");\n      return;\n    }\n\n    try {\n      if (!userId) {\n        addToast(\"\");\n        return;\n      }\n\n      setIsLoading(true);\n      if (navigator.storage) {\n        await navigator.storage.persist();\n      }\n\n      if (externalType === \"maps\") {\n        const { map, assets } = await createMapFromUrl(trimmedUrl, userId);\n        await addMap(map);\n        await addAssets(assets);\n        const mapState = await getMapState(map.id);\n        if (mapState) {\n          onMapChange(map, mapState);\n        }\n        addToast(\"\");\n      } else {\n        const { token, assets } = await createTokenFromUrl(trimmedUrl, userId);\n        await addToken(token);\n        await addAssets(assets);\n        addToast(\"\");\n      }\n\n      setUrlModalOpen(false);\n      setExternalUrl(\"\");\n    } catch (error) {\n      console.error(\"EXTERNAL_ASSET_IMPORT_FAILED\", error);\n      addToast(\" URL \");\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function handleMaps() {\n    if (droppedImagesRef.current && userId) {\n      setIsLoading(true);\n      try {\n        let maps = [];\n        const compressionQuality = imageCompressionQuality ?? 0.8;\n        for (let file of droppedImagesRef.current) {\n          const { map, assets } = await createMapFromFile(\n            file,\n            userId,\n            compressionQuality\n          );\n          await addMap(map);\n          await addAssets(assets);\n          maps.push(map);\n        }\n\n        if (maps.length === 1) {\n          const mapState = await getMapState(maps[0].id);\n          if (mapState) {\n            onMapChange(maps[0], mapState);\n          }\n        }\n      } catch (error) {\n        console.error(\"MAP_IMPORT_FAILED\", error);\n        addToast(\"\");\n      } finally {\n        setIsLoading(false);\n        droppedImagesRef.current = undefined;\n      }\n    }\n  }\n\n  async function handleTokens() {\n    if (droppedImagesRef.current && userId) {\n      setIsLoading(true);\n      try {\n        let tokens = [];\n        const compressionQuality = imageCompressionQuality ?? 0.8;\n        for (let file of droppedImagesRef.current) {\n          const { token, assets } = await createTokenFromFile(\n            file,\n            userId,\n            compressionQuality\n          );\n          await addToken(token);\n          await addAssets(assets);\n          tokens.push(token);\n        }\n\n        const dropPosition = dropPositionRef.current;\n        const mapStage = mapStageRef.current;\n        if (mapStage && dropPosition) {\n          const mapPosition = clientPositionToMapPosition(mapStage, dropPosition);\n          if (mapPosition) {\n            let tokenStates = [];\n            let offset = new Vector2(0, 0);\n            for (let token of tokens) {\n              if (!token) {\n                continue;\n              }\n              tokenStates.push(\n                createTokenState(\n                  token,\n                  Vector2.add(mapPosition, offset),\n                  userId,\n                  { autoEnableVision: autoVisionOnDrop }\n                )\n              );\n              offset = Vector2.add(offset, 0.01);\n            }\n            if (tokenStates.length > 0) {\n              onMapTokensStateCreate(tokenStates);\n            }\n          }\n        }\n      } catch (error) {\n        console.error(\"TOKEN_IMPORT_FAILED\", error);\n        addToast(\"\");\n      } finally {\n        setIsLoading(false);\n        droppedImagesRef.current = undefined;\n      }\n    }\n  }\n\n  function handleMapsOver() {\n    setDroppingType(\"maps\");\n  }\n\n  function handleTokensOver() {\n    setDroppingType(\"tokens\");\n  }\n\n  const { dragging, containerListeners, overlayListeners } =\n    useImageDrop(handleDrop);\n\n  return (\n    <ImageImportProvider\n      openImportFromUrl={() => openImportFromUrl(droppingType)}\n    >\n      <Flex\n        sx={{ height: \"100%\", flexGrow: 1, position: \"relative\" }}\n        {...containerListeners}\n      >\n        {children}\n        {dragging && (\n          <Flex\n            sx={{\n              position: \"absolute\",\n              top: 0,\n              right: 0,\n              left: 0,\n              bottom: 0,\n              cursor: \"copy\",\n              flexDirection: \"column\",\n              zIndex: 100,\n            }}\n            {...overlayListeners}\n          >\n            <Flex\n              sx={{\n                height: \"10%\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                color: droppingType === \"maps\" ? \"primary\" : \"text\",\n                opacity: droppingType === \"maps\" ? 1 : 0.8,\n                width: \"100%\",\n                position: \"relative\",\n              }}\n              onDragEnter={handleMapsOver}\n            >\n              <Box\n                bg=\"overlay\"\n                sx={{\n                  position: \"absolute\",\n                  top: 0,\n                  left: 0,\n                  right: 0,\n                  bottom: 0,\n                  margin: \"4px 16px\",\n                  border: \"1px dashed\",\n                  borderRadius: \"12px\",\n                  pointerEvents: \"none\",\n                }}\n              />\n              <Text sx={{ pointerEvents: \"none\", userSelect: \"none\" }}>\n                Drop as map\n              </Text>\n            </Flex>\n            <Flex\n              sx={{\n                flexGrow: 1,\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                color: droppingType === \"tokens\" ? \"primary\" : \"text\",\n                opacity: droppingType === \"tokens\" ? 1 : 0.8,\n                width: \"100%\",\n                position: \"relative\",\n              }}\n              onDragEnter={handleTokensOver}\n            >\n              <Box\n                bg=\"overlay\"\n                sx={{\n                  position: \"absolute\",\n                  top: 0,\n                  left: 0,\n                  right: 0,\n                  bottom: 0,\n                  margin: \"4px 16px\",\n                  border: \"1px dashed\",\n                  borderRadius: \"12px\",\n                  pointerEvents: \"none\",\n                }}\n              />\n              <Text sx={{ pointerEvents: \"none\", userSelect: \"none\" }}>\n                Drop as token\n              </Text>\n            </Flex>\n          </Flex>\n        )}\n        <ConfirmModal\n          isOpen={isLargeImageWarningModalOpen}\n          onRequestClose={handleLargeImageWarningCancel}\n          onConfirm={handleLargeImageWarningConfirm}\n          confirmText=\"Continue\"\n          label=\"Warning\"\n          description=\"An imported image is larger than 20MB, this may cause slowness. Continue?\"\n        />\n        <Modal\n          isOpen={isUrlModalOpen}\n          onRequestClose={handleUrlModalClose}\n          allowClose={!isLoading}\n        >\n          <Box\n            as=\"form\"\n            onSubmit={(event) =>\n              handleExternalUrlImport(\n                event as unknown as React.FormEvent<HTMLFormElement>\n              )\n            }\n            onPaste={handleUrlModalPaste}\n            sx={{\n              width: [\"90vw\", \"420px\"],\n              maxWidth: \"480px\",\n              p: 4,\n            }}\n          >\n            <Text sx={{ mb: 3, fontSize: 2, fontWeight: \"bold\" }}>\n               URL \n            </Text>\n            <Box\n              sx={{\n                border: \"1px dashed\",\n                borderColor: isUrlModalDragActive ? \"primary\" : \"border\",\n                borderRadius: \"8px\",\n                p: 3,\n                mb: 3,\n                textAlign: \"center\",\n                color: isUrlModalDragActive ? \"primary\" : \"text\",\n                backgroundColor: \"muted\",\n                opacity: isUrlModalDragActive ? 1 : 0.85,\n              }}\n              onDragOver={handleUrlModalDragOver}\n              onDragLeave={handleUrlModalDragLeave}\n              onDrop={handleUrlModalDrop}\n            >\n              <Text sx={{ fontSize: 1 }}>\n                \n              </Text>\n            </Box>\n            <Input\n              value={externalUrl}\n              onChange={(event) => setExternalUrl(event.target.value)}\n              placeholder=\"https://example.com/image.png\"\n              sx={{ mb: 3 }}\n              disabled={isLoading}\n              required\n            />\n            <Flex sx={{ gap: 2, mb: 3 }}>\n              <Button\n                type=\"button\"\n                variant={externalType === \"maps\" ? \"primary\" : \"secondary\"}\n                onClick={() => setExternalType(\"maps\")}\n                disabled={isLoading}\n              >\n                \n              </Button>\n              <Button\n                type=\"button\"\n                variant={externalType === \"tokens\" ? \"primary\" : \"secondary\"}\n                onClick={() => setExternalType(\"tokens\")}\n                disabled={isLoading}\n              >\n                \n              </Button>\n            </Flex>\n            <Flex sx={{ justifyContent: \"flex-end\", gap: 2 }}>\n              <Button\n                type=\"button\"\n                variant=\"secondary\"\n                onClick={handleUrlModalClose}\n                disabled={isLoading}\n              >\n                \n              </Button>\n              <Button type=\"submit\" disabled={isLoading || !externalUrl.trim()}>\n                \n              </Button>\n            </Flex>\n          </Box>\n        </Modal>\n        {isLoading && <LoadingOverlay bg=\"overlay\" />}\n      </Flex>\n    </ImageImportProvider>\n  );\n}\n\nexport default GlobalImageDrop;\n","import { useState, useEffect, useRef } from \"react\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport { useMapData } from \"../contexts/MapDataContext\";\nimport { useMapLoading } from \"../contexts/MapLoadingContext\";\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\nimport { useParty } from \"../contexts/PartyContext\";\nimport { useAssets } from \"../contexts/AssetsContext\";\n\nimport useDebounce from \"../hooks/useDebounce\";\nimport useNetworkedState from \"../hooks/useNetworkedState\";\nimport useMapActions from \"../hooks/useMapActions\";\nimport useTokenAttributesSync, {\n  TokenAttributeUpdateInput,\n} from \"../hooks/useTokenAttributes\";\n\nimport Session, { PeerDataEvent, PeerDataProgressEvent } from \"./Session\";\nimport useAssetTransfer from \"./useAssetTransfer\";\n\nimport Action from \"../actions/Action\";\n\nimport Map from \"../components/map/Map\";\nimport TokenBar from \"../components/token/TokenBar\";\n\nimport GlobalImageDrop from \"../components/image/GlobalImageDrop\";\n\nimport { Map as MapType } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport {\n  Asset,\n  AssetManifest,\n  AssetManifestAsset,\n  AssetManifestAssets,\n} from \"../types/Asset\";\nimport { TokenState } from \"../types/TokenState\";\nimport { DrawingState } from \"../types/Drawing\";\nimport { SpellTemplateState } from \"../types/SpellTemplate\";\nimport { Note } from \"../types/Note\";\nimport { TokenNote } from \"../types/TokenNote\";\nimport { WallState } from \"../types/Wall\";\nimport { MapStateSettingsChangeEventHandler } from \"../types/Events\";\nimport {\n  AddStatesAction,\n  EditStatesAction,\n  RemoveStatesAction,\n} from \"../actions\";\n\nfunction normalizeMapState(state: MapState | null): MapState | null {\n  if (!state) {\n    return state;\n  }\n  if (!state.walls) {\n    state.walls = {};\n  }\n  if (Array.isArray(state.explored)) {\n    return state;\n  }\n  return { ...state, explored: [] };\n}\n\n/**\n * @typedef {object} NetworkedMapProps\n * @property {Session} session\n */\n\n/**\n * @param {NetworkedMapProps} props\n */\nfunction NetworkedMapAndTokens({\n  session,\n  gameId,\n}: {\n  session: Session;\n  gameId: string;\n}) {\n  const { addToast } = useToasts();\n  const userId = useUserId();\n  const partyState = useParty();\n  const { assetLoadStart, assetProgressUpdate, isLoading } = useMapLoading();\n\n  const { updateMapState } = useMapData();\n  const { getAsset, putAsset } = useAssets();\n\n  const [currentMap, setCurrentMap] = useState<MapType | null>(null);\n  const [currentMapState, setCurrentMapState] =\n    useNetworkedState<MapState | null>(\n      null,\n      session,\n      \"map_state\",\n      500,\n      true,\n      \"mapId\",\n      normalizeMapState\n    );\n  const [assetManifest, setAssetManifest] =\n    useNetworkedState<AssetManifest | null>(\n      null,\n      session,\n      \"manifest\",\n      500,\n      true,\n      \"mapId\"\n    );\n\n  async function loadAssetManifestFromMap(map: MapType, mapState: MapState) {\n    const assets: AssetManifestAssets = {};\n    const { owner } = map;\n    let processedTokens = new Set();\n    for (let tokenState of Object.values(mapState.tokens)) {\n      if (tokenState.type === \"file\" && !processedTokens.has(tokenState.file)) {\n        processedTokens.add(tokenState.file);\n        assets[tokenState.file] = {\n          id: tokenState.file,\n          owner: tokenState.owner,\n        };\n      }\n    }\n    if (map.type === \"file\") {\n      assets[map.thumbnail] = { id: map.thumbnail, owner };\n      if (map.quality !== \"original\") {\n        const qualityId = map.resolutions[map.quality];\n        if (qualityId) {\n          assets[qualityId] = { id: qualityId, owner };\n        }\n      } else {\n        assets[map.file] = { id: map.file, owner };\n      }\n    }\n    setAssetManifest({ mapId: map.id, assets }, true, true);\n  }\n\n  function addAssetsIfNeeded(assets: AssetManifestAsset[]) {\n    setAssetManifest((prevManifest) => {\n      if (prevManifest?.assets) {\n        let newAssets = { ...prevManifest.assets };\n        for (let asset of assets) {\n          const id = asset.id;\n          const exists = id in newAssets;\n          if (!exists) {\n            newAssets[id] = asset;\n          }\n        }\n        return { ...prevManifest, assets: newAssets };\n      }\n      return prevManifest;\n    });\n  }\n\n  const { assetApiBase, uploadAsset, downloadAsset } = useAssetTransfer(gameId);\n\n  // Keep track of assets we are already requesting to prevent from loading them multiple times\n  const requestingAssetsRef = useRef(new Set());\n  const pendingAssetTimeoutsRef = useRef<Record<string, ReturnType<typeof setTimeout>>>(\n    {}\n  );\n  const assetDownloadFailuresRef = useRef<Record<string, number>>({});\n\n  useEffect(() => {\n    if (!assetManifest || !userId) {\n      return;\n    }\n\n    async function requestAssetsIfNeeded() {\n      if (!assetManifest) {\n        return;\n      }\n      for (let asset of Object.values(assetManifest.assets)) {\n        if (\n          asset.owner === userId ||\n          requestingAssetsRef.current.has(asset.id)\n        ) {\n          continue;\n        }\n\n        const ownerEntry = Object.entries(partyState).find(([, player]) => {\n          return player.userId === asset.owner;\n        });\n\n        const ownerSessionId = ownerEntry?.[0];\n        const ownerState = ownerEntry?.[1];\n\n        // Ensure requests are added before any async operation to prevent duplicate sends\n        requestingAssetsRef.current.add(asset.id);\n\n        const cachedAsset = await getAsset(asset.id);\n        if (!ownerState || !ownerSessionId) {\n          // Add no owner toast if we don't have asset in our cache\n          if (!cachedAsset) {\n            // TODO: Stop toast from appearing multiple times\n            addToast(\"Unable to find owner for asset\");\n          }\n          requestingAssetsRef.current.delete(asset.id);\n          continue;\n        }\n\n        const targetSessionId = ownerState.sessionId || ownerSessionId;\n\n        if (cachedAsset) {\n          requestingAssetsRef.current.delete(asset.id);\n        } else if (targetSessionId) {\n          assetLoadStart(asset.id);\n          const sentViaP2P = await session.sendAssetTo(\n            targetSessionId,\n            \"assetRequest\",\n            {\n              id: asset.id,\n              gameId,\n            },\n            undefined,\n            { allowRelayFallback: false }\n          );\n          if (!sentViaP2P) {\n            if (!assetApiBase) {\n              addToast(\"\");\n              requestingAssetsRef.current.delete(asset.id);\n              assetProgressUpdate({ id: asset.id, total: 1, count: 1 });\n              continue;\n            }\n            void session.sendAssetTo(\n              targetSessionId,\n              \"assetP2pFailed\",\n              {\n                id: asset.id,\n                gameId,\n              },\n              asset.id,\n              { allowRelayFallback: true }\n            );\n            continue;\n          }\n          const existingTimeout = pendingAssetTimeoutsRef.current[asset.id];\n          if (existingTimeout) {\n            clearTimeout(existingTimeout);\n          }\n          pendingAssetTimeoutsRef.current[asset.id] = setTimeout(() => {\n            if (!requestingAssetsRef.current.has(asset.id)) {\n              return;\n            }\n            if (!assetApiBase) {\n              addToast(\"\");\n              requestingAssetsRef.current.delete(asset.id);\n              assetProgressUpdate({ id: asset.id, total: 1, count: 1 });\n              return;\n            }\n            void session.sendAssetTo(\n              targetSessionId,\n              \"assetP2pFailed\",\n              {\n                id: asset.id,\n                gameId,\n              },\n              asset.id,\n              { allowRelayFallback: true }\n            );\n          }, 8000);\n        } else {\n          // \n          requestingAssetsRef.current.delete(asset.id);\n        }\n      }\n    }\n\n    requestAssetsIfNeeded();\n  }, [\n    assetManifest,\n    partyState,\n    session,\n    userId,\n    addToast,\n    getAsset,\n    assetLoadStart,\n    assetProgressUpdate,\n    assetApiBase,\n    gameId,\n  ]);\n\n  /**\n   * Map state\n   */\n\n  const { database } = useDatabase();\n  // Sync the map state to the database after 500ms of inactivity\n  const debouncedMapState = useDebounce(currentMapState, 500);\n  useEffect(() => {\n    if (\n      debouncedMapState &&\n      debouncedMapState.mapId &&\n      currentMap &&\n      currentMap?.owner === userId &&\n      database\n    ) {\n      updateMapState(debouncedMapState.mapId, debouncedMapState);\n    }\n  }, [currentMap, debouncedMapState, userId, database, updateMapState]);\n\n  async function handleMapChange(\n    newMap: MapType | null,\n    newMapState: MapState | null\n  ) {\n    // Clear map before sending new one\n    setCurrentMap(null);\n    session.socket?.emit(\"map\", null);\n\n    setCurrentMapState(newMapState, true, true);\n    setCurrentMap(newMap);\n\n    session.socket?.emit(\"map\", newMap);\n\n    if (!newMap || !newMapState) {\n      setAssetManifest(null, true, true);\n      return;\n    }\n\n    await loadAssetManifestFromMap(newMap, newMapState);\n  }\n\n  const [mapActions, addActions, updateActionIndex, resetActions] =\n    useMapActions(setCurrentMapState);\n\n  const { sendTokenAttributesUpdate, sendTokenAttributesBulk } =\n    useTokenAttributesSync(session, currentMapState, setCurrentMapState);\n\n  function handleMapReset(newMapState: MapState) {\n    setCurrentMapState(newMapState, true, true);\n    resetActions();\n  }\n\n  function handleMapDraw(action: Action<DrawingState>) {\n    addActions([{ type: \"drawings\", action }]);\n  }\n\n  function handleWallDraw(action: Action<WallState>) {\n    addActions([{ type: \"walls\", action }]);\n  }\n\n  function handleTemplateDraw(action: Action<SpellTemplateState>) {\n    addActions([{ type: \"templates\", action }]);\n  }\n\n  const handleMapStateChange: MapStateSettingsChangeEventHandler = (change) => {\n    if (\n      currentMapState &&\n      Array.isArray(change.explored) &&\n      change.explored.length === 0\n    ) {\n      setCurrentMapState(\n        (prevState) => {\n          if (!prevState) {\n            return prevState;\n          }\n          return { ...prevState, ...change };\n        },\n        false,\n        false,\n        true\n      );\n      session.socket?.emit(\"explored_reset\", { mapId: currentMapState.mapId });\n      return;\n    }\n    setCurrentMapState((prevState) => {\n      if (!prevState) {\n        return prevState;\n      }\n      return { ...prevState, ...change };\n    });\n  };\n\n  function handleUndo() {\n    updateActionIndex(-1);\n  }\n\n  function handleRedo() {\n    updateActionIndex(1);\n  }\n\n  // If map changes clear map actions\n  const previousMapIdRef = useRef<string>();\n  useEffect(() => {\n    if (currentMap && currentMap?.id !== previousMapIdRef.current) {\n      resetActions();\n      previousMapIdRef.current = currentMap?.id;\n    }\n  }, [currentMap, resetActions]);\n\n  function handleNoteCreate(notes: Note[]) {\n    const action = new AddStatesAction(notes);\n    addActions([{ type: \"notes\", action }]);\n  }\n\n  function handleNoteChange(changes: Record<string, Partial<Note>>) {\n    let edits: Partial<Note>[] = [];\n    for (let id in changes) {\n      edits.push({ ...changes[id], id });\n    }\n    const action = new EditStatesAction(edits);\n    addActions([{ type: \"notes\", action }]);\n  }\n\n  function handleNoteRemove(noteIds: string[]) {\n    const action = new RemoveStatesAction<Note>(noteIds);\n    addActions([{ type: \"notes\", action }]);\n  }\n\n  function handleTokenNoteCreate(notes: TokenNote[]) {\n    setCurrentMapState((prevState) => {\n      if (!prevState) {\n        return prevState;\n      }\n      const nextTokenNotes = { ...(prevState.tokenNotes || {}) };\n      for (const note of notes) {\n        nextTokenNotes[note.id] = note;\n      }\n      return { ...prevState, tokenNotes: nextTokenNotes };\n    }, true);\n  }\n\n  function handleTokenNoteChange(changes: Record<string, Partial<TokenNote>>) {\n    setCurrentMapState((prevState) => {\n      if (!prevState) {\n        return prevState;\n      }\n      const nextTokenNotes = { ...(prevState.tokenNotes || {}) };\n      for (const id of Object.keys(changes)) {\n        const existing = nextTokenNotes[id];\n        if (existing) {\n          nextTokenNotes[id] = { ...existing, ...changes[id], id };\n        }\n      }\n      return { ...prevState, tokenNotes: nextTokenNotes };\n    }, true);\n  }\n\n  function handleTokenNoteRemove(noteIds: string[]) {\n    setCurrentMapState((prevState) => {\n      if (!prevState) {\n        return prevState;\n      }\n      const nextTokenNotes = { ...(prevState.tokenNotes || {}) };\n      for (const id of noteIds) {\n        delete nextTokenNotes[id];\n      }\n      return { ...prevState, tokenNotes: nextTokenNotes };\n    }, true);\n  }\n\n  /**\n   * Token state\n   */\n\n  async function handleMapTokensStateCreate(tokenStates: TokenState[]) {\n    if (!currentMap || !currentMapState) {\n      return;\n    }\n\n    let assets: AssetManifestAsset[] = [];\n    for (let tokenState of tokenStates) {\n      if (tokenState.type === \"file\") {\n        assets.push({ id: tokenState.file, owner: tokenState.owner });\n      }\n    }\n    if (assets.length > 0) {\n      addAssetsIfNeeded(assets);\n    }\n\n    const action = new AddStatesAction(tokenStates);\n    addActions([{ type: \"tokens\", action }]);\n  }\n\n  function isTokenPositionOnly(\n    changes: Record<string, Partial<TokenState>>\n  ): boolean {\n    const allowedKeys = new Set([\"x\", \"y\", \"lastModified\", \"lastModifiedBy\"]);\n    return Object.values(changes).every((change) =>\n      Object.keys(change).every((key) => allowedKeys.has(key))\n    );\n  }\n\n  function buildAttributeUpdate(\n    tokenStateId: string,\n    nextAttributes: TokenState[\"attributes\"],\n    now: number\n  ) {\n    if (!currentMapState || !nextAttributes) {\n      return null;\n    }\n    const currentAttributes =\n      currentMapState.tokens[tokenStateId]?.attributes ?? null;\n    const baseBars = Array.isArray(nextAttributes.bars)\n      ? nextAttributes.bars\n      : currentAttributes?.bars ?? [];\n    const baseValues = Array.isArray(nextAttributes.values)\n      ? nextAttributes.values\n      : currentAttributes?.values ?? [];\n    const currentVersion = currentAttributes?.version ?? 0;\n    const requestedVersion =\n      typeof nextAttributes.version === \"number\"\n        ? nextAttributes.version\n        : currentVersion + 1;\n    const nextVersion =\n      requestedVersion <= currentVersion ? currentVersion + 1 : requestedVersion;\n    const nextUpdatedBy =\n      userId || nextAttributes.updatedBy || currentAttributes?.updatedBy || \"unknown\";\n    const normalizedAttributes = {\n      ...nextAttributes,\n      bars: baseBars,\n      values: baseValues,\n      version: nextVersion,\n      updatedAt: now,\n      updatedBy: nextUpdatedBy,\n    };\n    const updateInput: TokenAttributeUpdateInput = {\n      tokenStateId,\n      version: normalizedAttributes.version,\n      updatedAt: normalizedAttributes.updatedAt,\n      updatedBy: normalizedAttributes.updatedBy,\n      patch: { attributes: normalizedAttributes },\n    };\n    return { normalizedAttributes, updateInput };\n  }\n\n  function handleMapTokenStateChange(\n    changes: Record<string, Partial<TokenState>>\n  ) {\n    const now = Date.now();\n    const normalizedChanges: Record<string, Partial<TokenState>> = {};\n    const attributeUpdates: TokenAttributeUpdateInput[] = [];\n    for (let id in changes) {\n      const change = changes[id];\n      let nextChange = { ...change };\n      if (change.attributes) {\n        const result = buildAttributeUpdate(id, change.attributes, now);\n        if (result) {\n          nextChange = {\n            ...nextChange,\n            attributes: result.normalizedAttributes,\n          };\n          attributeUpdates.push(result.updateInput);\n        }\n      }\n      normalizedChanges[id] = nextChange;\n    }\n\n    let edits: Partial<TokenState>[] = [];\n    for (let id in normalizedChanges) {\n      edits.push({ ...normalizedChanges[id], id });\n    }\n    const action = new EditStatesAction(edits);\n    if (currentMapState && isTokenPositionOnly(normalizedChanges)) {\n      addActions([{ type: \"tokens\", action }], false, true);\n      session.socket?.emit(\"token_positions\", {\n        mapId: currentMapState.mapId,\n        changes: normalizedChanges,\n      });\n      return;\n    }\n    addActions([{ type: \"tokens\", action }]);\n\n    if (attributeUpdates.length === 1) {\n      sendTokenAttributesUpdate(attributeUpdates[0]);\n    } else if (attributeUpdates.length > 1) {\n      sendTokenAttributesBulk({ updates: attributeUpdates });\n    }\n  }\n\n  function handleMapTokenStateRemove(tokenStateIds: string[]) {\n    const action = new RemoveStatesAction<TokenState>(tokenStateIds);\n    addActions([{ type: \"tokens\", action }]);\n  }\n\n  function handleSelectionItemsChange(\n    tokenChanges: Record<string, Partial<TokenState>>,\n    noteChanges: Record<string, Partial<Note>>\n  ) {\n    const now = Date.now();\n    const normalizedTokenChanges: Record<string, Partial<TokenState>> = {};\n    const attributeUpdates: TokenAttributeUpdateInput[] = [];\n    for (let id in tokenChanges) {\n      const change = tokenChanges[id];\n      let nextChange = { ...change };\n      if (change.attributes) {\n        const result = buildAttributeUpdate(id, change.attributes, now);\n        if (result) {\n          nextChange = {\n            ...nextChange,\n            attributes: result.normalizedAttributes,\n          };\n          attributeUpdates.push(result.updateInput);\n        }\n      }\n      normalizedTokenChanges[id] = nextChange;\n    }\n\n    let tokenEdits: Partial<TokenState>[] = [];\n    for (let id in normalizedTokenChanges) {\n      tokenEdits.push({ ...normalizedTokenChanges[id], id });\n    }\n    const tokenAction = new EditStatesAction(tokenEdits);\n\n    let noteEdits: Partial<Note>[] = [];\n    for (let id in noteChanges) {\n      noteEdits.push({ ...noteChanges[id], id });\n    }\n    const noteAction = new EditStatesAction(noteEdits);\n\n    addActions([\n      { type: \"tokens\", action: tokenAction },\n      { type: \"notes\", action: noteAction },\n    ]);\n\n    if (attributeUpdates.length === 1) {\n      sendTokenAttributesUpdate(attributeUpdates[0]);\n    } else if (attributeUpdates.length > 1) {\n      sendTokenAttributesBulk({ updates: attributeUpdates });\n    }\n  }\n\n  function handleSelectionItemsRemove(\n    tokenStateIds: string[],\n    noteIds: string[]\n  ) {\n    const tokenAction = new RemoveStatesAction<TokenState>(tokenStateIds);\n    const noteAction = new RemoveStatesAction<Note>(noteIds);\n    addActions([\n      { type: \"tokens\", action: tokenAction },\n      { type: \"notes\", action: noteAction },\n    ]);\n  }\n\n  function handleSelectionItemsCreate(\n    tokenStates: TokenState[],\n    notes: Note[]\n  ) {\n    const tokenAction = new AddStatesAction(tokenStates);\n    const noteAction = new AddStatesAction(notes);\n    addActions([\n      { type: \"tokens\", action: tokenAction },\n      { type: \"notes\", action: noteAction },\n    ]);\n  }\n\n  useEffect(() => {\n    async function handlePeerData({ peer, id, data }: PeerDataEvent) {\n      const peerId = peer?.id;\n      if (id === \"assetRequest\") {\n        const requestedGameId =\n          typeof data?.gameId === \"string\" ? data.gameId : gameId;\n        if (requestedGameId !== gameId) {\n          if (typeof data?.id === \"string\") {\n            if (peerId) {\n              await session.sendAssetTo(\n                peerId,\n                \"assetResponseFail\",\n                data.id,\n                data.id,\n                { allowRelayFallback: true }\n              );\n            }\n          }\n          return;\n        }\n\n        const asset = await getAsset(data.id);\n        if (!asset) {\n          if (peerId) {\n            await session.sendAssetTo(\n              peerId,\n              \"assetResponseFail\",\n              data?.id,\n              data?.id,\n              { allowRelayFallback: true }\n            );\n          }\n          return;\n        }\n\n        if (peerId) {\n          const sentViaP2P = await session.sendAssetTo(\n            peerId,\n            \"assetResponseSuccess\",\n            asset,\n            asset.id,\n            { allowRelayFallback: false }\n          );\n          if (sentViaP2P) {\n            return;\n          }\n        }\n        return;\n      }\n\n      if (id === \"assetP2pFailed\") {\n        if (!peerId) {\n          return;\n        }\n        const requestedGameId =\n          typeof data?.gameId === \"string\" ? data.gameId : gameId;\n        if (requestedGameId !== gameId) {\n          return;\n        }\n        const asset = await getAsset(data.id);\n        if (!asset) {\n          await session.sendAssetTo(\n            peerId,\n            \"assetResponseFail\",\n            data?.id,\n            data?.id,\n            { allowRelayFallback: true }\n          );\n          return;\n        }\n        if (data?.reason === \"download_failed\") {\n          await session.sendAssetTo(\n            peerId,\n            \"assetResponseSuccess\",\n            asset,\n            asset.id,\n            { allowRelayFallback: true }\n          );\n          return;\n        }\n\n        let remoteUrl = asset.remoteUrl;\n        if (!remoteUrl) {\n          try {\n            const response = await uploadAsset(asset);\n            remoteUrl = response.url;\n            await putAsset({\n              ...asset,\n              remoteUrl,\n              size: response.size ?? asset.size,\n              originalName: response.originalName ?? asset.originalName,\n              source: asset.source ?? \"uploaded\",\n            });\n          } catch (error) {\n            console.error(\"ASSET_UPLOAD_ON_DEMAND_FAILED\", error);\n            await session.sendAssetTo(\n              peerId,\n              \"assetResponseSuccess\",\n              asset,\n              asset.id,\n              { allowRelayFallback: true }\n            );\n            return;\n          }\n        }\n\n        await session.sendAssetTo(\n          peerId,\n          \"assetResponseUrl\",\n          {\n            id: asset.id,\n            url: remoteUrl,\n            mime: asset.mime,\n            width: asset.width,\n            height: asset.height,\n            owner: asset.owner,\n            size: asset.size,\n            originalName: asset.originalName,\n          },\n          asset.id,\n          { allowRelayFallback: true }\n        );\n        return;\n      }\n\n      if (id === \"assetResponseUrl\") {\n        const assetId = data?.id;\n        const url = data?.url;\n        if (typeof assetId !== \"string\" || typeof url !== \"string\") {\n          return;\n        }\n\n        try {\n          const buffer = await downloadAsset(url);\n          const assetFromServer: Asset = {\n            id: assetId,\n            owner: data?.owner ?? \"unknown\",\n            mime: data?.mime ?? \"application/octet-stream\",\n            width: data?.width ?? 0,\n            height: data?.height ?? 0,\n            file: buffer,\n            remoteUrl: url,\n            size: data?.size,\n            originalName: data?.originalName,\n            source: \"uploaded\",\n          };\n          await putAsset(assetFromServer);\n          delete assetDownloadFailuresRef.current[assetId];\n          assetProgressUpdate({ id: assetId, total: 1, count: 1 });\n        } catch (error) {\n          const status = (error as Error & { status?: number })?.status;\n          const isNetworkError =\n            status === undefined &&\n            error instanceof Error &&\n            error.message === \"Failed to fetch\";\n          const isMissing =\n            status === 404 ||\n            (error instanceof Error &&\n              error.message === \"asset_download_failed_404\");\n          if ((isMissing || isNetworkError) && peerId) {\n            const previousFailures = assetDownloadFailuresRef.current[assetId] ?? 0;\n            const failureCount = previousFailures + 1;\n            assetDownloadFailuresRef.current[assetId] = failureCount;\n            const forceRelay = failureCount >= 2 || isNetworkError;\n            await session.sendAssetTo(\n              peerId,\n              \"assetP2pFailed\",\n              {\n                id: assetId,\n                gameId,\n                reason: forceRelay ? \"download_failed\" : \"not_found\",\n              },\n              assetId,\n              { allowRelayFallback: true }\n            );\n          } else {\n            console.error(\"ASSET_DOWNLOAD_FAILED\", error);\n            addToast(\"\");\n          }\n        } finally {\n          requestingAssetsRef.current.delete(assetId);\n          const pendingTimeout = pendingAssetTimeoutsRef.current[assetId];\n          if (pendingTimeout) {\n            clearTimeout(pendingTimeout);\n            delete pendingAssetTimeoutsRef.current[assetId];\n          }\n        }\n        return;\n      }\n\n      if (id === \"assetResponseSuccess\") {\n        const asset = data;\n        await putAsset(asset);\n        delete assetDownloadFailuresRef.current[asset.id];\n        requestingAssetsRef.current.delete(asset.id);\n        const pendingTimeout = pendingAssetTimeoutsRef.current[asset.id];\n        if (pendingTimeout) {\n          clearTimeout(pendingTimeout);\n          delete pendingAssetTimeoutsRef.current[asset.id];\n        }\n        return;\n      }\n\n      if (id === \"assetResponseFail\") {\n        const assetId = data;\n        delete assetDownloadFailuresRef.current[assetId];\n        requestingAssetsRef.current.delete(assetId);\n        assetProgressUpdate({ id: assetId, total: 1, count: 1 });\n        addToast(\"\");\n        const pendingTimeout = pendingAssetTimeoutsRef.current[assetId];\n        if (pendingTimeout) {\n          clearTimeout(pendingTimeout);\n          delete pendingAssetTimeoutsRef.current[assetId];\n        }\n      }\n    }\n\n    function handlePeerDataProgress({\n      id,\n      total,\n      count,\n    }: PeerDataProgressEvent) {\n      assetProgressUpdate({ id, total, count });\n    }\n\n    async function handleSocketMap(map?: MapType) {\n      if (map) {\n        setCurrentMap(map);\n      } else {\n        setCurrentMap(null);\n      }\n    }\n\n    function handleTokenPositions(update: {\n      mapId?: string;\n      changes?: Record<string, Partial<TokenState>>;\n    }) {\n      if (!update || !update.changes) {\n        return;\n      }\n      setCurrentMapState(\n        (prevState) => {\n          if (!prevState || !update.mapId || prevState.mapId !== update.mapId) {\n            return prevState;\n          }\n          const nextTokens = { ...prevState.tokens };\n          const changes = update.changes ?? {};\n          for (const [id, change] of Object.entries(changes)) {\n            const existing = nextTokens[id];\n            if (!existing) {\n              continue;\n            }\n            if (existing.type === \"file\") {\n              nextTokens[id] = {\n                ...existing,\n                ...change,\n                type: \"file\",\n              };\n            } else {\n              nextTokens[id] = {\n                ...existing,\n                ...change,\n                type: \"default\",\n              };\n            }\n          }\n          return { ...prevState, tokens: nextTokens };\n        },\n        false,\n        false,\n        true\n      );\n    }\n\n    function handleExploredReset(update: { mapId?: string }) {\n      if (!update?.mapId) {\n        return;\n      }\n      setCurrentMapState(\n        (prevState) => {\n          if (!prevState || prevState.mapId !== update.mapId) {\n            return prevState;\n          }\n          return { ...prevState, explored: [] };\n        },\n        false,\n        false,\n        true\n      );\n    }\n\n    session.on(\"peerData\", handlePeerData);\n    session.on(\"peerDataProgress\", handlePeerDataProgress);\n    session.socket?.on(\"map\", handleSocketMap);\n    session.socket?.on(\"token_positions\", handleTokenPositions);\n    session.socket?.on(\"explored_reset\", handleExploredReset);\n\n    return () => {\n      session.off(\"peerData\", handlePeerData);\n      session.off(\"peerDataProgress\", handlePeerDataProgress);\n      session.socket?.off(\"map\", handleSocketMap);\n      session.socket?.off(\"token_positions\", handleTokenPositions);\n      session.socket?.off(\"explored_reset\", handleExploredReset);\n    };\n  });\n\n  const canChangeMap = !isLoading;\n\n  return (\n    <GlobalImageDrop\n      onMapChange={handleMapChange}\n      onMapTokensStateCreate={handleMapTokensStateCreate}\n    >\n      <Map\n        map={currentMap}\n        mapState={currentMapState}\n        mapActions={mapActions}\n        onMapTokenStateChange={handleMapTokenStateChange}\n        onMapTokenStateRemove={handleMapTokenStateRemove}\n        onMapTokensStateCreate={handleMapTokensStateCreate}\n        onSelectionItemsChange={handleSelectionItemsChange}\n        onSelectionItemsRemove={handleSelectionItemsRemove}\n        onSelectionItemsCreate={handleSelectionItemsCreate}\n        onMapChange={handleMapChange}\n        onMapReset={handleMapReset}\n        onMapStateChange={handleMapStateChange}\n        onMapDraw={handleMapDraw}\n        onWallDraw={handleWallDraw}\n        onMapTemplateDraw={handleTemplateDraw}\n        onMapNoteCreate={handleNoteCreate}\n        onMapNoteChange={handleNoteChange}\n        onMapNoteRemove={handleNoteRemove}\n        onMapTokenNoteCreate={handleTokenNoteCreate}\n        onMapTokenNoteChange={handleTokenNoteChange}\n        onMapTokenNoteRemove={handleTokenNoteRemove}\n        allowMapChange={canChangeMap}\n        session={session}\n        onUndo={handleUndo}\n        onRedo={handleRedo}\n      />\n      <TokenBar onMapTokensStateCreate={handleMapTokensStateCreate} />\n    </GlobalImageDrop>\n  );\n}\n\nexport default NetworkedMapAndTokens;\n","import { Box, Label, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype AddPartyMemberModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  gameId: string;\n};\n\nfunction AddPartyMemberModal({\n  isOpen,\n  onRequestClose,\n  gameId,\n}: AddPartyMemberModalProps) {\n  return (\n    <Modal isOpen={isOpen} onRequestClose={onRequestClose}>\n      <Box>\n        <Label pt={2} pb={1}>\n          Invite players\n        </Label>\n        <Text as=\"p\" mb={2} variant=\"caption\">\n          Other people can join using the game ID\n        </Text>\n        <Box p={2} bg=\"hsla(230, 20%, 0%, 20%)\">\n          <Text>{gameId}</Text>\n        </Box>\n        <Text as=\"p\" my={2} variant=\"caption\">\n          Or by using this link\n        </Text>\n        <Box p={2} bg=\"hsla(230, 20%, 0%, 20%)\">\n          <Text>{window.location.href}</Text>\n        </Box>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default AddPartyMemberModal;\n","function AddPartyMemberIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V8c0-.55-.45-1-1-1s-1 .45-1 1v2H2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1H6zm9 4c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4z\" />\n    </svg>\n  );\n}\n\nexport default AddPartyMemberIcon;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport AddPartyMemberModal from \"../../modals/AddPartyMemberModal\";\nimport AddPartyMemberIcon from \"../../icons/AddPartyMemberIcon\";\n\nfunction AddPartyMemberButton({ gameId }: { gameId: string }) {\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\n  function openModal() {\n    setIsAddModalOpen(true);\n  }\n  function closeModal() {\n    setIsAddModalOpen(false);\n  }\n\n  return (\n    <>\n      <IconButton\n        m={1}\n        aria-label=\"Add Party Member\"\n        title=\"Add Party Member\"\n        onClick={openModal}\n      >\n        <AddPartyMemberIcon />\n      </IconButton>\n      <AddPartyMemberModal\n        isOpen={isAddModalOpen}\n        onRequestClose={closeModal}\n        gameId={gameId}\n      />\n    </>\n  );\n}\n\nexport default AddPartyMemberButton;\n","function DiceRollsIcon() {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n      <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM7.5 18c-.83 0-1.5-.67-1.5-1.5S6.67 15 7.5 15s1.5.67 1.5 1.5S8.33 18 7.5 18zm0-9C6.67 9 6 8.33 6 7.5S6.67 6 7.5 6 9 6.67 9 7.5 8.33 9 7.5 9zm4.5 4.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5 4.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm0-9c-.83 0-1.5-.67-1.5-1.5S15.67 6 16.5 6s1.5.67 1.5 1.5S17.33 9 16.5 9z\" />\n    </svg>\n  );\n}\n\nexport default DiceRollsIcon;\n","import { Flex, Box, Text } from \"theme-ui\";\nimport { DiceRoll as DiceRollType, DiceType } from \"../../types/Dice\";\n\ntype DiceRollProps = {\n  rolls: DiceRollType[];\n  type: DiceType;\n  children: React.ReactNode;\n};\n\nfunction DiceRoll({ rolls, type, children }: DiceRollProps) {\n  return (\n    <Flex sx={{ flexWrap: \"wrap\" }}>\n      <Box sx={{ transform: \"scale(0.8)\" }}>{children}</Box>\n      {rolls\n        .filter((d) => d.type === type && d.roll !== \"unknown\")\n        .map((dice, index: string | number) => (\n          <Text as=\"p\" my={1} variant=\"caption\" mx={1} key={index}>\n            {dice.roll}\n          </Text>\n        ))}\n    </Flex>\n  );\n}\n\nexport default DiceRoll;\n","import { useState } from \"react\";\nimport { Flex, Text, IconButton } from \"theme-ui\";\n\nimport DiceRollsIcon from \"../../icons/DiceRollsIcon\";\nimport D20Icon from \"../../icons/D20Icon\";\nimport D12Icon from \"../../icons/D12Icon\";\nimport D10Icon from \"../../icons/D10Icon\";\nimport D8Icon from \"../../icons/D8Icon\";\nimport D6Icon from \"../../icons/D6Icon\";\nimport D4Icon from \"../../icons/D4Icon\";\nimport D100Icon from \"../../icons/D100Icon\";\n\nimport DiceRoll from \"./DiceRoll\";\n\nimport { getDiceRollTotal } from \"../../helpers/dice\";\nimport { DiceRoll as DiceRollType, DiceType } from \"../../types/Dice\";\n\nconst diceIcons: { type: DiceType; Icon: React.ElementType }[] = [\n  { type: \"d20\", Icon: D20Icon },\n  { type: \"d12\", Icon: D12Icon },\n  { type: \"d10\", Icon: D10Icon },\n  { type: \"d8\", Icon: D8Icon },\n  { type: \"d6\", Icon: D6Icon },\n  { type: \"d4\", Icon: D4Icon },\n  { type: \"d100\", Icon: D100Icon },\n];\n\ntype DiceRollsProps = {\n  rolls: DiceRollType[];\n};\n\nfunction DiceRolls({ rolls }: DiceRollsProps) {\n  const total = getDiceRollTotal(rolls);\n\n  const [expanded, setExpanded] = useState<boolean>(false);\n\n  let expandedRolls = [];\n  for (let icon of diceIcons) {\n    if (rolls.some((roll) => roll.type === icon.type)) {\n      expandedRolls.push(\n        <DiceRoll rolls={rolls} type={icon.type} key={icon.type}>\n          <icon.Icon />\n        </DiceRoll>\n      );\n    }\n  }\n\n  if (total <= 0) {\n    return null;\n  }\n\n  return (\n    <Flex sx={{ flexDirection: \"column\" }}>\n      <Flex sx={{ alignItems: \"center\" }}>\n        <IconButton\n          title={expanded ? \"Hide Rolls\" : \"Show Rolls\"}\n          aria-label={expanded ? \"Hide Rolls\" : \"Show Rolls\"}\n          onClick={() => setExpanded(!expanded)}\n        >\n          <DiceRollsIcon />\n        </IconButton>\n        <Text px={1} as=\"p\" my={1} variant=\"body2\" sx={{ width: \"100%\" }}>\n          {total}\n        </Text>\n      </Flex>\n      {expanded && (\n        <Flex\n          sx={{\n            flexDirection: \"column\",\n          }}\n        >\n          {expandedRolls}\n        </Flex>\n      )}\n    </Flex>\n  );\n}\n\nexport default DiceRolls;\n","import { Text, Flex } from \"theme-ui\";\n\nimport DiceRolls from \"./DiceRolls\";\nimport { DiceRoll } from \"../../types/Dice\";\n\ntype NicknameProps = {\n  nickname: string;\n  diceRolls?: DiceRoll[];\n};\n\nfunction Nickname({ nickname, diceRolls }: NicknameProps) {\n  return (\n    <Flex sx={{ flexDirection: \"column\" }}>\n      <Text\n        as=\"p\"\n        my={1}\n        variant=\"body2\"\n        sx={{\n          position: \"relative\",\n        }}\n      >\n        {nickname}\n      </Text>\n      {diceRolls && <DiceRolls rolls={diceRolls} />}\n    </Flex>\n  );\n}\n\nexport default Nickname;\n","import { useRef } from \"react\";\nimport { Box, Input, Button, Label, Flex } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype ChangeNicknameModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onChangeSubmit: React.FormEventHandler<HTMLDivElement>;\n  nickname: string;\n  onChange: React.ChangeEventHandler<HTMLInputElement>;\n};\n\nfunction ChangeNicknameModal({\n  isOpen,\n  onRequestClose,\n  onChangeSubmit,\n  nickname,\n  onChange,\n}: ChangeNicknameModalProps) {\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput() {\n    inputRef.current?.focus();\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      onAfterOpen={focusInput}\n    >\n      <Box as=\"form\" onSubmit={onChangeSubmit}>\n        <Label py={2} htmlFor=\"nicknameChange\">\n          Change your nickname\n        </Label>\n        <Input\n          id=\"nicknameChange\"\n          value={nickname}\n          onChange={onChange}\n          ref={inputRef}\n        />\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }} disabled={!nickname}>\n            Change\n          </Button>\n        </Flex>\n      </Box>\n    </Modal>\n  );\n}\n\nexport default ChangeNicknameModal;\n","import { useState, useEffect, ChangeEvent, FormEvent } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport ChangeNicknameModal from \"../../modals/ChangeNicknameModal\";\nimport ChangeNicknameIcon from \"../../icons/ChangeNicknameIcon\";\n\ntype ChangeNicknameButtonProps = {\n  nickname: string;\n  onChange: (nickname: string) => void;\n};\n\nfunction ChangeNicknameButton({\n  nickname,\n  onChange,\n}: ChangeNicknameButtonProps) {\n  const [isChangeModalOpen, setIsChangeModalOpen] = useState(false);\n  function openModal() {\n    setIsChangeModalOpen(true);\n  }\n  function closeModal() {\n    setIsChangeModalOpen(false);\n  }\n\n  const [changedNickname, setChangedNickname] = useState(\"\");\n\n  useEffect(() => {\n    setChangedNickname(nickname);\n  }, [nickname]);\n\n  function handleChangeSubmit(event: FormEvent) {\n    event.preventDefault();\n    onChange(changedNickname);\n    closeModal();\n  }\n\n  function handleChange(event: ChangeEvent<HTMLInputElement>) {\n    setChangedNickname(event.target?.value);\n  }\n  return (\n    <>\n      <IconButton\n        m={1}\n        aria-label=\"Change Nickname\"\n        title=\"Change Nickname\"\n        onClick={openModal}\n      >\n        <ChangeNicknameIcon />\n      </IconButton>\n      <ChangeNicknameModal\n        isOpen={isChangeModalOpen}\n        onRequestClose={closeModal}\n        onChangeSubmit={handleChangeSubmit}\n        onChange={handleChange}\n        nickname={changedNickname}\n      />\n    </>\n  );\n}\n\nexport default ChangeNicknameButton;\n","import React, { useEffect, useState } from \"react\";\nimport { Box, Label, Flex, Button, Text, Checkbox } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport Modal from \"../components/Modal\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\nimport Divider from \"../components/Divider\";\n\nimport { getDatabase } from \"../database\";\n\nimport { Map } from \"../types/Map\";\nimport { Group, GroupContainer } from \"../types/Group\";\nimport { MapState } from \"../types/MapState\";\nimport { Token } from \"../types/Token\";\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\nexport type SelectData = {\n  name: string;\n  id: string;\n  type: \"default\" | \"file\";\n  checked: boolean;\n};\n\nexport type ConfirmDataEventHandler = (\n  checkedMaps: SelectData[],\n  checkedTokens: SelectData[],\n  checkedMapGroups: Group[],\n  checkedTokenGroups: Group[]\n) => void;\n\ntype SelectDataProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onConfirm: ConfirmDataEventHandler;\n  confirmText: string;\n  label: string;\n  databaseName: string;\n  filter: (table: string, data: Map | MapState | Token, id: string) => boolean;\n};\n\ntype DataRecord = Record<string, SelectData>;\n\nfunction SelectDataModal({\n  isOpen,\n  onRequestClose,\n  onConfirm,\n  confirmText,\n  label,\n  databaseName,\n  filter,\n}: SelectDataProps) {\n  const [maps, setMaps] = useState<DataRecord>({});\n  const [mapGroups, setMapGroups] = useState<Group[]>([]);\n  const [tokensByMap, setTokensByMap] = useState<Record<string, Set<string>>>(\n    {}\n  );\n  const [tokens, setTokens] = useState<DataRecord>({});\n  const [tokenGroups, setTokenGroups] = useState<Group[]>([]);\n\n  const [isLoading, setIsLoading] = useState(false);\n  const hasMaps = Object.values(maps).length > 0;\n  const hasTokens = Object.values(tokens).length > 0;\n\n  useEffect(() => {\n    async function loadData() {\n      if (isOpen && databaseName) {\n        setIsLoading(true);\n        const db = getDatabase({ addons: [] }, databaseName);\n        let loadedMaps: DataRecord = {};\n        let loadedTokensByMap: Record<string, Set<string>> = {};\n        let loadedTokens: DataRecord = {};\n        await db\n          .table(\"maps\")\n          .filter((map: Map) => filter(\"maps\", map, map.id))\n          .each((map: Map) => {\n            loadedMaps[map.id] = {\n              name: map.name,\n              id: map.id,\n              type: map.type,\n              checked: true,\n            };\n          });\n        await db\n          .table(\"states\")\n          .filter((state: MapState) => filter(\"states\", state, state.mapId))\n          .each((state: MapState) => {\n            loadedTokensByMap[state.mapId] = new Set(\n              Object.values(state.tokens).map(\n                (tokenState) => tokenState.tokenId\n              )\n            );\n          });\n\n        await db\n          .table(\"tokens\")\n          .filter((token: Token) => filter(\"tokens\", token, token.id))\n          .each((token: Token) => {\n            loadedTokens[token.id] = {\n              name: token.name,\n              id: token.id,\n              type: token.type,\n              checked: true,\n            };\n          });\n\n        const mapGroup = await db.table(\"groups\").get(\"maps\");\n        const tokenGroup = await db.table(\"groups\").get(\"tokens\");\n\n        db.close();\n        setMaps(loadedMaps);\n        setMapGroups(mapGroup.items);\n        setTokensByMap(loadedTokensByMap);\n        setTokenGroups(tokenGroup.items);\n        setTokens(loadedTokens);\n        setIsLoading(false);\n      } else {\n        setMaps({});\n        setTokens({});\n        setTokenGroups([]);\n        setMapGroups([]);\n        setTokensByMap({});\n      }\n    }\n    loadData();\n  }, [isOpen, databaseName, filter]);\n\n  // An object mapping a tokenId to how many checked maps it is currently used in\n  const [tokenUsedCount, setTokenUsedCount] = useState<Record<string, number>>(\n    {}\n  );\n  useEffect(() => {\n    let tokensUsed: Record<string, number> = {};\n    for (let mapId in maps) {\n      if (maps[mapId].checked && mapId in tokensByMap) {\n        for (let tokenId of tokensByMap[mapId]) {\n          if (tokenId in tokensUsed) {\n            tokensUsed[tokenId] += 1;\n          } else {\n            tokensUsed[tokenId] = 1;\n          }\n        }\n      }\n    }\n    setTokenUsedCount(tokensUsed);\n    // Update tokens to ensure used tokens are checked\n    setTokens((prevTokens) => {\n      let newTokens = { ...prevTokens };\n      for (let id in newTokens) {\n        if (id in tokensUsed && newTokens[id].type !== \"default\") {\n          newTokens[id].checked = true;\n        }\n      }\n      return newTokens;\n    });\n  }, [maps, tokensByMap]);\n\n  function getCheckedGroups(groups: Group[], data: DataRecord) {\n    let checkedGroups = [];\n    for (let group of groups) {\n      if (group.type === \"item\") {\n        if (data[group.id] && data[group.id].checked) {\n          checkedGroups.push(group);\n        }\n      } else {\n        let items = [];\n        for (let item of group.items) {\n          if (data[item.id] && data[item.id].checked) {\n            items.push(item);\n          }\n        }\n        if (items.length > 0) {\n          checkedGroups.push({ ...group, items });\n        }\n      }\n    }\n    return checkedGroups;\n  }\n\n  function handleConfirm() {\n    let checkedMaps = Object.values(maps).filter((map) => map.checked);\n    let checkedTokens = Object.values(tokens).filter((token) => token.checked);\n    let checkedMapGroups = getCheckedGroups(mapGroups, maps);\n    let checkedTokenGroups = getCheckedGroups(tokenGroups, tokens);\n\n    onConfirm(checkedMaps, checkedTokens, checkedMapGroups, checkedTokenGroups);\n  }\n\n  function handleMapsChanged(\n    event: React.ChangeEvent<HTMLInputElement>,\n    maps: SelectData[]\n  ) {\n    setMaps((prevMaps) => {\n      let newMaps = { ...prevMaps };\n      for (let map of maps) {\n        newMaps[map.id].checked = event.target.checked;\n      }\n      return newMaps;\n    });\n    // If all token select is unchecked then ensure all tokens are unchecked\n    if (!event.target.checked && !tokensSelectChecked) {\n      setTokens((prevTokens) => {\n        let newTokens = { ...prevTokens };\n        let tempUsedCount = { ...tokenUsedCount };\n        for (let id in newTokens) {\n          for (let map of maps) {\n            if (tokensByMap[map.id].has(id)) {\n              if (tempUsedCount[id] > 1) {\n                tempUsedCount[id] -= 1;\n              } else if (tempUsedCount[id] === 1) {\n                tempUsedCount[id] = 0;\n                newTokens[id].checked = false;\n              }\n            }\n          }\n        }\n        return newTokens;\n      });\n    }\n  }\n\n  function handleTokensChanged(\n    event: React.ChangeEvent<HTMLInputElement>,\n    tokens: SelectData[]\n  ) {\n    setTokens((prevTokens) => {\n      let newTokens = { ...prevTokens };\n      for (let token of tokens) {\n        if (!(token.id in tokenUsedCount) || token.type === \"default\") {\n          newTokens[token.id].checked = event.target.checked;\n        }\n      }\n      return newTokens;\n    });\n  }\n\n  // Some tokens are checked not by maps or all tokens are checked by maps\n  const tokensSelectChecked =\n    Object.values(tokens).some(\n      (token) => !(token.id in tokenUsedCount) && token.checked\n    ) || Object.values(tokens).every((token) => token.id in tokenUsedCount);\n\n  function renderGroupContainer(\n    group: GroupContainer,\n    checked: boolean,\n    renderItem: (group: Group) => React.ReactNode,\n    onGroupChange: (\n      event: React.ChangeEvent<HTMLInputElement>,\n      group: GroupContainer\n    ) => void\n  ) {\n    return (\n      <Flex\n        ml={4}\n        sx={{\n          flexWrap: \"wrap\",\n          borderRadius: \"4px\",\n          flexDirection: \"column\",\n          position: \"relative\",\n        }}\n        key={group.id}\n      >\n        <Label my={1} sx={{ fontFamily: \"body2\" }}>\n          <Checkbox\n            checked={checked}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n              onGroupChange(e, group)\n            }\n          />\n          {group.name}\n        </Label>\n        <Flex\n          sx={{\n            flexWrap: \"wrap\",\n            flexDirection: \"column\",\n            position: \"relative\",\n          }}\n        >\n          {group.items.map(renderItem)}\n          <Box\n            sx={{ position: \"absolute\", left: \"2px\", top: 0, height: \"100%\" }}\n          >\n            <Divider vertical fill />\n          </Box>\n        </Flex>\n      </Flex>\n    );\n  }\n\n  function renderMapGroup(group: Group) {\n    if (group.type === \"item\") {\n      const map = maps[group.id];\n      if (map) {\n        return (\n          <Label key={map.id} my={1} pl={4} sx={{ fontFamily: \"body2\" }}>\n            <Checkbox\n              checked={map.checked}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                handleMapsChanged(e, [map])\n              }\n            />\n            {map.name}\n          </Label>\n        );\n      }\n    } else {\n      if (group.items.some((item) => item.id in maps)) {\n        return renderGroupContainer(\n          group,\n          group.items.some((item) => maps[item.id]?.checked),\n          renderMapGroup,\n          (e, group) =>\n            handleMapsChanged(\n              e,\n              group.items\n                .filter((group) => group.id in maps)\n                .map((group) => maps[group.id])\n            )\n        );\n      }\n    }\n  }\n\n  function renderTokenGroup(group: Group) {\n    if (group.type === \"item\") {\n      const token = tokens[group.id];\n      if (token) {\n        return (\n          <Box pl={4} my={1} key={token.id}>\n            <Label sx={{ fontFamily: \"body2\" }}>\n              <Checkbox\n                checked={token.checked}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                  handleTokensChanged(e, [token])\n                }\n                disabled={\n                  token.type !== \"default\" && token.id in tokenUsedCount\n                }\n              />\n              {token.name}\n            </Label>\n            {token.id in tokenUsedCount && token.type !== \"default\" && (\n              <Text as=\"p\" variant=\"caption\" ml={4}>\n                Token used in {tokenUsedCount[token.id]} selected map\n                {tokenUsedCount[token.id] > 1 && \"s\"}\n              </Text>\n            )}\n          </Box>\n        );\n      }\n    } else {\n      if (group.items.some((item) => item.id in tokens)) {\n        const checked =\n          group.items.some(\n            (item) => !(item.id in tokenUsedCount) && tokens[item.id]?.checked\n          ) || group.items.every((item) => item.id in tokenUsedCount);\n        return renderGroupContainer(\n          group,\n          checked,\n          renderTokenGroup,\n          (e, group) =>\n            handleTokensChanged(\n              e,\n              group.items\n                .filter((group) => group.id in tokens)\n                .map((group) => tokens[group.id])\n            )\n        );\n      }\n    }\n  }\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      style={{ content: { maxWidth: \"450px\", width: \"100%\" } }}\n    >\n      <Box\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          width: \"100%\",\n          flexGrow: 1,\n        }}\n      >\n        <Label py={2}>{label}</Label>\n        {!hasMaps && !hasTokens && (\n          <Text as=\"p\" mb={2} variant=\"caption\">\n            No custom maps or tokens found.\n          </Text>\n        )}\n        <SimpleBar style={{ maxHeight: \"300px\" }}>\n          <Flex\n            p={2}\n            bg=\"muted\"\n            sx={{\n              flexWrap: \"wrap\",\n              borderRadius: \"4px\",\n              flexDirection: \"column\",\n            }}\n          >\n            {hasMaps && (\n              <>\n                <Flex>\n                  <Label>\n                    <Checkbox\n                      checked={Object.values(maps).some((map) => map.checked)}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                        handleMapsChanged(e, Object.values(maps))\n                      }\n                    />\n                    Maps\n                  </Label>\n                </Flex>\n                {mapGroups.map(renderMapGroup)}\n              </>\n            )}\n            {hasMaps && hasTokens && <Divider fill />}\n            {hasTokens && (\n              <>\n                <Label>\n                  <Checkbox\n                    checked={tokensSelectChecked}\n                    onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                      handleTokensChanged(e, Object.values(tokens))\n                    }\n                  />\n                  Tokens\n                </Label>\n                {tokenGroups.map(renderTokenGroup)}\n              </>\n            )}\n          </Flex>\n        </SimpleBar>\n        <Flex py={2}>\n          <Button sx={{ flexGrow: 1 }} m={1} ml={0} onClick={onRequestClose}>\n            Cancel\n          </Button>\n          <Button\n            disabled={\n              !Object.values(maps).some((map) => map.checked) &&\n              !Object.values(tokens).some((token) => token.checked)\n            }\n            sx={{ flexGrow: 1 }}\n            m={1}\n            mr={0}\n            onClick={handleConfirm}\n          >\n            {confirmText}\n          </Button>\n        </Flex>\n        {isLoading && <LoadingOverlay bg=\"overlay\" />}\n      </Box>\n    </Modal>\n  );\n}\n\nSelectDataModal.defaultProps = {\n  label: \"Select data\",\n  confirmText: \"Yes\",\n  filter: () => true,\n  databaseName: \"OwlbearRodeoDB\",\n};\n\nexport default SelectDataModal;\n","import { useRef, useState, useEffect } from \"react\";\nimport { Box, Label, Text, Button, Flex } from \"theme-ui\";\nimport { saveAs } from \"file-saver\";\nimport * as Comlink from \"comlink\";\nimport shortid from \"shortid\";\nimport { v4 as uuid } from \"uuid\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport Modal from \"../components/Modal\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\nimport LoadingBar from \"../components/LoadingBar\";\nimport ErrorBanner from \"../components/banner/ErrorBanner\";\n\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\n\nimport SelectDataModal, { SelectData } from \"./SelectDataModal\";\n\nimport { getDatabase } from \"../database\";\nimport { Map } from \"../types/Map\";\nimport { MapState } from \"../types/MapState\";\nimport { Token } from \"../types/Token\";\nimport { Group } from \"../types/Group\";\nimport { RequestCloseEventHandler } from \"../types/Events\";\nimport { Asset } from \"../types/Asset\";\n\nconst importDBName = \"OwlbearRodeoImportDB\";\n\nclass MissingAssetError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"MissingAssetError\";\n  }\n}\n\nfunction ImportExportModal({\n  isOpen,\n  onRequestClose,\n}: {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n}) {\n  const { worker } = useDatabase();\n  const userId = useUserId();\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<Error>();\n\n  const backgroundTaskRunningRef = useRef(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const [showImportSelector, setShowImportSelector] = useState(false);\n  const [showExportSelector, setShowExportSelector] = useState(false);\n\n  const { addToast } = useToasts();\n  function addSuccessToast(\n    message: string,\n    maps: number,\n    tokens: number\n  ) {\n    const mapText = `${maps} map${maps > 1 ? \"s\" : \"\"}`;\n    const tokenText = `${tokens} token${tokens > 1 ? \"s\" : \"\"}`;\n    if (maps > 0 && tokens > 0) {\n      addToast(`${message} ${mapText} and ${tokenText}`);\n    } else if (maps > 0) {\n      addToast(`${message} ${mapText}`);\n    } else if (tokens > 0) {\n      addToast(`${message} ${tokenText}`);\n    }\n  }\n\n  function addWarningToast(\n    message: string,\n    items: string[],\n  ) {\n    let text = \"\";\n\n    if (items.length > 0) {\n      if (items.length === 1) {\n        text += `${items[0]}`\n      } else {\n        for (let item in items) {\n          text += `${items[item]}, `\n        }\n        text = text.replace(/,\\s*$/, \"\");\n      }\n    }\n    const toastMessage = <span>{message} <b>{text}</b></span>\n    addToast(toastMessage, { appearance: \"warning\", autoDismiss: true });\n  }\n\n  function openFileDialog() {\n    if (fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  }\n\n  const loadingProgressRef = useRef(0);\n\n  function handleDBProgress({\n    completedRows,\n    totalRows,\n  }: {\n    completedRows: number;\n    totalRows: number;\n  }) {\n    loadingProgressRef.current = completedRows / totalRows;\n  }\n\n  async function handleImportDatabase(file: File) {\n    setIsLoading(true);\n    backgroundTaskRunningRef.current = true;\n    try {\n      await worker.importData(\n        file,\n        importDBName,\n        Comlink.proxy(handleDBProgress) as any\n      );\n\n      setIsLoading(false);\n      setShowImportSelector(true);\n      backgroundTaskRunningRef.current = false;\n    } catch (e) {\n      setIsLoading(false);\n      backgroundTaskRunningRef.current = false;\n      if (e instanceof (Error)) {\n        if (e.message.startsWith(\"Max buffer length exceeded\")) {\n          setError(\n            new Error(\n              \"Max image size exceeded ensure your database doesn't have an image over 100MB\"\n            )\n          );\n        } else {\n          console.error(e);\n          setError(e);\n        }\n      }\n    }\n    // Set file input to null to allow adding the same data 2 times in a row\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  }\n\n  function handleExportDatabase() {\n    setShowExportSelector(true);\n  }\n\n  useEffect(() => {\n    function handleBeforeUnload(event: BeforeUnloadEvent) {\n      if (backgroundTaskRunningRef.current) {\n        event.returnValue =\n          \"Database is still processing, are you sure you want to leave?\";\n      }\n    }\n\n    window.addEventListener(\"beforeunload\", handleBeforeUnload);\n    return () => {\n      window.removeEventListener(\"beforeunload\", handleBeforeUnload);\n    };\n  }, []);\n\n  function handleClose() {\n    if (isLoading) {\n      return;\n    }\n    onRequestClose();\n  }\n\n  async function handleImportSelectorClose() {\n    const importDB = getDatabase({ addons: [] }, importDBName);\n    await importDB.delete();\n    importDB.close();\n    setShowImportSelector(false);\n  }\n\n  async function handleImportSelectorConfirm(\n    checkedMaps: SelectData[],\n    checkedTokens: SelectData[],\n    checkedMapGroups: Group[],\n    checkedTokenGroups: Group[]\n  ) {\n    setIsLoading(true);\n    backgroundTaskRunningRef.current = true;\n    setShowImportSelector(false);\n    loadingProgressRef.current = 0;\n\n    const importDB = getDatabase({ addons: [] }, importDBName);\n    const db = getDatabase({});\n    try {\n      // Keep track of a mapping of old token ids to new ones to apply them to the map states\n      let newTokenIds: Record<string, string> = {};\n      // Mapping of old asset ids to new asset ids\n      let newAssetIds: Record<string, string> = {};\n      // Mapping of old asset ids to old maps\n      let oldAssetIds: Record<string, { itemName: string, itemId: string, item: \"map\" | \"token\", assetType: \"file\" | \"thumbnail\" | \"resolution\", newId: string }> = {};\n\n      // Mapping of old maps ids to new map ids\n      let newMapIds: Record<string, string> = {};\n\n      let newTokens: Token[] = [];\n      if (checkedTokens.length > 0) {\n        const tokenIds = checkedTokens.map((token) => token.id);\n        const tokensToAdd: Token[] | undefined = await importDB.table(\"tokens\").bulkGet(tokenIds);\n\n        if (tokensToAdd) {\n          for (let token of tokensToAdd) {\n            if (token) {\n              // Generate new ids\n              const newId = uuid();\n              newTokenIds[token.id] = newId;\n\n              if (token.type === \"default\") {\n                if (userId) {\n                  newTokens.push({ ...token, id: newId, owner: userId });\n                }\n              } else {\n                const newFileId = uuid();\n                const newThumbnailId = uuid();\n                newAssetIds[token.file] = newFileId;\n                newAssetIds[token.thumbnail] = newThumbnailId;\n\n                oldAssetIds[token.file] = { itemName: token.name, itemId: token.id, item: \"token\", assetType: \"file\", newId: newId };\n                oldAssetIds[token.thumbnail] = { itemName: token.name, itemId: token.id, item: \"token\", assetType: \"thumbnail\", newId: newId };\n\n                // Change ids and owner\n                if (userId) {\n                  newTokens.push({\n                    ...token,\n                    id: newId,\n                    owner: userId,\n                    file: newFileId,\n                    thumbnail: newThumbnailId,\n                  });\n                }\n              }\n            }\n          }\n        }\n      }\n\n      let newMaps: Map[] = [];\n      let newStates: MapState[] = [];\n      if (checkedMaps.length > 0) {\n        const mapIds = checkedMaps.map((map) => map.id);\n        const mapsToAdd = await importDB.table(\"maps\").bulkGet(mapIds);\n        if (mapsToAdd) {\n\n          for (let map of mapsToAdd) {\n            if (map) {\n              let state: MapState = await importDB.table(\"states\").get(map.id);\n              if (!state.templates) {\n                state.templates = {};\n              }\n              // Apply new token ids to imported state\n              for (let tokenState of Object.values(state.tokens)) {\n                if (tokenState.tokenId in newTokenIds) {\n                  tokenState.tokenId = newTokenIds[tokenState.tokenId];\n                }\n                // Change token state file asset id\n                if (tokenState.type === \"file\" && tokenState.file in newAssetIds) {\n                  tokenState.file = newAssetIds[tokenState.file];\n                }\n                // Change token state owner if owned by the user of the map\n                if (tokenState.owner === map.owner && userId) {\n                  tokenState.owner = userId;\n                }\n              }\n              // Generate new ids\n              const newId = uuid();\n              newMapIds[map.id] = newId;\n\n              if (map.type === \"default\") {\n                if (userId) {\n                  newMaps.push({ ...map, id: newId, owner: userId });\n                }\n              } else {\n                const newFileId = uuid();\n                const newThumbnailId = uuid();\n                newAssetIds[map.file] = newFileId;\n                newAssetIds[map.thumbnail] = newThumbnailId;\n\n                oldAssetIds[map.file] = { itemName: map.name, itemId: map.id, item: \"map\", assetType: \"file\", newId: newId };\n                oldAssetIds[map.thumbnail] = { itemName: map.name, itemId: map.id, item: \"map\", assetType: \"thumbnail\", newId: newId };\n\n                const newResolutionIds: Record<string, string> = {};\n                for (let res of Object.keys(map.resolutions)) {\n                  newResolutionIds[res] = uuid();\n                  newAssetIds[map.resolutions[res]] = newResolutionIds[res];\n                  oldAssetIds[map.resolutions[res]] = { itemName: map.name, itemId: map.id, item: \"map\", assetType: \"resolution\", newId: newId };\n                }\n\n                if (userId) {\n                  // Change ids and owner\n                  newMaps.push({\n                    ...map,\n                    id: newId,\n                    owner: userId,\n                    file: newFileId,\n                    thumbnail: newThumbnailId,\n                    resolutions: newResolutionIds,\n                  });\n                }\n              }\n\n              newStates.push({ ...state, mapId: newId });\n            }\n          }\n        }\n      }\n\n      // Add assets with new ids\n      const assetsToAdd: Asset[] | undefined = await importDB\n        .table(\"assets\")\n        .bulkGet(Object.keys(newAssetIds));\n      let newAssets: Asset[] = [];\n      const processedAssetIds: string[] = []\n      if (assetsToAdd) {\n        for (let asset of assetsToAdd) {\n          if (asset && userId) {\n            newAssets.push({\n              ...asset,\n              id: newAssetIds[asset.id],\n              owner: userId,\n            });\n            processedAssetIds.push(asset.id)\n          }\n        }\n      }\n\n      // compare items added to newAssetIds against those that were processed\n      const unprocessedAssets = Object.keys(newAssetIds).filter(item => processedAssetIds.indexOf(item) < 0);\n      let unprocessedMaps = 0\n      let unprocessedTokens = 0\n      // check if there are any items that have been unprocessed\n      if (unprocessedAssets.length > 0) {\n        const unprocessedItems: { id: string, name: string }[] = []\n        for (let item of unprocessedAssets) {\n          // get information of unprocessed item from oldAssetIds list\n          let unprocessedItem = oldAssetIds[item]\n\n          // should only remove corrupted asset once (one map can have multiple unprocessed assets)\n          if (!!!(unprocessedItems.some(value => value.id === unprocessedItem.itemId))) {\n            unprocessedItems.push({ id: unprocessedItem.itemId, name: unprocessedItem.itemName })\n            if (unprocessedItem.item === \"map\") {\n              unprocessedMaps += 1\n\n              // remove corrupt map from newMaps list -> otherwise corrupt data will be imported\n              const index = newMaps.findIndex(map => map.id === unprocessedItem.newId)\n              if (index !== -1) {\n                newMaps.splice(index, 1)\n              }\n\n              const stateIndex = newStates.findIndex(state => state.mapId === unprocessedItem.newId)\n              if (stateIndex !== -1) {\n                newStates.splice(stateIndex, 1)\n              }\n            } else if (unprocessedItem.item === \"token\") {\n              unprocessedTokens += 1\n              const index = newTokens.findIndex(token => token.id === unprocessedItem.newId)\n              if (index !== -1) {\n                newTokens.splice(index, 1)\n              }\n            }\n          }\n        }\n\n        const unprocessedItemNames = unprocessedItems.map(item => item.name)\n        addWarningToast(\"Could not import item(s)\", unprocessedItemNames)\n      }\n\n      // Add map groups with new ids\n      let newMapGroups: Group[] = [];\n      if (checkedMapGroups.length > 0) {\n        for (let group of checkedMapGroups) {\n          if (group.type === \"item\") {\n            newMapGroups.push({ ...group, id: newMapIds[group.id] });\n          } else {\n            newMapGroups.push({\n              ...group,\n              id: uuid(),\n              items: group.items.map((item) => ({\n                ...item,\n                id: newMapIds[item.id],\n              })),\n            });\n          }\n        }\n      }\n\n      // Add token groups with new ids\n      let newTokenGroups: Group[] = [];\n      if (checkedTokenGroups.length > 0) {\n        for (let group of checkedTokenGroups) {\n          if (group.type === \"item\") {\n            newTokenGroups.push({ ...group, id: newTokenIds[group.id] });\n          } else {\n            newTokenGroups.push({\n              ...group,\n              id: uuid(),\n              items: group.items.map((item) => ({\n                ...item,\n                id: newTokenIds[item.id],\n              })),\n            });\n          }\n        }\n      }\n\n      db.transaction(\n        \"rw\",\n        [\n          db.table(\"tokens\"),\n          db.table(\"maps\"),\n          db.table(\"states\"),\n          db.table(\"assets\"),\n          db.table(\"groups\"),\n        ],\n        async () => {\n          if (newTokens.length > 0) {\n            await db.table<Token>(\"tokens\").bulkAdd(newTokens);\n          }\n          if (newMaps.length > 0) {\n            await db.table<Map>(\"maps\").bulkAdd(newMaps);\n          }\n          if (newStates.length > 0) {\n            await db.table(\"states\").bulkAdd(newStates);\n          }\n          if (newAssets.length > 0) {\n            await db.table<Asset>(\"assets\").bulkAdd(newAssets);\n          }\n          if (newMapGroups.length > 0) {\n            const mapGroup = await db.table(\"groups\").get(\"maps\");\n            await db\n              .table<Group>(\"groups\")\n              .update(\"maps\", { items: [...newMapGroups, ...mapGroup.items] });\n          }\n          if (newTokenGroups.length > 0) {\n            const tokenGroup = await db.table(\"groups\").get(\"tokens\");\n            await db.table<Group>(\"groups\").update(\"tokens\", {\n              items: [...newTokenGroups, ...tokenGroup.items],\n            });\n          }\n        }\n      );\n      const totalImportedMaps = checkedMaps.length - unprocessedMaps\n      const totalImportedTokens = checkedTokens.length - unprocessedTokens\n      addSuccessToast(\"Imported\", totalImportedMaps, totalImportedTokens);\n    } catch (e) {\n      console.error(e);\n      if (e instanceof MissingAssetError) {\n        setError(e);\n      } else {\n        setError(new Error(\"Unable to import data\"));\n      }\n    }\n    await importDB.delete();\n    importDB.close();\n    setIsLoading(false);\n    backgroundTaskRunningRef.current = false;\n  }\n\n  function exportSelectorFilter(table: string) {\n    return (\n      table === \"maps\" ||\n      table === \"tokens\" ||\n      table === \"states\" ||\n      table === \"groups\"\n    );\n  }\n\n  async function handleExportSelectorClose() {\n    setShowExportSelector(false);\n  }\n\n  async function handleExportSelectorConfirm(\n    checkedMaps: SelectData[],\n    checkedTokens: SelectData[]\n  ) {\n    setShowExportSelector(false);\n    setIsLoading(true);\n    backgroundTaskRunningRef.current = true;\n\n    const mapIds = checkedMaps.map((map) => map.id);\n    const tokenIds = checkedTokens.map((token) => token.id);\n\n    try {\n      const buffer = await worker.exportData(\n        Comlink.proxy(handleDBProgress) as any,\n        mapIds,\n        tokenIds\n      );\n      const blob = new Blob([buffer]);\n      saveAs(blob, `${shortid.generate()}.owlbear`);\n      addSuccessToast(\"Exported\", checkedMaps.length, checkedTokens.length);\n    } catch (e: unknown) {\n      if (e instanceof (Error)) {\n        console.error(e);\n        setError(e);\n      }\n    }\n    setIsLoading(false);\n    backgroundTaskRunningRef.current = false;\n  }\n\n  return (\n    <Modal isOpen={isOpen} onRequestClose={handleClose} allowClose={!isLoading}>\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          maxWidth: \"300px\",\n          flexGrow: 1,\n        }}\n        m={2}\n      >\n        <Box>\n          <Label>Import / Export</Label>\n          <Text as=\"p\" mb={2} variant=\"caption\">\n            Select import or export then select the data you wish to use\n          </Text>\n          <input\n            onChange={(event) =>\n              event.target.files && handleImportDatabase(event.target.files[0])\n            }\n            type=\"file\"\n            accept=\".owlbear\"\n            style={{ display: \"none\" }}\n            ref={fileInputRef}\n          />\n          <Flex>\n            <Button mr={1} sx={{ flexGrow: 1 }} onClick={openFileDialog}>\n              Import\n            </Button>\n            <Button ml={1} sx={{ flexGrow: 1 }} onClick={handleExportDatabase}>\n              Export\n            </Button>\n          </Flex>\n        </Box>\n        {isLoading && (\n          <Box\n            sx={{\n              width: \"100%\",\n              height: \"100%\",\n              position: \"absolute\",\n              top: 0,\n              left: 0,\n            }}\n          >\n            <LoadingOverlay bg=\"overlay\" />\n            <Box sx={{ zIndex: 3, position: \"absolute\", width: \"100%\" }}>\n              <LoadingBar\n                isLoading={isLoading}\n                loadingProgressRef={loadingProgressRef}\n              />\n            </Box>\n          </Box>\n        )}\n        <ErrorBanner error={error} onRequestClose={() => setError(undefined)} />\n        <SelectDataModal\n          isOpen={showImportSelector}\n          onRequestClose={handleImportSelectorClose}\n          onConfirm={handleImportSelectorConfirm}\n          databaseName={importDBName}\n          confirmText=\"Import\"\n          label=\"Select data to import\"\n        />\n        <SelectDataModal\n          isOpen={showExportSelector}\n          onRequestClose={handleExportSelectorClose}\n          onConfirm={handleExportSelectorConfirm}\n          confirmText=\"Export\"\n          label=\"Select data to export\"\n          filter={exportSelectorFilter}\n        />\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default ImportExportModal;\n","import { useState, useEffect } from \"react\";\nimport {\n  Label,\n  Flex,\n  Box,\n  Button,\n  useColorMode,\n  Checkbox,\n  Divider,\n  Text,\n} from \"theme-ui\";\nimport prettyBytes from \"pretty-bytes\";\n\nimport Modal from \"../components/Modal\";\nimport Select from \"../components/Select\";\nimport Slider from \"../components/Slider\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\n\nimport { useUserId } from \"../contexts/UserIdContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\n\nimport useSetting from \"../hooks/useSetting\";\n\nimport ConfirmModal from \"./ConfirmModal\";\nimport ImportExportModal from \"./ImportExportModal\";\n\nimport { MapState } from \"../types/MapState\";\nimport { RequestCloseEventHandler } from \"../types/Events\";\n\ntype SettingsModalProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n};\n\nfunction SettingsModal({ isOpen, onRequestClose }: SettingsModalProps) {\n  const { database, databaseStatus } = useDatabase();\n  const userId = useUserId();\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [labelSize, setLabelSize] = useSetting<number>(\"map.labelSize\");\n  const [gridSnappingSensitivity, setGridSnappingSensitivity] =\n    useSetting<number>(\"map.gridSnappingSensitivity\");\n  const [showFogGuides, setShowFogGuides] =\n    useSetting<boolean>(\"fog.showGuides\");\n  const [fogEditOpacity, setFogEditOpacity] =\n    useSetting<number>(\"fog.editOpacity\");\n  const [imageCompressionQuality, setImageCompressionQuality] =\n    useSetting<number>(\"asset.compressionQuality\");\n  const [tokenNoteEnabled, setTokenNoteEnabled] =\n    useSetting<boolean>(\"tokenNote.enabled\");\n  const [tokenNoteTrigger, setTokenNoteTrigger] = useSetting<\n    \"click\" | \"doubleClick\" | \"longPress\"\n  >(\"tokenNote.trigger\");\n  const [tokenNoteLongPressMs, setTokenNoteLongPressMs] =\n    useSetting<number>(\"tokenNote.longPressMs\");\n  const [tokenNoteBlur, setTokenNoteBlur] = useSetting<\n    \"none\" | \"low\" | \"high\"\n  >(\"tokenNote.blur\");\n  const [tokenNoteFontSize, setTokenNoteFontSize] = useSetting<\n    \"sm\" | \"md\" | \"lg\"\n  >(\"tokenNote.fontSize\");\n  const [tokenNoteDefaultFont, setTokenNoteDefaultFont] = useSetting<\n    \"default\" | \"handwritten\" | \"rune\"\n  >(\"tokenNote.defaultFont\");\n  const [tokenNoteDefaultPermission, setTokenNoteDefaultPermission] =\n    useSetting<\"none\" | \"read\" | \"write\">(\"tokenNote.defaultPermission\");\n  const [storageEstimate, setStorageEstimate] = useState<StorageEstimate>();\n  const [isImportExportModalOpen, setIsImportExportModalOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    async function estimateStorage() {\n      // Persisted data on firefox doesn't count towards the usage quota so ignore it\n      const persisted = await navigator.storage.persisted();\n      const isFirefox =\n        navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\n      if (persisted && isFirefox) {\n        return;\n      }\n\n      const estimate = await navigator.storage.estimate();\n      setStorageEstimate(estimate);\n    }\n\n    if (isOpen && navigator.storage) {\n      estimateStorage();\n    }\n  }, [isOpen]);\n\n  async function handleEraseAllData() {\n    setIsLoading(true);\n    try {\n      localStorage.clear();\n      database?.close();\n      await database?.delete();\n    } catch {\n    } finally {\n      window.location.reload();\n    }\n  }\n\n  async function handleClearCache() {\n    setIsLoading(true);\n    // Clear saved settings\n    localStorage.clear();\n\n    if (database && userId) {\n      const assets = await database\n        .table(\"assets\")\n        .where(\"owner\")\n        .notEqual(userId)\n        .toArray();\n      const states: MapState[] = await database.table(\"states\").toArray();\n      for (let asset of assets) {\n        let inUse = false;\n        for (let state of states) {\n          for (let tokenState of Object.values(state.tokens)) {\n            if (tokenState.type === \"file\" && asset.id === tokenState.file) {\n              inUse = true;\n            }\n          }\n        }\n        if (!inUse) {\n          await database.table(\"assets\").delete(asset.id);\n        }\n      }\n\n      // TODO: Remove this when 1.11 comes out\n      // Hack to fix broken database upgrade\n      for (let state of states) {\n        if ((state as any).drawShapes) {\n          await database.table(\"states\").update(state.mapId, {\n            drawShapes: undefined,\n            drawings: (state as any).drawShapes,\n          });\n        }\n\n        if ((state as any).fogShapes) {\n          await database.table(\"states\").update(state.mapId, {\n            fogShapes: undefined,\n            fogs: (state as any).fogShapes,\n          });\n        }\n      }\n    }\n\n    window.location.reload();\n  }\n\n  const [colorMode, setColorMode] = useColorMode();\n  const tokenNoteTriggerOptions = [\n    { value: \"click\", label: \"On Click\" },\n    { value: \"doubleClick\", label: \"On Double Click\" },\n    { value: \"longPress\", label: \"On Long Press\" },\n  ];\n  const tokenNoteBlurOptions = [\n    { value: \"none\", label: \"None\" },\n    { value: \"low\", label: \"Low\" },\n    { value: \"high\", label: \"High\" },\n  ];\n  const tokenNoteFontSizeOptions = [\n    { value: \"sm\", label: \"Small\" },\n    { value: \"md\", label: \"Medium\" },\n    { value: \"lg\", label: \"Large\" },\n  ];\n  const tokenNoteFontOptions = [\n    { value: \"default\", label: \"System\" },\n    { value: \"handwritten\", label: \"Handwritten\" },\n    { value: \"rune\", label: \"Runic\" },\n  ];\n  const tokenNotePermissionOptions = [\n    { value: \"write\", label: \"Write\" },\n    { value: \"read\", label: \"Read Only\" },\n    { value: \"none\", label: \"Hidden\" },\n  ];\n\n  return (\n    <>\n      <Modal isOpen={isOpen} onRequestClose={onRequestClose}>\n        <Flex sx={{ flexDirection: \"column\" }}>\n          <Label py={2}>Settings</Label>\n          <Divider bg=\"text\" />\n          <Label py={2}>Accessibility:</Label>\n          <Label py={2}>\n            <span style={{ marginRight: \"4px\" }}>Light Theme</span>\n            <Checkbox\n              checked={colorMode === \"light\"}\n              onChange={(e) =>\n                setColorMode(e.target.checked ? \"light\" : \"default\")\n              }\n            />\n          </Label>\n          <Label py={2}>\n            <span style={{ marginRight: \"4px\" }}>Show Fog Guides</span>\n            <Checkbox\n              checked={showFogGuides}\n              onChange={(e) => setShowFogGuides(e.target.checked)}\n            />\n          </Label>\n          <Label py={2}>\n            Fog Edit Opacity\n            <Slider\n              step={0.05}\n              min={0}\n              max={1}\n              ml={1}\n              sx={{ width: \"initial\" }}\n              value={fogEditOpacity}\n              onChange={(e) => setFogEditOpacity(parseFloat(e.target.value))}\n              labelFunc={(value: number) => `${Math.round(value * 100)}%`}\n            />\n          </Label>\n          <Label py={2}>\n            Token Label Size\n            <Slider\n              step={0.5}\n              min={1}\n              max={3}\n              ml={1}\n              sx={{ width: \"initial\" }}\n              value={labelSize}\n              onChange={(e) => setLabelSize(parseFloat(e.target.value))}\n              labelFunc={(value: number) => `${value}x`}\n            />\n          </Label>\n          <Label py={2}>\n            Grid Snapping Sensitivity\n            <Slider\n              step={0.05}\n              min={0}\n              max={0.5}\n              ml={1}\n              sx={{ width: \"initial\" }}\n              value={gridSnappingSensitivity}\n              onChange={(e) =>\n                setGridSnappingSensitivity(parseFloat(e.target.value))\n              }\n              labelFunc={(value: number) => `${value * 2}`}\n            />\n          </Label>\n          <Label py={2}>\n            Image Compression\n            <Slider\n              step={0.05}\n              min={0.1}\n              max={1}\n              ml={1}\n              sx={{ width: \"initial\" }}\n              value={imageCompressionQuality ?? 0.8}\n              onChange={(e) =>\n                setImageCompressionQuality(parseFloat(e.target.value))\n              }\n              labelFunc={(value: number) => `${Math.round(value * 100)}%`}\n            />\n          </Label>\n          <Divider bg=\"text\" />\n          <Label py={2}>Token Notes:</Label>\n          <Label py={2}>\n            <span style={{ marginRight: \"4px\" }}>Enable Token Notes</span>\n            <Checkbox\n              checked={tokenNoteEnabled}\n              onChange={(e) => setTokenNoteEnabled(e.target.checked)}\n            />\n          </Label>\n          <Label py={2}>\n            Trigger\n            <Box sx={{ width: \"240px\" }}>\n              <Select\n                options={tokenNoteTriggerOptions}\n                value={tokenNoteTriggerOptions.find(\n                  (option) => option.value === tokenNoteTrigger\n                )}\n                onChange={(option: any) =>\n                  setTokenNoteTrigger(option?.value || \"longPress\")\n                }\n              />\n            </Box>\n          </Label>\n          {tokenNoteTrigger === \"longPress\" && (\n            <Label py={2}>\n              Long Press Duration\n              <Slider\n                step={50}\n                min={200}\n                max={1000}\n                ml={1}\n                sx={{ width: \"initial\" }}\n                value={tokenNoteLongPressMs}\n                onChange={(e) =>\n                  setTokenNoteLongPressMs(parseInt(e.target.value, 10))\n                }\n                labelFunc={(value: number) => `${value}ms`}\n              />\n            </Label>\n          )}\n          <Label py={2}>\n            Blur\n            <Box sx={{ width: \"240px\" }}>\n              <Select\n                options={tokenNoteBlurOptions}\n                value={tokenNoteBlurOptions.find(\n                  (option) => option.value === tokenNoteBlur\n                )}\n                onChange={(option: any) =>\n                  setTokenNoteBlur(option?.value || \"high\")\n                }\n              />\n            </Box>\n          </Label>\n          <Label py={2}>\n            Font Size\n            <Box sx={{ width: \"240px\" }}>\n              <Select\n                options={tokenNoteFontSizeOptions}\n                value={tokenNoteFontSizeOptions.find(\n                  (option) => option.value === tokenNoteFontSize\n                )}\n                onChange={(option: any) =>\n                  setTokenNoteFontSize(option?.value || \"md\")\n                }\n              />\n            </Box>\n          </Label>\n          <Label py={2}>\n            Default Font\n            <Box sx={{ width: \"240px\" }}>\n              <Select\n                options={tokenNoteFontOptions}\n                value={tokenNoteFontOptions.find(\n                  (option) => option.value === tokenNoteDefaultFont\n                )}\n                onChange={(option: any) =>\n                  setTokenNoteDefaultFont(option?.value || \"default\")\n                }\n              />\n            </Box>\n          </Label>\n          <Label py={2}>\n            Default Permission\n            <Box sx={{ width: \"240px\" }}>\n              <Select\n                options={tokenNotePermissionOptions}\n                value={tokenNotePermissionOptions.find(\n                  (option) => option.value === tokenNoteDefaultPermission\n                )}\n                onChange={(option: any) =>\n                  setTokenNoteDefaultPermission(option?.value || \"write\")\n                }\n              />\n            </Box>\n          </Label>\n          <Divider bg=\"text\" />\n          <Flex py={2}>\n            <Button\n              sx={{ flexGrow: 1 }}\n              onClick={handleClearCache}\n              disabled={!database}\n            >\n              Clear Cache\n            </Button>\n          </Flex>\n          <Flex py={2}>\n            <Button\n              sx={{ flexGrow: 1 }}\n              onClick={() => setIsDeleteModalOpen(true)}\n              disabled={!database}\n            >\n              Erase All Content and Reset\n            </Button>\n          </Flex>\n          <Flex py={2}>\n            <Button\n              sx={{ flexGrow: 1 }}\n              onClick={() => setIsImportExportModalOpen(true)}\n              disabled={databaseStatus !== \"loaded\"}\n            >\n              Import / Export Data\n            </Button>\n          </Flex>\n          {storageEstimate! && (\n            <Flex sx={{ justifyContent: \"center\" }}>\n              <Text variant=\"caption\">\n                Storage Used: {prettyBytes(storageEstimate.usage as number)} of{\" \"}\n                {prettyBytes(storageEstimate.quota as number)} (\n                {Math.round(\n                  ((storageEstimate.usage as number) /\n                    Math.max(storageEstimate.quota as number, 1)) *\n                    100\n                )}\n                %)\n              </Text>\n            </Flex>\n          )}\n          {isLoading && <LoadingOverlay bg=\"overlay\" />}\n        </Flex>\n      </Modal>\n      <ConfirmModal\n        isOpen={isDeleteModalOpen}\n        onRequestClose={() => setIsDeleteModalOpen(false)}\n        onConfirm={handleEraseAllData}\n        label=\"Erase All Content?\"\n        description=\"This will remove all data including saved maps and tokens.\"\n        confirmText=\"Erase\"\n      />\n      <ImportExportModal\n        isOpen={isImportExportModalOpen}\n        onRequestClose={() => setIsImportExportModalOpen(false)}\n      />\n    </>\n  );\n}\n\nexport default SettingsModal;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport SettingsIcon from \"../icons/SettingsIcon\";\nimport SettingsModal from \"../modals/SettingsModal\";\n\nfunction SettingsButton() {\n  const [isSettingsModalOpen, setIsSettingsModalOpen] = useState(false);\n  function openModal() {\n    setIsSettingsModalOpen(true);\n  }\n  function closeModal() {\n    setIsSettingsModalOpen(false);\n  }\n\n  return (\n    <>\n      <IconButton\n        m={1}\n        aria-label=\"Settings\"\n        title=\"Settings\"\n        onClick={openModal}\n      >\n        <SettingsIcon />\n      </IconButton>\n      <SettingsModal isOpen={isSettingsModalOpen} onRequestClose={closeModal} />\n    </>\n  );\n}\n\nexport default SettingsButton;\n","import { Duration } from \"../types/Timer\";\n\nconst MILLISECONDS_IN_HOUR = 3600000;\nconst MILLISECONDS_IN_MINUTE = 60000;\nconst MILLISECONDS_IN_SECOND = 1000;\n\n/**\n * Returns a timers duration in milliseconds\n * @param {Time} t The object with an hour, minute and second property\n */\nexport function getHMSDuration(t: Duration): number {\n  if (!t) {\n    return 0;\n  }\n  return (\n    t.hour * MILLISECONDS_IN_HOUR +\n    t.minute * MILLISECONDS_IN_MINUTE +\n    t.second * MILLISECONDS_IN_SECOND\n  );\n}\n\n/**\n * Returns an object with an hour, minute and second property\n * @param {number} duration The duration in milliseconds\n */\nexport function getDurationHMS(duration: number): Duration {\n  let workingDuration = duration;\n  const hour = Math.floor(workingDuration / MILLISECONDS_IN_HOUR);\n  workingDuration -= hour * MILLISECONDS_IN_HOUR;\n  const minute = Math.floor(workingDuration / MILLISECONDS_IN_MINUTE);\n  workingDuration -= minute * MILLISECONDS_IN_MINUTE;\n  const second = Math.floor(workingDuration / MILLISECONDS_IN_SECOND);\n\n  return { hour, minute, second };\n}\n","import { ChangeEvent, useRef } from \"react\";\nimport { Box, Label, Input, Button, Flex, Text } from \"theme-ui\";\n\nimport Modal from \"../components/Modal\";\n\nimport { getHMSDuration, getDurationHMS } from \"../helpers/timer\";\n\nimport useSetting from \"../hooks/useSetting\";\n\nimport {\n  RequestCloseEventHandler,\n  TimerStartEventHandler,\n  TimerStopEventHandler,\n} from \"../types/Events\";\nimport { Timer } from \"../types/Timer\";\n\ntype StartTimerProps = {\n  isOpen: boolean;\n  onRequestClose: RequestCloseEventHandler;\n  onTimerStart: TimerStartEventHandler;\n  onTimerStop: TimerStopEventHandler;\n  timer?: Timer;\n};\n\nfunction StartTimerModal({\n  isOpen,\n  onRequestClose,\n  onTimerStart,\n  onTimerStop,\n  timer,\n}: StartTimerProps) {\n  const inputRef = useRef<HTMLInputElement>(null);\n  function focusInput() {\n    inputRef.current && inputRef.current.focus();\n  }\n\n  const [hour, setHour] = useSetting<number>(\"timer.hour\");\n  const [minute, setMinute] = useSetting<number>(\"timer.minute\");\n  const [second, setSecond] = useSetting<number>(\"timer.second\");\n\n  function handleSubmit(event: ChangeEvent<HTMLInputElement>) {\n    event.preventDefault();\n    if (timer) {\n      onTimerStop();\n    } else {\n      const duration = getHMSDuration({ hour, minute, second });\n      onTimerStart({ current: duration, max: duration });\n    }\n  }\n\n  const inputStyle = {\n    width: \"70px\",\n    border: \"none\",\n    \":focus\": {\n      outline: \"none\",\n    },\n    fontSize: \"32px\",\n    padding: 2,\n    paddingLeft: 0,\n  };\n\n  function parseValue(value: string, max: number) {\n    const num = parseInt(value);\n    if (isNaN(num)) {\n      return 0;\n    }\n    return Math.min(num, max);\n  }\n\n  const timerHMS = timer && getDurationHMS(timer.current);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onRequestClose={onRequestClose}\n      onAfterOpen={focusInput}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          maxWidth: \"300px\",\n          flexGrow: 1,\n        }}\n        m={2}\n      >\n        <Box as=\"form\" onSubmit={handleSubmit}>\n          <Label py={2}>Start a countdown timer</Label>\n          <Flex mb={2} sx={{ flexGrow: 1, alignItems: \"baseline\" }}>\n            <Text as=\"label\" variant=\"body2\" sx={{ fontSize: \"16px\" }} p={1}>\n              H:\n            </Text>\n            <Input\n              sx={inputStyle}\n              value={`${timerHMS ? timerHMS.hour : hour}`}\n              onChange={(e) => setHour(parseValue(e.target.value, 24))}\n              type=\"number\"\n              disabled={!!timer}\n              min={0}\n              max={24}\n            />\n            <Text as=\"label\" variant=\"body2\" sx={{ fontSize: \"16px\" }} p={1}>\n              M:\n            </Text>\n            <Input\n              sx={inputStyle}\n              value={`${timerHMS ? timerHMS.minute : minute}`}\n              onChange={(e) => setMinute(parseValue(e.target.value, 59))}\n              type=\"number\"\n              ref={inputRef}\n              disabled={!!timer}\n              min={0}\n              max={59}\n            />\n            <Text as=\"label\" variant=\"body2\" sx={{ fontSize: \"16px\" }} p={1}>\n              S:\n            </Text>\n            <Input\n              sx={inputStyle}\n              value={`${timerHMS ? timerHMS.second : second}`}\n              onChange={(e) => setSecond(parseValue(e.target.value, 59))}\n              type=\"number\"\n              disabled={!!timer}\n              min={0}\n              max={59}\n            />\n          </Flex>\n          <Flex>\n            <Button\n              sx={{ flexGrow: 1 }}\n              disabled={hour === 0 && minute === 0 && second === 0}\n            >\n              {timer ? \"Stop Timer\" : \"Start Timer\"}\n            </Button>\n          </Flex>\n        </Box>\n      </Flex>\n    </Modal>\n  );\n}\n\nexport default StartTimerModal;\n","function StartTimerIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentcolor\"\n      transform=\"scale(-1 1)\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M16,22c1.1,0,2-0.9,2-2l-0.01-3.18c0-0.53-0.21-1.03-0.58-1.41L14,12l3.41-3.43c0.37-0.37,0.58-0.88,0.58-1.41L18,4 c0-1.1-0.9-2-2-2H8C6.9,2,6,2.9,6,4v3.16C6,7.69,6.21,8.2,6.58,8.58L10,12l-3.41,3.4C6.21,15.78,6,16.29,6,16.82V20 c0,1.1,0.9,2,2,2H16z M8,7.09V5c0-0.55,0.45-1,1-1h6c0.55,0,1,0.45,1,1v2.09c0,0.27-0.11,0.52-0.29,0.71L12,11.5L8.29,7.79 C8.11,7.61,8,7.35,8,7.09z\" />\n    </svg>\n  );\n}\n\nexport default StartTimerIcon;\n","import { useState } from \"react\";\nimport { IconButton } from \"theme-ui\";\n\nimport StartTimerModal from \"../../modals/StartTimerModal\";\nimport StartTimerIcon from \"../../icons/StartTimerIcon\";\nimport {\n  TimerStartEventHandler,\n  TimerStopEventHandler,\n} from \"../../types/Events\";\nimport { Timer } from \"../../types/Timer\";\n\ntype StartTimerButtonProps = {\n  onTimerStart: TimerStartEventHandler;\n  onTimerStop: TimerStopEventHandler;\n  timer?: Timer;\n};\n\nfunction StartTimerButton({\n  onTimerStart,\n  onTimerStop,\n  timer,\n}: StartTimerButtonProps) {\n  const [isTimerModalOpen, setIsTimerModalOpen] = useState(false);\n\n  function openModal() {\n    setIsTimerModalOpen(true);\n  }\n  function closeModal() {\n    setIsTimerModalOpen(false);\n  }\n\n  return (\n    <>\n      <IconButton\n        m={1}\n        aria-label=\"Start Timer\"\n        title=\"Start Timer\"\n        onClick={openModal}\n      >\n        <StartTimerIcon />\n      </IconButton>\n      <StartTimerModal\n        isOpen={isTimerModalOpen}\n        onRequestClose={closeModal}\n        onTimerStart={onTimerStart}\n        onTimerStop={onTimerStop}\n        timer={timer}\n      />\n    </>\n  );\n}\n\nexport default StartTimerButton;\n","import { useRef, useEffect } from \"react\";\n\n// Based on https://www.jayfreestone.com/writing/react-portals-with-hooks/\n\n/**\n * Creates DOM element to be used as React root.\n * @returns {HTMLElement}\n */\nfunction createRootElement(id: string) {\n  const rootContainer = document.createElement(\"div\");\n  rootContainer.setAttribute(\"id\", id);\n  return rootContainer;\n}\n\n/**\n * Appends element as last child of body.\n * @param {HTMLElement} rootElem\n */\nfunction addRootElement(rootElem: HTMLElement) {\n  if (document.body.lastElementChild) {\n    document.body.insertBefore(\n      rootElem,\n      document.body.lastElementChild?.nextElementSibling\n    );\n  }\n}\n\n/**\n * Hook to create a React Portal.\n * Automatically handles creating and tearing-down the root elements (no SRR\n * makes this trivial), so there is no need to ensure the parent target already\n * exists.\n * @example\n * const target = usePortal(id, [id]);\n * return createPortal(children, target);\n * @param {String} id The id of the target container, e.g 'modal' or 'spotlight'\n * @returns {HTMLElement} The DOM node to use as the Portal target.\n */\nfunction usePortal(id: string): HTMLElement {\n  const rootElemRef = useRef<HTMLElement | null>(null);\n\n  useEffect(\n    function setupElement() {\n      // Look for existing target dom element to append to\n      const existingParent: HTMLElement | null = document.querySelector(\n        `#${id}`\n      );\n      // Parent is either a new root or the existing dom element\n      const parentElem = existingParent || createRootElement(id);\n\n      // If there is no existing DOM element, add a new one.\n      if (!existingParent) {\n        addRootElement(parentElem);\n      }\n\n      // Add the detached element to the parent\n      rootElemRef.current && parentElem.appendChild(rootElemRef.current);\n\n      return function removeElement() {\n        rootElemRef.current && rootElemRef.current.remove();\n        if (parentElem.childNodes.length === -1) {\n          parentElem.remove();\n        }\n      };\n    },\n    [id]\n  );\n\n  /**\n   * It's important we evaluate this lazily:\n   * - We need first render to contain the DOM element, so it shouldn't happen\n   *   in useEffect. We would normally put this in the constructor().\n   * - We can't do 'const rootElemRef = useRef(document.createElement('div))',\n   *   since this will run every single render (that's a lot).\n   * - We want the ref to consistently point to the same DOM element and only\n   *   ever run once.\n   * @link https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n   */\n  function getRootElem() {\n    if (!rootElemRef.current) {\n      rootElemRef.current = document.createElement(\"div\");\n    }\n    return rootElemRef.current;\n  }\n\n  return getRootElem();\n}\n\nexport default usePortal;\n","import { useEffect, useRef } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Box, Progress } from \"theme-ui\";\n\nimport usePortal from \"../../hooks/usePortal\";\nimport { Timer as TimerType } from \"../../types/Timer\";\n\ntype TimerProps = {\n  timer?: TimerType;\n  index: number;\n};\n\nfunction Timer({ timer, index }: TimerProps) {\n  const progressBarRef = useRef<HTMLProgressElement>(null);\n\n  useEffect(() => {\n    if (progressBarRef.current && timer) {\n      progressBarRef.current.value = timer.current;\n    }\n  }, [timer]);\n\n  useEffect(() => {\n    let request = requestAnimationFrame(animate);\n    let previousTime = performance.now();\n    function animate(time: number) {\n      request = requestAnimationFrame(animate);\n      const deltaTime = time - previousTime;\n      previousTime = time;\n\n      if (progressBarRef.current && progressBarRef.current.value > 0) {\n        progressBarRef.current.value -= deltaTime;\n      }\n    }\n\n    return () => {\n      cancelAnimationFrame(request);\n    };\n  }, []);\n\n  const timerContainer = usePortal(\"root\");\n\n  return ReactDOM.createPortal(\n    <Box\n      sx={{\n        position: \"absolute\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        // Offset for iOS safe zone\n        bottom: \"env(safe-area-inset-bottom)\",\n        flexDirection: \"column\",\n        borderRadius: \"28px\",\n        left: \"50%\",\n        maxWidth: \"500px\",\n        width: \"40%\",\n        transform: `translate(-50%, -${index * 36}px)`,\n        padding: \"0 8px\",\n        margin: \"8px\",\n      }}\n      bg=\"overlay\"\n    >\n      <Progress\n        max={timer && timer.max}\n        m={2}\n        sx={{ width: \"100%\" }}\n        ref={progressBarRef}\n      />\n    </Box>,\n    timerContainer\n  );\n}\n\nexport default Timer;\n","function ExpandMoreDiceIcon({ isExpanded }: { isExpanded: boolean }) {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentcolor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      {isExpanded ? (\n        <path d=\"M17.727 6c.7 0 1.273.6 1.273 1.333v9.334C19 17.4 18.427 18 17.727 18H6.273C5.573 18 5 17.4 5 16.667V7.333C5 6.6 5.573 6 6.273 6zM17 8H7v8h10V8zm-5.444 1c.244 0 .444.193.444.429v5.182c0 .236-.2.429-.444.429H8.444A.438.438 0 018 14.611V9.43C8 9.193 8.2 9 8.444 9h3.112z\" />\n      ) : (\n        <path d=\"M17.727 6c.7 0 1.273.6 1.273 1.333v9.334C19 17.4 18.427 18 17.727 18H6.273C5.573 18 5 17.4 5 16.667V7.333C5 6.6 5.573 6 6.273 6zM17 8H7v8h10V8zm-5.444 1c.244 0 .444.193.444.429v2.142c0 .236-.2.429-.444.429H8.444A.438.438 0 018 11.571V9.43C8 9.193 8.2 9 8.444 9h3.112z\" />\n      )}\n    </svg>\n  );\n}\n\nexport default ExpandMoreDiceIcon;\n","import React, { useState } from \"react\";\nimport { Flex, IconButton, Box } from \"theme-ui\";\n\nimport ExpandMoreDiceIcon from \"../../icons/ExpandMoreDiceIcon\";\n\nimport { DiceLoadingProvider } from \"../../contexts/DiceLoadingContext\";\n\nimport useSetting from \"../../hooks/useSetting\";\n\nimport LoadingOverlay from \"../LoadingOverlay\";\n\nimport {\n  DiceShareChangeEventHandler,\n  DiceRollsChangeEventHandler,\n} from \"../../types/Events\";\nimport { DiceRoll } from \"../../types/Dice\";\n\nconst DiceTrayOverlay = React.lazy(() => import(\"../dice/DiceTrayOverlay\"));\n\ntype DiceTrayButtonProps = {\n  shareDice: boolean;\n  onShareDiceChange: DiceShareChangeEventHandler;\n  diceRolls: DiceRoll[];\n  onDiceRollsChange: DiceRollsChangeEventHandler;\n};\n\nfunction DiceTrayButton({\n  shareDice,\n  onShareDiceChange,\n  diceRolls,\n  onDiceRollsChange,\n}: DiceTrayButtonProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [fullScreen] = useSetting(\"map.fullScreen\");\n\n  return (\n    <Flex\n      sx={{\n        position: \"absolute\",\n        top: 0,\n        left: fullScreen ? \"0\" : \"100%\",\n        bottom: 0,\n        flexDirection: \"column\",\n        alignItems: \"flex-start\",\n        pointerEvents: \"none\",\n        zIndex: 1,\n      }}\n      ml={1}\n    >\n      <IconButton\n        aria-label={isExpanded ? \"Hide Dice Tray\" : \"Show Dice Tray\"}\n        title={isExpanded ? \"Hide Dice Tray\" : \"Show Dice Tray\"}\n        onClick={() => setIsExpanded(!isExpanded)}\n        sx={{\n          display: \"block\",\n          backgroundColor: \"overlay\",\n          borderRadius: \"50%\",\n          pointerEvents: \"all\",\n        }}\n        m={2}\n      >\n        <ExpandMoreDiceIcon isExpanded={isExpanded} />\n      </IconButton>\n      <DiceLoadingProvider>\n        <React.Suspense\n          fallback={\n            isExpanded && (\n              <Box\n                sx={{\n                  width: \"32px\",\n                  height: \"32px\",\n                  position: \"absolute\",\n                  top: \"40px\",\n                  left: \"8px\",\n                }}\n              >\n                <LoadingOverlay />\n              </Box>\n            )\n          }\n        >\n          <DiceTrayOverlay\n            isOpen={isExpanded}\n            shareDice={shareDice}\n            onShareDiceChange={onShareDiceChange}\n            diceRolls={diceRolls}\n            onDiceRollsChange={onDiceRollsChange}\n          />\n        </React.Suspense>\n      </DiceLoadingProvider>\n    </Flex>\n  );\n}\n\nexport default DiceTrayButton;\n","import { useEffect } from \"react\";\nimport { Flex, Box, Text } from \"theme-ui\";\nimport SimpleBar from \"simplebar-react\";\n\nimport AddPartyMemberButton from \"./AddPartyMemberButton\";\nimport Nickname from \"./Nickname\";\nimport ChangeNicknameButton from \"./ChangeNicknameButton\";\nimport SettingsButton from \"../SettingsButton\";\nimport StartTimerButton from \"./StartTimerButton\";\nimport Timer from \"./Timer\";\nimport DiceTrayButton from \"./DiceTrayButton\";\n\nimport useSetting from \"../../hooks/useSetting\";\n\nimport { useParty } from \"../../contexts/PartyContext\";\nimport { usePlayerState, usePlayerUpdater } from \"../../contexts/PlayerContext\";\nimport { DiceRoll } from \"../../types/Dice\";\nimport { Timer as TimerType } from \"../../types/Timer\";\n\ntype PartyProps = {\n  gameId: string;\n};\n\nfunction Party({ gameId }: PartyProps) {\n  const setPlayerState = usePlayerUpdater();\n  const playerState = usePlayerState();\n  const partyState = useParty();\n\n  const [fullScreen] = useSetting<boolean>(\"map.fullScreen\");\n  const [shareDice, setShareDice] = useSetting<boolean>(\"dice.shareDice\");\n\n  function handleTimerStart(newTimer: TimerType) {\n    setPlayerState((prevState) => ({ ...prevState, timer: newTimer }));\n  }\n\n  function handleTimerStop() {\n    setPlayerState((prevState) => ({ ...prevState, timer: undefined }));\n  }\n\n  useEffect(() => {\n    let prevTime = performance.now();\n    let request = requestAnimationFrame(update);\n    let counter = 0;\n    function update(time: number) {\n      request = requestAnimationFrame(update);\n      const deltaTime = time - prevTime;\n      prevTime = time;\n\n      if (playerState.timer) {\n        counter += deltaTime;\n        // Update timer every second\n        if (counter > 1000) {\n          const newTimer: TimerType = {\n            ...playerState.timer,\n            current: playerState.timer.current - counter,\n          };\n          if (newTimer.current < 0) {\n            setPlayerState((prevState) => ({ ...prevState, timer: undefined }));\n          } else {\n            setPlayerState((prevState) => ({ ...prevState, timer: newTimer }));\n          }\n          counter = 0;\n        }\n      }\n    }\n    return () => {\n      cancelAnimationFrame(request);\n    };\n  }, [playerState.timer, setPlayerState]);\n\n  function handleNicknameChange(newNickname: string) {\n    setPlayerState((prevState) => ({ ...prevState, nickname: newNickname }));\n  }\n\n  function handleDiceRollsChange(newDiceRolls: DiceRoll[]) {\n    setPlayerState(\n      (prevState) => ({\n        ...prevState,\n        dice: { share: shareDice, rolls: newDiceRolls },\n      }),\n      shareDice\n    );\n  }\n\n  function handleShareDiceChange(newShareDice: boolean) {\n    setShareDice(newShareDice);\n    setPlayerState((prevState) => ({\n      ...prevState,\n      dice: { ...prevState.dice, share: newShareDice },\n    }));\n  }\n\n  return (\n    <Box\n      bg=\"background\"\n      sx={{\n        position: \"relative\",\n      }}\n    >\n      <Box\n        sx={{\n          flexDirection: \"column\",\n          overflow: \"visible\",\n          alignItems: \"center\",\n          height: \"100%\",\n          display: fullScreen ? \"none\" : \"flex\",\n          width: \"112px\",\n          minWidth: \"112px\",\n        }}\n        p={3}\n      >\n        <Box\n          sx={{\n            width: \"100%\",\n          }}\n        >\n          <Text mb={1} variant=\"heading\" as=\"h1\">\n            Party\n          </Text>\n        </Box>\n        <SimpleBar\n          style={{\n            flexGrow: 1,\n            width: \"100%\",\n            minWidth: \"112px\",\n            padding: \"0 16px\",\n            height: \"calc(100% - 200px)\",\n          }}\n        >\n          <Nickname\n            nickname={`${playerState.nickname} (you)`}\n            diceRolls={shareDice ? playerState.dice.rolls : undefined}\n          />\n          {Object.entries(partyState).map(([id, { nickname, dice }]) => (\n            <Nickname\n              nickname={nickname}\n              key={id}\n              diceRolls={dice.share ? dice.rolls : undefined}\n            />\n          ))}\n          {playerState.timer && <Timer timer={playerState.timer} index={0} />}\n          {Object.entries(partyState)\n            .filter(([_, { timer }]) => timer)\n            .map(([id, { timer }], index) => (\n              <Timer\n                timer={timer}\n                key={id}\n                // Put party timers above your timer if there is one\n                index={playerState.timer ? index + 1 : index}\n              />\n            ))}\n        </SimpleBar>\n        <Flex sx={{ flexDirection: \"column\" }}>\n          <ChangeNicknameButton\n            nickname={playerState.nickname}\n            onChange={handleNicknameChange}\n          />\n          <AddPartyMemberButton gameId={gameId} />\n          <StartTimerButton\n            onTimerStart={handleTimerStart}\n            onTimerStop={handleTimerStop}\n            timer={playerState.timer}\n          />\n          <SettingsButton />\n        </Flex>\n      </Box>\n      <DiceTrayButton\n        shareDice={shareDice}\n        onShareDiceChange={handleShareDiceChange}\n        diceRolls={(playerState.dice && playerState.dice.rolls) || []}\n        onDiceRollsChange={handleDiceRollsChange}\n      />\n    </Box>\n  );\n}\n\nexport default Party;\n","import { useEffect, useRef } from \"react\";\nimport { useToasts } from \"react-toast-notifications\";\n\nimport Session from \"./Session\";\n\nimport { useParty } from \"../contexts/PartyContext\";\n\nimport Party from \"../components/party/Party\";\n\ntype NetworkedPartyProps = { gameId: string; session: Session };\n\nfunction NetworkedParty({ gameId, session }: NetworkedPartyProps) {\n  const partyState = useParty();\n  const { addToast } = useToasts();\n\n  // Keep a reference to players who have just joined to show the joined notification\n  const joinedPlayersRef = useRef<string[]>([]);\n  useEffect(() => {\n    if (joinedPlayersRef.current.length > 0) {\n      for (let id of joinedPlayersRef.current) {\n        if (partyState[id]) {\n          addToast(`${partyState[id].nickname} joined the party`);\n        }\n      }\n      joinedPlayersRef.current = [];\n    }\n  }, [partyState, addToast]);\n\n  useEffect(() => {\n    function handlePlayerJoined(sessionId: string) {\n      if (partyState[sessionId]) {\n        addToast(`${partyState[sessionId].nickname} joined the party`);\n      } else {\n        joinedPlayersRef.current.push(sessionId);\n      }\n    }\n\n    function handlePlayerLeft(sessionId: string) {\n      if (partyState[sessionId]) {\n        addToast(`${partyState[sessionId].nickname} left the party`);\n      }\n    }\n\n    session.on(\"playerJoined\", handlePlayerJoined);\n    session.on(\"playerLeft\", handlePlayerLeft);\n\n    return () => {\n      session.off(\"playerJoined\", handlePlayerJoined);\n      session.off(\"playerLeft\", handlePlayerLeft);\n    };\n  }, [session, partyState, addToast]);\n\n  return <Party gameId={gameId} />;\n}\n\nexport default NetworkedParty;\n","import { encode, decode } from \"@msgpack/msgpack\";\nimport shortid from \"shortid\";\nimport { deflate, inflate } from \"pako\";\n\nconst MAX_CHUNK_SIZE = 16000;\nconst DEFAULT_CONNECT_TIMEOUT_MS = 7000;\nconst FAIL_FAST_WINDOW_MS = 60000;\n\ntype IncomingChunk = {\n  buffers: (Uint8Array | undefined)[];\n  count: number;\n  total: number;\n};\n\ntype AssetChunkPayload = {\n  chunkId: string;\n  index: number;\n  total: number;\n  data: Uint8Array;\n};\n\ntype PeerData = any;\ntype PeerReply = (id: string, data: PeerData, chunkId?: string) => void;\n\ntype PeerDataEvent = {\n  peer: { id: string };\n  id: string;\n  data: PeerData;\n  reply: PeerReply;\n};\n\ntype PeerDataProgressEvent = {\n  peer: { id: string };\n  id: string;\n  count: number;\n  total: number;\n  reply: PeerReply;\n};\n\ntype AssetTransportOptions = {\n  getLocalId: () => string | undefined;\n  sendSignal: (event: string, payload: any) => void;\n  onPeerData: (event: PeerDataEvent) => void;\n  onPeerDataProgress: (event: PeerDataProgressEvent) => void;\n  log?: (message: string, payload?: any) => void;\n};\n\ntype SignalOfferPayload = {\n  from: string;\n  sdp: RTCSessionDescriptionInit;\n};\n\ntype SignalAnswerPayload = {\n  from: string;\n  sdp: RTCSessionDescriptionInit;\n};\n\ntype SignalIcePayload = {\n  from: string;\n  candidate: RTCIceCandidateInit;\n};\n\ntype PeerState = {\n  id: string;\n  pc: RTCPeerConnection;\n  channel?: RTCDataChannel;\n  isInitiator: boolean;\n  pendingCandidates: RTCIceCandidateInit[];\n  readyPromise?: Promise<boolean>;\n  readyResolve?: (ready: boolean) => void;\n  lastFailureAt?: number;\n};\n\nexport default class AssetTransport {\n  private options: AssetTransportOptions;\n  private peers: Record<string, PeerState>;\n  private incomingChunks: Record<string, IncomingChunk>;\n  private iceServers: RTCIceServer[] | null;\n  private icePromise?: Promise<RTCIceServer[]>;\n  private webrtcUnavailable: boolean;\n\n  constructor(options: AssetTransportOptions) {\n    this.options = options;\n    this.peers = {};\n    this.incomingChunks = {};\n    this.iceServers = null;\n    this.webrtcUnavailable = false;\n  }\n\n  isAvailable() {\n    if (this.webrtcUnavailable) {\n      return false;\n    }\n    if (typeof RTCPeerConnection === \"undefined\") {\n      this.markWebRtcUnavailable(\"missing_rtcpeerconnection\");\n      return false;\n    }\n    return true;\n  }\n\n  async send(\n    peerId: string,\n    eventId: string,\n    data: PeerData,\n    chunkId?: string,\n    options?: { timeoutMs?: number }\n  ): Promise<boolean> {\n    if (!this.isAvailable()) {\n      return false;\n    }\n\n    const peer = await this.ensurePeer(peerId, \"initiator\");\n    if (!peer) {\n      return false;\n    }\n\n    if (peer.lastFailureAt && Date.now() - peer.lastFailureAt < FAIL_FAST_WINDOW_MS) {\n      return false;\n    }\n\n    const ready = await this.waitForChannel(peer, options?.timeoutMs);\n    if (!ready || !peer.channel) {\n      peer.lastFailureAt = Date.now();\n      return false;\n    }\n\n    try {\n      this.sendChunks(peer, eventId, data, chunkId);\n      return true;\n    } catch (error) {\n      peer.lastFailureAt = Date.now();\n      this.options.log?.(\"P2P_ASSET_SEND_ERROR\", error);\n      return false;\n    }\n  }\n\n  handleOffer(payload: SignalOfferPayload) {\n    if (!this.isAvailable()) {\n      return;\n    }\n    if (!payload || typeof payload.from !== \"string\" || !payload.sdp) {\n      return;\n    }\n    void this.acceptOffer(payload.from, payload.sdp);\n  }\n\n  handleAnswer(payload: SignalAnswerPayload) {\n    if (!this.isAvailable()) {\n      return;\n    }\n    if (!payload || typeof payload.from !== \"string\" || !payload.sdp) {\n      return;\n    }\n    void this.acceptAnswer(payload.from, payload.sdp);\n  }\n\n  handleIce(payload: SignalIcePayload) {\n    if (!this.isAvailable()) {\n      return;\n    }\n    if (!payload || typeof payload.from !== \"string\" || !payload.candidate) {\n      return;\n    }\n    void this.acceptIce(payload.from, payload.candidate);\n  }\n\n  removePeer(peerId: string) {\n    const peer = this.peers[peerId];\n    if (!peer) {\n      return;\n    }\n    peer.channel?.close();\n    peer.pc.close();\n    delete this.peers[peerId];\n    this.cleanupIncomingChunks(peerId);\n  }\n\n  dispose() {\n    Object.keys(this.peers).forEach(peerId => this.removePeer(peerId));\n    this.incomingChunks = {};\n  }\n\n  private async ensurePeer(peerId: string, role?: \"initiator\" | \"answerer\") {\n    if (!this.isAvailable()) {\n      return;\n    }\n    if (this.peers[peerId]) {\n      return this.peers[peerId];\n    }\n\n    const iceServers = await this.loadIceServers();\n    let pc: RTCPeerConnection;\n    try {\n      pc = new RTCPeerConnection({ iceServers });\n    } catch (error) {\n      this.markWebRtcUnavailable(\"rtcpeerconnection_create_failed\", error);\n      return;\n    }\n    const localId = this.options.getLocalId();\n    const isInitiator =\n      role === \"initiator\"\n        ? true\n        : role === \"answerer\"\n        ? false\n        : localId\n        ? localId < peerId\n        : true;\n    const peer: PeerState = {\n      id: peerId,\n      pc,\n      isInitiator,\n      pendingCandidates: [],\n    };\n\n    pc.onicecandidate = event => {\n      if (!event.candidate) {\n        this.options.log?.(\"P2P_ICE_CANDIDATE_END\", { peerId });\n        return;\n      }\n      const localCandidateType =\n        \"type\" in event.candidate ? (event.candidate as any).type : \"unknown\";\n      this.options.log?.(\"P2P_ICE_CANDIDATE_LOCAL\", {\n        peerId,\n        candidateType: localCandidateType,\n      });\n      this.options.sendSignal(\"webrtc_ice\", {\n        to: peerId,\n        candidate: event.candidate,\n      });\n    };\n\n    pc.onconnectionstatechange = () => {\n      this.options.log?.(\"P2P_CONN_STATE\", {\n        peerId,\n        state: pc.connectionState,\n      });\n      if (pc.connectionState === \"failed\" || pc.connectionState === \"closed\") {\n        this.options.log?.(\"P2P_ASSET_CONN_CLOSED\", {\n          peerId,\n          state: pc.connectionState,\n        });\n        this.removePeer(peerId);\n      }\n    };\n\n    pc.oniceconnectionstatechange = () => {\n      this.options.log?.(\"P2P_ICE_STATE\", {\n        peerId,\n        state: pc.iceConnectionState,\n      });\n    };\n\n    pc.onicegatheringstatechange = () => {\n      this.options.log?.(\"P2P_ICE_GATHERING_STATE\", {\n        peerId,\n        state: pc.iceGatheringState,\n      });\n    };\n\n    pc.onicecandidateerror = (event: any) => {\n      this.options.log?.(\"P2P_ICE_CANDIDATE_ERROR\", {\n        peerId,\n        errorCode: event?.errorCode,\n        errorText: event?.errorText,\n        url: event?.url,\n      });\n    };\n\n    if (isInitiator) {\n      const channel = pc.createDataChannel(\"assets\");\n      this.attachChannel(peer, channel);\n      void this.createOffer(peer);\n    } else {\n      pc.ondatachannel = event => {\n        this.attachChannel(peer, event.channel);\n      };\n    }\n\n    this.peers[peerId] = peer;\n    return peer;\n  }\n\n  private attachChannel(peer: PeerState, channel: RTCDataChannel) {\n    peer.channel = channel;\n    channel.binaryType = \"arraybuffer\";\n    channel.onopen = () => {\n      this.options.log?.(\"P2P_CHANNEL_OPEN\", { peerId: peer.id });\n      peer.readyResolve?.(true);\n    };\n    channel.onclose = () => {\n      this.options.log?.(\"P2P_CHANNEL_CLOSE\", { peerId: peer.id });\n      peer.readyResolve?.(false);\n    };\n    channel.onerror = () => {\n      this.options.log?.(\"P2P_CHANNEL_ERROR\", { peerId: peer.id });\n      peer.readyResolve?.(false);\n    };\n    channel.onmessage = event => {\n      void this.handleChannelMessage(peer.id, event.data);\n    };\n  }\n\n  private async createOffer(peer: PeerState) {\n    try {\n      const offer = await peer.pc.createOffer();\n      await peer.pc.setLocalDescription(offer);\n      if (peer.pc.localDescription) {\n        this.options.log?.(\"P2P_SIGNAL_OFFER_LOCAL\", { peerId: peer.id });\n        this.options.sendSignal(\"webrtc_offer\", {\n          to: peer.id,\n          sdp: peer.pc.localDescription,\n        });\n      }\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_OFFER_ERROR\", error);\n    }\n  }\n\n  private async acceptOffer(peerId: string, sdp: RTCSessionDescriptionInit) {\n    const peer = await this.ensurePeer(peerId, \"answerer\");\n    if (!peer || peer.isInitiator) {\n      return;\n    }\n    try {\n      this.options.log?.(\"P2P_SIGNAL_OFFER_REMOTE\", { peerId });\n      await peer.pc.setRemoteDescription(sdp);\n      const answer = await peer.pc.createAnswer();\n      await peer.pc.setLocalDescription(answer);\n      if (peer.pc.localDescription) {\n        this.options.log?.(\"P2P_SIGNAL_ANSWER_LOCAL\", { peerId });\n        this.options.sendSignal(\"webrtc_answer\", {\n          to: peerId,\n          sdp: peer.pc.localDescription,\n        });\n      }\n      await this.flushPendingIce(peer);\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_ACCEPT_OFFER_ERROR\", error);\n    }\n  }\n\n  private async acceptAnswer(peerId: string, sdp: RTCSessionDescriptionInit) {\n    const peer = this.peers[peerId];\n    if (!peer || !peer.isInitiator) {\n      return;\n    }\n    try {\n      this.options.log?.(\"P2P_SIGNAL_ANSWER_REMOTE\", { peerId });\n      await peer.pc.setRemoteDescription(sdp);\n      await this.flushPendingIce(peer);\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_ACCEPT_ANSWER_ERROR\", error);\n    }\n  }\n\n  private async acceptIce(peerId: string, candidate: RTCIceCandidateInit) {\n    const peer = this.peers[peerId];\n    if (!peer) {\n      return;\n    }\n    const remoteCandidateType =\n      candidate && \"type\" in candidate ? (candidate as any).type : \"unknown\";\n    this.options.log?.(\"P2P_ICE_CANDIDATE_REMOTE\", {\n      peerId,\n      candidateType: remoteCandidateType,\n    });\n    if (!peer.pc.remoteDescription) {\n      peer.pendingCandidates.push(candidate);\n      return;\n    }\n    try {\n      await peer.pc.addIceCandidate(candidate);\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_ADD_ICE_ERROR\", error);\n    }\n  }\n\n  private async flushPendingIce(peer: PeerState) {\n    if (!peer.pendingCandidates.length) {\n      return;\n    }\n    const candidates = [...peer.pendingCandidates];\n    peer.pendingCandidates = [];\n    for (const candidate of candidates) {\n      try {\n        await peer.pc.addIceCandidate(candidate);\n      } catch (error) {\n        this.options.log?.(\"P2P_ASSET_PENDING_ICE_ERROR\", error);\n      }\n    }\n  }\n\n  private async waitForChannel(\n    peer: PeerState,\n    timeoutMs = DEFAULT_CONNECT_TIMEOUT_MS\n  ) {\n    if (peer.channel?.readyState === \"open\") {\n      return true;\n    }\n    if (!peer.readyPromise) {\n      peer.readyPromise = new Promise(resolve => {\n        peer.readyResolve = resolve;\n      });\n    }\n    const timeout = new Promise<boolean>(resolve => {\n      setTimeout(() => resolve(false), timeoutMs);\n    });\n    return Promise.race([peer.readyPromise, timeout]);\n  }\n\n  private sendChunks(\n    peer: PeerState,\n    eventId: string,\n    data: PeerData,\n    chunkId?: string\n  ) {\n    const message = encode({ id: eventId, data });\n    const compressed = deflate(message);\n    const id = chunkId || shortid.generate();\n    const chunks = this.chunk(compressed, id);\n    for (const chunk of chunks) {\n      const payload: AssetChunkPayload = {\n        chunkId: chunk.chunkId,\n        index: chunk.index,\n        total: chunk.total,\n        data: chunk.data,\n      };\n      const encoded = encode(payload);\n      peer.channel?.send(encoded);\n    }\n  }\n\n  private chunk(data: Uint8Array, chunkId: string) {\n    const size = data.byteLength;\n    const total = Math.ceil(size / MAX_CHUNK_SIZE) || 1;\n    const chunks: AssetChunkPayload[] = [];\n\n    for (let index = 0; index < total; index++) {\n      const start = index * MAX_CHUNK_SIZE;\n      const end = Math.min(start + MAX_CHUNK_SIZE, size);\n      const slice = data.slice(start, end);\n      chunks.push({ chunkId, index, total, data: slice });\n    }\n\n    return chunks;\n  }\n\n  private async handleChannelMessage(peerId: string, payload: any) {\n    const data = await this.normalizePayload(payload);\n    if (!data) {\n      return;\n    }\n    let decoded: AssetChunkPayload;\n    try {\n      decoded = decode(data) as AssetChunkPayload;\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_DECODE_ERROR\", error);\n      return;\n    }\n\n    if (!decoded || typeof decoded.chunkId !== \"string\") {\n      return;\n    }\n\n    const { chunkId, index, total } = decoded;\n    const key = `${peerId}:${chunkId}`;\n    let chunkState = this.incomingChunks[key];\n    if (!chunkState || chunkState.total !== total) {\n      chunkState = {\n        buffers: new Array(total),\n        count: 0,\n        total,\n      };\n    }\n\n    if (!chunkState.buffers[index]) {\n      chunkState.count += 1;\n    }\n    chunkState.buffers[index] = decoded.data;\n    this.incomingChunks[key] = chunkState;\n\n    const reply: PeerReply = (id, replyData, replyChunkId) => {\n      void this.send(peerId, id, replyData, replyChunkId);\n    };\n\n    this.options.onPeerDataProgress({\n      peer: { id: peerId },\n      id: chunkId,\n      count: chunkState.count,\n      total: chunkState.total,\n      reply,\n    });\n\n    if (chunkState.count === chunkState.total) {\n      try {\n        const merged = this.mergeChunks(chunkState.buffers);\n        const decompressed = inflate(merged);\n        const message = decode(decompressed) as { id: string; data: PeerData };\n        this.options.log?.(\"ASSET_RECEIVE_MODE_P2P\", {\n          sessionId: peerId,\n          eventId: message.id,\n        });\n        this.options.onPeerData({\n          peer: { id: peerId },\n          id: message.id,\n          data: message.data,\n          reply,\n        });\n      } catch (error) {\n        this.options.log?.(\"P2P_ASSET_MESSAGE_ERROR\", error);\n      } finally {\n        delete this.incomingChunks[key];\n      }\n    }\n  }\n\n  private mergeChunks(buffers: (Uint8Array | undefined)[]) {\n    const totalLength = buffers.reduce((acc, buf) => {\n      if (!buf) {\n        return acc;\n      }\n      return acc + buf.byteLength;\n    }, 0);\n    const merged = new Uint8Array(totalLength);\n    let offset = 0;\n    for (let i = 0; i < buffers.length; i++) {\n      const buffer = buffers[i];\n      if (!buffer) {\n        continue;\n      }\n      merged.set(buffer, offset);\n      offset += buffer.byteLength;\n    }\n    return merged;\n  }\n\n  private cleanupIncomingChunks(peerId: string) {\n    for (const key of Object.keys(this.incomingChunks)) {\n      if (key.startsWith(`${peerId}:`)) {\n        delete this.incomingChunks[key];\n      }\n    }\n  }\n\n  private async normalizePayload(payload: any): Promise<Uint8Array | null> {\n    if (!payload) {\n      return null;\n    }\n    if (payload instanceof ArrayBuffer) {\n      return new Uint8Array(payload);\n    }\n    if (payload instanceof Uint8Array) {\n      return payload;\n    }\n    if (payload instanceof Blob) {\n      return new Uint8Array(await payload.arrayBuffer());\n    }\n    return null;\n  }\n\n  private async loadIceServers() {\n    if (this.iceServers) {\n      return this.iceServers;\n    }\n    if (!this.icePromise) {\n      this.icePromise = this.fetchIceServers();\n    }\n    this.iceServers = await this.icePromise;\n    this.options.log?.(\"P2P_ICE_SERVERS\", {\n      servers: this.iceServers,\n    });\n    return this.iceServers;\n  }\n\n  private async fetchIceServers(): Promise<RTCIceServer[]> {\n    const brokerUrl = process.env.REACT_APP_BROKER_URL;\n    if (!brokerUrl) {\n      this.options.log?.(\"P2P_ICE_FETCH_SKIP\", { reason: \"missing_broker_url\" });\n      return [];\n    }\n    try {\n      const base = brokerUrl.replace(/\\/$/, \"\");\n      const response = await fetch(`${base}/iceservers`, { credentials: \"omit\" });\n      if (!response.ok) {\n        this.options.log?.(\"P2P_ICE_FETCH_ERROR\", {\n          status: response.status,\n        });\n        return [];\n      }\n      const data = await response.json();\n      const iceServers = Array.isArray(data?.iceServers) ? data.iceServers : [];\n      this.options.log?.(\"P2P_ICE_FETCH_OK\", { count: iceServers.length });\n      return iceServers;\n    } catch (error) {\n      this.options.log?.(\"P2P_ASSET_ICE_FETCH_ERROR\", error);\n      return [];\n    }\n  }\n\n  private markWebRtcUnavailable(reason: string, error?: unknown) {\n    if (this.webrtcUnavailable) {\n      return;\n    }\n    this.webrtcUnavailable = true;\n    if (error) {\n      this.options.log?.(\"P2P_UNAVAILABLE\", { reason, error });\n      return;\n    }\n    this.options.log?.(\"P2P_UNAVAILABLE\", { reason });\n  }\n}\n","import { encode, decode } from \"@msgpack/msgpack\";\nimport shortid from \"shortid\";\nimport { deflate, inflate } from \"pako\";\n\nexport const STREAM_PROTOCOL_VERSION = 1;\nexport const STREAM_EVENT = \"ext_stream\";\nexport const STREAM_CHUNK_EVENT = \"ext_stream_chunk\";\nexport const STREAM_DEFAULT_CHUNK_SIZE = 16000;\nexport const STREAM_DEFAULT_COMPRESS_THRESHOLD = 512;\nexport const STREAM_CHUNK_TTL_MS = 15000;\nexport const STREAM_MAX_TOPIC_LENGTH = 128;\n\nexport type StreamEncoding = \"msgpack\" | \"json\";\nexport type StreamCompression = \"none\" | \"deflate\";\n\nexport type StreamChunk = {\n  index: number;\n  total: number;\n};\n\nexport type StreamEnvelope = {\n  v: number;\n  id: string;\n  topic: string;\n  enc: StreamEncoding;\n  comp: StreamCompression;\n  size: number;\n  ts: number;\n  data: Uint8Array;\n  chunk?: StreamChunk;\n  meta?: Record<string, any>;\n  from?: string;\n};\n\nexport type StreamSendOptions = {\n  encoding?: StreamEncoding;\n  compressThreshold?: number;\n  chunkSize?: number;\n  includeSelf?: boolean;\n  id?: string;\n  meta?: Record<string, any>;\n};\n\nexport type StreamDecoded = {\n  id: string;\n  topic: string;\n  data: any;\n  meta?: Record<string, any>;\n  from?: string;\n};\n\nconst topicRegex = /^[A-Za-z0-9][A-Za-z0-9._-]{0,127}$/;\n\nconst textEncoder = new TextEncoder();\nconst textDecoder = new TextDecoder();\n\nexport const isValidStreamTopic = (topic: string) =>\n  typeof topic === \"string\" &&\n  topic.length > 0 &&\n  topic.length <= STREAM_MAX_TOPIC_LENGTH &&\n  topicRegex.test(topic);\n\nconst encodeData = (data: any, encoding: StreamEncoding): Uint8Array => {\n  if (encoding === \"json\") {\n    return textEncoder.encode(JSON.stringify(data));\n  }\n  return encode(data);\n};\nexport const decodeData = (data: Uint8Array, encoding: StreamEncoding) => {\n  if (encoding === \"json\") {\n    const text = textDecoder.decode(data);\n    return JSON.parse(text);\n  }\n  return decode(data);\n};\n\nconst coerceUint8Array = (data: unknown): Uint8Array | null => {\n  if (data instanceof Uint8Array) {\n    return data;\n  }\n  if (Array.isArray(data)) {\n    return Uint8Array.from(data as number[]);\n  }\n  if (data && typeof data === \"object\") {\n    if (\"buffer\" in data && (data as any).buffer instanceof ArrayBuffer) {\n      return new Uint8Array((data as any).buffer);\n    }\n    const values = Object.values(data as Record<string, unknown>);\n    if (values.length > 0 && values.every(value => typeof value === \"number\")) {\n      return Uint8Array.from(values as number[]);\n    }\n  }\n  return null;\n};\nexport const normalizeIncomingEnvelope = (payload: any): StreamEnvelope | null => {\n  if (!payload || typeof payload !== \"object\") {\n    return null;\n  }\n\n  const {\n    v,\n    id,\n    topic,\n    enc,\n    comp,\n    size,\n    ts,\n    data,\n    chunk,\n    meta,\n    from,\n  } = payload as StreamEnvelope;\n\n  if (v !== STREAM_PROTOCOL_VERSION) {\n    return null;\n  }\n  if (typeof id !== \"string\" || !isValidStreamTopic(topic)) {\n    return null;\n  }\n  if (enc !== \"msgpack\" && enc !== \"json\") {\n    return null;\n  }\n  if (comp !== \"none\" && comp !== \"deflate\") {\n    return null;\n  }\n  if (typeof size !== \"number\" || !Number.isFinite(size) || size <= 0) {\n    return null;\n  }\n\n  const normalizedData = coerceUint8Array(data);\n  if (!normalizedData) {\n    return null;\n  }\n\n  let normalizedChunk: StreamChunk | undefined;\n  if (chunk !== undefined) {\n    if (\n      typeof chunk !== \"object\" ||\n      typeof chunk.index !== \"number\" ||\n      typeof chunk.total !== \"number\" ||\n      chunk.total <= 0 ||\n      chunk.index < 0 ||\n      chunk.index >= chunk.total\n    ) {\n      return null;\n    }\n    normalizedChunk = { index: chunk.index, total: chunk.total };\n  }\n\n  const normalizedMeta =\n    meta && typeof meta === \"object\" ? (meta as Record<string, any>) : undefined;\n  const normalizedFrom = typeof from === \"string\" ? from : undefined;\n  const normalizedTs =\n    typeof ts === \"number\" && Number.isFinite(ts) ? ts : Date.now();\n\n  return {\n    v,\n    id,\n    topic,\n    enc,\n    comp,\n    size,\n    ts: normalizedTs,\n    data: normalizedData,\n    chunk: normalizedChunk,\n    meta: normalizedMeta,\n    from: normalizedFrom,\n  };\n};\nexport const buildStreamFrames = (\n  topic: string,\n  data: any,\n  options?: StreamSendOptions\n): StreamEnvelope[] => {\n  const encoding = options?.encoding ?? \"msgpack\";\n  const id = options?.id ?? shortid.generate();\n  const ts = Date.now();\n  const raw = encodeData(data, encoding);\n  const size = raw.byteLength;\n  const compressThreshold =\n    options?.compressThreshold ?? STREAM_DEFAULT_COMPRESS_THRESHOLD;\n  let comp: StreamCompression = \"none\";\n  let payload = raw;\n\n  if (compressThreshold >= 0 && raw.byteLength >= compressThreshold) {\n    payload = deflate(raw);\n    comp = \"deflate\";\n  }\n\n  const chunkSize = options?.chunkSize ?? STREAM_DEFAULT_CHUNK_SIZE;\n  const meta = options?.includeSelf\n    ? { ...(options?.meta || {}), includeSelf: true }\n    : options?.meta;\n\n  if (payload.byteLength <= chunkSize) {\n    return [\n      {\n        v: STREAM_PROTOCOL_VERSION,\n        id,\n        topic,\n        enc: encoding,\n        comp,\n        size,\n        ts,\n        data: payload,\n        meta,\n      },\n    ];\n  }\n\n  const total = Math.ceil(payload.byteLength / chunkSize) || 1;\n  const frames: StreamEnvelope[] = [];\n  for (let index = 0; index < total; index++) {\n    const start = index * chunkSize;\n    const end = Math.min(start + chunkSize, payload.byteLength);\n    const slice = payload.slice(start, end);\n    frames.push({\n      v: STREAM_PROTOCOL_VERSION,\n      id,\n      topic,\n      enc: encoding,\n      comp,\n      size,\n      ts,\n      data: slice,\n      chunk: { index, total },\n      meta,\n    });\n  }\n\n  return frames;\n};\nexport const decodeStreamEnvelope = (\n  envelope: StreamEnvelope,\n  dataOverride?: Uint8Array\n): StreamDecoded => {\n  const payload = dataOverride ?? envelope.data;\n  const decompressed = envelope.comp === \"deflate\" ? inflate(payload) : payload;\n  const decoded = decodeData(decompressed, envelope.enc);\n  return {\n    id: envelope.id,\n    topic: envelope.topic,\n    data: decoded,\n    meta: envelope.meta,\n    from: envelope.from,\n  };\n};\n","import io, { Socket } from \"socket.io-client\";\nimport msgParser from \"socket.io-msgpack-parser\";\nimport { EventEmitter } from \"events\";\nimport { encode, decode } from \"@msgpack/msgpack\";\nimport shortid from \"shortid\";\nimport { deflate, inflate } from \"pako\";\n\nimport { omit } from \"../helpers/shared\";\nimport AssetTransport from \"./AssetTransport\";\nimport {\n  STREAM_CHUNK_EVENT,\n  STREAM_CHUNK_TTL_MS,\n  STREAM_EVENT,\n  StreamDecoded,\n  StreamEnvelope,\n  StreamSendOptions,\n  buildStreamFrames,\n  decodeStreamEnvelope,\n  isValidStreamTopic,\n  normalizeIncomingEnvelope,\n} from \"./StreamProtocol\";\n\nconst MAX_CHUNK_SIZE = 16000;\n\ntype RelayChunkPayload = {\n  from: string;\n  chunkId: string;\n  index: number;\n  total: number;\n  data: Uint8Array;\n};\n\ntype OutgoingChunkPayload = {\n  chunkId: string;\n  index: number;\n  total: number;\n  data: Uint8Array;\n};\n\ntype IncomingChunk = {\n  buffers: (Uint8Array | undefined)[];\n  count: number;\n  total: number;\n};\n\ntype IncomingStreamChunk = {\n  buffers: (Uint8Array | undefined)[];\n  count: number;\n  total: number;\n  expiresAt: number;\n  envelope: StreamEnvelope;\n};\n\nexport type SessionPeer = {\n  id: string;\n};\n\nexport type PeerData = any;\n\nexport type PeerReply = (id: string, data: PeerData, chunkId?: string) => void;\n\nexport type PeerDataEvent = {\n  peer: SessionPeer;\n  id: string;\n  data: PeerData;\n  reply: PeerReply;\n};\n\nexport type PeerDataProgressEvent = {\n  peer: SessionPeer;\n  id: string;\n  count: number;\n  total: number;\n  reply: PeerReply;\n};\n\nexport type StreamEvent = StreamDecoded;\nexport type StreamEventHandler = (event: StreamEvent) => void;\n\nexport type SessionStatus =\n  | \"ready\"\n  | \"joining\"\n  | \"joined\"\n  | \"offline\"\n  | \"reconnecting\"\n  | \"auth\"\n  | \"needs_update\";\nexport type SessionStatusHandler = (status: SessionStatus) => void;\n\nexport type PlayerJoinedHandler = (id: string) => void;\nexport type PlayerLeftHandler = (id: string) => void;\nexport type GameExpiredHandler = () => void;\n\nclass Session extends EventEmitter {\n  socket?: Socket;\n  private _incomingChunks: Record<string, IncomingChunk>;\n  private _incomingStreamChunks: Record<string, IncomingStreamChunk>;\n  private _gameId: string;\n  private _password: string;\n  private peers: Record<string, SessionPeer>;\n  private assetTransport: AssetTransport;\n  private streamDebugEnabled: boolean;\n\n  constructor() {\n    super();\n    this._incomingChunks = {};\n    this._incomingStreamChunks = {};\n    this._gameId = \"\";\n    this._password = \"\";\n    this.peers = {};\n    this.streamDebugEnabled = false;\n    this.assetTransport = new AssetTransport({\n      getLocalId: () => this.socket?.id,\n      sendSignal: (event, payload) => {\n        this.socket?.emit(event, payload);\n      },\n      onPeerData: event => this.emit(\"peerData\", event),\n      onPeerDataProgress: event => this.emit(\"peerDataProgress\", event),\n      log: (message, payload) => {\n        console.info(message, payload);\n      },\n    });\n    this.installStreamDebugConsole();\n  }\n\n  get id() {\n    return this.socket?.id;\n  }\n\n  async connect() {\n    try {\n      if (\n        !process.env.REACT_APP_BROKER_URL ||\n        process.env.REACT_APP_MAINTENANCE === \"true\"\n      ) {\n        this.emit(\"status\", \"offline\");\n        return;\n      }\n\n      this.socket = io(process.env.REACT_APP_BROKER_URL!, {\n        withCredentials: true,\n        parser: msgParser,\n        transports: [\"websocket\"],\n      });\n\n      this.registerSocketHandlers();\n      this.emit(\"status\", \"ready\");\n    } catch (error: any) {\n      this.emit(\"status\", \"offline\");\n    }\n  }\n\n  disconnect() {\n    this.socket?.disconnect();\n    this.socket = undefined;\n    this._incomingChunks = {};\n    this._incomingStreamChunks = {};\n    this.peers = {};\n    this.assetTransport.dispose();\n  }\n\n  joinGame(gameId: string, password: string) {\n    if (typeof gameId !== \"string\" || typeof password !== \"string\") {\n      console.error(\n        \"Unable to join game: invalid game ID or password\",\n        gameId,\n        password\n      );\n      return;\n    }\n\n    this._gameId = gameId;\n    this._password = password;\n\n    this.socket?.emit(\n      \"join_game\",\n      gameId,\n      password,\n      process.env.REACT_APP_VERSION\n    );\n    this.emit(\"status\", \"joining\");\n  }\n\n  sendTo(sessionId: string, eventId: string, data: PeerData, chunkId?: string) {\n    if (!this.socket || !sessionId) {\n      return;\n    }\n\n    try {\n      const message = encode({ id: eventId, data });\n      const compressed = deflate(message);\n      const id = chunkId || shortid.generate();\n      const chunks = this.chunk(compressed, id);\n\n      for (let chunk of chunks) {\n        this.socket.emit(\"relay_chunk\", {\n          to: sessionId,\n          ...chunk,\n        });\n      }\n    } catch (error) {\n      console.error(\"SESSION_SEND_ERROR\", error);\n    }\n  }\n\n  async sendAssetTo(\n    sessionId: string,\n    eventId: string,\n    data: PeerData,\n    chunkId?: string,\n    options?: { allowRelayFallback?: boolean; timeoutMs?: number }\n  ) {\n    if (!sessionId) {\n      return false;\n    }\n    const allowRelayFallback = options?.allowRelayFallback !== false;\n    if (!this.assetTransport.isAvailable()) {\n      this.sendTo(sessionId, eventId, data, chunkId);\n      console.info(\"ASSET_SEND_MODE_RELAY_NO_P2P\", {\n        sessionId,\n        eventId,\n        chunkId,\n        allowRelayFallback,\n      });\n      return false;\n    }\n    console.info(\"ASSET_SEND_TRY_P2P\", { sessionId, eventId, chunkId });\n    const sentViaP2P = await this.assetTransport.send(\n      sessionId,\n      eventId,\n      data,\n      chunkId,\n      { timeoutMs: options?.timeoutMs }\n    );\n    if (sentViaP2P) {\n      console.info(\"ASSET_SEND_MODE_P2P\", { sessionId, eventId, chunkId });\n      return true;\n    }\n\n    if (allowRelayFallback) {\n      this.sendTo(sessionId, eventId, data, chunkId);\n      console.info(\"ASSET_SEND_MODE_RELAY\", { sessionId, eventId, chunkId });\n      return false;\n    }\n\n    console.info(\"ASSET_SEND_P2P_FAILED_NO_RELAY\", {\n      sessionId,\n      eventId,\n      chunkId,\n    });\n    return sentViaP2P;\n  }\n\n  sendStream(topic: string, data: any, options?: StreamSendOptions) {\n    if (!this.socket) {\n      return;\n    }\n    if (!isValidStreamTopic(topic)) {\n      console.warn(\"STREAM_INVALID_TOPIC\", topic);\n      return;\n    }\n    try {\n      const frames = buildStreamFrames(topic, data, options);\n      for (let frame of frames) {\n        const eventName =\n          frame.chunk && frame.chunk.total > 1 ? STREAM_CHUNK_EVENT : STREAM_EVENT;\n        this.socket.emit(eventName, frame);\n      }\n    } catch (error) {\n      console.error(\"STREAM_SEND_ERROR\", error);\n    }\n  }\n\n  onStream(topic: string, handler: StreamEventHandler) {\n    if (!isValidStreamTopic(topic)) {\n      console.warn(\"STREAM_INVALID_TOPIC\", topic);\n      return;\n    }\n    this.on(`stream:${topic}`, handler);\n  }\n\n  private chunk(data: Uint8Array, chunkId: string): OutgoingChunkPayload[] {\n    const size = data.byteLength;\n    const total = Math.ceil(size / MAX_CHUNK_SIZE) || 1;\n    const chunks: OutgoingChunkPayload[] = [];\n\n    for (let index = 0; index < total; index++) {\n      const start = index * MAX_CHUNK_SIZE;\n      const end = Math.min(start + MAX_CHUNK_SIZE, size);\n      const slice = data.slice(start, end);\n      chunks.push({ chunkId, index, total, data: slice });\n    }\n\n    return chunks;\n  }\n\n  private registerSocketHandlers() {\n    if (!this.socket) {\n      return;\n    }\n\n    this.socket.on(\"player_joined\", this.handlePlayerJoined);\n    this.socket.on(\"player_left\", this.handlePlayerLeft);\n    this.socket.on(\"joined_game\", this.handleJoinedGame);\n    this.socket.on(\"auth_error\", this.handleAuthError);\n    this.socket.on(\"game_expired\", this.handleGameExpired);\n    this.socket.on(\"disconnect\", this.handleSocketDisconnect);\n    this.socket.io.on(\"reconnect\", this.handleSocketReconnect);\n    this.socket.on(\"force_update\", this.handleForceUpdate);\n    this.socket.on(\"relay_chunk\", this.handleRelayChunk);\n    this.socket.on(STREAM_EVENT, this.handleStreamEnvelope);\n    this.socket.on(STREAM_CHUNK_EVENT, this.handleStreamEnvelope);\n    this.socket.on(\"webrtc_offer\", this.handleWebRtcOffer);\n    this.socket.on(\"webrtc_answer\", this.handleWebRtcAnswer);\n    this.socket.on(\"webrtc_ice\", this.handleWebRtcIce);\n  }\n\n  private handlePlayerJoined = (id: string) => {\n    this.peers[id] = { id };\n    this.emit(\"playerJoined\", id);\n  };\n\n  private handlePlayerLeft = (id: string) => {\n    if (id in this.peers) {\n      this.peers = omit(this.peers, [id]);\n    }\n    this.assetTransport.removePeer(id);\n    this.emit(\"playerLeft\", id);\n    this.cleanupIncomingChunks(id);\n    this.cleanupIncomingStreamChunks(id);\n  };\n\n  private handleJoinedGame = () => {\n    this.emit(\"status\", \"joined\");\n  };\n\n  private handleGameExpired = () => {\n    this.emit(\"gameExpired\");\n  };\n\n  private handleAuthError = () => {\n    this.emit(\"status\", \"auth\");\n  };\n\n  private handleForceUpdate = () => {\n    this.socket?.disconnect();\n    this.emit(\"status\", \"needs_update\");\n  };\n\n  private handleSocketDisconnect = () => {\n    this.emit(\"status\", \"reconnecting\");\n    this._incomingChunks = {};\n    this._incomingStreamChunks = {};\n    this.peers = {};\n    this.assetTransport.dispose();\n  };\n\n  private handleSocketReconnect = () => {\n    if (this.socket) {\n      this.socket.sendBuffer = [];\n    }\n    if (this._gameId) {\n      this.joinGame(this._gameId, this._password);\n    }\n  };\n\n  private handleRelayChunk = (payload: RelayChunkPayload) => {\n    if (!payload || typeof payload.from !== \"string\") {\n      return;\n    }\n    const { from, chunkId, index, total } = payload;\n    let { data } = payload;\n\n    if (!(data instanceof Uint8Array)) {\n      if (Array.isArray(data)) {\n        data = Uint8Array.from(data);\n      } else if (data && typeof data === \"object\" && \"buffer\" in data) {\n        data = new Uint8Array((data as any).buffer);\n      } else if (data && typeof data === \"object\") {\n        // msgpack may serialize Uint8Array as plain object {0: x, 1: y, ...}\n        const values = Object.values(data);\n        if (values.length > 0 && values.every(v => typeof v === \"number\")) {\n          data = Uint8Array.from(values as number[]);\n        } else {\n          return;\n        }\n      } else {\n        return;\n      }\n    }\n\n    const key = `${from}:${chunkId}`;\n    let chunkState = this._incomingChunks[key];\n    if (!chunkState || chunkState.total !== total) {\n      chunkState = {\n        buffers: new Array(total),\n        count: 0,\n        total,\n      };\n    }\n\n    if (!chunkState.buffers[index]) {\n      chunkState.count += 1;\n    }\n    chunkState.buffers[index] = data;\n    this._incomingChunks[key] = chunkState;\n\n    const reply: PeerReply = (id, replyData, replyChunkId) => {\n      this.sendTo(from, id, replyData, replyChunkId);\n    };\n\n    this.emit(\"peerDataProgress\", {\n      peer: { id: from },\n      id: chunkId,\n      count: chunkState.count,\n      total: chunkState.total,\n      reply,\n    });\n\n    if (chunkState.count === chunkState.total) {\n      try {\n        const merged = this.mergeChunks(chunkState.buffers);\n        const decompressed = inflate(merged);\n        const decoded = decode(decompressed) as { id: string; data: PeerData };\n        if (decoded?.id && decoded.id.startsWith(\"asset\")) {\n          console.info(\"ASSET_RECEIVE_MODE_RELAY\", {\n            sessionId: from,\n            eventId: decoded.id,\n          });\n        }\n        this.emit(\"peerData\", {\n          peer: { id: from },\n          id: decoded.id,\n          data: decoded.data,\n          reply,\n        });\n      } catch (error) {\n        console.error(\"SESSION_RELAY_DECODE_ERROR\", error);\n      } finally {\n        delete this._incomingChunks[key];\n      }\n    }\n  };\n\n  private handleStreamEnvelope = (payload: any) => {\n    const envelope = normalizeIncomingEnvelope(payload);\n    if (!envelope) {\n      return;\n    }\n\n    const from = envelope.from || \"unknown\";\n    if (envelope.chunk && envelope.chunk.total > 1) {\n      const { index, total } = envelope.chunk;\n      const key = `${from}:${envelope.id}`;\n      const now = Date.now();\n      let chunkState = this._incomingStreamChunks[key];\n      if (!chunkState || chunkState.total !== total || chunkState.expiresAt <= now) {\n        chunkState = {\n          buffers: new Array(total),\n          count: 0,\n          total,\n          expiresAt: now + STREAM_CHUNK_TTL_MS,\n          envelope,\n        };\n      }\n\n      if (!chunkState.buffers[index]) {\n        chunkState.count += 1;\n      }\n      chunkState.buffers[index] = envelope.data;\n      this._incomingStreamChunks[key] = chunkState;\n\n      if (chunkState.count === chunkState.total) {\n        try {\n          const merged = this.mergeChunks(chunkState.buffers);\n          const decoded = decodeStreamEnvelope(envelope, merged);\n          this.emitStream(decoded);\n        } catch (error) {\n          console.error(\"STREAM_DECODE_ERROR\", error);\n        } finally {\n          delete this._incomingStreamChunks[key];\n        }\n      }\n      return;\n    }\n\n    try {\n      const decoded = decodeStreamEnvelope(envelope);\n      this.emitStream(decoded);\n    } catch (error) {\n      console.error(\"STREAM_DECODE_ERROR\", error);\n    }\n  };\n\n  private emitStream = (event: StreamDecoded) => {\n    if (event.meta?.debug) {\n      console.info(\"STREAM_DEBUG_REMOTE\", {\n        topic: event.topic,\n        from: event.from,\n        id: event.id,\n        data: event.data,\n      });\n    }\n    if (this.streamDebugEnabled) {\n      console.info(\"STREAM_DEBUG_RECEIVE\", {\n        topic: event.topic,\n        from: event.from,\n        id: event.id,\n        data: event.data,\n        meta: event.meta,\n      });\n    }\n    this.emit(\"stream\", event);\n    this.emit(`stream:${event.topic}`, event);\n  };\n\n  private enableStreamDebug = () => {\n    if (this.streamDebugEnabled) {\n      return;\n    }\n    this.streamDebugEnabled = true;\n    console.info(\"STREAM_DEBUG_ENABLED\");\n  };\n\n  private disableStreamDebug = () => {\n    if (!this.streamDebugEnabled) {\n      return;\n    }\n    this.streamDebugEnabled = false;\n    console.info(\"STREAM_DEBUG_DISABLED\");\n  };\n\n  private installStreamDebugConsole() {\n    if (typeof window === \"undefined\") {\n      return;\n    }\n    const globalScope = window as any;\n    if (globalScope.OBRStreamDebug?.__attached) {\n      globalScope.OBRStreamDebug.__session = this;\n      return;\n    }\n    globalScope.OBRStreamDebug = {\n      __attached: true,\n      __session: this,\n      enable: () => this.enableStreamDebug(),\n      disable: () => this.disableStreamDebug(),\n      send: (topic: string, data: any, options?: StreamSendOptions) => {\n        const meta = { ...(options?.meta || {}), debug: true };\n        this.sendStream(topic, data, { ...options, meta });\n      },\n      status: () => this.streamDebugEnabled,\n      help: () => {\n        console.info(\"OBRStreamDebug.enable()\");\n        console.info(\"OBRStreamDebug.send(\\\"ext.debug\\\", { hello: true })\");\n        console.info(\"OBRStreamDebug.disable()\");\n      },\n    };\n  }\n\n  private handleWebRtcOffer = (payload: any) => {\n    this.assetTransport.handleOffer(payload);\n  };\n\n  private handleWebRtcAnswer = (payload: any) => {\n    this.assetTransport.handleAnswer(payload);\n  };\n\n  private handleWebRtcIce = (payload: any) => {\n    this.assetTransport.handleIce(payload);\n  };\n\n  private mergeChunks(buffers: (Uint8Array | undefined)[]) {\n    const totalLength = buffers.reduce((acc, buf) => {\n      if (!buf) {\n        return acc;\n      }\n      return acc + buf.byteLength;\n    }, 0);\n    const merged = new Uint8Array(totalLength);\n    let offset = 0;\n    for (let i = 0; i < buffers.length; i++) {\n      const buffer = buffers[i];\n      if (!buffer) {\n        continue;\n      }\n      merged.set(buffer, offset);\n      offset += buffer.byteLength;\n    }\n    return merged;\n  }\n\n  private cleanupIncomingChunks(peerId: string) {\n    for (let key of Object.keys(this._incomingChunks)) {\n      if (key.startsWith(`${peerId}:`)) {\n        delete this._incomingChunks[key];\n      }\n    }\n  }\n\n  private cleanupIncomingStreamChunks(peerId: string) {\n    for (let key of Object.keys(this._incomingStreamChunks)) {\n      if (key.startsWith(`${peerId}:`)) {\n        delete this._incomingStreamChunks[key];\n      }\n    }\n  }\n}\n\ndeclare interface Session {\n  on(event: \"peerData\", listener: (event: PeerDataEvent) => void): this;\n  on(event: \"peerDataProgress\", listener: (event: PeerDataProgressEvent) => void): this;\n  on(event: \"stream\", listener: StreamEventHandler): this;\n  on(event: `stream:${string}`, listener: StreamEventHandler): this;\n  on(event: \"status\", listener: SessionStatusHandler): this;\n  on(event: \"playerJoined\", listener: PlayerJoinedHandler): this;\n  on(event: \"playerLeft\", listener: PlayerLeftHandler): this;\n  on(event: \"gameExpired\", listener: GameExpiredHandler): this;\n\n  off(event: \"peerData\", listener: (event: PeerDataEvent) => void): this;\n  off(event: \"peerDataProgress\", listener: (event: PeerDataProgressEvent) => void): this;\n  off(event: \"stream\", listener: StreamEventHandler): this;\n  off(event: `stream:${string}`, listener: StreamEventHandler): this;\n  off(event: \"status\", listener: SessionStatusHandler): this;\n  off(event: \"playerJoined\", listener: PlayerJoinedHandler): this;\n  off(event: \"playerLeft\", listener: PlayerLeftHandler): this;\n  off(event: \"gameExpired\", listener: GameExpiredHandler): this;\n}\n\nexport default Session;\n","import { useState, useEffect, useRef } from \"react\";\nimport { Flex } from \"theme-ui\";\nimport { useParams } from \"react-router-dom\";\nimport Konva from \"konva\";\n\nimport ReconnectBanner from \"../components/banner/ReconnectBanner\";\nimport OfflineBanner from \"../components/banner/OfflineBanner\";\nimport LoadingOverlay from \"../components/LoadingOverlay\";\nimport MapLoadingOverlay from \"../components/map/MapLoadingOverlay\";\nimport UpgradingLoadingOverlay from \"../components/UpgradingLoadingOverlay\";\n\nimport AuthModal from \"../modals/AuthModal\";\nimport GameExpiredModal from \"../modals/GameExpiredModal\";\nimport ForceUpdateModal from \"../modals/ForceUpdateModal\";\nimport MaintenanceModal from \"../modals/MaintenanceModal\";\n\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { MapStageProvider } from \"../contexts/MapStageContext\";\nimport { useDatabase } from \"../contexts/DatabaseContext\";\nimport { PlayerProvider } from \"../contexts/PlayerContext\";\nimport { PartyProvider } from \"../contexts/PartyContext\";\nimport { AssetsProvider, AssetURLsProvider } from \"../contexts/AssetsContext\";\nimport { MapDataProvider } from \"../contexts/MapDataContext\";\nimport { TokenDataProvider } from \"../contexts/TokenDataContext\";\nimport { MapLoadingProvider } from \"../contexts/MapLoadingContext\";\n\nimport NetworkedMapAndTokens from \"../network/NetworkedMapAndTokens\";\nimport NetworkedParty from \"../network/NetworkedParty\";\n\nimport Session, { SessionStatus } from \"../network/Session\";\n\nfunction Game() {\n  const { id: gameId }: { id: string } = useParams();\n  const { password } = useAuth();\n  const { databaseStatus } = useDatabase();\n\n  const [session] = useState(new Session());\n  const [sessionStatus, setSessionStatus] = useState<SessionStatus>();\n\n  const [maintenance, setMaintenance] = useState(\n    process.env.REACT_APP_MAINTENANCE === \"true\"\n  );\n\n  useEffect(() => {\n    function handleStatus(status: SessionStatus) {\n      setSessionStatus(status);\n    }\n\n    session.on(\"status\", handleStatus);\n\n    return () => {\n      session.off(\"status\", handleStatus);\n    };\n  }, [session]);\n\n  const [gameExpired, setGameExpired] = useState(false);\n  useEffect(() => {\n    function handleGameExpired() {\n      setGameExpired(true);\n    }\n\n    session.on(\"gameExpired\", handleGameExpired);\n\n    return () => {\n      session.off(\"gameExpired\", handleGameExpired);\n    };\n  }, [session]);\n\n  // Join game\n  useEffect(() => {\n    if (\n      sessionStatus === \"ready\" &&\n      (databaseStatus === \"loaded\" || databaseStatus === \"disabled\")\n    ) {\n      session.joinGame(gameId, password);\n    }\n  }, [gameId, password, databaseStatus, session, sessionStatus]);\n\n  function handleAuthSubmit(newPassword: string) {\n    if (databaseStatus === \"loaded\" || databaseStatus === \"disabled\") {\n      session.joinGame(gameId, newPassword);\n    }\n  }\n\n  useEffect(() => {\n    async function connect() {\n      await session.connect();\n    }\n    connect();\n\n    return () => {\n      session.disconnect();\n    };\n  }, [session]);\n\n  // A ref to the Konva stage\n  // the ref will be assigned in the MapInteraction component\n  const mapStageRef = useRef<Konva.Stage | null>(null);\n\n  return (\n    <AssetsProvider gameId={gameId}>\n      <AssetURLsProvider>\n        <MapLoadingProvider>\n          <MapDataProvider>\n            <TokenDataProvider>\n              <PlayerProvider session={session}>\n                <PartyProvider session={session}>\n                  <MapStageProvider value={mapStageRef}>\n                    <Flex\n                      sx={{\n                        justifyContent: \"space-between\",\n                        flexGrow: 1,\n                        height: \"100%\",\n                      }}\n                    >\n                      <NetworkedParty session={session} gameId={gameId} />\n                      <NetworkedMapAndTokens session={session} gameId={gameId} />\n                    </Flex>\n                    <OfflineBanner isOpen={sessionStatus === \"offline\"} />\n                    <ReconnectBanner\n                      isOpen={sessionStatus === \"reconnecting\"}\n                    />\n                    <AuthModal\n                      isOpen={sessionStatus === \"auth\"}\n                      onSubmit={handleAuthSubmit}\n                    />\n                    <GameExpiredModal\n                      isOpen={gameExpired}\n                      onRequestClose={() => setGameExpired(false)}\n                    />\n                    <ForceUpdateModal\n                      isOpen={sessionStatus === \"needs_update\"}\n                    />\n                    {!sessionStatus && <LoadingOverlay />}\n                    {sessionStatus && databaseStatus === \"upgrading\" && (\n                      <UpgradingLoadingOverlay />\n                    )}\n                    <MaintenanceModal\n                      isOpen={maintenance}\n                      onRequestClose={() => setMaintenance(false)}\n                    />\n                    <MapLoadingOverlay />\n                  </MapStageProvider>\n                </PartyProvider>\n              </PlayerProvider>\n            </TokenDataProvider>\n          </MapDataProvider>\n        </MapLoadingProvider>\n      </AssetURLsProvider>\n    </AssetsProvider>\n  );\n}\n\nexport default Game;\n","import { Flex, Text, Link as ExternalLink } from \"theme-ui\";\n\nimport Footer from \"../components/Footer\";\n\nfunction About() {\n  return (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"100%\",\n        alignItems: \"center\",\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          maxWidth: \"350px\",\n          flexGrow: 1,\n        }}\n        m={4}\n      >\n        <Text my={2} variant=\"heading\" as=\"h1\" sx={{ fontSize: 5 }}>\n          About <span aria-hidden=\"true\"></span>\n        </Text>\n        <Text my={1} mt={2} variant=\"heading\" as=\"h3\" sx={{ fontSize: 3 }}>\n          The Goal\n        </Text>\n        <Text variant=\"body2\" as=\"p\">\n          Owlbear Rodeo is an attempt to make a web app to run tabletop\n          encounters without the complicated setup process needed for other\n          VTTs.\n        </Text>\n        <Text my={1} mt={2} variant=\"heading\" as=\"h3\" sx={{ fontSize: 3 }}>\n          The People\n        </Text>\n        <Text variant=\"body2\" as=\"p\">\n          Made by two people in Melbourne, Australia.{\" \"}\n          <ExternalLink href=\"https://mitchmccaffrey.com/\">Mitch</ExternalLink>{\" \"}\n          and{\" \"}\n          <ExternalLink href=\"https://twitter.com/nthouliss\">\n            Nicola\n          </ExternalLink>{\" \"}\n          were looking for an easy way to continue their d{\"&\"}d campaign as\n          in-person interaction becomes harder during the COVID-19 crisis.\n        </Text>\n        <Text my={1} mt={2} variant=\"heading\" as=\"h3\" sx={{ fontSize: 3 }}>\n          Contact\n        </Text>\n        <Text variant=\"body2\" as=\"p\">\n          For questions or feedback email{\" \"}\n          <ExternalLink href=\"mailto:support@owlbear.rodeo\">\n            support@owlbear.rodeo\n          </ExternalLink>\n        </Text>\n      </Flex>\n      <Footer />\n    </Flex>\n  );\n}\n\nexport default About;\n","import defaultMaps from \"./DefaultMaps.mp4\";\nimport customMaps from \"./CustomMaps.mp4\";\nimport editingMapsAdvanced from \"./EditingMapsAdvanced.jpg\";\nimport resetAndRemovingMaps from \"./ResetAndRemovingMaps.mp4\";\nimport usingDrawing from \"./UsingDrawing.mp4\";\nimport openDiceTray from \"./OpenDiceTray.mp4\";\nimport diceRolling from \"./DiceRolling.mp4\";\nimport diceStyles from \"./DiceStyles.mp4\";\nimport diceTraySize from \"./DiceTraySize.mp4\";\nimport usingFog from \"./UsingFog.mp4\";\nimport usingMeasure from \"./UsingMeasure.mp4\";\nimport defaultTokens from \"./DefaultTokens.mp4\";\nimport workingWithTokens from \"./WorkingWithTokens.mp4\";\nimport deletingTokens from \"./DeletingTokens.mp4\";\nimport customTokens from \"./CustomTokens.mp4\";\nimport tokenEditor from \"./TokenEditor.mp4\";\nimport addPartyMember from \"./AddPartyMember.mp4\";\nimport changeNickname from \"./ChangeNickname.mp4\";\nimport sharingAudio from \"./SharingAudio.mp4\";\nimport startGame from \"./StartGame.mp4\";\nimport diceSharing from \"./DiceSharing.mp4\";\nimport usingTimer from \"./UsingTimer.mp4\";\nimport usingPointer from \"./UsingPointer.mp4\";\nimport mapEditor from \"./MapEditor.mp4\";\nimport filteringMaps from \"./FilteringMaps.mp4\";\nimport groupAndRemovingTokens from \"./GroupAndRemovingTokens.mp4\";\nimport filteringTokens from \"./FilteringTokens.mp4\";\nimport usingNotes from \"./UsingNotes.mp4\";\nimport settings from \"./Settings.jpg\";\n\nconst assets = {\n  defaultMaps,\n  customMaps,\n  editingMapsAdvanced,\n  resetAndRemovingMaps,\n  usingDrawing,\n  openDiceTray,\n  diceRolling,\n  diceStyles,\n  diceTraySize,\n  usingFog,\n  usingMeasure,\n  defaultTokens,\n  workingWithTokens,\n  deletingTokens,\n  customTokens,\n  tokenEditor,\n  addPartyMember,\n  changeNickname,\n  sharingAudio,\n  startGame,\n  diceSharing,\n  usingTimer,\n  usingPointer,\n  mapEditor,\n  filteringMaps,\n  groupAndRemovingTokens,\n  filteringTokens,\n  usingNotes,\n  settings,\n};\n\nexport default assets;\n","export default __webpack_public_path__ + \"static/media/DefaultMaps.4c4ef41e.mp4\";","export default __webpack_public_path__ + \"static/media/CustomMaps.44db03b2.mp4\";","export default __webpack_public_path__ + \"static/media/EditingMapsAdvanced.3593f8ba.jpg\";","export default __webpack_public_path__ + \"static/media/ResetAndRemovingMaps.23d7cccd.mp4\";","export default __webpack_public_path__ + \"static/media/UsingDrawing.f91521d3.mp4\";","export default __webpack_public_path__ + \"static/media/OpenDiceTray.c2970165.mp4\";","export default __webpack_public_path__ + \"static/media/DiceRolling.509696e0.mp4\";","export default __webpack_public_path__ + \"static/media/DiceStyles.db684041.mp4\";","export default __webpack_public_path__ + \"static/media/DiceTraySize.1aabefbc.mp4\";","export default __webpack_public_path__ + \"static/media/UsingFog.50a52450.mp4\";","export default __webpack_public_path__ + \"static/media/UsingMeasure.348878de.mp4\";","export default __webpack_public_path__ + \"static/media/DefaultTokens.3ce0f414.mp4\";","export default __webpack_public_path__ + \"static/media/WorkingWithTokens.2e35df9d.mp4\";","export default __webpack_public_path__ + \"static/media/DeletingTokens.994008cb.mp4\";","export default __webpack_public_path__ + \"static/media/CustomTokens.d5ec3482.mp4\";","export default __webpack_public_path__ + \"static/media/TokenEditor.068ab35d.mp4\";","export default __webpack_public_path__ + \"static/media/AddPartyMember.2b8d6b49.mp4\";","export default __webpack_public_path__ + \"static/media/ChangeNickname.b4d5d37e.mp4\";","export default __webpack_public_path__ + \"static/media/SharingAudio.70b067dc.mp4\";","export default __webpack_public_path__ + \"static/media/StartGame.47d4335e.mp4\";","export default __webpack_public_path__ + \"static/media/DiceSharing.c64f4786.mp4\";","export default __webpack_public_path__ + \"static/media/UsingTimer.31f46398.mp4\";","export default __webpack_public_path__ + \"static/media/UsingPointer.fd040959.mp4\";","export default __webpack_public_path__ + \"static/media/MapEditor.6f401478.mp4\";","export default __webpack_public_path__ + \"static/media/FilteringMaps.52240774.mp4\";","export default __webpack_public_path__ + \"static/media/GroupAndRemovingTokens.df37439d.mp4\";","export default __webpack_public_path__ + \"static/media/FilteringTokens.ef3c2a7f.mp4\";","export default __webpack_public_path__ + \"static/media/UsingNotes.bd7e047f.mp4\";","export default __webpack_public_path__ + \"static/media/Settings.64c09861.jpg\";","import { Flex, Text, Box } from \"theme-ui\";\nimport raw from \"raw.macro\";\n\nimport Footer from \"../components/Footer\";\nimport Markdown from \"../components/Markdown\";\n\nimport assets from \"../docs/assets\";\n\nconst database = raw(\"../docs/faq/database.md\");\nconst maps = raw(\"../docs/faq/maps.md\");\nconst audioSharing = raw(\"../docs/faq/audio-sharing.md\");\nconst general = raw(\"../docs/faq/general.md\");\nconst connection = raw(\"../docs/faq/connection.md\");\n\nfunction FAQ() {\n  return (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"100%\",\n        alignItems: \"center\",\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          maxWidth: \"500px\",\n          flexGrow: 1,\n        }}\n        m={4}\n      >\n        <Text mb={2} variant=\"heading\" as=\"h1\" sx={{ fontSize: 5 }}>\n          Frequently Asked Questions\n        </Text>\n        <Box my={1} id=\"general\">\n          <Markdown source={general} assets={assets} />\n        </Box>\n        <Box my={1} id=\"maps\">\n          <Markdown source={maps} assets={assets} />\n        </Box>\n        <Box my={1} id=\"audio-sharing\">\n          <Markdown source={audioSharing} assets={assets} />\n        </Box>\n        <Box my={1} id=\"database\">\n          <Markdown source={database} assets={assets} />\n        </Box>\n        <Box my={1} id=\"connection\">\n          <Markdown source={connection} assets={assets} />\n        </Box>\n      </Flex>\n      <Footer />\n    </Flex>\n  );\n}\n\nexport default FAQ;\n","import React, { useState } from \"react\";\nimport { Box, Flex, Text, IconButton, Divider } from \"theme-ui\";\n\nimport ExpandMoreIcon from \"../icons/ExpandMoreIcon\";\n\ntype AccordianProps = {\n  heading: string;\n  children: React.ReactNode;\n  defaultOpen: boolean;\n};\n\nfunction Accordion({ heading, children, defaultOpen }: AccordianProps) {\n  const [open, setOpen] = useState(defaultOpen);\n\n  return (\n    <Box sx={{ width: \"100%\" }}>\n      <Flex\n        sx={{ justifyContent: \"space-between\" }}\n        onClick={() => setOpen(!open)}\n        my={1}\n      >\n        <Text as=\"h1\" variant=\"heading\" sx={{ fontSize: 5 }}>\n          {heading}\n        </Text>\n        <IconButton\n          title={open ? \"Show Less\" : \"Show More\"}\n          aria-label={open ? \"Show Less\" : \"Show More\"}\n          sx={{ transform: open ? \"rotate(0deg)\" : \"rotate(180deg)\" }}\n        >\n          <ExpandMoreIcon />\n        </IconButton>\n      </Flex>\n      {open && children}\n      <Divider bg=\"text\" sx={{ opacity: 0.25 }} />\n    </Box>\n  );\n}\n\nAccordion.defaultProps = {\n  defaultOpen: false,\n};\n\nexport default Accordion;\n","import { Flex, Text } from \"theme-ui\";\nimport raw from \"raw.macro\";\nimport { useLocation } from \"react-router-dom\";\n\nimport Footer from \"../components/Footer\";\nimport Markdown from \"../components/Markdown\";\nimport Accordion from \"../components/Accordion\";\n\nconst v110 = raw(\"../docs/releaseNotes/v1.1.0.md\");\nconst v120 = raw(\"../docs/releaseNotes/v1.2.0.md\");\nconst v121 = raw(\"../docs/releaseNotes/v1.2.1.md\");\nconst v130 = raw(\"../docs/releaseNotes/v1.3.0.md\");\nconst v131 = raw(\"../docs/releaseNotes/v1.3.1.md\");\nconst v132 = raw(\"../docs/releaseNotes/v1.3.2.md\");\nconst v133 = raw(\"../docs/releaseNotes/v1.3.3.md\");\nconst v140 = raw(\"../docs/releaseNotes/v1.4.0.md\");\nconst v141 = raw(\"../docs/releaseNotes/v1.4.1.md\");\nconst v142 = raw(\"../docs/releaseNotes/v1.4.2.md\");\nconst v150 = raw(\"../docs/releaseNotes/v1.5.0.md\");\nconst v151 = raw(\"../docs/releaseNotes/v1.5.1.md\");\nconst v152 = raw(\"../docs/releaseNotes/v1.5.2.md\");\nconst v160 = raw(\"../docs/releaseNotes/v1.6.0.md\");\nconst v161 = raw(\"../docs/releaseNotes/v1.6.1.md\");\nconst v162 = raw(\"../docs/releaseNotes/v1.6.2.md\");\nconst v170 = raw(\"../docs/releaseNotes/v1.7.0.md\");\nconst v180 = raw(\"../docs/releaseNotes/v1.8.0.md\");\nconst v181 = raw(\"../docs/releaseNotes/v1.8.1.md\");\nconst v190 = raw(\"../docs/releaseNotes/v1.9.0.md\");\nconst v1100 = raw(\"../docs/releaseNotes/v1.10.0.md\");\nconst v1101 = raw(\"../docs/releaseNotes/v1.10.1.md\");\nconst v1102 = raw(\"../docs/releaseNotes/v1.10.2.md\");\n\nfunction ReleaseNotes() {\n  const location = useLocation();\n  return (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"100%\",\n        alignItems: \"center\",\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          maxWidth: \"564px\",\n          flexGrow: 1,\n          width: \"100%\",\n        }}\n        p={4}\n      >\n        <Text mb={2} variant=\"heading\" as=\"h1\" sx={{ fontSize: 5 }}>\n          Release Notes\n        </Text>\n        <div id=\"v1102\">\n          <Accordion heading=\"v1.10.2\" defaultOpen>\n            <Markdown source={v1102} />\n          </Accordion>\n        </div>\n        <div id=\"v1101\">\n          <Accordion heading=\"v1.10.1\" defaultOpen={location.hash === \"#v1101\"}>\n            <Markdown source={v1101} />\n          </Accordion>\n        </div>\n        <div id=\"v1100\">\n          <Accordion heading=\"v1.10.0\" defaultOpen={location.hash === \"#v1100\"}>\n            <Markdown source={v1100} />\n          </Accordion>\n        </div>\n        <div id=\"v190\">\n          <Accordion heading=\"v1.9.0\" defaultOpen={location.hash === \"#v190\"}>\n            <Markdown source={v190} />\n          </Accordion>\n        </div>\n        <div id=\"v181\">\n          <Accordion heading=\"v1.8.1\" defaultOpen={location.hash === \"#v181\"}>\n            <Markdown source={v181} />\n          </Accordion>\n        </div>\n        <div id=\"v180\">\n          <Accordion heading=\"v1.8.0\" defaultOpen={location.hash === \"#v180\"}>\n            <Markdown source={v180} />\n          </Accordion>\n        </div>\n        <div id=\"v170\">\n          <Accordion heading=\"v1.7.0\" defaultOpen={location.hash === \"#v170\"}>\n            <Markdown source={v170} />\n          </Accordion>\n        </div>\n        <div id=\"v162\">\n          <Accordion heading=\"v1.6.2\" defaultOpen={location.hash === \"#v162\"}>\n            <Markdown source={v162} />\n          </Accordion>\n        </div>\n        <div id=\"v161\">\n          <Accordion heading=\"v1.6.1\" defaultOpen={location.hash === \"#v161\"}>\n            <Markdown source={v161} />\n          </Accordion>\n        </div>\n        <div id=\"v160\">\n          <Accordion heading=\"v1.6.0\" defaultOpen={location.hash === \"#v160\"}>\n            <Markdown source={v160} />\n          </Accordion>\n        </div>\n        <div id=\"v152\">\n          <Accordion heading=\"v1.5.2\" defaultOpen={location.hash === \"#v152\"}>\n            <Markdown source={v152} />\n          </Accordion>\n        </div>\n        <div id=\"v151\">\n          <Accordion heading=\"v1.5.1\" defaultOpen={location.hash === \"#v151\"}>\n            <Markdown source={v151} />\n          </Accordion>\n        </div>\n        <div id=\"v150\">\n          <Accordion heading=\"v1.5.0\" defaultOpen={location.hash === \"#v150\"}>\n            <Markdown source={v150} />\n          </Accordion>\n        </div>\n        <div id=\"v142\">\n          <Accordion heading=\"v1.4.2\" defaultOpen={location.hash === \"#v142\"}>\n            <Markdown source={v142} />\n          </Accordion>\n        </div>\n        <div id=\"v141\">\n          <Accordion heading=\"v1.4.1\" defaultOpen={location.hash === \"#v141\"}>\n            <Markdown source={v141} />\n          </Accordion>\n        </div>\n        <div id=\"v140\">\n          <Accordion heading=\"v1.4.0\" defaultOpen={location.hash === \"#v140\"}>\n            <Markdown source={v140} />\n          </Accordion>\n        </div>\n        <div id=\"v133\">\n          <Accordion heading=\"v1.3.3\" defaultOpen={location.hash === \"#v133\"}>\n            <Markdown source={v133} />\n          </Accordion>\n        </div>\n        <div id=\"v132\">\n          <Accordion heading=\"v1.3.2\" defaultOpen={location.hash === \"#v132\"}>\n            <Markdown source={v132} />\n          </Accordion>\n        </div>\n        <div id=\"v131\">\n          <Accordion heading=\"v1.3.1\" defaultOpen={location.hash === \"#v131\"}>\n            <Markdown source={v131} />\n          </Accordion>\n        </div>\n        <div id=\"v130\">\n          <Accordion heading=\"v1.3.0\" defaultOpen={location.hash === \"#v130\"}>\n            <Markdown source={v130} />\n          </Accordion>\n        </div>\n        <div id=\"v121\">\n          <Accordion heading=\"v1.2.1\" defaultOpen={location.hash === \"#v121\"}>\n            <Markdown source={v121} />\n          </Accordion>\n        </div>\n        <div id=\"v120\">\n          <Accordion heading=\"v1.2.0\" defaultOpen={location.hash === \"#v120\"}>\n            <Markdown source={v120} />\n          </Accordion>\n        </div>\n        <div id=\"v110\">\n          <Accordion heading=\"v1.1.0\" defaultOpen={location.hash === \"#v110\"}>\n            <Markdown source={v110} />\n          </Accordion>\n        </div>\n      </Flex>\n      <Footer />\n    </Flex>\n  );\n}\n\nexport default ReleaseNotes;\n","import { Flex, Text } from \"theme-ui\";\nimport raw from \"raw.macro\";\nimport { useLocation } from \"react-router-dom\";\n\nimport Footer from \"../components/Footer\";\nimport Markdown from \"../components/Markdown\";\nimport Accordion from \"../components/Accordion\";\n\nimport assets from \"../docs/assets\";\n\nconst overview = raw(\"../docs/howTo/overview.md\");\nconst startingAndJoining = raw(\"../docs/howTo/startingAndJoining.md\");\nconst sharingMaps = raw(\"../docs/howTo/sharingMaps.md\");\nconst usingTokens = raw(\"../docs/howTo/usingTokens.md\");\nconst usingDrawing = raw(\"../docs/howTo/usingDrawing.md\");\nconst usingDice = raw(\"../docs/howTo/usingDice.md\");\nconst usingFog = raw(\"../docs/howTo/usingFog.md\");\nconst usingMeasure = raw(\"../docs/howTo/usingMeasure.md\");\nconst sharingAudio = raw(\"../docs/howTo/sharingAudio.md\");\nconst usingPointer = raw(\"../docs/howTo/usingPointer.md\");\nconst usingTimer = raw(\"../docs/howTo/usingTimer.md\");\nconst usingNotes = raw(\"../docs/howTo/usingNotes.md\");\nconst shortcuts = raw(\"../docs/howTo/shortcuts.md\");\nconst settings = raw(\"../docs/howTo/settings.md\");\n\nfunction HowTo() {\n  const location = useLocation();\n  return (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        minHeight: \"100%\",\n        alignItems: \"center\",\n      }}\n    >\n      <Flex\n        sx={{\n          flexDirection: \"column\",\n          maxWidth: \"564px\",\n          flexGrow: 1,\n          width: \"100%\",\n        }}\n        p={4}\n      >\n        <Text mb={2} variant=\"heading\" as=\"h1\" sx={{ fontSize: 5 }}>\n          How To\n        </Text>\n        <div id=\"overview\">\n          <Markdown source={overview} assets={assets} />\n        </div>\n        <div id=\"startingAndJoining\">\n          <Accordion\n            heading=\"Starting and Joining a Game\"\n            defaultOpen={location.hash === \"#startingAndJoining\"}\n          >\n            <Markdown source={startingAndJoining} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"sharingMaps\">\n          <Accordion\n            heading=\"Sharing a Map\"\n            defaultOpen={location.hash === \"#sharingMaps\"}\n          >\n            <Markdown source={sharingMaps} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingTokens\">\n          <Accordion\n            heading=\"Using Tokens\"\n            defaultOpen={location.hash === \"#usingTokens\"}\n          >\n            <Markdown source={usingTokens} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingDrawing\">\n          <Accordion\n            heading=\"Using the Drawing Tool\"\n            defaultOpen={location.hash === \"#usingDrawing\"}\n          >\n            <Markdown source={usingDrawing} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingDice\">\n          <Accordion\n            heading=\"Using Dice\"\n            defaultOpen={location.hash === \"#usingDice\"}\n          >\n            <Markdown source={usingDice} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingFog\">\n          <Accordion\n            heading=\"Using the Fog Tool\"\n            defaultOpen={location.hash === \"#usingFog\"}\n          >\n            <Markdown source={usingFog} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingMeasure\">\n          <Accordion\n            heading=\"Using the Measure Tool\"\n            defaultOpen={location.hash === \"#usingMeasure\"}\n          >\n            <Markdown source={usingMeasure} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingPointer\">\n          <Accordion\n            heading=\"Using the Pointer Tool\"\n            defaultOpen={location.hash === \"#usingPointer\"}\n          >\n            <Markdown source={usingPointer} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingNotes\">\n          <Accordion\n            heading=\"Using the Notes Tool\"\n            defaultOpen={location.hash === \"#usingNotes\"}\n          >\n            <Markdown source={usingNotes} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"usingTimer\">\n          <Accordion\n            heading=\"Using the Countdown Timer\"\n            defaultOpen={location.hash === \"#usingTimer\"}\n          >\n            <Markdown source={usingTimer} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"settings\">\n          <Accordion\n            heading=\"Settings\"\n            defaultOpen={location.hash === \"#settings\"}\n          >\n            <Markdown source={settings} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"sharingAudio\">\n          <Accordion\n            heading=\"Sharing Audio (Experimental)\"\n            defaultOpen={location.hash === \"#sharingAudio\"}\n          >\n            <Markdown source={sharingAudio} assets={assets} />\n          </Accordion>\n        </div>\n        <div id=\"shortcuts\">\n          <Accordion\n            heading=\"Shortcuts\"\n            defaultOpen={location.hash === \"#shortcuts\"}\n          >\n            <Markdown source={shortcuts} assets={assets} />\n          </Accordion>\n        </div>\n      </Flex>\n      <Footer />\n    </Flex>\n  );\n}\n\nexport default HowTo;\n","import React from \"react\";\nimport { Box, Text } from \"theme-ui\";\nimport { AppearanceTypes, ToastProvider as DefaultToastProvider } from \"react-toast-notifications\";\n\nfunction getToastAppearance(appearance: AppearanceTypes) {\n  let colour = \"overlay\"\n  if (appearance === \"error\") {\n    colour = \"highlight\"\n  } else if (appearance === \"info\") {\n    colour = \"overlay\"\n  } else if (appearance === \"warning\") {\n    colour = \"secondary\"\n  } else if (appearance === \"success\") {\n    colour = \"primary\"\n  }\n  return colour;\n}\n\nfunction CustomToast({ appearance, children }: { appearance: AppearanceTypes, children: React.ReactNode }) {\n  return (\n    <Box\n      m={2}\n      mb={0}\n      bg={appearance ? getToastAppearance(appearance) : \"overlay\"}\n      sx={{ borderRadius: \"4px\", padding: \"12px 16px\" }}\n    >\n      <Text as=\"p\" variant=\"body2\">\n        {children}\n      </Text>\n    </Box>\n  );\n}\n\nexport function ToastProvider({ children }: { children?: React.ReactNode }) {\n  return (\n    <DefaultToastProvider\n      components={{ Toast: CustomToast }}\n      autoDismiss={true}\n      autoDismissTimeout={2000}\n      placement=\"bottom-center\"\n    >\n      {children}\n    </DefaultToastProvider>\n  );\n}\n","import { ThemeProvider } from \"theme-ui\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\nimport theme from \"./theme\";\nimport Home from \"./routes/Home\";\nimport Game from \"./routes/Game\";\nimport About from \"./routes/About\";\nimport FAQ from \"./routes/FAQ\";\nimport ReleaseNotes from \"./routes/ReleaseNotes\";\nimport HowTo from \"./routes/HowTo\";\n\nimport { AuthProvider } from \"./contexts/AuthContext\";\nimport { SettingsProvider } from \"./contexts/SettingsContext\";\nimport { KeyboardProvider } from \"./contexts/KeyboardContext\";\nimport { DatabaseProvider } from \"./contexts/DatabaseContext\";\nimport { UserIdProvider } from \"./contexts/UserIdContext\";\n\nimport { ToastProvider } from \"./components/Toast\";\n\nfunction App() {\n  return (\n    <ThemeProvider theme={theme}>\n      <SettingsProvider>\n        <AuthProvider>\n          <KeyboardProvider>\n            <ToastProvider>\n              <Router>\n                <Switch>\n                  <Route path=\"/how-to\">\n                    <HowTo />\n                  </Route>\n                  <Route path=\"/release-notes\">\n                    <ReleaseNotes />\n                  </Route>\n                  <Route path=\"/about\">\n                    <About />\n                  </Route>\n                  <Route path=\"/faq\">\n                    <FAQ />\n                  </Route>\n                  <Route path=\"/game/:id\">\n                    <DatabaseProvider>\n                      <UserIdProvider>\n                        <Game />\n                      </UserIdProvider>\n                    </DatabaseProvider>\n                  </Route>\n                  <Route path=\"/\">\n                    <Home />\n                  </Route>\n                </Switch>\n              </Router>\n            </ToastProvider>\n          </KeyboardProvider>\n        </AuthProvider>\n      </SettingsProvider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config: any) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    if (!process.env.PUBLIC_URL) {\n      // TODO: handle is PUBLIC_URL has not been set\n      return; \n    }\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string | URL, config: any) {\n  navigator.serviceWorker\n    .register(swUrl as string)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\n// TODO: handle swUrl -> type has to be handled as RequestInfo OR string | URL\nfunction checkValidServiceWorker(swUrl: any, config: any) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import \"./polyfills/xhrResponseText\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport Modal from \"react-modal\";\n\n// Add css for simplebar\nimport \"simplebar/dist/simplebar.min.css\";\n\nimport * as serviceWorker from \"./serviceWorker\";\n\nimport \"./index.css\";\n\n// Pointer events shim\nif (!(\"PointerEvent\" in window)) {\n  import(\"pepjs\");\n}\n\n// Intersection observer polyfill\nif (!(\"IntersectionObserver\" in window)) {\n  import(\"intersection-observer\");\n}\n\nModal.setAppElement(\"#root\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import FakeStorage from \"./FakeStorage\";\n\n/**\n * An interface to a local storage backed settings store with a versioning mechanism\n */\nclass Settings {\n  name;\n  currentVersion;\n  storage;\n\n  constructor(name: string) {\n    this.name = name;\n    // Try and use local storage if it is available, if not mock it with an in memory storage\n    try {\n      localStorage.setItem(\"__test\", \"__test\");\n      localStorage.removeItem(\"__test\");\n      this.storage = localStorage;\n    } catch (e) {\n      console.warn(\"Local storage is disabled, no settings will be saved\");\n      this.storage = new FakeStorage();\n    }\n    this.currentVersion = this.get(\"__version\");\n  }\n\n  version(versionNumber: number, upgradeFunction: Function) {\n    if (versionNumber > this.currentVersion) {\n      this.currentVersion = versionNumber;\n      this.setAll(upgradeFunction(this.getAll()));\n    }\n  }\n\n  getAll(): any {\n    return JSON.parse(this.storage.getItem(this.name));\n  }\n\n  get(key: string) {\n    const settings = this.getAll();\n    return settings && settings[key];\n  }\n\n  setAll(newSettings: any) {\n    this.storage.setItem(\n      this.name,\n      JSON.stringify({ ...newSettings, __version: this.currentVersion })\n    );\n  }\n\n  set(key: string, value: string) {\n    let settings = this.getAll();\n    settings[key] = value;\n    this.setAll(settings);\n  }\n}\n\nexport default Settings;\n","import React, { useState, useEffect, useContext } from \"react\";\n\nimport { getSettings } from \"../settings\";\n\nimport { Settings } from \"../types/Settings\";\n\ntype SettingsContextValue = {\n  settings: Settings;\n  setSettings: React.Dispatch<React.SetStateAction<Settings>>;\n};\n\nconst SettingsContext =\n  React.createContext<SettingsContextValue | undefined>(undefined);\n\nconst settingsProvider = getSettings();\n\nexport function SettingsProvider({ children }: { children: React.ReactNode }) {\n  const [settings, setSettings] = useState<Settings>(settingsProvider.getAll());\n\n  useEffect(() => {\n    settingsProvider.setAll(settings);\n  }, [settings]);\n\n  const value = {\n    settings,\n    setSettings,\n  };\n\n  return (\n    <SettingsContext.Provider value={value}>\n      {children}\n    </SettingsContext.Provider>\n  );\n}\n\nexport function useSettings() {\n  const context = useContext(SettingsContext);\n  if (context === undefined) {\n    throw new Error(\"useSettings must be used within a SettingsProvider\");\n  }\n  return context;\n}\n\nexport default SettingsContext;\n","import Settings from \"./helpers/Settings\";\n\nfunction loadVersions(settings: Settings) {\n  settings.version(1, () => ({\n    fog: {\n      type: \"polygon\",\n      useEdgeSnapping: false,\n      useFogCut: false,\n      preview: false,\n    },\n    drawing: {\n      color: \"red\",\n      type: \"brush\",\n      useBlending: true,\n      opacity: 1,\n      strokeWidth: 1,\n      dashStyle: \"solid\",\n    },\n    measure: {\n      type: \"chebyshev\",\n      scale: \"5ft\",\n    },\n    timer: {\n      hour: 0,\n      minute: 0,\n      second: 0,\n    },\n    dice: {\n      shareDice: false,\n      style: \"galaxy\",\n    },\n  }));\n  // v1.5.2 - Added full screen support for map and label size\n  settings.version(2, (prev: any) => ({\n    ...prev,\n    map: { fullScreen: false, labelSize: 1 },\n  }));\n  // v1.7.0 - Added game password\n  settings.version(3, (prev: any) => ({\n    ...prev,\n    game: { usePassword: true },\n  }));\n  // v1.8.0 - Added pointer color, grid snapping sensitivity and remove measure\n  settings.version(4, (prev: any) => {\n    let newSettings = {\n      ...prev,\n      pointer: { color: \"red\" },\n      map: { ...prev.map, gridSnappingSensitivity: 0.2 },\n    };\n    delete newSettings.measure;\n    return newSettings;\n  });\n  // v1.8.0 - Removed edge snapping for multilayer\n  settings.version(5, (prev: any) => {\n    let newSettings = { ...prev };\n    delete newSettings.fog.useEdgeSnapping;\n    newSettings.fog.multilayer = false;\n    return newSettings;\n  });\n  // v1.8.1 - Add show guides toggle\n  settings.version(6, (prev: any) => ({\n    ...prev,\n    fog: { ...prev.fog, showGuides: true },\n  }));\n  // v1.8.1 - Add fog edit opacity\n  settings.version(7, (prev: any) => ({\n    ...prev,\n    fog: { ...prev.fog, editOpacity: 0.5 },\n  }));\n  // v1.10.0 - Add select tool\n  settings.version(8, (prev: any) => ({\n    ...prev,\n    select: { type: \"rectangle\" },\n  }));\n  // v1.10.0 - Add use shape fill setting\n  settings.version(9, (prev: any) => ({\n    ...prev,\n    drawing: {\n      ...prev.drawing,\n      useShapeFill: true,\n    },\n  }));\n  // v1.11.0 - Add image compression quality\n  settings.version(10, (prev: any) => ({\n    ...prev,\n    asset: {\n      compressionQuality: prev?.asset?.compressionQuality ?? 0.8,\n    },\n  }));\n  // v1.12.0 - Add spell template tool settings\n  settings.version(11, (prev: any) => ({\n    ...prev,\n    spellTemplates: {\n      type: \"circle\",\n      rule: \"center\",\n      color: \"red\",\n      opacity: 0.5,\n      strokeWidth: 1,\n      lineWidth: 1,\n      coneAngle: 90,\n      ringInnerRatio: 0.5,\n      previewOnRotate: true,\n    },\n  }));\n  // v1.13.0 - Add token note settings\n  settings.version(12, (prev: any) => ({\n    ...prev,\n    tokenNote: {\n      enabled: false,\n      trigger: \"longPress\",\n      longPressMs: 500,\n      blur: \"high\",\n      fontSize: \"md\",\n      defaultFont: \"default\",\n      defaultPermission: \"write\",\n    },\n  }));\n  // v1.14.0 - Add drawing opacity/stroke width/dash style\n  settings.version(13, (prev: any) => ({\n    ...prev,\n    drawing: {\n      ...prev.drawing,\n      opacity:\n        typeof prev?.drawing?.opacity === \"number\"\n          ? prev.drawing.opacity\n          : prev?.drawing?.useBlending\n          ? 0.5\n          : 1,\n      strokeWidth:\n        typeof prev?.drawing?.strokeWidth === \"number\"\n          ? prev.drawing.strokeWidth\n          : 1,\n      dashStyle: prev?.drawing?.dashStyle ?? \"solid\",\n    },\n  }));\n  // v1.15.0 - Add GM fog opacity\n  settings.version(14, (prev: any) => ({\n    ...prev,\n    fog: {\n      ...prev.fog,\n      gmOpacity:\n        typeof prev?.fog?.gmOpacity === \"number\" ? prev.fog.gmOpacity : 0.35,\n    },\n  }));\n  // v1.15.1 - Add explored fog toggle\n  settings.version(15, (prev: any) => ({\n    ...prev,\n    fog: {\n      ...prev.fog,\n      showExplored: typeof prev?.fog?.showExplored === \"boolean\" ? prev.fog.showExplored : false,\n    },\n  }));\n  // v1.16.0 - Add real-time fog preview on token drag\n  settings.version(16, (prev: any) => ({\n    ...prev,\n    fog: {\n      ...prev.fog,\n      previewOnDrag:\n        typeof prev?.fog?.previewOnDrag === \"boolean\"\n          ? prev.fog.previewOnDrag\n          : false,\n    },\n  }));\n  // v1.16.1 - Add auto vision on token drop\n  settings.version(17, (prev: any) => ({\n    ...prev,\n    fog: {\n      ...prev.fog,\n      autoVisionOnDrop:\n        typeof prev?.fog?.autoVisionOnDrop === \"boolean\"\n          ? prev.fog.autoVisionOnDrop\n          : false,\n    },\n  }));\n}\n\nexport function getSettings() {\n  let settings = new Settings(\"OwlbearRodeoSettings\");\n  loadVersions(settings);\n  return settings;\n}\n","/**\n * @param {Blob} blob\n * @returns {Promise<Uint8Array>}\n */\nasync function blobToBuffer(blob: Blob): Promise<Uint8Array> {\n  if (blob.arrayBuffer) {\n    const arrayBuffer = await blob.arrayBuffer();\n    return new Uint8Array(arrayBuffer);\n  } else {\n    return new Promise((resolve) => {\n      const reader = new FileReader();\n\n      function onLoadEnd() {\n        reader.removeEventListener(\"loadend\", onLoadEnd, false);\n        resolve(Buffer.from(reader.result as ArrayBuffer));\n      }\n\n      reader.addEventListener(\"loadend\", onLoadEnd, false);\n      reader.readAsArrayBuffer(blob);\n    });\n  }\n}\n\nexport default blobToBuffer;\n"],"sourceRoot":""}